<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="3201 一般存款"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	commsend_001();
	commsend_101();
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>
<VARIABLE UPLOOP="TRUE">
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(3201                            储蓄存款)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=2201)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  

  <ITEM NAME="#LACTNO" LINE="7"  COL="11"  TYPE="%-10s" VISABLE="TRUE" FUNCTIONS="T(帐    号: )"/>
  <ITEM NAME="#LACSEQ" LINE="7"  COL="45"  TYPE="%-10s" FUNCTIONS="T(帐户序号: )" VISABLE="FALSE" INPUT="LABEL"/>
  <ITEM NAME="#LACTNO" LINE="9"  COL="10"  TYPE="%-16s" VISABLE="TRUE" FUNCTIONS="T(【产品信息】)"/>
  <ITEM NAME="#LACTNO" LINE="10" COL="11"  TYPE="%-50s" VISABLE="TRUE" FUNCTIONS="T(------------------------------------------------------------)"/>
  

  <ITEM NAME="#ACTNO" INPUT="TEXT" LINE="7"  COL="21" TYPE="%-19s" VISABLE="TRUE" FUNCTIONS="T(1000004000278)">
  <ONLOSTFOCUS>"{
	dim @baktxno as string;
	@baktxno=$TXNO;
	$TXNO='9951';
	$FD101=#ACTNO+space(157);
	commsend_001();
	
	callserver();
	$TXNO=@baktxno;
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	commrecv_101();
	
	// 卡户的判断条件是: 101-1域长度为19并且101-E域不为空
	if( (len(rtrim(substr($FD101,0,24)))==19 or len(rtrim(substr($FD101,0,24)))==17) and atoi(substr($FD101,147,4))!=0 )
	{
		#ACTSEQ=substr($FD101,147,4);
	    show(#S_NBCD,false);
	    show(#NBFLAG,false);
	    show(#ACTSEQ,true);
	    show(#LACSEQ,true);
	    return(true);
	}else{
	    #NBFLAG='0';
	    showblock('ACTINFO',true,true);
	    show(#ACTSEQ,false);
	    show(#LACSEQ,false);
	 }
  }"
  </ONLOSTFOCUS>
  </ITEM>

  
  <ITEM NAME="#ACTSEQ" INPUT="TEXT" LINE="7"  COL="55" TYPE="%4d" DEVICE="KEYBOARD" VISABLE="FALSE" FUNCTIONS="">
  <ONLOSTFOCUS>"{
	dim @baktxno as string;
	@baktxno=$TXNO;
	$TXNO='9846';
	$FD101=#ACTNO+space(24-len(#ACTNO))+#ACTSEQ+space(153);
	commsend_001();
	
	callserver();
	$TXNO=@baktxno;
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	commrecv_101();
	#NBFLAG='0';
	showblock('ACTINFO',true,true);
  }"
  </ONLOSTFOCUS>
  </ITEM>

  
  <ITEM NAME="#ACTNO24"    TYPE="%-24s"  FUNCTIONS=""/>  
  <ITEM NAME="#TXAMT15"    TYPE="%17.2f" FUNCTIONS=""/>
  <ITEM NAME="#DESC10"     TYPE="%-10s"  FUNCTIONS=""/>
  <ITEM NAME="#DSCPT"      TYPE="%-3s"   FUNCTIONS=""/>
  <ITEM NAME="#ACTTYPE"    TYPE="%-1s"   FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ_2"   TYPE="%-4s"   FUNCTIONS=""/>
  
  <BLOCK NAME="ACTINFO" LINE="10" COL="5" VISABLE="FALSE">


  <ITEM LINE="2"  COL="6"  TYPE="%-10s" FUNCTIONS="T(户    名:)"/>
  <ITEM LINE="3"  COL="6"  TYPE="%-10s" FUNCTIONS="T(币    种:!)"/>
  <ITEM LINE="4"  COL="6"  TYPE="%-10s" FUNCTIONS="T(余    额:)"/>
  <ITEM LINE="5"  COL="6"  TYPE="%-10s" FUNCTIONS="T(产品名称:)"/>
  
  <ITEM LINE="7"  COL="6"  TYPE="%-10s" FUNCTIONS="T(凭证类型:!)"/>
  <ITEM LINE="7"  COL="40" TYPE="%-10s" FUNCTIONS="T(凭证号码:)"/>
  <ITEM LINE="8"  COL="6"  TYPE="%-10s" FUNCTIONS="T(无折标志:!)"  NAME="#S_NBCD" INPUT="LABEL"/>
  <ITEM LINE="9"  COL="6"  TYPE="%-10s" FUNCTIONS="T(现转标志:!)"/>
  <ITEM LINE="10" COL="6" TYPE="%-10s" FUNCTIONS="T(交易金额:)"/>
  <!---------------------------------------------------->
  <ITEM NAME="#CUSTNAME" LINE="2"  COL="16" TYPE="%-50s" FUNCTIONS="J(#CUSTNAME30)"/>
  <ITEM NAME="#CUSTNAME30" TYPE="%-30s" FUNCTIONS="T(#CUSTNAME)"/>
  <ITEM NAME="#CURCD" LINE="3"  COL="16" TYPE="%-2s" INPUT="SELECT" FUNCTIONS="" ENABLE="FALSE">
	<SELECT>
		<OPTION VALUE="01" TITLE="0.人民币"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#LAVBAL" LINE="4"  COL="16" TYPE="%-21s" FUNCTIONS="X(#AVBAL)"/>
  <ITEM NAME="#AVBAL"  TYPE="%17.2f" FUNCTIONS="J(#LAVBAL)"/>
  <ITEM NAME="#PRODNAME" LINE="5"  COL="16" TYPE="%-30s" FUNCTIONS=""/>
  <ITEM NAME="#VOCTYPE"  LINE="7"  COL="16" TYPE="%-3s" INPUT="SELECT" FUNCTIONS="" ENABLE="FALSE">
	<SELECT>
		<OPTION VALUE="010" TITLE="0.储蓄活期存折"/>
		<OPTION VALUE="020" TITLE="0.储蓄卡"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#SVOCTYPE"         TYPE="%-30s"         FUNCTIONS="S(#VOCTYPE,#VOCTYPE)"/>

  <ITEM NAME="#VOCNUM" LINE="7"  COL="50" TYPE="%16d" FUNCTIONS=""/>
  <ITEM NAME="#NBFLAG" LINE="8"  COL="16" TYPE="%-1s" FUNCTIONS="T(0)"/>
  <ITEM NAME="#SNBFLAG"  TYPE="%-4s"        FUNCTIONS="S(#NBFLAG,#NBFLAG)"/>

  <ITEM NAME="#CASHFLAG" LINE="9"  COL="16" TYPE="%-1s" INPUT="SELECT" FUNCTIONS="" ENABLE="FALSE">
	<SELECT>
		<OPTION VALUE="1" TITLE="0.现金"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#SCASHFLAG" TYPE="%-4s"        FUNCTIONS="S(#CASHFLAG,#CASHFLAG)"/>
  
  <ITEM NAME="#TXAMT" LINE="10"  COL="16" TYPE="%17.2f" INPUT="TEXT" FUNCTIONS="T(10000)J(#LTXAMT)"/>
  <ITEM NAME="#LTXAMT" TYPE="%-21s" FUNCTIONS="X(#TXAMT)"/>
  
   </BLOCK>

 

  <!--输出变量--->
  
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>

</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
	<PACKAGE DEVICE="SCREEN" DESC="储蓄存款">
	NOTHING
	</PACKAGE>
	<PRINT>
	"{
		print( 3,30,'储蓄存款');
		print( 4,22,'帐    号:[19]',#ACTNO);
		print( 5,22,'户    名:[50]',#CUSTNAME);
		print( 6,22,'产品名称:[30]',#PRODNAME);
		print( 7,22,'凭证类型:[30]',#SVOCTYPE);
		print( 8,22,'凭证号码:[16]',#VOCNUM);
		print( 9,22,'有无存折:[ 4]',#SVOCTYPE);
		print(10,22,'存款方式:[ 4]',#SCASHFLAG);
		print(11,22,'交易金额:[21]',#LTXAMT);
		print(12,22,'流 水 号:[ 5]',$FD4);
	}"
	</PRINT>
	
</RESPONSE>
<IMPORT>CXCZ.IMP</IMPORT>
</TRANSACTION>
