<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="8604     批量业务联机入帐"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	initfd();
	$MSGTYPE='03001';
	dim @baktxno as string;
	@baktxno=$TXNO;
	$FD12='6604';
	$TXNO='9986';
	 commsend_001();
     	$FD21=#AGENTYPE;
     	$FD25=#DWNAME; 
     	$FD71=#YWTYPE;
     	$FD92=#DWID;
	callserver();
	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}
	$FD16 = '6604';
  	$MSGTYPE='03001';
    
}"
</COMMSEND>
<COMMRECV>"{
commrecv_001();
if($FD12 == '0000')
	 {
		 showmsg('交易成功!');
	 }
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-52s" FUNCTIONS=
    "T(8604                            批量业务联机入帐)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=6604)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  
  <ITEM LINE="7"   COL="10"   TYPE="%-10s" FUNCTIONS="T(单位编号:)"/>
  <ITEM LINE="7"   COL="26"   TYPE="%-10s" FUNCTIONS="T(业务性质:!)" />
  <ITEM LINE="7"   COL="48"   TYPE="%-10s" FUNCTIONS="T(代理类型:!)" />
  <ITEM LINE="9"   COL="10"   TYPE="%-10s" FUNCTIONS="T(单位名称:)" />
   
  <ITEM LINE="7"   COL="21"  NAME="#DWID"        TYPE="%-4s"        INPUT="TEXT"    FUNCTIONS="">
   <ONLOSTFOCUS>
		"{
		    dim @txno_bak as string;
        	    @txno_bak=$TXNO;
		    $TXNO='9841';
		    $FD92=#DWID;
		    commsend_001();		
		    callserver();
		    if($FD12!='0000')
		    {
			    showmsg(geterror());
			    return(false);
		    }
		    $TXNO=@txno_bak;
		    #DWNAME=delspace($FD25);
		    #YWTYPE=delspace($FD71);
		    #AGENTYPE=delspace($FD21);
		    enable(#DWNAME,false);
		    enable(#YWTYPE,false);
		    enable(#AGENTYPE,false);
		}"
	 </ONLOSTFOCUS>
  </ITEM>  
  <ITEM LINE="7"  COL="37"  NAME="#YWTYPE"      TYPE="%-1s"        INPUT="SELECT"  FUNCTIONS="T(0)">
    <SELECT>
       <OPTION VALUE ="0" TITLE="0.代收" />
       <OPTION VALUE ="1" TITLE="1.代付" />
    </SELECT>
  </ITEM>
  <ITEM LINE="7"  COL="60"  NAME="#AGENTYPE"    TYPE="%-2s"        INPUT="SELECT"  FUNCTIONS="T(30)">
   <SELECT>
       <OPTION VALUE ="30" TITLE="30.代发工资       " />
       <OPTION VALUE ="31" TITLE="31.财政工资       " />
       <OPTION VALUE ="32" TITLE="32.代发自来水工资 " />
       <OPTION VALUE ="33" TITLE="33.批量贷记       " />
       <OPTION VALUE ="35" TITLE="35.现金代发       " />
       <OPTION VALUE ="37" TITLE="37.代发定活       " />
       <OPTION VALUE ="38" TITLE="38.代发整整       " />
       <OPTION VALUE ="39" TITLE="39.代发零整       " />
       <OPTION VALUE ="40" TITLE="40.代扣费         " />
       <OPTION VALUE ="41" TITLE="41.代收个人所得税 " />
       <OPTION VALUE ="42" TITLE="42.代收罚款       " />
       <OPTION VALUE ="43" TITLE="43.代收水费       " />
       <OPTION VALUE ="44" TITLE="44.代收煤气费     " />
       <OPTION VALUE ="45" TITLE="45.代收电费       " />
       <OPTION VALUE ="46" TITLE="46.代收税款       " />
       <OPTION VALUE ="47" TITLE="47.代收话费       " />
       <OPTION VALUE ="48" TITLE="48.代收移动费    " />
    </SELECT>          
  </ITEM>
  <ITEM LINE="9"   COL="21"   NAME="#DWNAME"         TYPE="%-50s"       INPUT="TEXT"  FUNCTIONS=""/>  
	 <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD"   TYPE="%-6s"    FUNCTIONS="T()"/>

  <ITEM LINE="21"  COL="59" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>
  "{
  	initfd();
	$MSGTYPE='03001';
	dim @baktxno as string;
	dim @f as file;
	dim @tota as string;
	@baktxno=$TXNO;
	$FD12='6604';
	$TXNO='9986';
	commsend_001();
     	$FD21=#AGENTYPE;
     	$FD25=#DWNAME; 
     	$FD71=#YWTYPE;
     	$FD92=#DWID;
	callserver();
	$TXNO=@baktxno;
	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}
	$FD16 = '6604';
  	$MSGTYPE='03001';
  	commsend_001();
     	$FD21=#AGENTYPE;
     	$FD25=#DWNAME; 
     	$FD71=#YWTYPE;
     	$FD92=#DWID;
	@tota=callserver();
	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}
	if($FD67 != '0')
	{
	 	  @f=openfile('../tmp/批量业务联机入帐['+#DWID+']','w');
     	writeline(@f,@tota);
     	closefile(@f);
     	call('fview ../tmp/批量业务联机入帐['+#DWID+']');
  }
  else
  {
      showmsg('该单位没有数据可联机入账!!!');
  }
  }"
  </ONCLICK>
  </ITEM>

</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE>
NOTHING
</PACKAGE>
</RESPONSE>

<OUTPUT>

</OUTPUT>
</TRANSACTION>
