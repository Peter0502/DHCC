<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00000000" TITLE="7114 制卡处理  "
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
  <COMMSEND>"{
	initfd();
	commsend_001();
	$FD37=#STACTNO;
	$FD38=#EDACTNO;
	$FD52=#COUNT;
	$FD116=#JZTYPE; 
  }"
  </COMMSEND>
  <COMMRECV>"{
	if($FD12 == '0000')
	{
	showmsg('交易成功!');
	}
}"
</COMMRECV>

<FIRSTWORK>"{
	dim @txno_bak as string;
	dim @tota as string;
	@txno_bak=$TXNO;
	$TXNO='9923';
	commsend_001();
	@tota=callserver();
	//showmsg(@tota);	
	setsel(#JZTYPE,@tota,'o5t20o1v4o2');
}"
</FIRSTWORK>

  <VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(7114                            制卡处理)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
   <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
   <ITEM NAME="#TXNO" 	 TYPE="%-4s" FUNCTIONS="T($TXNO=5114)"/>
   <!--输入变量-->
  <ITEM LINE="7"   COL="15" TYPE="%-10s" FUNCTIONS="T(介质种类:)"/>
  <ITEM LINE="9"   COL="15" TYPE="%-10s" FUNCTIONS="T(起始卡号:)"/>
  <ITEM LINE="11"  COL="15" TYPE="%-10s" FUNCTIONS="T(终止卡号:)"/>
  <ITEM LINE="13"  COL="15" TYPE="%-10s" FUNCTIONS="T(总 数 量:)"/>
  <ITEM NAME="#JZTYPE" 	INPUT="SELECT" LINE="7" COL="25" TYPE="%-4s" 	FUNCTIONS="T(0020)V(NB)">
  	<SELECT>
  		<OPTION VALUE="0O20" TITLE="1.储蓄卡"/>
  	</SELECT>
  </ITEM>
  <ITEM NAME="#STARTNO" INPUT="TEXT" LINE="9"  COL="25" TYPE="%8d" 	FUNCTIONS="T()V(NB)"/>
  <ITEM NAME="#ENDNO" INPUT="TEXT" LINE="11" COL="25" TYPE="%8d" 	FUNCTIONS="T()V(NB)"/>
  <ITEM NAME="#STACTNO" TYPE="%16d" 	FUNCTIONS="T(#CAPTION+#STARTNO)"/>
  <ITEM NAME="#EDACTNO"  TYPE="%16d" 	FUNCTIONS="T(#CAPTION+#ENDNO)"/>
  <ITEM NAME="#CAPTION" TYPE="%8d" FUNCTIONS="T(62246581)"/>
<!--
  <ITEM NAME="#STACTNO" INPUT="TEXT" LINE="9"  COL="25" TYPE="%8d" 	FUNCTIONS="T()V(NB)"/>
  <ITEM NAME="#EDACTNO" INPUT="TEXT" LINE="11" COL="25" TYPE="%8d" 	FUNCTIONS="T()V(NB)"/>
-->
  <ITEM NAME="#FLAG" TYPE="%-12s" FUNCTIONS="T(1)">
   <ONLOSTFOCUS>
  "{
     //#COUNT=itoa((atoi(#EDACTNO)-atoi(#STACTNO)+1),'%12d');
     #COUNT=itoa((val(#ENDNO)-val(#STARTNO)+1),'%12d');
     show(#COUNT,true);
     enable(#COUNT,false);
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#COUNT"   INPUT="TEXT" LINE="13" COL="25" TYPE="%12s" 	FUNCTIONS="T(0)"/>
  <ITEM NAME="#PASSWD" 	TYPE="%-6s"  FUNCTIONS="T()"/>
  <ITEM NAME="#NAME2"  TYPE="%-20s" FUNCTIONS="S(#JZTYPE,#JZTYPE)"/>
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($HDATE,1,4)"/>
  <ITEM NAME="#MON"   TYPE="%-2s" FUNCTIONS="T($HDATE,5,2)"/>
  <ITEM NAME="#DAY"   TYPE="%-2s" FUNCTIONS="T($HDATE,7,2)"/>
 </VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="制卡处理!">
 NOTHING
 </PACKAGE>
  <PRINT>"{
	  print( 2,  24,'交易名称:制卡处理');
	  
	  print( 4,  20,'交易机构:[5]',$FD2);
	  print( 5,  20,'交易日期:[4]年[2]月[2]日',#YEAR,#MON,#DAY);  
	  print( 6,  20,'流水号码:[6]',$FD4);
	  print( 7,  20,'操作员号:[4]',$FD7);
	  
	  print( 8,  20,'介质种类:[20 ]',#NAME2);
	  print( 9,  20,'起始卡号:[16 ]',#STACTNO);
	  print( 10, 20,'终止卡号:[16 ]',#EDACTNO);
	  print( 11, 20,'总 数 量:[12 ]',#COUNT);
	}"
</PRINT>
</RESPONSE>
</TRANSACTION>




