<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00000000" TITLE="7113 撤销凭证管理交易  "
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
  <COMMSEND>"{
 	commsend_001();
 		$FD23=#PZZL;
 		$FD30=#ACTNO;
 		$FD52=#WSSRNO;
 		$FD53=#PZSL;
 		$FD58=#PZHM;
 		$FD92=#TLRNO;
  }"
  </COMMSEND>
  <COMMRECV>"{
	if($FD12 == '0000')
	 {
		 showmsg('交易成功!');
	 }
}"
</COMMRECV>

<FIRSTWORK>"{
	dim @txno_bak as string;
	dim @tota as string;
	@txno_bak=$TXNO;
	$TXNO='9885';
	commsend_001();
	@tota=callserver();	
    //showmsg(@tota);
	setsel(#PZZL,@tota,'o5t20o1v3o2');
}"

</FIRSTWORK>

  <VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(7113                            撤销凭证管理交易)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
   <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
   <ITEM NAME="#TXNO" 	 TYPE="%-4s" FUNCTIONS="T($TXNO=5113)"/>
   <!--输入变量-->
   
  <ITEM LINE="7"   	COL="15" TYPE="%-10s" FUNCTIONS="T(流 水 号:)"/>
  
  <ITEM LINE="10"  	COL="15" TYPE="%-10s" FUNCTIONS="T(客户帐号:)"/>
  
  <ITEM LINE="11" 	COL="15" TYPE="%-10s" FUNCTIONS="T(凭证种类:)"/>
  <ITEM LINE="12" 	COL="15" TYPE="%-10s" FUNCTIONS="T(凭证号码:)"/>
  <ITEM LINE="13" 	COL="15" TYPE="%-10s" FUNCTIONS="T(凭证数量:)"/>
  <ITEM LINE="14"		COL="15" TYPE="%-10s" FUNCTIONS="T(操 作 员:)"/>
 
  <ITEM NAME="#WSSRNO" INPUT="TEXT" LINE="7" COL="25" TYPE="%12d" 	FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
	"{
		initfd();
		dim @txno_bak as string;
		@txno_bak=$TXNO;
		$TXNO='9871';
		commsend_001();
		$FD52=#WSSRNO;
		$TXNO=@txno_bak;
		callserver();
		#PZZL=$FD23;
		#PZSL=$FD53;
		#ACTNO=$FD30;	
		#PZHM=$FD58;
		#TLRNO=$FD92;
		showall();
		if($FD12!='0000')
		{
			showmsg(geterror());
			return(false);
		}
		enable(#PZZL, false);	
		enable(#PZSL, false);	
		enable(#TLRNO, false);	
		enable(#PZHM, false);	
		enable(#ACTNO,false);
			initfd();
	}"
    </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#ACTNO"	INPUT="TEXT" 		LINE="10" COL="25" TYPE="%-20s" FUNCTIONS="T()V(NB)"/>
  <ITEM NAME="#PZZL" 	INPUT="SELECT" 	LINE="11" COL="25" TYPE="%-3s" 		FUNCTIONS="T(001)V(NB)">
  	<SELECT>
  		<OPTION VALUE="001" TITLE="现金支票"/>
  		
  	</SELECT>
  </ITEM>
  <ITEM NAME="#NAME2"  TYPE="%-20s" FUNCTIONS="S(#PZZL,#PZZL)"/>
  <ITEM NAME="#PZHM" 	INPUT="TEXT" LINE="12" COL="25" TYPE="%16d" 	FUNCTIONS="T()V(NB)"/>


  <ITEM NAME="#PZSL"   	INPUT="TEXT" 	LINE="13" COL="25" TYPE="%10d" 		DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)"/>
  <ITEM NAME="#TLRNO"   INPUT="TEXT" 	LINE="14" COL="25" TYPE="%4d" 		DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)"/>
  
  <ITEM NAME="#PASSWD" 	TYPE="%-6s" 	FUNCTIONS="T()"/>
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($HDATE,1,4)"/>
  <ITEM NAME="#MON"   TYPE="%-2s" FUNCTIONS="T($HDATE,5,2)"/>
  <ITEM NAME="#DAY"   TYPE="%-2s" FUNCTIONS="T($HDATE,7,2)"/>
  
    </VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="撤销凭证管理交易!">
 NOTHING
 </PACKAGE>
  <PRINT>"{
          print( 2,  24,'交易名称:撤销凭证管理交易');
          
          print( 4,  20,'交易机构:[5]',$FD2);
	  print( 5,  20,'交易日期:[4]年[2]月[2]日',#YEAR,#MON,#DAY);  
	  print( 6,  20,'流水号码:[6]',$FD4);
	  print( 7,  20,'操作员号:[4]',$FD7);
	  
	  print( 8,  20,'流 水 号:[12 ]',#WSSRNO);
	  print( 9,  20,'客户帐号:[20 ]',#ACTNO); 
	  print( 10, 20,'凭证种类:[20 ]',#NAME2);
	  print( 11, 20,'凭证号码:[16 ]',#PZHM);
	  print( 12, 20,'凭证数量:[10 ]',#PZSL);	
	  print( 13, 20,'操 作 员:[4  ]',#TLRNO);
	}"
</PRINT>
</RESPONSE>
<RESPONSE>
	<PACKAGE DEVICE="PRINTER" DESC="请打印业务专用凭证" LINESPACE="12">
 NOTHING
 </PACKAGE>
  <PRINT>"{
 $KINDNO='00';
 dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 7, 28,'[5]',$KINBR);
	print( 7, 10,'[20]',$BRNAME);
	print( 7, 5,'交易日期:[8  ]  [8]',$HDATE,@txtime);
    print( 9,36,'撤销凭证管理交易'); 
	print(11,  10,'流 水 号:[12 ]',#WSSRNO);
	print(13,  10,'客户帐号:[20]',#ACTNO);
	  print( 15, 10,'凭证种类:[20 ]',#NAME2);
	  print( 15, 10,'凭证号码:[16 ]',#PZHM);
	  print( 17, 10,'凭证数量:[12 ]',#PZSL);
	print(19,10,'操作员号:[4]     流 水 号:[6]',$FD7,$FD4);           
	  
	}"
</PRINT>
</RESPONSE>
 </TRANSACTION>


