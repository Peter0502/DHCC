<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111001" TITLE="2117 公司机构信息录入"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	initfd();
	commsend_001();
	$FD25=#YWFW;		//业务范围
	$FD26=#JGYWM;		//机构英文名
	$FD27=#SJJGM;		//上级机构名
	$FD28=#CUSTNO;	//客户号
	$FD30=#JGXYDM;	//机构信用代码
	$FD82=#JGLB;		//机构类别
	$FD48=#JGXF;		//机构细分
	$FD52=#JJHYFL3;	//经济行业分类
	$FD50=#JJLX;		//经济类型
	$FD81=#TEL;			//电话
	$FD67=#SJJGZCLX;//上级机构注册类型
	$FD31=#SJJGZCHM;//上级机构注册号码
	$FD60=#SJJGZZDM;//上级机构组织代码
	$FD83=#SJJGXYDM;//上级机构信用代码
	$FD63=#ZCDQH2;		//注册地行政区划
	$FD44=#KSRQ;		//开始日期
	$FD45=#ZZRQ;		//终止日期
	$FD62=#KHXKZH;	//开户许可证号
	
	}"
</COMMSEND>
<COMMRECV>"{
	}"
</COMMRECV>

<VARIABLE>
	<ITEM LINE="3"  COL="3" TYPE="%-52s" FUNCTIONS=
    "T(2117                           公司机构信息录入)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=1117)"/>
  
  <ITEM LINE="5" COL="2" TYPE="%-15s" FUNCTIONS="T(客   户   号:)" />
  <ITEM LINE="6" COL="2" TYPE="%-15s" FUNCTIONS="T(机构信用代码:)" />
  <ITEM LINE="6" COL="35" TYPE="%-15s" FUNCTIONS="T(开户许可证号:)" />
  <ITEM LINE="7" COL="2" TYPE="%-18s" FUNCTIONS="T(营业执照开始日期:)" />
  <ITEM LINE="7" COL="35" TYPE="%-18s" FUNCTIONS="T(营业执照终止日期:)" />  
  <ITEM LINE="8" COL="2" TYPE="%-15s" FUNCTIONS="T(注册地行政区:)" />
  <ITEM LINE="9" COL="2" TYPE="%-15s" FUNCTIONS="T(组织机构类别:)" />
  <ITEM LINE="9" COL="35" TYPE="%-15s" FUNCTIONS="T(组织机构细分:)" />
  <ITEM LINE="10" COL="2" TYPE="%-15s" FUNCTIONS="T(经济行业分类:)" />
  <ITEM LINE="12" COL="2" TYPE="%-15s" FUNCTIONS="T(经 济  类 型:)" />
  <ITEM LINE="13" COL="2" TYPE="%-15s" FUNCTIONS="T(业 务  范 围:)" />
  <ITEM LINE="14" COL="2" TYPE="%-15s" FUNCTIONS="T(机构英文名称:)" />
  <ITEM LINE="15" COL="2" TYPE="%-15s" FUNCTIONS="T(财 务  电 话:)" />
  <ITEM LINE="16" COL="2" TYPE="%-15s" FUNCTIONS="T(上级机构名称:)" />
  <ITEM LINE="17" COL="2" TYPE="%-25s" FUNCTIONS="T(上级机构登记注册类型:)" />
  <ITEM LINE="18" COL="2" TYPE="%-25s" FUNCTIONS="T(上级机构登记注册号码:)" />
  <ITEM LINE="19" COL="2" TYPE="%-20s" FUNCTIONS="T(上级机构组织代码:)" />
  <ITEM LINE="20" COL="2" TYPE="%-20s" FUNCTIONS="T(上级机构信用代码:)" />

	<ITEM LINE="5" COL="15" NAME="#CUSTNO" TYPE="%-8s" DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
	"{
		dim @txno_bak as string;
		@txno_bak=$TXNO;
		$TXNO='9410';
		$FD28=#CUSTNO;
		commsend_001();
		callserver();
		$TXNO=@txno_bak;
	
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
			
			
		}
		dim @list1 as string;
		@list1 = getproandcity('10000','province');
		setsel(#ZCDQH,@list1,'o5t20o1v6o2');		
	}"
    </ONLOSTFOCUS>
  </ITEM>
  
  <ITEM LINE="6" COL="15" NAME="#JGXYDM" TYPE="%-20s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)">
  <ITEM NAME="#S_JGXYDM" TYPE="%-10s" FUNCTIONS="S(#JGXYDM,#JGXYDM)"/> 
	<ONLOSTFOCUS>"{
		dim @l as number;
		@l = len(#JGXYDM);
    if(@l != 18){
   
    showmsg('机构信用号码位数错误，应为18位');
        	return(false);
		}
    	
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="6" COL="48" NAME="#KHXKZH" TYPE="%-20s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS="T()V()"/>
  <ITEM NAME="#S_KHXKZH" TYPE="%-10s" FUNCTIONS="S(#KHXKZH,#KHXKZH)"/>   
  <ITEM LINE="7" COL="15" NAME="#KSRQ" TYPE="%-8s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS=""/>
  <ITEM NAME="#S_KSRQ" TYPE="%-8s" FUNCTIONS="S(#KSRQ,#KSRQ)"/> 
  <ITEM LINE="7" COL="48" NAME="#ZZRQ" TYPE="%-8s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS=""/>  
  <ITEM NAME="#S_ZZRQ" TYPE="%-8s" FUNCTIONS="S(#ZZRQ,#ZZRQ)"/>   
  
  <ITEM LINE="8" COL="15" NAME="#ZCDQH" TYPE="%-10s" INPUT="SELECT" DEVICE="KEYBOARD" FUNCTIONS="V(NB)">
  	<ONLOSTFOCUS>"{
  		dim @list1 as string;
			@list1 = getproandcity(#ZCDQH,'city');
			setsel(#ZCDQH1,@list1,'o5t20o1v6o2');	
  		}"
  		</ONLOSTFOCUS>
	</ITEM>
  <ITEM NAME="#S_ZCDQH" TYPE="%-10s" FUNCTIONS="S(#ZCDQH,#ZCDQH)"/> 	
	 <ITEM LINE="8" COL="30" NAME="#ZCDQH1" TYPE="%-10s" INPUT="SELECT" DEVICE="KEYBOARD" FUNCTIONS="V(NB)">
  	<ONLOSTFOCUS>"{
  		dim @list1 as string;
			@list1 = getproandcity(#ZCDQH1,'county');
			setsel(#ZCDQH2,@list1,'o5t20o1v6o2');	
			showmsg(#ZCDQH2);
  		}"
  		</ONLOSTFOCUS>
	</ITEM>
  <ITEM NAME="#S_ZCDQH1" TYPE="%-10s" FUNCTIONS="S(#ZCDQH1,#ZCDQH1)"/> 
	<ITEM LINE="8" COL="45" NAME="#ZCDQH2" TYPE="%-10s" INPUT="SELECT" DEVICE="KEYBOARD" FUNCTIONS="V(NB)"/>
  <ITEM NAME="#S_ZCDQH2" TYPE="%-10s" FUNCTIONS="S(#ZCDQH2,#ZCDQH2)"/> 	
  
  <ITEM LINE="9" COL="15" NAME="#JGLB" TYPE="%-1s" INPUT="SElECT" DEVICE="KEYBOARD" FUNCTIONS="T(1)V(NB)">
  	<SElECT>
  		<OPTION VALUE="1" TITLE="1.企业"/>
  		<OPTION VALUE="2" TITLE="2.事业单位"/>
  		<OPTION VALUE="3" TITLE="3.机关"/>
  		<OPTION VALUE="4" TITLE="4.社会团体"/>
  		<OPTION VALUE="7" TITLE="7.个体工商户"/>	
  		<OPTION VALUE="9" TITLE="9.其他"/>
  	</SELECT>
	</ITEM>
  <ITEM NAME="#S_JGLB" TYPE="%-10s" FUNCTIONS="S(#JGLB,#JGLB)"/> 

  <ITEM LINE="9" COL="45" NAME="#JGXF" TYPE="%-2s" INPUT="SElECT" DEVICE="KEYBOARD" FUNCTIONS="T(10)V(NB)">
  	<SElECT>
  		<OPTION VALUE="10" TITLE="10.企业法人"/>
  		<OPTION VALUE="11" TITLE="11.其他企业"/>
  		<OPTION VALUE="12" TITLE="12.农民合作社"/>
  		<OPTION VALUE="13" TITLE="13.个人独资、合法企业"/>
  		<OPTION VALUE="14" TITLE="14.企业的分支机构"/>
  		<OPTION VALUE="20" TITLE="20.事业法人"/>
  		<OPTION VALUE="21" TITLE="21.未登记的事业单位"/>
  		<OPTION VALUE="24" TITLE="24.事业单位的分支机构"/>
  		<OPTION VALUE="30" TITLE="30.机关法人"/>
  		<OPTION VALUE="31" TITLE="31.机关的内设机构"/>
  		<OPTION VALUE="32" TITLE="32.机关的下设机构"/>
  		<OPTION VALUE="40" TITLE="40.社会团体法人"/>
  		<OPTION VALUE="41" TITLE="41.社会团体分支机构"/>
  		<OPTION VALUE="51" TITLE="51.民办非企业"/>
  		<OPTION VALUE="52" TITLE="52.基金会"/>
  		<OPTION VALUE="53" TITLE="53.居委会"/>
  		<OPTION VALUE="54" TITLE="54.村委会"/>
  		<OPTION VALUE="60" TITLE="60.律师事务所、司法鉴定所"/>
  		<OPTION VALUE="61" TITLE="61.宗教活动场所"/>
  		<OPTION VALUE="62" TITLE="62.境外在境内成立的组织机构"/>
  		<OPTION VALUE="70" TITLE="70.个体工商户"/>
  		<OPTION VALUE="99" TITLE="99.其他"/>
  	</SElECT>
  	<ONLOSTFOCUS>"{
  		//
  		dim @list1 as string;
			@list1 = gethypropertiy('10000');
			setsel(#JJHYFL,@list1,'o5t50o1v1o2');
  		}"
  		</ONLOSTFOCUS>
  </ITEM>	
  <ITEM NAME="#S_JGXF" TYPE="%-30s" FUNCTIONS="S(#JGXF,#JGXF)"/>  
  
  <ITEM LINE="10" COL="15" NAME="#JJHYFL" TYPE="%-15s" INPUT="SElECT" DEVICE="KEYBOARD" FUNCTIONS="V()">
		<ONLOSTFOCUS>"{
  		
  		dim @list1 as string;
			@list1 = gethypropertiy(#JJHYFL);
			setsel(#JJHYFL1,@list1,'o5t50o1v3o2');
  		}"
  	</ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#S_JJHYFL" TYPE="%-20s" FUNCTIONS="S(#JJHYFL,#JJHYFL)"/>   
  <ITEM LINE="10" COL="35" NAME="#JJHYFL1" TYPE="%-15s" INPUT="SElECT" DEVICE="KEYBOARD" FUNCTIONS="V()">
		<ONLOSTFOCUS>"{
  		
  		dim @list1 as string;
			@list1 = gethypropertiy(#JJHYFL1);
			setsel(#JJHYFL2,@list1,'o5t50o1v4o2');
  		}"
  	</ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#S_JJHYFL1" TYPE="%-20s" FUNCTIONS="S(#JJHYFL1,#JJHYFL1)"/> 
  
   <ITEM LINE="11" COL="15" NAME="#JJHYFL2" TYPE="%-15s" INPUT="SElECT" DEVICE="KEYBOARD" FUNCTIONS="V()">
		<ONLOSTFOCUS>"{
  		
  		dim @list1 as string;
			@list1 = gethypropertiy(#JJHYFL2);
			setsel(#JJHYFL3,@list1,'o5t50o1v5o2');
			
  		}"
  	</ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#S_JJHYFL2" TYPE="%-20s" FUNCTIONS="S(#JJHYFL2,#JJHYFL2)"/> 
	
	<ITEM LINE="11" COL="35" NAME="#JJHYFL3" TYPE="%-15s" INPUT="SElECT" DEVICE="KEYBOARD" FUNCTIONS="V()"/>
  <ITEM NAME="#S_JJHYFL3" TYPE="%-20s" FUNCTIONS="S(#JJHYFL3,#JJHYFL3)"/> 
  
  <ITEM LINE="12" COL="15" NAME="#JJLX" TYPE="%-2s" INPUT="SElECT" DEVICE="KEYBOARD" FUNCTIONS="T()V()">
	<SElECT>
		<OPTION VALUE="10" TITLE="10.内资"/>
		<OPTION VALUE="11" TITLE="11.国有全资"/>
		<OPTION VALUE="12" TITLE="12.集体全资"/>
		<OPTION VALUE="13" TITLE="13.股份合作"/>
		<OPTION VALUE="14" TITLE="14.联营"/>
		<OPTION VALUE="15" TITLE="15.有限责任公司"/>
		<OPTION VALUE="16" TITLE="16.股份有限公司"/>
		<OPTION VALUE="17" TITLE="17.私有"/>
		<OPTION VALUE="19" TITLE="19.其他内资"/>
		<OPTION VALUE="20" TITLE="20.港澳台投资"/>
		<OPTION VALUE="21" TITLE="21.内地和港澳台投资"/>
		<OPTION VALUE="22" TITLE="22.内地和港澳台合作"/>
		<OPTION VALUE="23" TITLE="23.港澳台独资"/>
		<OPTION VALUE="24" TITLE="24.港澳台投资股份有限公司"/>
		<OPTION VALUE="29" TITLE="29.其他港澳台投资"/>
		<OPTION VALUE="30" TITLE="30.国外投资"/>
		<OPTION VALUE="31" TITLE="31.中外合资"/>
		<OPTION VALUE="32" TITLE="32.中外合作"/>
		<OPTION VALUE="33" TITLE="33.外资"/>
		<OPTION VALUE="34" TITLE="34.国外投资股份有限公司"/>
		<OPTION VALUE="39" TITLE="39.其他国外投资"/>
		<OPTION VALUE="90" TITLE="90.其他"/>
	</SElECT>
	</ITEM>
  <ITEM NAME="#S_JJLX" TYPE="%-30s" FUNCTIONS="S(#JJLX,#JJLX)"/> 

  <ITEM LINE="13" COL="15" NAME="#YWFW" TYPE="%-50s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS="V()"/>
  <ITEM NAME="#S_YWFW" TYPE="%-50s" FUNCTIONS="S(#YWFW,#YWFW)"/> 
  
  <ITEM LINE="14" COL="15" NAME="#JGYWM" TYPE="%-50s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS=""/>
  <ITEM NAME="#S_JGYWM" TYPE="%-30s" FUNCTIONS="S(#JGYWM,#JGYWM)"/>   
  
  <ITEM LINE="15" COL="15" NAME="#TEL" TYPE="%-18s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS="V()"/>
  <ITEM NAME="#S_TEL" TYPE="%-20s" FUNCTIONS="S(#TEL,#TEL)"/>   
  
  <ITEM LINE="16" COL="15" NAME="#SJJGM" TYPE="%-50s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS="V()"/>
  <ITEM NAME="#S_SJJGM" TYPE="%-30s" FUNCTIONS="S(#SJJGM,#SJJGM)"/>   
  
  <ITEM NAME="#S" TYPE="%-30s" FUNCTIONS="">
   <ONLOSTFOCUS>
    "{
  		dim @txno_bak as string;
			dim @tota as string;
			@txno_bak=$TXNO;
			$TXNO='9799';
			$FD67='5';
			commsend_001();
			@tota=callserver();
			if($FD12 != '0000')
			{
				showmsg(geterror());
				return(false);
			}
		
			$TXNO=@txno_bak;
			setsel(#SJJGZCLX,@tota,'o5t20o1v1o2');
			}"
  	</ONLOSTFOCUS>
  </ITEM>
   
  <ITEM LINE="17" COL="15" NAME="#SJJGZCLX" TYPE="%-2s" INPUT="SElECT" DEVICE="KEYBOARD" FUNCTIONS="T()V()"/>
  <ITEM NAME="#S_SJJGZCLX" TYPE="%-30s" FUNCTIONS="S(#SJJGZCLX,#SJJGZCLX)"/>     
  
  <ITEM LINE="18" COL="15" NAME="#SJJGZCHM" TYPE="%-20s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS="V()"/>
  <ITEM NAME="#S_SJJGZCHM" TYPE="%-20s" FUNCTIONS="S(#SJJGZCHM,#SJJGZCHM)"/>
       
  <ITEM LINE="19" COL="15" NAME="#SJJGZZDM" TYPE="%-20s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS="V()">
	<ONLOSTFOCUS>"{
		dim @l as number;
		@l = len(#SJJGZZDM);
    if(@l == 10){
		}
		else{
	  		showmsg('机构组织号码位数错误，应为10位');
        	return(false);
			}
    	
  }"
  </ONLOSTFOCUS>   
  </ITEM>
  <ITEM NAME="#S_SJJGZZDM" TYPE="%-20s" FUNCTIONS="S(#SJJGZZDM,#SJJGZZDM)"/>
    
  <ITEM LINE="20" COL="15" NAME="#SJJGXYDM" TYPE="%-20s" INPUT="TEXT" DEVICE="KEYBOARD" FUNCTIONS="V()">
	<ONLOSTFOCUS>"{
		dim @l as number;
		@l = len(#SJJGXYDM);
    if(@l == 18){
		}
		else{
	  		showmsg('机构信用号码位数错误，应为18位');
        	return(false);
			}
    	
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#S_SJJGXYDM" TYPE="%-20s" FUNCTIONS="S(#SJJGXYDM,#SJJGXYDM)"/>     

	<ITEM NAME="#SS_ZCDQH" TYPE="%-100s" FUNCTIONS="T(#S_ZCDQH+#S_ZCDQH1+#S_ZCDQH2)"/>
	<ITEM NAME="#SS_JJHYFL" TYPE="%-100s" FUNCTIONS="T(#S_JJHYFL+#S_JJHYFL1+#S_JJHYFL2+#S_JJHYFL3)"/>

  
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM LINE="22" COL="59" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  
  	
</VARIABLE>

<REQUEST>
	</REQUEST>
	
<RESPONSE>
	<PACKAGE DEVICE="SCREEN" DESC="按任意键继续...">
		NOTHING
		</PACKAGE>
	<PRINT>"{
		print( 3,20,'对公客户信息');
		print( 6,10,'客户号      :[8]',#CUSTNO);
		print( 7,10,'机构信用代码:[18]',#S_JGXYDM);
		print( 8,10,'开户许可证号:[20]',#S_KHXKZH);
		print( 9,10,'开始日期    :[8]',#S_KSRQ);
		print(10,10,'终止日期    :[8]',#S_ZZRQ);
		print(11,10,'注册地行政区:[50]',delspace(#SS_ZCDQH));
		print(12,10,'经济行业分类:[100]',delspace(#SS_JJHYFL));
		print(13,10,'经济类型    :[30]',#S_JJLX);
		print(14,10,'业务范围    :[30]',#S_YWFW);
		print(15,10,'机构英文名  :[30]',#S_JGYWM);
		print(16,10,'财务电话    :[20]',#S_TEL);
		print(17,10,'上级机构名称:[20]',#S_SJJGM);
		print(18,10,'上级机构登记注册类型:[20]',#S_SJJGZCLX);
		print(19,10,'上级机构登记注册号码:[20]',#S_SJJGZCHM);
		print(20,10,'上级机构组织代码    :[20]',#S_SJJGZZDM);
		print(21,10,'上级机构信用代码    :[20]',#S_SJJGXYDM);
		
		}"
		</PRINT>
</RESPONSE>

<RESPONSE>
	<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="请打印业务专用凭证...">
		NOTHING
	</PACKAGE>
	<PRINT>"{
		$KINDNO='00';
    dim @txtime  as string;
    @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	  print( 5, 20,'机构名称:[30]',$BRNAME);
    print( 5, 2,'代码:2117');
	  print( 5, 13,'交易:公司机构信息录入');
	  print( 6,10,'客户号      :[8]',#CUSTNO);
		print( 7,10,'机构信用代码:[18]',#S_JGXYDM);
		print( 8,10,'开户许可证号:[20]',#S_KHXKZH);
		print( 9,10,'开始日期    :[8]',#S_KSRQ);
		print(10,10,'终止日期    :[8]',#S_ZZRQ);
		print(11,10,'注册地行政区:[50]',delspace(#SS_ZCDQH));
		print(12,10,'经济行业分类:[100]',delspace(#SS_JJHYFL));
		print(13,10,'经济类型    :[30]',#S_JJLX);
		print(14,10,'业务范围    :[30]',#S_YWFW);
		print(15,10,'机构英文名  :[30]',#S_JGYWM);
		print(16,10,'财务电话    :[20]',#S_TEL);
		print(17,10,'上级机构名称:[20]',#S_SJJGM);
		print(18,10,'上级机构登记注册类型:[20]',#S_SJJGZCLX);
		print(19,10,'上级机构登记注册号码:[20]',#S_SJJGZCHM);
		print(20,10,'上级机构组织代码    :[20]',#S_SJJGZZDM);
		print(21,10,'上级机构信用代码    :[20]',#S_SJJGXYDM);
		 
	  print( 24,20,'备注:');
	  print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	  print( 24,5,'柜员:[4]',$FD7);
	  print( 24,5,'流水号:[6]',$FD4);
		}"
	</PRINT>
	
	</RESPONSE>