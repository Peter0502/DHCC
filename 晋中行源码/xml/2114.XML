<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111001" TITLE="2114 公司股东信息录入"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	initfd();
	commsend_001();

}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();

}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(2114                        公司股东信息录入)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=1114)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <!--输入变量-->
  <ITEM LINE="7" COL="15" TYPE="%-10s" FUNCTIONS="T(客 户 号:)"/>
 <!-- <ITEM LINE="8" COL="15" TYPE="%-10S" FUNCTIONS="T(高管编号:)"/>  -->
  <ITEM LINE="9"  COL="15" TYPE="%-10s" FUNCTIONS="T(股东类型:)"/>
 <!-- <ITEM LINE="10"  COL="15" TYPE="%-10s" FUNCTIONS="T(成员编号:)"/>  -->
  <ITEM LINE="11"  COL="15" TYPE="%-10s" FUNCTIONS="T(股东名称:)"/>
  <ITEM NAME = "#GDXB1" LINE="12"  COL="15" TYPE="%-10s" FUNCTIONS="T(股东性别:)"/>
  <ITEM LINE="13" COL="15" TYPE="%-10s" FUNCTIONS="T(证件类型:)"/>
  <ITEM LINE="14" COL="15" TYPE="%-10s" FUNCTIONS="T(证件号码:)"/>
  <ITEM NAME="ZZJGDM" LINE="15" COL="15" TYPE="%-20s" FUNCTIONS="T(组织机构代码:)"/>
  <ITEM NAME="XYDM" LINE="16" COL="15" TYPE="%-10s" FUNCTIONS="T(信用代码:)"/>
  <ITEM LINE="17" COL="15" TYPE="%-10s" FUNCTIONS="T(持股比例%:)"/>
  
  <ITEM NAME="#CUSTNO" 	INPUT="TEXT" LINE="7" COL="25" TYPE="%-8s" 	FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
	"{
		dim @txno_bak as string;
		@txno_bak=$TXNO;
		$TXNO='9942';
		$FD28=#CUSTNO;
		commsend_001();
		$TXNO=@txno_bak;
		callserver();
		#KHLX=$FD66;
		showmsg(#KHLX);
		//showmsg(#KHTYPE);	
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
			}
		if(#KHLX == '1')
		{
			showmsg('个人户不能做此交易！');
			return(false);
		}
	}"
    </ONLOSTFOCUS>
  </ITEM>


  	
 <!-- <ITEM NAME="#GGBH" 	INPUT="TEXT" 	LINE="8" COL="25" TYPE="%-6s" 	FUNCTIONS="V(NB)"/> -->
  
  <ITEM NAME="#GDLX" 	INPUT="SELECT" 	LINE="9" COL="25" TYPE="%-1s" 	FUNCTIONS="T(0)V(NB)">
    	<SELECT>
		<OPTION VALUE="0" TITLE="1.自然人"/>
		<OPTION VALUE="1" TITLE="2.机构"/>	
	</SELECT>
	<ONLOSTFOCUS>"{
		if(#GDLX == '1'){
		show(#ZZJGDM,true);
		show(#XYDM,true);
		show(#ZZJGDM1,true);
		show(#XYDM1,true);
		show(#GDXB,false);
		enable(#GDXB,false);
		show(#GDXB1,false);
		enable(#GDXB1,false);
		}
		else
		{
			show(#ZZJGDM,false);
			show(#XYDM,false);
			show(#ZZJGDM1,false);
			show(#XYDM1,false);
			show(#GDXB,true);
			enable(#GDXB,true);
			show(#GDXB1,true);
			enable(#GDXB1,true);
		}
		}"
		</ONLOSTFOCUS>
  </ITEM>


  <ITEM NAME="#NAME" 	INPUT="TEXT" LINE="11" COL="25" TYPE="%-20s" 	FUNCTIONS="V(NB)"/>

 <ITEM NAME="#GDXB" INPUT="SELECT" LINE="12" COL="25" TYPE="%-1s" 	FUNCTIONS="T(1)V(NB)">
  	<SELECT>
		<OPTION VALUE="1" TITLE="1.男"/>
		<OPTION VALUE="2" TITLE="2.女"/>
	</SELECT>
  </ITEM>
   
  <ITEM NAME="#S" TYPE="%-30s" FUNCTIONS="">
   <ONLOSTFOCUS>
    "{
    	
  		dim @txno_bak as string;
			dim @tota as string;
			@txno_bak=$TXNO;
			$TXNO='9799';
			if(#GDLX == '0'){
			$FD67='1';
			}
			else
			{
					$FD67='5';
			}
			commsend_001();
			@tota=callserver();
			if($FD12 != '0000')
			{
				showmsg(geterror());
				return(false);
			}
		
			$TXNO=@txno_bak;
			setsel(#ZJLX,@tota,'o5t20o1v1o2');
			
		  
			}"
  	</ONLOSTFOCUS>
  </ITEM>
   <ITEM NAME="#SKHLX" TYPE="%-4s"  FUNCTIONS="S(#KHLX,#KHLX)"/> 
  
  <ITEM NAME="#ZJLX" INPUT="SELECT" LINE="13" COL="25" TYPE="%-50s" FUNCTIONS="T()V(NB)"> 	
  	<SELECT>
  		<OPTION VALUE="1" TITLE="1.身份证">
  	
  	</SELECT>
  </ITEM>
  <ITEM NAME="#ZJHM" INPUT="TEXT" LINE="14" COL="25" TYPE="%-20s" FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
  	"{
  	dim @l as number;
		@l = len(#ZJHM);
		if('1' == #ZJLX and #GDLX=='0'){
    		if(@l == 15 or  @l == 18){
		}else{
	  		showmsg('身份证号码位数错误');
        	return(false);
			}
    	}
	}"
	</ONLOSTFOCUS>
	</ITEM>
 	<ITEM NAME="#ZZJGDM1" INPUT="TEXT" LINE="15" COL="25" TYPE="%-20s" FUNCTIONS="T()V(NB)">
 	<ONLOSTFOCUS>"{
 		dim @l as number;
		@l = len(#ZZJGDM1);
    if(@l == 10){
		}
		else{
	  		showmsg('机构组织号码位数错误，应为10位');
        return(false);
			}
 		
 		}"
 		</ONLOSTFOCUS>
 		</ITEM>
 		<ITEM NAME="#XYDM1" INPUT="TEXT" LINE="16" COL="25" TYPE="%-20s" FUNCTIONS="T()V(NB)">
 		<ONLOSTFOCUS>"{
 		dim @l as number;
		@l = len(#XYDM1);
    if(@l != 18){
   
    showmsg('机构信用号码位数错误，应为18位');
        	return(false);
		}
		}"
 		</ONLOSTFOCUS>
 		</ITEM>	
 <ITEM NAME="#CGBL" INPUT="TEXT" LINE="17" COL="25" TYPE="%16.2f" FUNCTIONS="V(NB)">
 	<ONLOSTFOCUS>
 		"{
 		if(#CGBL &lt; 0.0 or #CGBL &gt; 100.0)
 		{
 			showmsg('请输入正确的持股比例!');
 			return(false);
 		}
 		}"
 		</ONLOSTFOCUS>
 </ITEM>
  <!--输出变量--->
  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM NAME="#KHTYPE" TYPE="%-1s" FUNCTIONS="T()"/>
  <ITEM NAME="#GDBH" TYPE="%-4s" FUNCTIONS="T()"/>
<!--	
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT">-->

  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
    	<ONCLICK>
    	"{
    		initfd();
    		dim @tota as string;
    		dim @ch as string;
				commsend_001();
				$FD26=#NAME;
				$FD28=#CUSTNO;
				$FD67=#GDLX;
				$FD68=#GDXB;
				$FD69=#ZJLX;
				$FD62=#ZJHM;
				$FD40=#CGBL;
				$FD37=#ZZJGDM1;
				$FD38=#XYDM1;
    		@tota=callserver();

       		if($FD12!='0000'){
				showmsg(geterror());
					return(false);
				}
				else{
				#GDBH=$FD35;
				showall();
				runoutput();
    		@ch=showmsg('下一步执行 公司高管信息录入，Y-继续;N-退出：');
					if(@ch == 'Y' or @ch == 'y'){	
						open('2113.XML', '#CUSTNO='+#CUSTNO+';');
						return(true);
					}
					else{
						return(true);
					}
					}
    		}"
	</ONCLICK>    		
  </ITEM>

</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
	<PACKAGE DEVICE="SCREEN" DESC="按任意键继续">
	NOTHING
	</PACKAGE>
	<PRINT>"{
		print(8,30,        '录入成功！')
		print(9,10, '客户号:[8]',#CUSTNO);
		print(10,10,'股东类型:[30]',#GDLX);
		print(11,10,'股东名称:[30]',#NAME);
		print(12,10,'股东编号:[10]',#GDBH);
		
	
		}"
	</PRINT>
</RESPONSE>
<RESPONSE>
	<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="请打印业务专用凭证">
	NOTHING
	</PACKAGE>
	<PRINT>
	"{
	  $KINDNO='00';
    dim @txtime  as string;
    @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	  print( 5, 20,'机构名称:[30]',$BRNAME);
    print( 5, 2,'代码:2114');
	  print( 5, 13,'交易:公司股东信息录入');
	  print( 8, 20,'客 户 号:[8]',#CUSTNO);
		print( 9, 20,'股东编号:[10]',#GDBH);
	
	  print(11, 20,'股东类型:[50]',#GDLX);
	  print(12, 20,'股东名称:[50]',#NAME);
	  print(13, 20,'持股比例:[50]',#CGBL);
	  
	  print( 24,20,'备注:');
	  print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	  print( 24,5,'柜员:[4]',$FD7);
	  print( 24,5,'流水号:[6]',$FD4);
	}"
	</PRINT>
</RESPONSE>
</TRANSACTION>







