<?xml version="1.0"  encoding="GBK" ?>
<TRANSACTION RIGHTS="11111111011100000000000001100010" TITLE="供热补打凭条"
xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<VARIABLE>
	<ITEM LINE="3" COL="3"   TYPE="%-70s"    FUNCTIONS="T(9933                      补打瑞阳供热缴费凭条)"/>
	<ITEM LINE="4" COL="3"   TYPE="%-70s"    FUNCTIONS="T(────────────────────────────────────────)"/>
  <!--ITEM NAME="#TXNO"       TYPE="%-4s"     FUNCTIONS="T($TXNO=4100)"/-->
  <ITEM NAME="#MSGTYPE"    TYPE="%-5s"     FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM LINE="10"   COL="3" TYPE="%-14s"  FUNCTIONS="T(用  户  号:)"/>
  <ITEM LINE="10"   COL="17" NAME="#USER_NO" INPUT="TEXT" TYPE="%-24s"  FUNCTIONS="T()">
   <ONLOSTFOCUS>
	"{
		if (len(delspace(#USER_NO)) != 0 )
		{
			dim @tota as string;
			dim @selid as number;
			$FD30=#USER_NO;
			$FD60='RYGR';
			commsend_001();
			$FD16='1010';
			//showmsg($FD16);
			callagnpt();	
			if($FD12!='0000'){
				showmsg($FD13);
				return(false);
			}
			@tota=getfiletxt('../tmp/'+$KINBR+$TTYNAME);
			if(@tota==''){
				showmsg('未找到记录!');
				return(false);
			}
			autolist(@tota);
			@selid=list_work();
			rerun();
		}
  }"
  </ONLOSTFOCUS>
 </ITEM>
  
  <ITEM LINE="12"   COL="3" TYPE="%-14s"  FUNCTIONS="T(缴费流水号:)"/>
  <ITEM LINE="12"   COL="17" NAME="#JFTRACENO" INPUT="TEXT" TYPE="%-24s"  FUNCTIONS="V(NB)T()"/>
  
	<ITEM NAME="#YHNO_2"      TYPE="%-30s"    FUNCTIONS=""/>
	<ITEM NAME="#YHNAME_2"    TYPE="%-50s"    FUNCTIONS=""/>              		
	<ITEM NAME="#ADDRESS_2"   TYPE="%-50s"    FUNCTIONS=""/>           					
 	<ITEM NAME="#YEAR_2"      TYPE="%-4s"  		FUNCTIONS=""/>                    
 	<ITEM NAME="#FWMJ_2"      TYPE="%-12.2f"  FUNCTIONS=""/> 										
 	<ITEM NAME="#MONTH_2"     TYPE="%-2s"  	  FUNCTIONS=""/> 									
 	<ITEM NAME="#MJDJ_2"      TYPE="%-12.2f"  FUNCTIONS=""/> 										
 	<ITEM NAME="#MJYS_2"      TYPE="%-12.2f"  FUNCTIONS=""/> 										
	<ITEM NAME="#JLYL_2"      TYPE="%-12.2f"  FUNCTIONS=""/> 										
	<ITEM NAME="#JLDJ_2"      TYPE="%-12.3f"  FUNCTIONS=""/> 										
	<ITEM NAME="#JLYS_2"      TYPE="%-12.2f"  FUNCTIONS=""/> 										
	<ITEM NAME="#YSBJ_2"      TYPE="%-12.2f"  FUNCTIONS=""/> 										
	<ITEM NAME="#JMJE_2"      TYPE="%-12.2f"  FUNCTIONS=""/> 										
	<ITEM NAME="#YHJE_2"      TYPE="%-12.2f"  FUNCTIONS=""/> 										
	<ITEM NAME="#AMT_2"       TYPE="%-12.2f"  FUNCTIONS=""/> 										
	<ITEM NAME="#BZ_2"        TYPE="%-60s"    FUNCTIONS=""/>    										
	<ITEM NAME="#TRACE_NO"    TYPE="%-24s"    FUNCTIONS=""/>
	<ITEM NAME="#STAT"        TYPE="%-1s"     FUNCTIONS=""/>
	<ITEM NAME="#JFDATE"      TYPE="%-8s"     FUNCTIONS=""/>  
  
 <ITEM  NAME="#BTN" LINE="21"  COL="63" TYPE="%-6s"    FUNCTIONS="T(确  定)" INPUT="BUTTON">
	<ONCLICK>"{
	dim @tota as string;
	dim @filename as string;
	//$FD30=#USER_NO;
	$FD27=#JFTRACENO;
	$FD60='RYGR';
	commsend_001();
	$FD16='4100';

		callagnpt();
		if($FD12!='0000')
		{
			showmsg($FD13);
			return(false);
		}
		
		#YHNO_2=$FD30;
		#YHNAME_2=$FD25;
		#ADDRESS_2=$FD26;
		#YEAR_2=$FD34;
		#MONTH_2=$FD35;
		#FWMJ_2=val($FD84);
		#MJDJ_2=val($FD85);
		#MJYS_2=val($FD97);
		#JLDJ_2=val($FD94);
		#JLYL_2=val($FD39);
		#JLYS_2=val($FD40);
		#YSBJ_2=val($FD41);
		#JMJE_2=val($FD42);
		#YHJE_2=val($FD43);
		#AMT_2=val($FD44);
		#BZ_2=$FD81;
		#STAT=$FD20;
		#TRACE_NO=$FD27;
		#JFDATE=$FD45;
		
		runoutput();
		rerun();
  }"
  </ONCLICK>
 </ITEM>
</VARIABLE>
 <RESPONSE>
  <PACKAGE DEVICE="SCREEN"  DESC="交易完成">
    NOTHING
  </PACKAGE>
	<PRINT>
	 "{       
			print(3,42,'[4]   [2]    [2]',substr($HDATE,0,4),substr($HDATE,4,5),substr($HDATE,6,7));
		  	print(4,20,'     [40]                 [20]',#ADDRESS_2,#TRACE_NO); 
		  	print(5,14,'     [24]',#USR_NO);
			print(7,16,' [16]    [15][4]        [10]    [16]',#YEAR_2,delspace(comma(itoa(#FWMJ_2,'%.2f'))),#MONTH_2,delspace(comma(itoa(#MJDJ_2,'%.2f'))),delspace(comma(itoa(#MJYS_2,'%.2f')))); 
			print(8,40,'                                      [16]',delspace(comma(itoa(#YSBJ_2,'%.2f'))));
			print(9,40,'                                      [16]',delspace(comma(itoa(#AMT_2,'%.2f'))));
			if(#STAT=='0')
			{
				print(12,20,'基础热费');
			}
			else
			{
				print(12,20,'退款');
			}
			print(15,20,'[12]                                [12]',$FD3,$FD7);
	 }"
	</PRINT>
 </RESPONSE>
 <RESPONSE>
   <PACKAGE DEVICE="PRINTER"  LINESPACE="22" DESC="打印专用凭证">
     NOTHING
   </PACKAGE>
   <PRINT>
   	"{
   			print(3,42,'[4]   [2]    [2]',substr($HDATE,0,4),substr($HDATE,4,5),substr($HDATE,6,7));
		  	print(4,20,'     [40]                 [20]',#ADDRESS_2,#TRACE_NO); 
		  	print(5,14,'     [24]',#USR_NO);
			print(7,16,' [16]    [15][4]        [10]    [16]',#YEAR_2,delspace(comma(itoa(#FWMJ_2,'%.2f'))),#MONTH_2,delspace(comma(itoa(#MJDJ_2,'%.2f'))),delspace(comma(itoa(#MJYS_2,'%.2f')))); 
			print(8,40,'                                      [16]',delspace(comma(itoa(#YSBJ_2,'%.2f'))));
			print(9,40,'                                      [16]',delspace(comma(itoa(#AMT_2,'%.2f'))));
			if(#STAT=='0')
			{
				print(12,20,'基础热费');
			}
			else
			{
				print(12,20,'退款');
			}
			print(15,20,'[12]                                [12]',$FD3,$FD7);
     }"
   </PRINT>
 </RESPONSE>
</TRANSACTION>