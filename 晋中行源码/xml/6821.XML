<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="6821 买断式再贴现记账"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
  <COMMSEND>"{
      initfd();
      $FD26=#CPRQC;
      $FD27=#SKRQC;
	  $FD31=#CPRZH;
	  $FD32=#SKRZH;
	  $FD45=#HPDQR;
	  $FD48=#ZTTS;
	  $FD60=#PJH ;
	  $FD62=#XYBH ;
	  $FD81=#FKHQC;
	  $FD82=#SKRKHHQC;
	  $FD84=getitems('#ZTXLV');
	  $FD90=#PJLX;
          $FD37=$FD38;
      $FD100=getitems('#ZTXLX#HPJE#KKKK');

	$FD120='9110000000016';		//清算中心在人行的帐户,后台记人行帐要用到

      commsend_001();
	  $FD16='4942';
}"
</COMMSEND>
<COMMRECV>"{
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(6821                         买断式再贴现记账  )"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
   <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4942)"/>
   <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
   <!--输入变量-->
     <ITEM LINE="5"   COL="3" TYPE="%-15s" FUNCTIONS="T(再贴现协议编号:)"/>

  <ITEM LINE="7"   COL="3" TYPE="%-70s" FUNCTIONS="T(--------------------【以下为票面信息】-----------------------------)"/>
    <ITEM LINE="9"    COL="3"  TYPE="%-12s" FUNCTIONS="T(再贴现利率:)"/>
    <ITEM LINE="9"    COL="37" TYPE="%-12s" FUNCTIONS="T(在途天数:)"/>
    <ITEM LINE="10"   COL="3"  TYPE="%-12s" FUNCTIONS="T(再贴现利息:)"/>
    <ITEM LINE="11"   COL="3"  TYPE="%-12s" FUNCTIONS="T(出票人帐号:)"/>
    <ITEM LINE="12"   COL="3"  TYPE="%-12s" FUNCTIONS="T(出票人全称:)"/>
    <ITEM LINE="13"   COL="3"  TYPE="%-12s" FUNCTIONS="T(付款行全称:)"/>
    <ITEM LINE="14"   COL="3"  TYPE="%-12s" FUNCTIONS="T(收款人帐号:)"/>
    <ITEM LINE="15"   COL="3"  TYPE="%-12s" FUNCTIONS="T(收款人全称:)"/>
    <ITEM LINE="16"   COL="3"  TYPE="%-18s" FUNCTIONS="T(收款人开户行全称:)"/>
    <ITEM LINE="17"   COL="3"  TYPE="%-12s" FUNCTIONS="T(票据类型:)"/>
    <ITEM LINE="17"   COL="37" TYPE="%-12s" FUNCTIONS="T(票 据 号:)"/>
    <ITEM LINE="18"   COL="3"  TYPE="%-12s" FUNCTIONS="T(汇票金额:)"/>
    <ITEM LINE="18"   COL="37" TYPE="%-12s" FUNCTIONS="T(汇票到期日:)"/>


  <ITEM NAME="#XYBH" LINE="5" COL="18" TYPE="%-20s" INPUT="TEXT" FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
  "{
                initfd();
		$FD62=#XYBH;
		$TXNO='9883';
		commsend_001();
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
	 	#CPRQC=$FD26;
	 	#SKRQC=$FD27;
	 	#CPRZH=$FD31;
	 	#SKRZH=$FD32;
	 	#HPDQR=$FD45;
	 	#ZTTS =$FD48;
	 	#PJH  =$FD60;
	 	#FKHQC=$FD81;
	 	#SKRKHHQC=$FD82;
	 	#ZTXLV=val($FD84, 0.000001);
	 	#PJLX =$FD90;
	 	#ZTXLX=val(substr($FD100, 0, 16), 0.01);
	 	#HPJE =val(substr($FD100, 16, 16), 0.01);

		enable( #CPRQC, false);
		enable( #SKRQC, false);
		enable( #CPRZH, false);
		enable( #SKRZH, false);
		enable( #HPDQR, false);
		enable( #ZTTS , false);
		enable( #PJH  , false);
		enable( #FKHQC, false);
		enable( #SKRKHHQC, false);
		enable( #ZTXLV, false);
		enable( #PJLX , false);
		enable( #ZTXLX, false);
		enable( #HPJE , false);
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#ZTXLV"	 LINE="9" COL="15" TYPE="%9.6f" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#ZTTS"	 LINE="9" COL="49" TYPE="%4d" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#ZTXLX"	 LINE="10" COL="15" TYPE="%17.2f" INPUT="TEXT"	FUNCTIONS="V(NB)"/>

  <ITEM NAME="#CPRZH"	 LINE="11" COL="15" TYPE="%-24s" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#CPRQC"	 LINE="12" COL="15" TYPE="%-50s" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#FKHQC"	 LINE="13" COL="15" TYPE="%-30s" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#SKRZH"	 LINE="14" COL="15" TYPE="%-24s" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#SKRQC"	 LINE="15" COL="15" TYPE="%-50s" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#SKRKHHQC"	 LINE="16" COL="21" TYPE="%-30s" INPUT="TEXT" FUNCTIONS="V(NB)"/>

  <ITEM NAME="#PJLX" INPUT="SELECT" LINE="17"  COL="13" TYPE="%-3s" 	FUNCTIONS="T(111)V(NB)">
  		<SELECT>
  			<OPTION VALUE="111" TITLE="银行承兑汇票 "/>
  			<OPTION VALUE="112" TITLE="银行汇票 "/>
  		</SELECT>
  </ITEM>
  <ITEM NAME="#PJH"	 LINE="17" COL="49" TYPE="%16d" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#HPJE"	 LINE="18" COL="15" TYPE="%17.2f" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
  <ITEM NAME="#HPDQR"	 LINE="18" COL="49" TYPE="%8s" INPUT="TEXT"	FUNCTIONS="V(NB)D()"/>


  <ITEM NAME="#KKKK" TYPE="%-80s" FUNCTIONS="T()"/>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM NAME="#FD" TYPE="%-1s"/>

 <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($FD5,1,4)"/>
 <ITEM NAME="#MON"   TYPE="%-2s" FUNCTIONS="T($FD5,5,2)"/>
 <ITEM NAME="#DAY"   TYPE="%-2s" FUNCTIONS="T($FD5,7,2)"/>
 <ITEM NAME="#SUBMIT" LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>

    </VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="买断式再贴现记账">
NOTHING
</PACKAGE>
<PRINT>"{
	 print( 7, 20,'记帐成功');
	 print( 9, 20,'再贴现协议编号: [20]',#XYBH);
  }"
</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER"   DESC="打印业务专用凭证">
  NOTHING
</PACKAGE>
<PRINT>"{
 dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:6821');
	print( 5, 13,'交易:买断式再贴现记账');
	
	print( 10,  10,'再贴现协议编号: [20]',#XYBH);
	printacdtl_1();
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);        
}"
</PRINT>
</RESPONSE>

</TRANSACTION>
