<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110100000000000000000000000000" TITLE="5595 办理支付划款申请"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	 
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-50s" FUNCTIONS=
	"T(5595                       办理支付划款申请)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5615)"/>
  <ITEM NAME="#TXNAME" TYPE="%-12s" FUNCTIONS="T(办理支付划款申请)"/><!---交易名称--->
  <ITEM NAME="#TXNUMBER" TYPE="%-4s" FUNCTIONS="T(5595)"/><!--交易代码-->
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  
  <BLOCK LINE="4" COL="10" >
<!--  
  <ITEM LINE="4" COL="8" TYPE="%-14s"  FUNCTIONS="T( 财 政 编 码: )"/>
  <ITEM LINE="4" COL="21" TYPE="%-16s" NAME="#FIN_CODE" INPUT="TEXT" FUNCTIONS="V(NB)T(0234204)"/>
-->
  
  <ITEM LINE="5" COL="8" TYPE="%-14s"  FUNCTIONS="T(财政机关代码:)"/>
  <ITEM LINE="5" COL="21" TYPE="%-11s" NAME="#FIN_CODE" INPUT="TEXT" FUNCTIONS="V(NB)">
  	<ONLOSTFOCUS>
  	"{
  	
  	    if(len(#FIN_CODE)!=11)
  	    {
  	       // showmsg('位数不足!');
               // return(false);
  	    }
  	 }"	
  	</ONLOSTFOCUS>
  </ITEM>
 
  <ITEM LINE="6" COL="8" TYPE="%-14s"  FUNCTIONS="T( 代理行 行号: )"/>
  <ITEM LINE="6" COL="21" TYPE="%-16s" NAME="#BR_NO" INPUT="TEXT"  FUNCTIONS="V(NB)T(313175000011)"/>
  
  <ITEM LINE="7" COL="8" TYPE="%-14s" FUNCTIONS="T( 报 文 日 期: )"/>
  <ITEM LINE="7" COL="21" TYPE="%-8d" NAME="#NoteDate" INPUT="TEXT" FUNCTIONS="V(19000101,99991231)"/>
  
  <ITEM LINE="8" COL="8" TYPE="%-14s"  FUNCTIONS="T( 报 文 序 号: )"/>
  <ITEM LINE="8" COL="21" TYPE="%-3s" NAME="#Seq" INPUT="TEXT" FUNCTIONS="V(NB)" >
  	<ONLOSTFOCUS>
  	"{
  	
  	    if(len(#Seq)!=3)
  	    {
  	        showmsg('请输入3位序号!');
                return(false);
  	    }
  	 }"	
  	</ONLOSTFOCUS>
  </ITEM>
  
  <ITEM NAME="#cPackNo" TYPE="%-8s" FUNCTIONS="T()"/>
  <ITEM NAME="#cVouNo" TYPE="%-20s" FUNCTIONS="T()"/>

 <!--
  <ITEM LINE="9" COL="8" TYPE="%-14s"  FUNCTIONS="T(支 付 方 式: )"/>
  <ITEM LINE="9" COL="21" TYPE="%-1s" NAME="#PAY_NOTE_TYPE" INPUT="SELECT" FUNCTIONS="V(NB)">
    <SELECT>
  	  <OPTION VALUE="1"  TITLE="1.直接支付" />
  	  <OPTION VALUE="2"  TITLE="2.授权支付" />
  	</SELECT>
  	 <ONLOSTFOCUS>
  	"{
  	    if(#PAY_NOTE_TYPE=='1')
  	    {
  	        #ADD_WORD='直接支付';
  	    }
  	    else if(#PAY_NOTE_TYPE=='2')
  	    {
  	        #ADD_WORD='授权支付';
  	    }
  	 }"	
  	</ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="10" COL="8" TYPE="%-6s" FUNCTIONS="T(附言:)"/>
  <ITEM LINE="10" COL="14" TYPE="%-50s" NAME="#ADD_WORD" INPUT="TEXT" FUNCTIONS="V(NB)" />
  -->
  </BLOCK>
   <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM LINE="21"  COL="59" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>
    "{
        dim @tota as string; 
        dim @filename as string; 
        initfd();
	      commsend_001();
	      $FD16='5615';
	      $FD60=#Seq;
	      $FD47=#NoteDate;
	      $FD58=#BR_NO;
	      $FD59=#FIN_CODE;
	      
        @tota=calltips();
        if( $FD12!='0000')
        {
            showmsg(geterror());
  		      return(false);
        }
        #cPackNo=delspace($FD32);
        #cVouNo=delspace($FD33);
        showmsg('划款申请报文发送成功!');
        @filename='../tmp/'+$KINBR+$TTYNAME+#TXNO;
        savefiletxt(@filename,@tota); 
        runoutput();
        call('fview '+@filename);
    }"
  </ONCLICK>
  
   </ITEM> 
</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
	<PACKAGE DEVICE="SCREEN"  DESC="交易完成">  
		NOTHING
	</PACKAGE>
		<PRINT>
		"{
		print( 5,20,'财政机关代码:[11]',#FIN_CODE);
		print( 7,20,'代理行 行号:[20]',#BR_NO);
		print( 9,20,'报 文 日 期:[8]',#NoteDate);
		print(11,20,'报 文 序 号:[3]',#Seq);	
		print(13,20,'报文 流水号:[8]',#cPackNo);	
		print(15,20,'支付 凭证号:[8]',#cVouNo);   
			
		}"
		</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" DESC="请打印凭证" LINESPACE="24" >
NOTHING
</PACKAGE>
<PRINT>
"{
$KINDNO='00';
dim @txtime as string;
		dim @feetype as string;
		@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
		print( 5,20,'机构名称:[30]',$BRNAME);
		print( 5, 2,'代码:[4]',#TXNUMBER);
		print( 5,13,'交易名称:[20]',#TXNAME);
		print( 7,30,'\L0办理支付划款申请凭条\L1');
		print( 9,20,'财政机关代码:[11]',#FIN_CODE);
		
		print( 10,20,'代理行 行号:[20]',#BR_NO);
		print( 11,20,'报 文 日 期:[8]',#NoteDate);
		print(12,20,'报 文 序 号:[3]',#Seq);	
		print(13,20,'报文 流水号:[8]',#cPackNo);	
		print(14,20,'支付 凭证号:[8]',#cVouNo);
		print_sq();
		print(24,20,'备注:');
		print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
		print(24,5,'柜员:[4]',$FD7);
		print(24,5,'流水号:[6]',$FD4);
	

}"
</PRINT>
</RESPONSE>
<OUTPUT>
</OUTPUT>
</TRANSACTION>

