<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111111" TITLE="5586 扣税交易与行内冲正"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
  commsend_001();
}"
</COMMSEND>
<COMMRECV>"{
   commrecv_001();
}"
</COMMRECV>
<VARIABLE UPLOOP="TRUE">
  <ITEM LINE="3"  COL="3" TYPE="%-50s" FUNCTIONS=
    "T(5586                          扣税交易与行内冲正)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5586)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>

  <ITEM LINE="7"  COL="15" TYPE="%-14s" FUNCTIONS="T(委 托  日 期:)"/>
  <ITEM LINE="8"  COL="15" TYPE="%-14s" FUNCTIONS="T(征税机关代码:)"/>
  <ITEM LINE="9"  COL="15" TYPE="%-14s" FUNCTIONS="T(交易流水序号:)"/>
  <ITEM LINE="10" COL="10" TYPE="%-60s" FUNCTIONS=
  "T(---------------------------原扣税信息------------------------------------)"/>
  
  <ITEM LINE="12" COL="13" TYPE="%-14s" FUNCTIONS="T(纳税 人 名称:)"/>
  <ITEM LINE="13" COL="13" TYPE="%-14s" FUNCTIONS="T(扣 税  账 号:)"/>
  <ITEM LINE="14" COL="13" TYPE="%-14s" FUNCTIONS="T(扣税账号户名:)"/>
  <ITEM LINE="15" COL="13" TYPE="%-14s" FUNCTIONS="T(扣/缴税金额 :)"/>
  <ITEM LINE="16" COL="13" TYPE="%-14s" FUNCTIONS="T(行内记账状态:)"/>

  <!--输入变量-->
  <ITEM NAME="#WT_DATE" LINE="7" COL="29"  TYPE="%-8d" INPUT="TEXT" FUNCTIONS="V(NB)T($HDATE)D()"/>
  <ITEM NAME="#TAXORGCODE" LINE="8" COL="29" TYPE="%-11s" INPUT="TEXT" FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
  "{
     if(len(#TAXORGCODE)!=11){
        showmsg('征收机关代码错误!');
        return(false);
     }
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#TRACE_NO" LINE="9" COL="29" TYPE="%-8s" INPUT="TEXT"  FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
  "{
     dim @txno as string;
     commsend_001();
     @txno=$TXNO;
     $FD60=#TAXORGCODE;
     $FD44=#WT_DATE;
     $FD73=#TRACE_NO;
     $FD16='9527';
     $TXNO='9527';
     calltips();
     if($FD12!='0000'){
        showmsg(geterror());
        return(false);
     }
     $TXNO=@txno;
      
     #TAXPAYNAME=delspace($FD27);
     #PAYACCT=delspace($FD31);
     #HANDORGNAME=delspace($FD25);
     #TXAMT=comma(itoa(val(delspace($FD40),0.01),'%16.2f'));
     #TXSTAT==delspace($FD26);
     
     enable(#TAXPAYNAME,false);
     enable(#PAYACCT,false);
     enable(#HANDORGNAME,false);
     enable(#TXAMT,false);
     enable(#TXSTAT,false);
     
  }"
  </ONLOSTFOCUS>
  </ITEM>
  
  <ITEM NAME="#TAXPAYNAME"  LINE="12" COL="27" TYPE="%-60s"  ENABLE="FLASE" INPUT="TEXT" FUNCTIONS=""/>
  <ITEM NAME="#PAYACCT"     LINE="13" COL="27" TYPE="%-24s"  ENABLE="FLASE" INPUT="TEXT" FUNCTIONS=""/>
  <ITEM NAME="#HANDORGNAME" LINE="14" COL="27" TYPE="%-60s"  ENABLE="FLASE" INPUT="TEXT" FUNCTIONS=""/>
  <ITEM NAME="#TXAMT"       LINE="15" COL="27" TYPE="%-17s"  ENABLE="FLASE" INPUT="TEXT" FUNCTIONS=""/>
  <ITEM NAME="#TXSTAT"      LINE="16" COL="27" TYPE="%-60s"  ENABLE="FLASE" INPUT="TEXT" FUNCTIONS=""/>
  
  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM NAME="#RETSTAT" TYPE="%-4s" FUNCTIONS="T()"/>

  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>"{
       initfd();
       commsend_001();
       $TXNO='5586';
       $FD16=$TXNO;
       
       $FD44=#WT_DATE;
       $FD73=#TRACE_NO;
       $FD30=#TAXORGCODE;
       $FD40=#TXAMT;
       calltips();   
       if($FD12!='0000'){
           showmsg(geterror());
           return(false);
       }
       runoutput();
      }"
  </ONCLICK>
  </ITEM>
   
</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="显示内容" >
NOTHING
</PACKAGE>
<PRINT>"{
      print(10,20,'行内冲正成功');
}"</PRINT>
</RESPONSE>
<RESPONSE>
   <PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="请打印业务专用凭证">
   NOTHING
   </PACKAGE>
   <PRINT>
   "{
     $KINDNO='00';
     dim @txtime  as string;
     @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
     print( 5, 20,'机构名称 :[30                           ]            交易:扣税交易行内冲正    代码:5586',$BRNAME);

     print( 9, 30,'纳税人名称 :[60      ]',#TAXPAYNAME);
     print(11, 30,'缴 税  账 号:[20                  ]',#PAYACCT);
     print(13, 30,'缴税账号户名:[60                  ]',#HANDORGNAME);
     print(15, 30,'扣/缴税金 额:[20                  ]',#TXAMT);
     

     print( 24,20,'备注:             交易日期:[8       ] [8       ]       柜员:[4   ]                流水号:[6     ]',$HDATE,@txtime,$FD7,$FD4);
   }"
   </PRINT>
</RESPONSE>
</TRANSACTION>
