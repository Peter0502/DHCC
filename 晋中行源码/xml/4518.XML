<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00000000" TITLE="4518  抵押品类型修改 "
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	commsend_001();
	$MSGTYPE='03001';
	$FD16='4518';
	$FD30 = #ACTNO;	
	$FD22=#CPTYPE;
	$FD81=#BZ;
	}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
   "T(4518                            抵押品类型修改)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>

  <!--输入变量-->
  <ITEM LINE="7"   COL="05" TYPE="%-14s" FUNCTIONS="T(贷款账号 :)"/>
  <ITEM LINE="7"   COL="41" TYPE="%-14s" FUNCTIONS="T(帐户序号 :)" NAME="#S_SEQNO" INPUT="LABEL" VISABLE="FALSE"/>
  <ITEM LINE="08"  COL="05" TYPE="%-14s" FUNCTIONS="T(贷款户名 :)"/>

  <ITEM LINE="10"  COL="05" TYPE="%-14s" FUNCTIONS="T(借 据 号 :)"/>
  <ITEM LINE="11"  COL="05" TYPE="%-14s" FUNCTIONS="T(贷款余额 :)"/>
  <ITEM LINE="12"  COL="05" TYPE="%-14s" FUNCTIONS="T(抵押金额 :)"/>
  <ITEM LINE="14"  COL="05" TYPE="%-70s" FUNCTIONS="T(----入库抵押品信息-----------------------------------------------------)"/>
  <ITEM LINE="16"  COL="05" TYPE="%-14s" FUNCTIONS="T(抵押品类型!:)"/>
  <ITEM LINE="17"  COL="05" TYPE="%-14s" FUNCTIONS="T(抵押品价值 :)"/>
  <ITEM LINE="18"  COL="05" TYPE="%-14s" FUNCTIONS="T(备      注 :)"/>

  <ITEM NAME="#ACTNO" 	INPUT="TEXT" 	LINE="7"   COL="15	" TYPE="%-19s" 	FUNCTIONS="T()V(NB)"/>

  <ITEM NAME="#CON1"    TYPE="%-1s" >
  <ONLOSTFOCUS>
 "{
					initfd();
					commsend_001();
					$MSGTYPE='03001';
					$FD16 = '9571';
					$FD30 = #ACTNO;	
					$FD2=$OPNBR;
  				$FD3=$KINBR;
  				$FD5=$HDATE;callserver();
  				if($FD12!='0000')
  				{
  				    showmsg(geterror());
  				    return(false);
  				}

					#NAME=$FD25;
					#SEQNO=$FD35;
					#JJH=$FD63;
					#AVBAL=atoi($FD41)/100;
					#CPAMT=atoi($FD40)/100;
					#CPTYPE = $FD22;	
					#CPBAL = atoi($FD42)/100;
					#BZ    = $FD83; 
    			
					if(atoi($FD35) &gt; 1)
					{
						show(#S_SEQNO,true);
						show(#SEQNO,true);
					}

					show(#NAME,true);
					show(#JJH,true);
					show(#AVBAL,true);
					show(#CPAMT,true);  
					show(#CPBAL,true);
					show(#CPTYPE,true); 
					show(#BZ,true);
					
					enable(#NAME,false);
					enable(#JJH,false);
					enable(#AVBAL,false);
					enable(#CPAMT,false);    
					enable(#CPBAL,false); 
		
		
		
				//enable(#AVBAL,false);
				//enable(#CPAMT,false);

  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#SEQNO" 	INPUT="TEXT" 	LINE="7"    COL="51	" TYPE="%4d" 	FUNCTIONS="" VISABLE="FALSE"/>
  <ITEM NAME="#NAME" 	INPUT="TEXT" 	LINE="8"    COL="15	" TYPE="%-50s" 	FUNCTIONS="" />

  <ITEM NAME="#JJH" 	INPUT="TEXT" 	LINE="10"    COL="17	" TYPE="%-20s"   	FUNCTIONS="" />
  <ITEM NAME="#AVBAL" 	INPUT="TEXT" 	LINE="11"    COL="17	" TYPE="%17.2f" 	FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
  "{
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#CPAMT" 	INPUT="TEXT" 	LINE="12"    COL="17	" TYPE="%17.2f" 	FUNCTIONS="V(NB)" >
  <ONLOSTFOCUS>
  "{
      if(#CPAMT &lt; #AVBAL)
      {
          showmsg('抵押品价值必须大于贷款余额!!!');
          return(false);
      }
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#CPTYPE" 	INPUT="TEXT" 	LINE="16"    COL="17	" TYPE="%-2s" 	    FUNCTIONS="T(01)" >
  <SELECT>
  <OPTION TITLE="房产    " VALUE="01"/>
  <OPTION TITLE="土地    " VALUE="02"/>
  <OPTION TITLE="存单质押" VALUE="03"/>
  <OPTION TITLE="机器设备" VALUE="04"/>
  <OPTION TITLE="库存商品" VALUE="05"/>
  <OPTION TITLE="交通工具" VALUE="06"/>
  <OPTION TITLE="其他    " VALUE="99"/>
  </SELECT>
  </ITEM>
  <ITEM NAME="#S_CPTYPE" TYPE="%10s" FUNCTIONS="S(#CPTYPE,#CPTYPE)"/>
  <ITEM NAME="#CPBAL" 	INPUT="TEXT" 	LINE="17"    COL="17	" TYPE="%17.2f" 	FUNCTIONS="V(NB)" >
  <ONLOSTFOCUS>
  "{
      if(#CPBAL &lt; #CPAMT)
      {
          showmsg('抵押品价值必须大于抵押金额!!!');
          return(false);
      }
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#BZ" 	    INPUT="TEXT" 	LINE="18"    COL="17	" TYPE="%-50s"    	FUNCTIONS="" />

  <ITEM NAME="#PASSWD"  TYPE="%-6s"     />
  <ITEM NAME="#WSSRNO"  TYPE="%-6s"     />
  <ITEM NAME="#OTXDAY"  TYPE="%-10s"    />
  <ITEM NAME="#OSTDAY"  TYPE="%-10s"    />
  <ITEM NAME="#OENDAY"  TYPE="%-10s"    />
  <ITEM NAME="#OOPAMT"  TYPE="%-21s"    />
  <ITEM NAME="#OTXAMT"  TYPE="%-21s"    />
  <ITEM NAME="#OAVBAL"  TYPE="%-21s"    />

  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  
  </VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" LINESPACE="38" DESC="显示内容">
NOTHING
</PACKAGE>
<PRINT>"{
print(7,27,'    ★操作成功★ ');
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="20" DESC="请打印抵押品入库凭证">
LNDYRK||@actno|@jjno|@name|@lnkd|@rkamt|@stday|@enday|@opamt|@txamt|@avbal|@nomrate|@overrate|@acno|@tp|@wssrno|@txtp|@crdb|@goods|@bz|@dyamt
</PACKAGE>
<INIT>
"{
    #OTXDAY=substr($HDATE,0,4)+'-'+substr($HDATE,4,2)+'-'+substr($HDATE,6,2);
    #OSTDAY=substr(@stday,0,4)+'-'+substr(@stday,4,2)+'-'+substr(@stday,6,2);
    #OENDAY=substr(@enday,0,4)+'-'+substr(@enday,4,2)+'-'+substr(@enday,6,2);
    #OOPAMT=comma(@rkamt,21);
    #OTXAMT=comma(@dyamt,21);
    #OAVBAL=comma(@avbal,21);
}"
</INIT>
<PRINT>"{
dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
print( 2,25,'\H0抵押品入库凭证\H1');
print( 4,1,'      交易日期: [10        ]  [8]                                         流 水 号: [5  ]',#OTXDAY,@txtime,@wssrno);
print( 5,1,' ┍━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑');
print( 6,1,' ┃  机构名称: [60                                                          ]                    ┃',$BRNAME);
print( 7,1,' ┃  贷款账号: [19                   ]                             借 据 号: [20             ]  ┃',@actno,@jjno);
print( 8,1,' ┃  户    名: [50                                                ]                              ┃',@name);
print( 9,1,' ┃  产品名称: [50                                                ]科 目 号: [3  ]                 ┃',@lnkd,@acno);
print(10,1,' ┃--------------------------------------------------------------------------------------------┃');
print(11,1,' ┃  入库金额: 人民币[50                                          ]   [21               ]┃',ltrim(#OOPAMT),space(21));
print(12,1,' ┃--------------------------------------------------------------------------------------------┃');
print(13,1,' ┃  抵押品类型: [8       ]                                                                      ┃',@goods); 
print(14,1,' ┃  备注: 	[50                                                ]                                ┃',@bz); 
print(15,1,' ┃  起止日期: [10        ]  到 [10        ]                                                       ┃',#OSTDAY,#OENDAY);
print(16,1,' ┃  贷款余额: [21                   ]                   抵押品金额: [21                   ]       ┃',ltrim(#OAVBAL),ltrim(#OTXAMT));
print(17,1,' ┕━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙');
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印抵押物品入库普通凭证">
NOTHING
</PACKAGE>
<PRINT>
"{
dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 3, 25,'[5]',$KINBR);
	print( 3, 10,'[20]',$BRNAME);
	print( 3, 5,'交易日期:[8]  [8]',$HDATE,@txtime);
	print( 4, 36,'抵押物品入库');
	print( 5, 10,'贷款帐号:[19]',#ACTNO);
	print( 6, 10,'贷款户名:[50]',#NAME);
	print( 7, 10,'借 据 号:[20]',#JJH);
	print( 8, 10,'贷款余额:[17]',itoa(#AVBAL,'%17.2f'));
	print( 9, 10,'抵押金额:[17]',itoa(#CPAMT,'%17.2f'));
	print(10, 10,'抵押品类型:[10]',#S_CPTYPE);
	print(11, 10,'抵押品价值:[17]',itoa(#CPBAL,'%17.2f'));
	print(12, 10,'备    注:[50]',#BZ);
	print(13, 10,'操作员号:[4]     流 水 号:[6]',$FD7,$FD4);
}"
</PRINT>
</RESPONSE>
</TRANSACTION>

