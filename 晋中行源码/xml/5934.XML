<TRANSACTION RIGHTS="11111111"  TITLE="5934 网上支付明细对账)"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
}"
</COMMSEND>
<COMMRECV>"{
}"
</COMMRECV>
<VARIABLE>
	<ITEM LINE="3"  COL="3" TYPE="%-52s" FUNCTIONS=
	"T(5934                      网上支付明细对账)"/>
	<ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
	"T(─────────────────────────────────────)"/>
	<ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T()"/>
	<ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T()">
		<!--
		<ONLOSTFOCUS>
		"{	
			dim @str as string;
			dim @selid as number;
			initfd();
			commsend_001();
			$FD16 = '1537';
			$FD18 = 'SNB';
			$FD72 = '1';
			callagncjwy();
			@str=getfiletxt('../tmp/'+$KINBR+$TTYNAME);
			if($FD12 != '0000')
			{
				showmsg(geterror());
				return(false);
			}
			if (delspace($FD72) == '0')
			{
				showmsg('汇总已经对平,不用对明细账');
			}
			else
			{
				if(autolist('~'+@str))
				{
					@selid=list_work();
					if(@selid &lt; 0)
					{
						list_del();
						rerun();
						return(true);
					}
					@selid=list_getselid();
					if(@selid &lt; 0)
					{
						list_del();
						rerun();
						return(true);
					}
					#DZDATE = list_gettext(@selid,0);
					enable(#DZDATE, false);
					#YWSTS = list_gettext(@selid,1);
					enable(#YWSTS, false);
					#GZDATE = list_gettext(@selid,2);
					enable(#GZDATE, false);
					#GZCC = list_gettext(@selid,3);
					enable(#GZCC, false);
					#JYLX = list_gettext(@selid,4);
					enable(#JYLX, false);
					#LWIND = list_gettext(@selid,5);
					enable(#LWIND, false);
					showblock('INFO', true, true);
				}
			}
		}"
		</ONLOSTFOCUS>
		-->
	</ITEM>
	<!--BLOCK NAME="INFO" COL="0" LINE="0" VISABLE="FALSE"-->
		<ITEM LINE="10"  COL="05"  TYPE="%-60s"  FUNCTIONS=
			"T(                   【选择明细对账申请信息】)"/>
		<ITEM LINE="11" COL="5"  TYPE="%-9s" FUNCTIONS="T(交易类型:)"/>
		<ITEM LINE="12" COL="5"  TYPE="%-9s" FUNCTIONS="T(往来标志:)"/>
		<ITEM LINE="13" COL="5"  TYPE="%-9s" FUNCTIONS="T(业务状态:)"/>
		<ITEM LINE="14" COL="5"  TYPE="%-19s" FUNCTIONS="T(轧差日期或终态日期:)"/>
		<ITEM LINE="15" COL="5"  TYPE="%-9s" FUNCTIONS="T(轧差场次:)"/>
		<ITEM LINE="16" COL="5"  TYPE="%-9s" FUNCTIONS="T(对账日期:)"/>
		<ITEM LINE="11" COL="17" NAME="#JYLX"     TYPE="%-20s" DEVICE="KEYBOARD" FUNCTIONS=""/>
		<ITEM LINE="12" COL="17" NAME="#LWIND"      TYPE="%-4s"  DEVICE="KEYBOARD" FUNCTIONS=""/>
		<ITEM LINE="13" COL="17" NAME="#YWSTS"     TYPE="%-6s" DEVICE="KEYBOARD" FUNCTIONS=""/>
		<ITEM LINE="14" COL="17" NAME="#GZDATE"      TYPE="%-8s"  DEVICE="KEYBOARD" FUNCTIONS=""/>
		<ITEM LINE="15" COL="17" NAME="#GZCC"    TYPE="%-2s" DEVICE="KEYBOARD" FUNCTIONS=""/>
		<ITEM LINE="16" COL="17" NAME="#DZDATE"     TYPE="%-8s"  DEVICE="KEYBOARD" FUNCTIONS=""/>
	<!--/BLOCK-->
	<ITEM LINE="21" COL="59" NAME="#OK"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
		<ONLOSTFOCUS>"{
			initfd();
			commsend_001();
			$FD16 = '1537';
			$FD18 = 'SNB';
			$FD44 = #DZDATE;
			$FD45 = #GZDATE;
			$FD37 = #JYLX;
			$FD66 = #GZCC;
			if (#LWIND == '来账')
			{
				$FD36 = 'SR01';
			}
			if (#LWIND == '往账')
			{
				$FD36 = 'SR00';
			}
			if (#YWSTS == '已清算')
			{
				$FD35 = 'PR04';
			}
			if (#YWSTS == '已成功')
			{
				$FD35 = 'PR05';
			}
			if (#YWSTS == '已撤销')
			{
				$FD35 = 'PR08';
			}
			if (#YWSTS == '已拒绝')
			{
				$FD35 = 'PR09';
			}
			callagncjwy();
			if($FD12 != '0000')
			{
				showmsg(geterror());
				return(false);
			}
			showmsg('明细对账成功');
	
		}"</ONLOSTFOCUS>
	</ITEM>
 
</VARIABLE>

<REQUEST>
</REQUEST>
<!--
<RESPONSE>
    <PACKAGE DEVICE="SCREEN" >
    NOTHING
    </PACKAGE>
    <PRINT>"{
    
        dim @test1 as string;
        dim @test2 as string; 
		    $KINDNO='00';       
        // showmsg($FD51);
        if($FD51 == '005')
        {
              print(7,20,' 当 前 状 态 下 不 允 许 做 此 交 易 ! ');  
        } 
        else if($FD51 == '006')
        {
              print(7,18,' 尚 未 收 到 核 对 报 文，不 能 做 此 交 易 ! ');  
        }  
        else if($FD12 == '0000')
        {
              print(2 ,8,'                恭 喜 您, 总 帐 核 对 成 功 ! '); 
              print(5 ,8,'                    人       行            我       行 ');        
              print(7 ,8,'往 帐 笔 数:        [10     ]             [10     ] ',itoa(val($FD52,1),'%10.0f'),itoa(val($FD54,1),'%10.0f'));  
              print(9 ,8,'往 帐 金 额:  [16      ]       [16      ] ',itoa(val($FD40,0.01),'%16.2f'),itoa(val($FD42,0.01),'%16.2f'));                  
  
              print(11,8,'来 帐 笔 数:        [10     ]             [10     ] ',itoa(val($FD53,1),'%10.0f'),itoa(val($FD55,1),'%10.0f'));  
              print(13,8,'来 帐 金 额:  [16      ]       [16      ] ',itoa(val($FD41,0.01),'%16.2f'),itoa(val($FD43,0.01),'%16.2f'));               
                   
        }        
        else if($FD51 == '007')
        {
              print(2 ,8,'                   网 上 支 付 总 帐 对 帐 不 符  '); 
              print(5 ,8,'                    人       行            我       行 ');        
              print(7 ,8,'往 帐 笔 数:        [10     ]             [10     ] ',itoa(val($FD52,1),'%10.0f'),itoa(val($FD54,1),'%10.0f'));  
              print(9 ,8,'往 帐 金 额:  [16      ]       [16      ] ',itoa(val($FD40,0.01),'%16.2f'),itoa(val($FD42,0.01),'%16.2f'));                  
  
              print(11,8,'来 帐 笔 数:        [10     ]             [10     ] ',itoa(val($FD53,1),'%10.0f'),itoa(val($FD55,1),'%10.0f'));  
              print(13,8,'来 帐 金 额:  [16      ]       [16      ] ',itoa(val($FD41,0.01),'%16.2f'),itoa(val($FD43,0.01),'%16.2f'));               
        } 
        else
        {
              print(7,28,' 总 帐 核 对 时 出 错 ! ');  
        }                 

        }"
    </PRINT>
</RESPONSE>
-->
</TRANSACTION>
