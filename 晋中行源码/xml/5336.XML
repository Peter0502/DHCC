<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="5336      付款人开户行开户行多方协议号维护"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
 }"
</COMMSEND>
<COMMRECV>"{
}"
</COMMRECV>


<VARIABLE UPLOOP="TRUE">
<ITEM LINE="3"  COL="3" TYPE="%-55s" FUNCTIONS=
    "T(5336                    付款人开户行多方协议号维护)"/>
<ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
 <!--系统变量定义 -->
<ITEM NAME="#HTRMSEQ" TYPE="%-2s" FUNCTIONS="T($HTRMSEQ)"/>
<ITEM NAME="#HEJFNO"  TYPE="%-6s" FUNCTIONS="T($HEJFNO=000000)"/>
<ITEM NAME="#HCODE"   TYPE="%-1s" FUNCTIONS="T($HCODE)"/>
<ITEM NAME="#KINBR"   TYPE="%-7s" FUNCTIONS="T($KINBR)"/>
<ITEM NAME="#DSCPT"   TYPE="%3d"  FUNCTIONS="T(001)"/>
<ITEM NAME="#TXTYPE"  TYPE="%-2s" FUNCTIONS="T(  )"/>
<ITEM NAME="#TRMSEQ"  TYPE="%-2s" FUNCTIONS="T($TRMSEQ)"/>
<ITEM NAME="#EJFNO"   TYPE="%-6d" FUNCTIONS="T($TXTNO)"/>
<ITEM NAME="#TASKID"  TYPE="%-2s" FUNCTIONS="T(UC)"/>
<ITEM NAME="#TMTYPE"  TYPE="%-1s" FUNCTIONS="T(0)"/>
<ITEM NAME="#TXNO"    TYPE="%-2s" FUNCTIONS="T(62)"/>
<ITEM NAME="#PTYPE"   TYPE="%-1s" FUNCTIONS="T(0)"/>
<ITEM NAME="#MULTTX"  TYPE="%-1s" FUNCTIONS="T(0)"/>
<ITEM NAME="#CRDB"    TYPE="%-1s" FUNCTIONS="T(1)"/>
<ITEM NAME="#APTYPE"  TYPE="%-1s" FUNCTIONS="T(l)"/>
<ITEM NAME="#ACTNO"   TYPE="%-18s" FUNCTIONS="T(#PAYACTNO,1,18)"/>
<ITEM NAME="#SUPIN1"  TYPE="%-1s" FUNCTIONS="T(0)"/>
<ITEM NAME="#SUPIN2"  TYPE="%-1s" FUNCTIONS="T(0)"/>
<ITEM NAME="#REASON"  TYPE="%-6s" FUNCTIONS="T(0)"/>
<ITEM NAME="#TLRNO"   TYPE="%-6s" FUNCTIONS="T($TLRNO)"/>
<ITEM NAME="#NBCD"    TYPE="%-1s" FUNCTIONS="T(0)"/>
<ITEM NAME="#TRNMOD"  TYPE="%-1s" FUNCTIONS="T(0)"/>
<ITEM NAME="#SBTMOD"  TYPE="%-1s" FUNCTIONS="T(0)"/>
<ITEM NAME="#CURCD"   TYPE="%-3s" FUNCTIONS="T(RMB)"/>
<ITEM NAME="#XCRT"    TYPE="%-8s" FUNCTIONS="T($XCRT)"/>
<ITEM NAME="#APNO"    TYPE="%2d"  FUNCTIONS="T(09)"/>
<ITEM NAME="#CURP"    TYPE="%1d"  FUNCTIONS="T(1)"/>
<ITEM NAME="#OPNBR"   TYPE="%-7s"  FUNCTIONS="T($KINBR)"/>
<ITEM NAME="#TXAMT"   TYPE="%-12s" FUNCTIONS="T(000000000000)" />
<ITEM TYPE="%-1s" NAME="#QFLAG" FUNCTIONS=""/> 
<!--屏幕输入内容 -->
 <ITEM LINE="5"	COL="3" TYPE="%-12s" 	FUNCTIONS="T(多方协议号: )"/>
 <ITEM LINE="6" COL="3" TYPE="%-12s" 	FUNCTIONS="T(付款  帐号: )"/>
 <ITEM LINE="7" COL="3" TYPE="%-12s"    FUNCTIONS="T(操作  类型:!)"/>
 <ITEM LINE="8" COL="3" TYPE="%-12s" 	FUNCTIONS="T(付款  户名: )"/>
 <ITEM LINE="9" COL="3" TYPE="%-12s" 	FUNCTIONS="T(收款协议号: )"/>
 <ITEM LINE="10" COL="3" TYPE="%-12s" 	FUNCTIONS="T(收款  行号: )"/>
 <ITEM LINE="11" COL="3" TYPE="%-12s" 	FUNCTIONS="T(收款  帐号: )"/>
 <ITEM LINE="12" COL="3" TYPE="%-12s" 	FUNCTIONS="T(收款  户名: )"/>
 <ITEM LINE="13" COL="3" TYPE="%-12s" 	FUNCTIONS="T(业务  种类: )"/>
 <ITEM LINE="14" COL="3" TYPE="%-12s" 	FUNCTIONS="T(子业务种类1: )"/> 
 <ITEM LINE="15" COL="3" TYPE="%-12s" 	FUNCTIONS="T(子业务种类2: )"/> 
 <ITEM LINE="16" COL="3" TYPE="%-12s" 	FUNCTIONS="T(子业务种类3: )"/> 
 <ITEM LINE="17" COL="3" TYPE="%-12s" 	FUNCTIONS="T(子业务种类4: )"/> 
 <ITEM LINE="18" COL="3" TYPE="%-12s" 	FUNCTIONS="T(子业务种类5: )"/> 
 
<!--控制输入内容 --> 
<ITEM TYPE="%-1s"  NAME="#RTYPE"  FUNCTIONS="j(#OPTYPE?0,T{1}T{0})"/>
<ITEM LINE="5"   COL="15"  TYPE="%-60s"  NAME="#XYNO"   DEVICE="KEYBOARD"  FUNCTIONS="V(NB)"/>
<ITEM LINE="6"    COL="15"  TYPE="%-19s"   NAME="#PAYACTNO"  DEVICE="KEYBOARD" FUNCTIONS="V(NB)"/>
<ITEM LINE="7"  COL="15"  NAME="#OPTYPE" TYPE="%1d"  DEVICE="KEYBOARD" FUNCTIONS="T(0)V(0|1|2|3)J(#SOPTYPE)J(#RTYPE)">
    <SELECT LINE="7" COL="17">
      <OPTION VALUE="0" TITLE="查询"/>
      <OPTION VALUE="1" TITLE="增加"/>
      <OPTION VALUE="2" TITLE="修改"/>
      <OPTION VALUE="3" TITLE="删除"/>
    </SELECT>
 <ONLOSTFOCUS>
"{
	dim @actno as string;
	dim @a as string;
	dim @tota as string;
	if(#OPTYPE=='0'){
		//查询
		#QFLAG='1';
		enable(#SETSELECT,true);
		goitem(#OK,true);
		return(true);							
	}else{ 
		//修改(插入、删除)
		if(#OPTYPE=='2' or #OPTYPE=='3'){
			//删除、修改
			if(#QFLAG!='1'){
				showmsg('必须先查询后修改!');	
				return(false);
			}
		}
	}
  }"
</ONLOSTFOCUS>
</ITEM> 
<ITEM LINE="8"    COL="15"  TYPE="%-60s"   NAME="#PAYNAME"  DEVICE="KEYBOARD" FUNCTIONS="V(NB)"/>
<ITEM LINE="9"    COL="15"  TYPE="%-60s"   NAME="#CASHXYNO"  DEVICE="KEYBOARD" FUNCTIONS=""/>
<ITEM LINE="10"    COL="15"  TYPE="%-12s"   NAME="#CASHNO"  DEVICE="KEYBOARD" FUNCTIONS="V(NB)">
<ONLOSTFOCUS>"{
    dim @baktxno as string;
	@baktxno=$TXNO;
	$TXNO='9553';
	$FD32=#CASHNO;
	commsend_001();
	callserver();
	$TXNO=@baktxno;
	if($FD12!='0000'){
			showmsg(geterror());
			return(false);
	}
	showhelp(3,70,8,3,'支付系统行名信息',substr($FD96,0,60));
  }"
</ONLOSTFOCUS>
</ITEM>
<ITEM LINE="11"    COL="15"  TYPE="%-32s"   NAME="#CASHACTNO"  DEVICE="KEYBOARD" FUNCTIONS="V(NB)"/>
 <ITEM LINE="12"   COL="15"  TYPE="%-60s"  NAME="#CASHNAME"   DEVICE="KEYBOARD"  FUNCTIONS="V(NB)">
</ITEM>
 <ITEM LINE="13"  COL="15"  TYPE="%-5s"  NAME="#YWTYPE"   DEVICE="KEYBOARD"  FUNCTIONS="T(00100)V(NB)">
 <SELECT LINE="5" COL="47" >
	<OPTION VALUE="00100" TITLE="电费"/>
	<OPTION VALUE="00200" TITLE="水暖费"/>
	<OPTION VALUE="00300" TITLE="煤气费"/>
	<OPTION VALUE="00400" TITLE="电话费"/>
	<OPTION VALUE="00500" TITLE="通讯费"/>
	<OPTION VALUE="00600" TITLE="保险费"/>
	<OPTION VALUE="00700" TITLE="房屋管理费"/>
	<OPTION VALUE="00800" TITLE="代理服务费"/>
	<OPTION VALUE="00900" TITLE="学教费"/>
	<OPTION VALUE="01000" TITLE="有线电视费"/>
	<OPTION VALUE="01100" TITLE="企业管理费用"/>
	<OPTION VALUE="01200" TITLE="其他费用"/>
	<OPTION VALUE="05100" TITLE="薪金报酬费"/>
	<OPTION VALUE="09900" TITLE="其他代付费用"/>
 </SELECT>
 <ONLOSTFOCUS>"{
	#SETSELECT="#YWTYPE";
	enable(#SETSELECT,true);
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM  NAME="#SETSELECT"   TYPE="%-10s" ENABLE="FALSE" FUNCTIONS="">
 <ONLOSTFOCUS>"{
	dim @f as file;
	dim @line as string;
	dim @cnt as number;
	dim @ywtype as string;
	dim @ywdesc as string;
	dim @seltext as string;
	dim @len as number;
	@seltext='     未用            ';
	@f=openfile('../etc/'+#YWTYPE+'.dst');
	if(@f &lt; 0){
		showmsg('无法打开业务种类'+#YWTYPE+'的子类型描述文件!');
		return(false);
	}
	@line=readline(@f);	
	@cnt=atoi(substr(@line,0,2));
	if(@cnt &lt;= 0){
		showmsg('业务种类'+#YWTYPE+'的子类型描述文件格式错误!');
		closefile(@f);
		return(false);
	}
	while(true){
		//此处假定每行的行尾符号为一个字符
		@line=readline(@f);
		if(@line==''){
			break;
		}
		@len=len(@line);
		if(@len &lt; 5){
			continue;
		}
		if(substr(@line,@len-1,1)==chr(10)){
			@line=substr(@line,0,@len-1)+'                     ';
		}else{
			@line=@line+'                     ';
		}	
		@ywtype=substr(@line,0,5);
		@ywdesc=substr(@line,5,16);
		@seltext=@seltext+@ywtype+@ywdesc;
	}
	closefile(@f);
	setsel(#YWTYPE1,@seltext,'v5t11o5');
	setsel(#YWTYPE2,@seltext,'v5t11o5');
	setsel(#YWTYPE3,@seltext,'v5t11o5');
	setsel(#YWTYPE4,@seltext,'v5t11o5');
	setsel(#YWTYPE5,@seltext,'v5t11o5');
	if(#SETSELECT==	'#OPTYPE'){
		enable(#SETSELECT,false);
		#SETSELECT='';	
		showall();
		goitem(#OPTYPE,false);
	}else {
		enable(#SETSELECT,false);
		#SETSELECT='';	
	}	
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM LINE="14"  COL="15"  TYPE="%-5s"  NAME="#YWTYPE1"   DEVICE="KEYBOARD"  FUNCTIONS="T(     )V(NB)">
 <SELECT LINE="14" COL="17">
	<OPTION VALUE="     " TITLE="未用"/>
 </SELECT>
 <ONLOSTFOCUS>"{
	if(#YWTYPE1=='     '){
		showmsg('必须至少选择一种业务类型');
		return(false);
	}
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM LINE="15"  COL="15"  TYPE="%-5s"  NAME="#YWTYPE2"   DEVICE="KEYBOARD"  FUNCTIONS="T(     )"> 
 <SELECT LINE="15" COL="17">
	<OPTION VALUE="     " TITLE="未用"/>
 </SELECT>
 <ONLOSTFOCUS>"{
	if(#YWTYPE1=='     ' and  #YWTYPE2!='     '){
		showmsg('业务类型1未选择,不能选择此项');
		return(false);
	}
	if(#YWTYPE1==#YWTYPE2 and #YWTYPE2!='     '){
		showmsg('业务类型已选,不能选择此项');
		return(false);
	}
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM LINE="16"  COL="15"  TYPE="%-5s"  NAME="#YWTYPE3"   DEVICE="KEYBOARD"  FUNCTIONS="T(     )">
 <SELECT LINE="16" COL="17">
	<OPTION VALUE="     " TITLE="未用"/>
 </SELECT>
 <ONLOSTFOCUS>"{
	if(#YWTYPE2=='     ' and #YWTYPE3!='     '){
		showmsg('业务类型2未选择,不能选择此项');
		return(false);
	}
	if(#YWTYPE3==#YWTYPE1 and #YWTYPE3!='     ' or #YWTYPE3==#YWTYPE2 and #YWTYPE3!='     '){
		showmsg('业务类型已选,不能选择此项');
		return(false);
	}
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM LINE="17"  COL="15"  TYPE="%-5s"  NAME="#YWTYPE4"   DEVICE="KEYBOARD"  FUNCTIONS="T(     )">
 <SELECT LINE="17" COL="17">
	<OPTION VALUE="     " TITLE="未用"/>
 </SELECT>
 <ONLOSTFOCUS>"{
	if(#YWTYPE3=='     ' and #YWTYPE4!='     ' ){
		showmsg('业务类型3未选择,不能选择此项');
		return(false);
	}
	if(#YWTYPE4==#YWTYPE1 and #YWTYPE4!='     ' or #YWTYPE4==#YWTYPE2 and #YWTYPE4!='     ' or #YWTYPE4==#YWTYPE3 and #YWTYPE4!='     '){
		showmsg('业务类型已选,不能选择此项');
		return(false);
	}
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM LINE="18"  COL="15"  TYPE="%-5s"  NAME="#YWTYPE5"   DEVICE="KEYBOARD"  FUNCTIONS="T(     )">
 <SELECT LINE="18" COL="17">
	<OPTION VALUE="     " TITLE="未用"/>
 </SELECT>
 <ONLOSTFOCUS>"{
	if(#YWTYPE4=='     ' and #YWTYPE5!='     ' ){
		showmsg('业务类型4未选择,不能选择此项');
		return(false);
	}
	if(#YWTYPE5==#YWTYPE1 and #YWTYPE5!='     ' or #YWTYPE5==#YWTYPE2 and #YWTYPE5!='     ' or #YWTYPE5==#YWTYPE3 and #YWTYPE5!='     ' or #YWTYPE5==#YWTYPE4 and #YWTYPE5!='     '){
		showmsg('业务类型已选,不能选择此项');
		return(false);
	}
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <!-- 返回变量 --> 
<ITEM  TYPE="%-16s"  NAME="#FILENAME"    FUNCTIONS=""/>
<ITEM  TYPE="%-4s"   NAME="#SOPTYPE"     FUNCTIONS="S(#OPTYPE,#OPTYPE)"/> 
<ITEM  TYPE="%-1s"   NAME="#ROPTYPE"     FUNCTIONS=""/> 
<ITEM  TYPE="%-60s"   NAME="#RXYNO"     FUNCTIONS=""/> 
<ITEM  TYPE="%-19s"   NAME="#RPAYACTNO" FUNCTIONS=""/> 
<ITEM  TYPE="%-60s"   NAME="#RPAYNAME" FUNCTIONS=""/> 
<ITEM  TYPE="%-60s"   NAME="#RCASHXYNO" FUNCTIONS=""/> 
<ITEM  TYPE="%-12s"   NAME="#RCASHNO" FUNCTIONS=""/> 
<ITEM  TYPE="%-32s"   NAME="#RCASHACTNO" FUNCTIONS=""/> 
<ITEM  TYPE="%-60s"   NAME="#RCASHNAME" FUNCTIONS=""/> 
<ITEM  TYPE="%-5s"  NAME="#RYWTYPE" FUNCTIONS=""/> 
<ITEM  TYPE="%-5s"  NAME="#RYWTYPE1" FUNCTIONS=""/> 
<ITEM  TYPE="%-5s"  NAME="#RYWTYPE2" FUNCTIONS=""/> 
<ITEM  TYPE="%-5s"  NAME="#RYWTYPE3" FUNCTIONS=""/> 
<ITEM  TYPE="%-5s"  NAME="#RYWTYPE4" FUNCTIONS=""/> 
<ITEM  TYPE="%-5s"  NAME="#RYWTYPE5" FUNCTIONS=""/> 
<ITEM  TYPE="%-4s"  NAME="#SPACE4" FUNCTIONS=""/> 
<ITEM  TYPE="%-20s"  NAME="#SPACE20" FUNCTIONS=""/> 
<ITEM NAME="#SERVER"  TYPE="%-7s" FUNCTIONS="T($ORKINBR=#OPNBR)T($TTSKID=UP)"/>
<ITEM NAME="#TOTA"  TYPE="%-44s" FUNCTIONS=""/>
<ITEM LINE="21"  COL="59" TYPE="%-6s" NAME="#OK" FUNCTIONS="T(确  定)" INPUT="BUTTON">
<ONCLICK>"{
    commsend_001();
    $FD16='5876';
    $FD67=#OPTYPE;
	$FD96=getitems('#XYNO#PAYNAME#CASHXYNO#CASHNAME#SPACE4');
    $FD52=#CASHNO;
    $FD37=#PAYACTNO;
    $FD75=#CASHACTNO;
	$FD81=getitems('#YWTYPE#YWTYPE1#YWTYPE2#YWTYPE3#YWTYPE4#YWTYPE5#SPACE20');

    callserver();
    	if($FD12!='0000'){
   		showmsg(geterror());
   		return(false);
    }

	setitems('#XYNO#PAYNAME#CASHXYNO#CASHNAME#SPACE4',$FD96);
	setitems('#CASHNO',$FD52);
	setitems('#PAYACTNO',$FD37);
	setitems('#CASHACTNO',$FD75);
	setitems('#YWTYPE#YWTYPE1#YWTYPE2#YWTYPE3#YWTYPE4#YWTYPE5#SPACE20',$FD81);

	show(#XYNO,true);
	show(#PAYNAME,true);
	show(#CASHXYNO,true);
	show(#CASHNAME,true);
	show(#CASHNO,true);
	show(#PAYACTNO,true);
	show(#CASHACTNO,true);
	show(#YWTYPE,true);
	show(#YWTYPE1,true);
	show(#YWTYPE2,true);
	show(#YWTYPE3,true);
	show(#YWTYPE4,true);
	show(#YWTYPE5,true);

	if(#OPTYPE=='0'){
		showmsg('查询完毕');
		setitems('#OPTYPE','2');
		show(#OPTYPE,true);
	}else{
		runoutput();
	}

   }"
</ONCLICK>
</ITEM>

</VARIABLE>
<!--发送信息包-->
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="交易成功" CHECK="#OPTYPE?0">
    NOTHING
</PACKAGE>
<PRINT>"{
        print(5, 25,'小额多方协议号维护[4]成功',getseltitle(#OPTYPE,#OPTYPE));
        print(7, 20,'协议号:[60]',#XYNO);
    }"
</PRINT>
</RESPONSE>


</TRANSACTION>
