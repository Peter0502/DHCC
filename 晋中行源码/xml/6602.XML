<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00110000" TITLE="6602 证券回购借出借入记账"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
  <COMMSEND>"{
        initfd();
	$FD21=#BZ;	//币种
	$FD27=#DFHM;
	$FD30=#DFZH;
	$FD39=getitems('#ZQMZ');
	$FD40=getitems('#CRJE');
	$FD44=#DQRQ;
	$FD58=#PZH;
	$FD68=#CRBZ;
	$FD69='2';	//固定转帐
	$FD70=#ZQLB;
	$FD71='1';
	$FD85=itoa(#NLV*1000000, '%08.0f');
	$FD86=#XYBH;
	$FD89=#PZLX;
	$FD94=itoa(#DZYL*100000, '%08.0f');
  	commsend_001();
        $FD16='4702';
  }"
</COMMSEND>
<COMMRECV>"{
	
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(6602                      证券回购借出借入记帐  )"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4702)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>

  <!--输入变量-->
  <ITEM LINE="7"   COL="3"  TYPE="%-18s" FUNCTIONS="T(证券回购协议编号:)"/>
  <ITEM LINE="7"   COL="36" TYPE="%-10s" FUNCTIONS="T(证券类型:)"/>
  <ITEM LINE="8"   COL="3"  TYPE="%-16s" FUNCTIONS="T(证券面值:)"/>
  <ITEM LINE="8"   COL="36" TYPE="%-14s" FUNCTIONS="T(抵质押率:)"/>
  <ITEM LINE="8"   COL="57" TYPE="%-4s"  FUNCTIONS="T(％)"/>
  <!--ITEM LINE="10"  COL="3"  TYPE="%-14s" FUNCTIONS="T(币  种:)"/-->

  <ITEM LINE="11"  COL="3"  TYPE="%-16s" FUNCTIONS="T(借出/借入标志:)"/>
  <ITEM LINE="11"  COL="36" TYPE="%-16s" FUNCTIONS="T(借出/借入金额:)"/>

  <ITEM LINE="12"  COL="3"  TYPE="%-14s" FUNCTIONS="T(协议到期日:)"/>
  <ITEM LINE="12"  COL="36" TYPE="%-14s" FUNCTIONS="T(年利率:)"/>
  <ITEM LINE="12"  COL="57" TYPE="%-14s" FUNCTIONS="T(％)"/>

  <ITEM LINE="15"  COL="3"  TYPE="%-14s" FUNCTIONS="T(凭证种类:)"/>
  <ITEM LINE="15"  COL="46" TYPE="%-8s"  FUNCTIONS="T(凭证号:)"/>
  <ITEM LINE="16"  COL="3"  TYPE="%-14s" FUNCTIONS="T(帐    号:)"/>
  <ITEM LINE="17"  COL="3"  TYPE="%-14s" FUNCTIONS="T(户    名:)"/>
  <ITEM LINE="18"  COL="3"  TYPE="%-20s" FUNCTIONS="T(借入/借出机构名称:)"/>

  <ITEM NAME="#XYBH" INPUT="TEXT"   LINE="7"  COL="21" TYPE="%-10s" FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
  "{
	initfd();
	$TXNO='9840';
	$FD86=#XYBH;
	$FD67='1';	//查询出
	commsend_001();
	callserver();
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	#ZQMZ=val($FD39, 0.01);
	#CRJE=val($FD40, 0.01);
	#DQRQ=$FD44;
	switch($FD68){		//借出借入标志
		case '1':
		#SCRBZ='借出';
			break;
		case '2':
		#SCRBZ='借入';
			break;
	}
	#FSBZ=$FD69;
	switch($FD70){	//债券类别
		case '1':
			#SZQLB='国家债券';	
			break;
		case '2':
			#SZQLB='中央银行债券';	
			break;
		case '3':
			#SZQLB='其他债券';	
			break;
		case '4':
			#SZQLB='返售票据';	
			break;
		default:
			#SZQLB='错误债券';		
	}
	show(#SZQLB,true);
	#NLV=val($FD85, 0.000001);
	#DZYL=val($FD94, 0.00001);

	enable(#CRJE, true);
	enable(#DQRQ, true);
	enable(#FSBZ, true);
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#SZQLB"  LINE="7"  COL="47" TYPE="%-12s" 	FUNCTIONS=""/>
  <ITEM NAME="#ZQLB" TYPE="%-1s" FUNCTIONS="T($FD70)"/>
  <ITEM NAME="#CRBZ" TYPE="%-1s" FUNCTIONS="T($FD68)"/>
  <ITEM NAME="#ZQMZ"  TYPE="%17.2f" FUNCTIONS="J(#XZQMZ)"/>
  <ITEM NAME="#XZQMZ" LINE="8" COL="15"  TYPE="%-21s" FUNCTIONS="X(#ZQMZ)"/>
  <ITEM NAME="#DZYL"  TYPE="%9.5f"  FUNCTIONS="J(#XDZYL)"/>
  <ITEM NAME="#XDZYL" LINE="8" COL="47" TYPE="%-8s"  FUNCTIONS="X(#DZYL)"/>
   <ITEM NAME="#BZ"  TYPE="%-2s" FUNCTIONS="T(01)"/>
   <ITEM NAME="#SCRBZ" LINE="11"  COL="17" TYPE="%-4s" />

   <ITEM NAME="#CRJE" TYPE="%17.2f" FUNCTIONS="J(#XCRJE)"/>
   <ITEM NAME="#XCRJE"	 LINE="11" COL="51" TYPE="%-21s" FUNCTIONS="X(#CRJE)"/>

  <ITEM NAME="#DQRQ" LINE="12" COL="15" TYPE="%8s" FUNCTIONS=""/>
  <ITEM NAME="#NLV"  TYPE="%9.5f" FUNCTIONS="J(#XNLV)"/>
  <ITEM NAME="#XNLV" LINE="12" COL="47" TYPE="%-8s" FUNCTIONS="X(#NLV)"/>
<!--
  <ITEM NAME="#FSBZ" INPUT="SELECT" LINE="13"  COL="17" TYPE="%-1s" ENABLE="FALSE" FUNCTIONS="T(2)V(1|2)">
  	<SELECT>
  		<OPTION VALUE="1" TITLE="1.现金 "/>
  		<OPTION VALUE="2" TITLE="2.转账 "/>
  	</SELECT>
  </ITEM>
-->
  <ITEM NAME="#FSBZ" TYPE="%-1s" FUNCTIONS=""/>

   <ITEM NAME="#PZLX" INPUT="SELECT" LINE="15"  COL="13" TYPE="%-3s" 	FUNCTIONS="T(122)V(NB)">
  	<SELECT>
  		<OPTION VALUE="122" TITLE="122转帐借方传票 "/>
  		<OPTION VALUE="123" TITLE="123转帐贷方传票 "/>

  	</SELECT>
  </ITEM>
  <ITEM NAME="#PZH"	 LINE="15" COL="55" TYPE="%16d"  INPUT="TEXT" FUNCTIONS="T()"/>

  <ITEM NAME="#DFZH" LINE="16" COL="13" TYPE="%-19s" INPUT="TEXT" FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
  "{
	commsend_001();
	$FD16='9812';
	$FD30=#DFZH;
	callserver();
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	#DFHM=$FD27;
	show(#DFHM, true);
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#DFHM" LINE="17" COL="13" TYPE="%-50s"  />
  <ITEM NAME="#JRJCJG" LINE="18" COL="21" TYPE="%-50s" INPUT="TEXT"  FUNCTIONS="V(NB)"/>

  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($FD5,1,4)"/>
  <ITEM NAME="#MON"   TYPE="%-2s" FUNCTIONS="T($FD5,5,2)"/>
  <ITEM NAME="#DAY"   TYPE="%-2s" FUNCTIONS="T($FD5,7,2)"/>

  <ITEM NAME="#SUBMIT" LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>

  </VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="证券回购借出借入记账!">
NOTHING
</PACKAGE>
 <PRINT>"{
     print( 3, 30,'证券回购借出借入记账');
     print( 5, 20,'证券回购协议编号 : [10]',#XYBH);
     print( 6, 20,'证   券   面  值 : [12]',ltrim(comma(itoa(#ZQMZ,'%13.2f'),12)));
     print( 7, 20,'抵   质   押  率 : [8 ]',ltrim(comma(itoa(#DZYL,'%9.5f'),8)));
     print( 8, 20,'借出 / 借入 金额 : [8 ]',ltrim(comma(itoa(#CRJE,'%13.2f'),12)));
     print( 9, 20,'协  议 到 期  日 : [8 ]',#DQRQ);
     print(10, 20,'年     利     率 : [8 ]',ltrim(comma(itoa(#NLV,'%9.6f'),8)));
     print(12, 20,'证券回购借出借入账号: [24]',$FD31);
 }"
</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
  <PRINT>"{
dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:6602');
	print( 5, 13,'交易:证券回购借出借入记帐');
	
	print(07, 20,'证券回购协议编号: [10]',#XYBH);
	print(08, 20,'证   券   面  值: [12]',ltrim(comma(itoa(#ZQMZ,'%13.2f'),12)));
	print(09, 20,'抵   质   押  率: [8 ]',ltrim(comma(itoa(#DZYL,'%9.5f'),8)));
	print(10, 20,'借出 / 借入 金额: [12]',ltrim(comma(itoa(#CRJE,'%13.2f'),12)));
	print(11, 20,'协  议 到 期  日: [8 ]',#DQRQ);
	print(12, 20,'年     利     率: [8 ]',ltrim(comma(itoa(#NLV,'%9.6f'),8)));
	print(13, 20,'证券回购借出借入账号: [24]',$FD31);
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);   
     }"
</PRINT>
</RESPONSE>
</TRANSACTION>
