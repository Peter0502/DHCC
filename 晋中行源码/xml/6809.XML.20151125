<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="6809  回购式转贴现转入录入"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
    initfd();
	$MSGTYPE='03001';
    dim @baktxno as string;
    @baktxno=$TXNO;
	commsend_001();
	$FD12='4923';
	$FD16='9886';
    $FD25=#NAME;
    $FD44=#MDATE;
    $FD46=#RDATE;
    $FD63=#PANO;
    $FD68=#LIND;
    $FD69=#OPNO;
    $FD84=getitems('#PINT');
    $FD100=getitems('#TINT#AMT');
    callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
	$FD16 = '4923';
  	$MSGTYPE='03001';
}"
</COMMSEND>
<COMMRECV>"{
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-74s" FUNCTIONS=
    "T(6809                      回购式转贴现转入录入)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4923)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>

  <ITEM LINE="6"   COL="10" TYPE="%-10s" FUNCTIONS="T(操作标志!)"/>
  <ITEM LINE="7"   COL="10" TYPE="%-16s" FUNCTIONS="T(转贴现协议编号:)"/>
  <ITEM LINE="9"   COL="10"  TYPE="%-62s" FUNCTIONS="T(--------------------------------------------------------------------)"/>
  <ITEM LINE="11"  COL="10" TYPE="%-12s" FUNCTIONS="T(申请人名称:)"/>
  <ITEM LINE="12"  COL="10" TYPE="%-14s" FUNCTIONS="T(异地同城标志:!)"/>
  <ITEM LINE="13"  COL="10" TYPE="%-12s" FUNCTIONS="T(转贴现利率:)"/>
  <ITEM LINE="13"  COL="33" TYPE="%-2s"  FUNCTIONS="T(‰)"/>
  <ITEM LINE="14"  COL="10" TYPE="%-14s" FUNCTIONS="T(汇总票据金额:)"/>
  <ITEM LINE="15"  COL="10" TYPE="%-12s" FUNCTIONS="T(转贴现日期:)"/>
  <ITEM LINE="16"  COL="10" TYPE="%-10s" FUNCTIONS="T(回购日期:)"/>
  <ITEM LINE="17"  COL="10" TYPE="%-12s" FUNCTIONS="T(转贴现利息:)"/>
  
  <!--输入变量-->
  <ITEM NAME="#OPNO" LINE="6" COL="20" TYPE="%-1s" INPUT="SELECT" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="0" TITLE="录入"/>
		<OPTION VALUE="1" TITLE="修改"/>
		<OPTION VALUE="2" TITLE="删除"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#FLAGOPNO" TYPE="%4s" FUNCTIONS="S(#OPNO,#OPNO)"/>
  <ITEM NAME="#PANO" LINE="7" COL="26" TYPE="%-20s" INPUT="TEXT" FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
  "{
    if(#OPNO!='0')
    {
    	commsend_001();
 		$FD16='9690';
		$FD63=#PANO;
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#NAME=$FD25;
		#MDATE=$FD44;
		#RDATE=$FD46;
		#LIND=$FD68;
		setitems('#PINT',$FD84);
		setitems('#TINT#AMT',$FD100);
		show(#NAME,true);
		show(#PINT,true);
		show(#LIND,true);
		show(#TINT,true);
		show(#AMT,true);
		show(#MDATE,true);
		show(#RDATE,true);
	}

    if(#OPNO=='1')
    {
		enable(#TINT,false);
	}
	else if(#OPNO=='2')
    {
		goitem(#PASSWD,false);
	}
 }"
 </ONLOSTFOCUS>
 </ITEM>
 
  <ITEM NAME="#NAME" LINE="11" COL="22" TYPE="%-50s" INPUT="TEXT" FUNCTIONS="T()"/>
  
  <ITEM NAME="#LIND" LINE="12" COL="24" TYPE="%-1s" INPUT="SELECT" FUNCTIONS="T()">
  <SELECT>
		<OPTION VALUE="0" TITLE="本地"/>
		<OPTION VALUE="1" TITLE="异地"/>
	</SELECT>
	</ITEM>
  <ITEM NAME="#FLAGLIND" TYPE="%4s" FUNCTIONS="S(#LIND,#LIND)"/>
  <ITEM NAME="#PINT" LINE="13" COL="22" TYPE="%9.6f" INPUT="TEXT" FUNCTIONS="T()"/>
  <ITEM NAME="#AMT" LINE="14" COL="24" TYPE="%17.2f" INPUT="TEXT" FUNCTIONS="J(LAMT)"/>
   <ITEM NAME="#LAMT" TYPE="%-16s" FUNCTIONS="X(#AMT)"/>
  <ITEM NAME="#MDATE" LINE="15" COL="22" TYPE="%-8s" INPUT="TEXT" FUNCTIONS="D()">
  <ONLOSTFOCUS>
 "{
        if( #MDATE  &lt; $HDATE)
        {
            showmsg('到期日期必须大于当前日期，请重新输入!');
            return(false);
        }
 }"
 </ONLOSTFOCUS>
 </ITEM>
  <ITEM NAME="#RDATE" LINE="16" COL="22" TYPE="%-8s" INPUT="TEXT" FUNCTIONS="D()">
  <ONLOSTFOCUS>
  "{
        if( #RDATE  &lt; $HDATE)
        {
            showmsg('到期日期必须大于当前日期，请重新输入!');
            return(false);
        }

        if( #RDATE  &lt; #MDATE)
        {
            showmsg('回购日期必须大于转贴现日，请重新输入!');
            return(false);
        }
		if(#OPNO == '0')
		{
			goitem(#PASSWD,false);
		}

  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#TINT" LINE="17" COL="22" TYPE="%17.2f" INPUT="TEXT" FUNCTIONS="T()"/>
  
  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#O16" TYPE="%-16s" FUNCTIONS="T(0000000000000000)"/>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  
  <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($FD5,1,4)"/>
  <ITEM NAME="#MON"   TYPE="%-2s" FUNCTIONS="T($FD5,5,2)"/>
  <ITEM NAME="#DAY"   TYPE="%-2s" FUNCTIONS="T($FD5,7,2)"/>

  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  </VARIABLE>

<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="回购式转贴现转入录入!">
NOTHING
</PACKAGE>
	<PRINT>"{
	  print( 4,30,'回购式转贴现转入录入');
	  print( 6,20,'操  作  标  志: [4]' ,#FLAGOPNO);
	  print( 7,20,'转贴现协议编号: [20]',#PANO);
	  print( 8,20,'申 请 人 名 称: [50]',#NAME);
	  print( 9,20,'异地 同城 标志: [4]' ,#FLAGLIND);
	  print(10,20,'转 贴 现 利 率: [8]' ,ltrim(comma(itoa(#PINT,'%9.6f'),8)));
	  print(11,20,'汇总 票据 金额: [16]',#LAMT);
	  print(12,20,'转 贴 现 日 期: [8]' ,#MDATE);
	  print(13,20,'回  购  日  期: [8]' ,#RDATE);
 }"
 </PRINT>
 </RESPONSE>

 <RESPONSE>
 <PACKAGE DEVICE="PRINTER"  LINESPACE="38" DESC="打印凭条">
 NOTHING
 </PACKAGE>
  <PRINT>"{
	   print( 5,16,'[4]     [2]     [2]',#YEAR,#MON,#DAY);
	   print( 7, 8,'[5]',$FD2);
	   print( 7,24,'回购式转贴现转入录入');
	   print( 7,46,'[4]',$FD7);
	   print( 7,62,'[6]',$FD4);
	   print( 8,2,'操  作  标  志: [4]' ,#FLAGOPNO);
	   print( 9,2,'转贴现协议编号: [20]',#PANO);
	   print(10,2,'申 请 人 名 称: [50]',#NAME);
	   print(11,2,'异地 同城 标志: [4]' ,#FLAGLIND);
	   print(12,2,'转 贴 现 利 率: [8]' ,ltrim(comma(itoa(#PINT,'%9.6f'),8)));
	   print(13,2,'汇总 票据 金额: [16]',#LAMT);
	   print(14,2,'转 贴 现 日 期: [8]' ,#MDATE);
	   print(15,2,'回  购  日  期: [8]' ,#RDATE);
   }"
</PRINT>
</RESPONSE>

</TRANSACTION>
