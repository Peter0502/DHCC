<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111111100000000000000000000000" TITLE="5522 银行端缴款申报查询交易"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
          $FD45=#OORDERNO;
          $FD44=#OWTDATE;
	  $FD37=#CORPCODE;
	  $FD38=#TAXPAYCODE;
	  $FD60=#TAXORGCODE;
          commsend_001();
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>
<VARIABLE UPLOOP="TRUE">
<ITEM LINE="3"  COL="3" TYPE="%-64s" FUNCTIONS=
  "T(5522                     银行端缴款申报查询交易)"/>
<ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
 "T(─────────────────────────────────────)"/>
<ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5542)"/>
<ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>

<ITEM LINE="06" COL="10" TYPE="%-11s" FUNCTIONS="T(原申报序号:)"/>
<ITEM LINE="06" COL="41" TYPE="%-11s" FUNCTIONS="T(原委托日期:)"/>
<ITEM LINE="07" COL="10" TYPE="%-11s" FUNCTIONS="T(原征收机关:)"/>
<ITEM LINE="07" COL="41" TYPE="%-11s" FUNCTIONS="T(企业  代码:)"/>
<ITEM LINE="08" COL="10" TYPE="%-11s" FUNCTIONS="T(纳税人编码:)"/>

<!--输入变量-->
<ITEM NAME="#TAXORGTYPE"  TYPE="%1s" FUNCTIONS=""/>
<ITEM NAME="#OORDERNO"    LINE="06" COL="21" TYPE="%8d" INPUT="TEXT" FUNCTIONS="V(NB)">
<HELP>和商业银行行号、委托日期共同唯一标识一次查询请求</HELP>
</ITEM>   
<ITEM NAME="#OWTDATE"     LINE="06" COL="52" TYPE="%8d" INPUT="TEXT" FUNCTIONS="D()V(NB)">
<HELP>查询信息发送日期</HELP>
</ITEM>
<ITEM NAME="#TAXORGCODE"  LINE="07" COL="21" TYPE="%-12s" INPUT="TEXT" FUNCTIONS="V(NB)T()">
<HELP>纳税人所属的征收机关代码</HELP>
 <ONLOSTFOCUS>
 "{
   //ADD BY ZHGF
    dim @c as string;
    dim @d as string;
    dim @a as string;
    dim @b as string;
    dim @e as string;
    dim @f as string;
    dim @g as string;
   dim @FullMsg as string;
   @FullMsg='';
   initfd();
   dim @baktxno as string;
   @baktxno=$TXNO;
   $TXNO='9410';//ZHGF 查询机构代码表
   $FD61=#TAXORGCODE;
   commsend_001();
   calltips();
   $TXNO=@baktxno;
   if($FD12!='0000'){
     showmsg(geterror());
     return (false);
   }
     @d = substr($FD95,12,60);//名称
    @c =substr($FD95,72,1);//类型
    @a = substr($FD95,73,1);//级别
    @b = substr($FD95,74,1);
    //@FullMsg='户名:'+@d+chr(10)+'类型:'+@c+chr(10)+'征收机关类型:'+@a+chr(10)+'机构级次:'+@b;20090707 RM 
    //20090707 ADD BY ZHGF
    if(@c=='1'){
	@e='国税';
    }else {
	@e='地税';
    }
    //add by xijie20090708
    if(@a=='1'){
    @g='国家';
    }else if(@a=='2'){
    @g='省';
    }else if(@a=='3'){
    @g='市';
    }else if(@a=='4'){
    @g='县';
    }else{
    @g='乡';
    }
    //20090707 ADD BY ZHGF
    @FullMsg ='户名:'+@d+chr(10)+'征收机关类型:'+@e+chr(10)+'机构级次:'+@g;
    //showhelp(6,70,8,3,'征收机关基本信息',@FullMsg);
    showhelp(5,70,8,3,'征收机关基本信息',@FullMsg);
    //#TAXORGTYPE=substr(@a,0,1);RM BY ZHGF 20090707
    #TAXORGTYPE=substr(@c,0,1);
    //$FD20=@b;REPLACE BY NEXTLINE
    $FD20=@c;
}"
</ONLOSTFOCUS>
</ITEM>   

<ITEM NAME="#CORPCODE"    LINE="07" COL="52" TYPE="%20s" INPUT="TEXT" FUNCTIONS="">
<HELP>工商机关提供给征收机关的企业统一代码</HELP>
</ITEM>
<ITEM NAME="#TAXPAYCODE"  LINE="08" COL="21" TYPE="%20s" INPUT="TEXT" FUNCTIONS="V(NB)">
<HELP>唯一标识一个纳税人</HELP>
</ITEM>

<ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
<ONCLICK>
	"{
        commsend_001();
	$FD16='5542';
	$FD45=#OORDERNO;
        $FD44=#OWTDATE;
	$FD37=#CORPCODE;
	$FD38=#TAXPAYCODE;
	$FD60=#TAXORGCODE;
	calltips();
	if($FD12!='0000'){
	  showmsg(geterror());
	  return(false);
	}
	
	runoutput();
	rerun();
  		}"
</ONCLICK>
</ITEM>

</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE>
</PACKAGE>
<!--<PRINT>"{
     }"
</PRINT>-->
</RESPONSE>
</TRANSACTION>
