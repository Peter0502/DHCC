<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00110000" TITLE="6601 证券回购信息维护"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
  <COMMSEND>"{
     	initfd();
		$FD39=itoa(#ZQMZ*100, '%016.0f');
		$FD40=itoa(#CRJE*100, '%016.0f');
		$FD44=#DQRQ;
		$FD67=#CZLX;
		$FD68=#CRBZ;
		$FD69=#FSBZ;
		$FD70=#ZQLB;
		$FD85=itoa(#NLV*1000000, '%08.0f');
		$FD86=#XYBH;
		$FD94=itoa(#DZYL*100000, '%08.0f');
  		commsend_001();
        	$FD16='4701';
	}"
</COMMSEND>
<COMMRECV>"{
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(6601                        证券回购信息维护  )"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
  "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4701)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <!--输入变量-->
  <ITEM LINE="7"   COL="3"  TYPE="%-10s" FUNCTIONS="T(操作类型:)"/>
  <ITEM LINE="7"   COL="36" TYPE="%-18s" FUNCTIONS="T(证券回购协议编号:)"/>
  <ITEM LINE="10"  COL="3"  TYPE="%-10s" FUNCTIONS="T(证券类型:)"/>
  <ITEM LINE="10"  COL="36" TYPE="%-10s" FUNCTIONS="T(证券面值:)"/>
  <ITEM LINE="11"  COL="3"  TYPE="%-10s" FUNCTIONS="T(抵质押率:)"/>
  <ITEM LINE="11"  COL="25" TYPE="%-2s"  FUNCTIONS="T(％)"/>

  <ITEM LINE="13"  COL="3"  TYPE="%-14s" FUNCTIONS="T(借出/借入标志:)"/>
  <ITEM LINE="13"  COL="36" TYPE="%-14s" FUNCTIONS="T(借出/借入金额:)"/>

  <ITEM LINE="14"  COL="3"  TYPE="%-12s" FUNCTIONS="T(协议到期日:)"/>
  <ITEM LINE="14"  COL="36" TYPE="%-8s"  FUNCTIONS="T(年利率:)"/>
  <ITEM LINE="14"  COL="57" TYPE="%-2s"  FUNCTIONS="T(％)"/>

  <!--ITEM LINE="16"  COL="3" TYPE="%-14s" FUNCTIONS="T(付款收款方式:)"/-->

  <ITEM NAME="#CZLX"   INPUT="SELECT" LINE="7" COL="13" TYPE="%-1s" 	FUNCTIONS="T(0)"> 
  	<SELECT>
  		<OPTION VALUE="0" TITLE="0.录入 "/>
  		<OPTION VALUE="1" TITLE="1.修改 "/>
  		<OPTION VALUE="2" TITLE="2.删除 "/>
  	</SELECT>
  </ITEM>
  <ITEM NAME="#CZLXNAME"  TYPE="%-4s" FUNCTIONS="S(#CZLX,#CZLX)"/> 

  <ITEM NAME="#XYBH" 	INPUT="TEXT" LINE="7" COL="54" TYPE="%-10s" 	FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
  "{
		if(#CZLX != '0'){
     			initfd();
			$TXNO='9840';
			$FD86=#XYBH;
			$FD67=#CZLX;
			commsend_001();
			callserver();
			if($FD12!='0000'){
				showmsg(geterror());
				return(false);
			}
			#ZQMZ=val($FD39, 0.01);
			#CRJE=val($FD40, 0.01);
			#DQRQ=$FD44;
			#CRBZ=$FD68;
			#FSBZ=$FD69;
			#ZQLB=$FD70;
			#NLV=val($FD85, 0.000001);
			#DZYL=val($FD94, 0.00001);

			enable(#ZQMZ, true);
			enable(#CRJE, true);
			enable(#DQRQ, true);
			enable(#CRBZ, true);
			enable(#FSBZ, true);
			enable(#ZQLB, true);
			enable(#NLV, true);
			enable(#DZYL, true);
		if(#CZLX == '2'){
			goitem(#PASSWD);
		}
	}
  }"
  </ONLOSTFOCUS>

   </ITEM>
   <ITEM NAME="#ZQLB" INPUT="SELECT" LINE="10"  COL="13" TYPE="%-1s" 	FUNCTIONS="T(1)V(NB)">
  	<SELECT>
  		<OPTION VALUE="1" TITLE="1.国家债券 "/>
  		<OPTION VALUE="2" TITLE="2.中央银行债券 "/>
  		<OPTION VALUE="3" TITLE="3.其他证券 "/>
  		<OPTION VALUE="4" TITLE="4.返售票据 "/>
  	</SELECT>
</ITEM>

  <ITEM NAME="#ZQLBNAME"  TYPE="%-10s" FUNCTIONS="S(#ZQLB,#ZQLB)"/> 

   <ITEM NAME="#ZQMZ"	 LINE="10" COL="46" TYPE="%13.2f" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
   <ITEM NAME="#DZYL"	 LINE="11" COL="13" TYPE="%9.5f" INPUT="TEXT"	FUNCTIONS="V(NB)">
   <ONLOSTFOCUS>
   "{
        if(#DZYL &gt; 100)
        {
		   showmsg('输入数据超限');
           return(false);
        }
   }"
   </ONLOSTFOCUS>
   </ITEM>

  <ITEM NAME="#CRBZ" INPUT="SELECT" LINE="13"  COL="17" TYPE="%-1s" 	FUNCTIONS="T(1)V(1|2)">
  	<SELECT>
  		<OPTION VALUE="1" TITLE="1.借出 "/>
  		<OPTION VALUE="2" TITLE="2.借入 "/>
  	</SELECT>
  </ITEM>
  <ITEM NAME="#CRBZNAME"  TYPE="%-4s" FUNCTIONS="S(#CRBZ,#CRBZ)"/> 

  <ITEM NAME="#CRJE" LINE="13" COL="50" TYPE="%13.2f" INPUT="TEXT"	FUNCTIONS="T()V(NB)">
   <ONLOSTFOCUS>
   "{
        dim @l as number;
        @l=#ZQMZ*#DZYL*0.01;

        if( @l &lt;  #CRJE )
        {
            showmsg('金额错误，金额必须小于证券面值乘以抵押率值!');
            return(false);
        }
   }"
   </ONLOSTFOCUS>
   </ITEM>

  <ITEM NAME="#DQRQ" LINE="14" COL="15" TYPE="%8d" INPUT="TEXT"	FUNCTIONS="D()V(NB)">
   <ONLOSTFOCUS>
   "{
        if(#DQRQ &lt; $HDATE)
        {
           showmsg('日期错误，请重新输入!');
           return(false);
        }
   }"
   </ONLOSTFOCUS>
   </ITEM>


  <ITEM NAME="#NLV"	 LINE="14" COL="44" TYPE="%9.5f" INPUT="TEXT"	FUNCTIONS="V(NB)"/>
<!--
  <ITEM NAME="#FSBZ" INPUT="SELECT" LINE="16"  COL="17" TYPE="%-1s" 	FUNCTIONS="T(2)V(1|2)">
  	<SELECT>
  		<OPTION VALUE="1" TITLE="1.现金 "/>
  		<OPTION VALUE="2" TITLE="2.转账 "/>
  	</SELECT>
  </ITEM>
  <ITEM NAME="#FSBZNAME"  TYPE="%-4s" FUNCTIONS="S(#FSBZ,#FSBZ)"/> 
-->
  <ITEM NAME="#FSBZ"  TYPE="%-1s" FUNCTIONS="T(2)"/>
  <ITEM NAME="#FSBZNAME"  TYPE="%-4s" FUNCTIONS="T(转帐)"/> 

  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/> 
  <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($FD5,1,4)"/>
  <ITEM NAME="#MON"  TYPE="%-2s" FUNCTIONS="T($FD5,5,2)"/>
  <ITEM NAME="#DAY"  TYPE="%-2s" FUNCTIONS="T($FD5,7,2)"/>

  <ITEM NAME="#SUBMIT" LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  
</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
 <PACKAGE DEVICE="SCREEN"  LINESPACE="38" DESC="显示内容">
 NOTHING
    </PACKAGE>
    <PRINT>"{
        print( 3, 20,'6601 证券回购信息维护--[4]',#CZLXNAME);
        print( 6,  2,'协议编号 :[10]',#XYBH);
        print( 6, 35,'证券类型 :[10 ]',#ZQLBNAME);
        print( 7,  2,'证券面值 :[12]',ltrim(comma(itoa(#ZQMZ,'%13.2f'),12)));
        print( 7, 35,'抵质押率 :[8]％',ltrim(comma(itoa(#DZYL,'%9.3f'),8)));
        print(8,  2,'借出/借入标志:[8 ]',#CRBZNAME);
        print(8, 35,'借出/借入金额:[8 ]',ltrim(comma(itoa(#CRJE,'%13.2f'),12)));
        print(9,  2,'协议到期日 :[8 ]',#DQRQ);
        print(9, 35,'年利率 :[8]％ ',ltrim(comma(itoa(#NLV,'%9.3f'),8)));
    }"
    </PRINT>
</RESPONSE>

<RESPONSE>
 <PACKAGE DEVICE="PRINTER"  DESC="打印业务专用凭证">
 NOTHING
    </PACKAGE>
    <PRINT>"{
 dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:6601');
	print( 5, 13,'交易:证券回购信息维护');
	
	print( 7, 36,'证券回购信息维护--[4]',#CZLXNAME);
	print(08, 20,'协议编号:[10]',#XYBH);
	print(09, 20,'证券类型:[10 ]',#ZQLBNAME);
	print(10, 20,'证券面值:[12]',ltrim(comma(itoa(#ZQMZ,'%13.2f'),12)));
	print(11, 20,'抵质押率:[8]％',ltrim(comma(itoa(#DZYL,'%9.3f'),8)));
	print(12, 20,'借出/借入标志:[8 ]',#CRBZNAME);
	print(13, 20,'借出/借入金额:[8 ]',ltrim(comma(itoa(#CRJE,'%13.2f'),12)));
	print(14, 20,'协议到期日:[8 ]',#DQRQ);
	print(15, 20,'年利率:[8]％',ltrim(comma(itoa(#NLV,'%9.3f'),8)));
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);       
    }"
    </PRINT>
</RESPONSE>

</TRANSACTION>
