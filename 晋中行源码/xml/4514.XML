<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11000000" TITLE="4514 贷款冲正补记"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	commsend_001();
	$MSGTYPE='03001';
	$TXNO='3315';
	$FD16='3315';
	$FD39=getitems('#BJAMT');
	//showmsg($FD39);
	$FD40=getitems('#BNAMT');
	$FD41=getitems('#BWAMT');
	$FD42=getitems('#FLAMT');
	$FD44=#CZDAY;
	//$FD65='3205';
	//$FD65='3315';
	$FD67=#CBBZ;
	$FD68=#ZJBZ;
	}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
   "T(4514                            贷款冲正补记)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>

  <!--输入变量-->
  <ITEM LINE="7"   COL="05" TYPE="%-14s" FUNCTIONS="T(冲补标志!:)"/>
  <ITEM LINE="7"   COL="40" TYPE="%-16s" FUNCTIONS="T(原借贷标志!:)"/>
  <ITEM LINE="9"   COL="05" TYPE="%-14s" FUNCTIONS="T(贷款账号 :)"/>
  <ITEM LINE="09"  COL="41" TYPE="%-14s" FUNCTIONS="T(帐户序号 :)" NAME="#S_SEQNO" INPUT="LABEL" VISABLE="FALSE"/>
  <ITEM LINE="10"  COL="05" TYPE="%-14s" FUNCTIONS="T(贷款户名 :)"/>
  <ITEM LINE="12"  COL="05" TYPE="%-14s" FUNCTIONS="T(本金金额 :)"/>
  <ITEM LINE="12"  COL="41" TYPE="%-14s" FUNCTIONS="T(表内金额 :)"/>
  <ITEM LINE="13"  COL="05" TYPE="%-14s" FUNCTIONS="T(表外金额 :)"/>
  <ITEM LINE="13"  COL="41" TYPE="%-14s" FUNCTIONS="T(复利金额 :)"/>
  <ITEM LINE="15"  COL="05" TYPE="%-14s" FUNCTIONS="T(错帐日期 :)"/>


  <ITEM NAME="#CBBZ" 	INPUT="SELECT" 	LINE="7"   COL="15	" TYPE="%-1s" 	FUNCTIONS="T(1)">
  <SELECT>
  <OPTION TITLE="冲正" VALUE="1"/>
  <OPTION TITLE="补记" VALUE="2"/>
  </SELECT>
  </ITEM>

  <ITEM NAME="#ZJBZ" 	INPUT="SELECT" 	LINE="7"   COL="51	" TYPE="%-1s" 	FUNCTIONS="T(1)">
  <SELECT>
  <!--改回原来的-->
  <OPTION TITLE="借" VALUE="1"/><!--1-->
  <OPTION TITLE="贷" VALUE="0"/><!--0-->
  </SELECT>
  </ITEM>

  <ITEM NAME="#ACTNO" 	INPUT="TEXT" 	LINE="9"   COL="15	" TYPE="%-19s" 	FUNCTIONS="T()V(NB)"/>

  <ITEM NAME="#CON1"    TYPE="%-1s" >
  <ONLOSTFOCUS>
 "{
	commsend_001();
        $FD16='9807';
        $FD37=#ACTNO;

        callserver();
        if($FD12!='0000')
        {
            showmsg(geterror());
            return(false);
        }
		#NAME=$FD25;
		#SEQNO=$FD35;

		if(atoi($FD35)>1)
		{
			show(#S_SEQNO,true);
			show(#SEQNO,true);
		}
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#SEQNO" 	INPUT="TEXT" 	LINE="9"     COL="51	" TYPE="%4d" 	FUNCTIONS="" VISABLE="FALSE"/>
  <ITEM NAME="#NAME" 	LINE="10"    COL="15	" TYPE="%-60s" 	FUNCTIONS="" />

  <ITEM NAME="#BJAMT" 	INPUT="TEXT" 	LINE="12"    COL="15	" TYPE="%17.2f" 	FUNCTIONS="" />
  <ITEM NAME="#BNAMT" 	INPUT="TEXT" 	LINE="12"    COL="51	" TYPE="%17.2f" 	FUNCTIONS="" />
  <ITEM NAME="#BWAMT" 	INPUT="TEXT" 	LINE="13"    COL="15	" TYPE="%17.2f" 	FUNCTIONS="" />
  <ITEM NAME="#FLAMT" 	INPUT="TEXT" 	LINE="13"    COL="51	" TYPE="%17.2f" 	FUNCTIONS="" />

  <ITEM NAME="#CZDAY" 	INPUT="TEXT" 	LINE="15"    COL="15	" TYPE="%-8s" 	    FUNCTIONS="V(NB)D()" />

  <ITEM NAME="#PASSWD"  TYPE="%-6s"     />
  <ITEM NAME="#WSSRNO"  TYPE="%-6s"     />
  <ITEM NAME="#OTXDAY"  TYPE="%-10s"    />
  <ITEM NAME="#OSTDAY"  TYPE="%-10s"    />
  <ITEM NAME="#OENDAY"  TYPE="%-10s"    />
  <ITEM NAME="#OOPAMT"  TYPE="%-21s"    />
  <ITEM NAME="#OTXAMT"  TYPE="%-21s"    />
  <ITEM NAME="#OAVBAL"  TYPE="%-21s"    />
  <ITEM NAME="#ODINUM"  TYPE="%-21s"    />


  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  
  </VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" LINESPACE="38" DESC="显示内容">
NOTHING
</PACKAGE>
<PRINT>"{
print(7,27,'    ★操作成功★ ');
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="20" DESC="请打印贷款本金冲正补记凭证">
LNCBBJ|@jelx|@actno|@jjno|@name|@lnkd|@rkamt|@stday|@enday|@opamt|@txamt|@avbal|@nomrate|@overrate|@acno|@tp|@lx|@wssrno|@crdb|@dinum|@czday|@fxbz
</PACKAGE>
<INIT>
"{
    #OTXDAY=substr($HDATE,0,4)+'-'+substr($HDATE,4,2)+'-'+substr($HDATE,6,2);
    #OSTDAY=substr(@czday,0,4)+'-'+substr(@czday,4,2)+'-'+substr(@czday,6,2);
    #OTXAMT=comma(@rkamt,21);
    #ODINUM=comma(@dinum,21);
}"
</INIT>
<PRINT>"{
print( 2,35,'\H0贷款本金[4   ]([2 ]方)凭证\H1', @lx, @tp);
print( 4,12,'      交易日期: [10        ]                                                 流 水 号: [5  ]',#OTXDAY,@wssrno);
print( 5,7,' ┍━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑');
print( 6,7,' ┃  机构名称: [60                                                          ]                    ┃',$BRNAME);
print( 7,7,' ┃  贷款账号: [19                   ]                             借 据 号: [20             ]  ┃',@actno,@jjno);
print( 8,7,' ┃  户    名: [60                                                ]                    ┃',@name);
print( 9,7,' ┃  产品名称: [50                                                ]科 目 号: [7      ]             ┃',@lnkd,@acno);
print(10,7,' ┃--------------------------------------------------------------------------------------------┃');
print(11,7,' ┃  冲补标志: [4    ]                                   借贷标志: [4    ]                           ┃',@lx,@tp);
print(12,7,' ┃  错帐日期: [10        ]                             [4    ]积数: [21                    ]          ┃',#OSTDAY,@lx,ltrim(#ODINUM));
print(13,7,' ┃  金额类型: [20                         ]                                                            ┃',@jelx);
print(14,7,' ┃  冲正金额: 人民币[8 ][30                             ]                                    ┃',@fxbz,ltrim(#OTXAMT));
print(15,7,' ┕━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙');
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="20" DESC="请打印贷款表内冲正补记凭证">
LNCBBN|@jelx|@actno|@jjno|@name|@lnkd|@rkamt|@stday|@enday|@opamt|@txamt|@avbal|@nomrate|@overrate|@acno|@tp|@lx|@wssrno|@crdb|@dinum|@czday|@fxbz
</PACKAGE>
<INIT>
"{
    #OTXDAY=substr($HDATE,0,4)+'-'+substr($HDATE,4,2)+'-'+substr($HDATE,6,2);
    #OSTDAY=substr(@czday,0,4)+'-'+substr(@czday,4,2)+'-'+substr(@czday,6,2);
    #OTXAMT=comma(@rkamt,21);
    #ODINUM=comma(@dinum,21);
}"
</INIT>
<PRINT>"{
print( 2,35,'\H0贷款表内[4   ]([2 ]方)凭证\H1', @lx, @tp);
print( 4,12,'      交易日期: [10        ]                                                 流 水 号: [5  ]',#OTXDAY,@wssrno);
print( 5,7,' ┍━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑');
print( 6,7,' ┃  机构名称: [60                                                          ]                    ┃',$BRNAME);
print( 7,7,' ┃  贷款账号: [19                   ]                             借 据 号: [20             ]  ┃',@actno,@jjno);
print( 8,7,' ┃  户    名: [60                                                ]                              ┃',@name);
print( 9,7,' ┃  产品名称: [50                                                ]科 目 号: [7      ]             ┃',@lnkd,@acno);
print(10,7,' ┃--------------------------------------------------------------------------------------------┃');
print(11,7,' ┃  冲补标志: [4    ]                                   借贷标志: [4    ]                           ┃',@lx,@tp);
print(12,7,' ┃  错帐日期: [10        ]                             [4    ]积数: [21                    ]          ┃',#OSTDAY,@lx,ltrim(#ODINUM));
print(13,7,' ┃  金额类型: [20                         ]                                                            ┃',@jelx);
print(14,7,' ┃  冲正金额: 人民币[8 ][30                ]        ┃',@fxbz,ltrim(#OTXAMT));
print(15,7,' ┕━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙');
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="20" DESC="请打印贷款表外冲正补记凭证">
LNCBBW|@jelx|@actno|@jjno|@name|@lnkd|@rkamt|@stday|@enday|@opamt|@txamt|@avbal|@nomrate|@overrate|@acno|@tp|@lx|@wssrno|@crdb|@dinum|@czday|@fxbz
</PACKAGE>
<INIT>
"{
    #OTXDAY=substr($HDATE,0,4)+'-'+substr($HDATE,4,2)+'-'+substr($HDATE,6,2);
    #OSTDAY=substr(@czday,0,4)+'-'+substr(@czday,4,2)+'-'+substr(@czday,6,2);
    #OTXAMT=comma(@rkamt,21);
    #ODINUM=comma(@dinum,21);
}"
</INIT>
<PRINT>"{
print( 2,35,'\H0贷款表外[4   ]([2 ]方)凭证\H1', @lx, @tp);
print( 4,12,'      交易日期: [10        ]                                                 流 水 号: [5  ]',#OTXDAY,@wssrno);
print( 5,7,' ┍━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑');
print( 6,7,' ┃  机构名称: [60                                                          ]                    ┃',$BRNAME);
print( 7,7,' ┃  贷款账号: [19                   ]                             借 据 号: [20             ]  ┃',@actno,@jjno);
print( 8,7,' ┃  户    名: [60                                                ]                              ┃',@name);
print( 9,7,' ┃  产品名称: [50                                                ]科 目 号: [7      ]             ┃',@lnkd,@acno);
print(10,7,' ┃--------------------------------------------------------------------------------------------┃');
print(11,7,' ┃  冲补标志: [4    ]                                   借贷标志: [4    ]                           ┃',@lx,@tp);
print(12,7,' ┃  错帐日期: [10        ]                             [4    ]积数: [21                    ]          ┃',#OSTDAY,@lx,ltrim(#ODINUM));
print(13,7,' ┃  金额类型: [20                         ]                                                            ┃',@jelx);
print(14,7,' ┃  冲正金额: 人民币[8 ][30                  ]          ┃',@fxbz,ltrim(#OTXAMT));
print(15,7,' ┕━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙');
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="20" DESC="请打印贷款表外冲正补记凭证">
LNCBFL|@jelx|@actno|@jjno|@name|@lnkd|@rkamt|@stday|@enday|@opamt|@txamt|@avbal|@nomrate|@overrate|@acno|@tp|@lx|@wssrno|@crdb|@dinum|@czday|@fxbz
</PACKAGE>
<INIT>
"{
    #OTXDAY=substr($HDATE,0,4)+'-'+substr($HDATE,4,2)+'-'+substr($HDATE,6,2);
    #OSTDAY=substr(@czday,0,4)+'-'+substr(@czday,4,2)+'-'+substr(@czday,6,2);
    #OTXAMT=comma(@rkamt,21);
    #ODINUM=comma(@dinum,21);
}"
</INIT>
<PRINT>"{
print( 2,35,'\H0贷款复利[4   ]([2 ]方)凭证\H1', @lx, @tp);
print( 4,12,'      交易日期: [10        ]                                                 流 水 号: [5  ]',#OTXDAY,@wssrno);
print( 5,7,' ┍━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑');
print( 6,7,' ┃  机构名称: [60                                                          ]                  ┃',$BRNAME);
print( 7,7,' ┃  贷款账号: [19                   ]                             借 据 号: [20             ] ┃',@actno,@jjno);
print( 8,7,' ┃  户    名: [60                                                ]                            ┃',@name);
print( 9,7,' ┃  产品名称: [50                                                ]科 目 号: [7      ]         ┃',@lnkd,@acno);
print(10,7,' ┃--------------------------------------------------------------------------------------------┃');
print(11,7,' ┃  冲补标志: [4    ]                                   借贷标志: [4    ]                     ┃',@lx,@tp);
print(12,7,' ┃  错帐日期: [10        ]                             [4    ]积数: [21                    ]    ┃',#OSTDAY,@lx,ltrim(#ODINUM));
print(13,7,' ┃  金额类型: [20                         ]                                                   ┃',@jelx);
print(14,7,' ┃  冲正金额: 人民币[8 ][30                      ]       ┃',@fxbz,ltrim(#OTXAMT));
print(15,7,' ┕━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙');
}"
</PRINT>
</RESPONSE>

<RESPONSE>
  <PACKAGE DEVICE="PRINTER" DESC="打印业务专用凭证(贷款冲正补记)">
   NOTHING
  </PACKAGE> 
  <PRINT>
  "{
dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);
        print( 5, 2,'代码:4514');
        print( 5, 13,'交易:贷款冲正补记');
        print_sq();
	printacdtl_1();
	print( 24,20,'备注:')
        print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
        print( 24,5,'柜员:[4]',$FD7);
        print( 24,5,'流水号:[6]',$FD4);
   
}"
  </PRINT>
</RESPONSE>
</TRANSACTION>
