<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00110000" TITLE="6406  同业拆出收回"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
    initfd();
	dim @txno_bak as string;
	dim @tota as string;
	@txno_bak=$TXNO;
	$FD12='4506';
	$TXNO='9986';
	$FD25=#CJHM;
	$FD30=#DFZH;
        $FD31=#CJZH;
        $FD32=#WHZH;
	$FD36=#CJQX;
//    $FD40=getitems('#CJJE');
//    $FD41=getitems('#ZHYE');
      $FD42=getitems('#GHJE');
	$FD43=getitems('#GHLX');
//	$FD84=getitems('#CJLL');
//	$FD85=getitems('#YQLL');							  

	$FD40=itoa(val(#CJJE,100),'%016d');
	$FD41=itoa(val(#ZHYE,100),'%016d');

	$FD44=#DQRQ;
	$FD67='1';//同城#HSFS 回收方式
	$FD72='2';
	$FD73=#HTH;	
	$FD84=itoa(val(#CJLL,1000000),'%08d');
	$FD85=itoa(val(#YQLL,1000000),'%08d');
	commsend_001();
//  $FD121=#WHZH+space(88)+$FD42;   //A017
	callserver();
	if($FD12!='0000')
	   {
			 showmsg(geterror());
			 return(false);
		}
	$FD16='4506';
	$MSGTYPE='03001';
	}"
</COMMSEND>

<COMMRECV>"{
	 if($FD12 == '0000')
	 {
		 showmsg('交易成功!');
	 }
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(6406                         同业拆出收回)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4506)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <!--输入变量-->
  <BLOCK NAME="COMMON" LINE="6" COL="8">
  <ITEM LINE="0" COL="0" TYPE="%-10s" FUNCTIONS="T(合 同 号:)"/>
<!--  <ITEM LINE="0" COL="30" TYPE="%-10s" FUNCTIONS="T(回收方式:!)"/> -->
  <ITEM LINE="0" COL="28" TYPE="%-10s" FUNCTIONS="T(帐    号:)"/>
  <ITEM LINE="1" COL="0"  TYPE="%-12s" FUNCTIONS="T(户      名:)"/>
  <ITEM LINE="2" COL="0" TYPE="%-10s" FUNCTIONS="T(归还金额:)"/>
  <ITEM LINE="3" COL="0" TYPE="%-10s" FUNCTIONS="T(归还利息:)"/> 
  <ITEM LINE="4" COL="0" TYPE="%-60s" FUNCTIONS="T(------------------------------------------------------------)"/>
  <ITEM LINE="5" COL="0" TYPE="%-10s" FUNCTIONS="T(拆借账号:)"/>
  <ITEM LINE="6" COL="0" TYPE="%-10s" FUNCTIONS="T(拆借户名:)"/>
  <ITEM LINE="7" COL="0" TYPE="%-10s" FUNCTIONS="T(账户余额:)"/>
  <ITEM LINE="8" COL="0" TYPE="%-10s" FUNCTIONS="T(对方账号:)"/>
  <ITEM LINE="9" COL="0" TYPE="%-10s" FUNCTIONS="T(拆借金额:)"/> 
  <ITEM LINE="10" COL="0" TYPE="%-10s" FUNCTIONS="T(拆借利率:)"/>
  <ITEM LINE="10" COL="18" TYPE="%-2s" FUNCTIONS="T(％)"/>   
  <ITEM LINE="10" COL="30" TYPE="%-10s" FUNCTIONS="T(逾期利率:)"/> 
  <ITEM LINE="10" COL="50" TYPE="%-2s" FUNCTIONS="T(％)"/>  
  <ITEM LINE="11" COL="0" TYPE="%-10s" FUNCTIONS="T(到期日期:)"/>
  <ITEM LINE="11" COL="30" TYPE="%-10s" FUNCTIONS="T(拆借期限:)"/>
  <ITEM LINE="11" COL="50" TYPE="%-2s" FUNCTIONS="T(天)"/>   

  <ITEM NAME="#HTH" INPUT="TEXT" LINE="0" COL="10" TYPE="%-10s" FUNCTIONS="V(NB)"> 
  <ONLOSTFOCUS>
 "{	
		initfd();
 		dim @tota as string;	
    	commsend_001();
 		$FD16='9944';
		$FD73=#HTH;
		$FD72='1';
		$FD72='2';
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
    	#CJHM=delspace($FD25);
	  	#CJZH=delspace($FD31);
    	#DQRQ=delspace($FD44);
    	#CJQX=delspace($FD36);
	  	#DFZH=delspace($FD30);  

//    	setitems('#CJLL',$FD84);
//    	setitems('#YQLL',$FD85);
//    	setitems('#CJJE',$FD40);
//    	setitems('#ZHYE',$FD41);
    	setitems('#GHJE',$FD42);
    	setitems('#GHLX',$FD43);

		#CJLL = ltrim(comma(itoa(val($FD84,0.000001),'%.6f'),8));
		#YQLL = ltrim(comma(itoa(val($FD85,0.000001),'%.6f'),8));
		#CJJE=ltrim(comma(itoa(val($FD40,0.01),'%.2f'),16));
		#ZHYE=ltrim(comma(itoa(val($FD41,0.01),'%.2f'),16));
		#GHJE= val($FD40,0.01);

	  	show(#CJHM,true);
    	show(#CJZH,true);
	  	show(#DQRQ,true);
	  	show(#CJLL,true);	
	  	show(#YQLL,true);
	  	show(#CJQX,true);
	  	show(#CJJE,true);		
	  	show(#ZHYE,true);				
	  	show(#GHJE,true);	
    	show(#GHLX,true);
    	show(#DFZH,true); 
    	show(#GHJE,true);
    	enable(#GHJE,false);				
	 }"
 </ONLOSTFOCUS>
  </ITEM> 
  <ITEM NAME="#WHZH" INPUT="TEXT" LINE="0" COL="40" TYPE="%-19s" FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
 "{	
    initfd();
    commsend_001();
 		$FD16='9731';
    $FD102=#WHZH;
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#WHHM=delspace($FD25);
		show(#WHHM,true);
 }"
 </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#WHHM" INPUT="LABEL" LINE="1" COL="12" TYPE="%-50s" FUNCTIONS=""/>
  
  <!---
  <ITEM NAME="#GHJE" INPUT="TEXT"  LINE="1" COL="10" TYPE="%17.2f" FUNCTIONS="V(000000000000001,999999999999999)"/>
  -->
  <ITEM NAME="#GHJE" INPUT="TEXT"  LINE="2" COL="10" TYPE="%17.2f" FUNCTIONS="J(#LGHJE)"/>
  <ITEM NAME="#LGHJE" TYPE="%-16s" FUNCTIONS="X(#GHJE)"/>
  <ITEM NAME="#GHLX" INPUT="TEXT"  LINE="3" COL="10" TYPE="%17.2f" FUNCTIONS="J(#LGHLX)"/>
   <ITEM NAME="#LGHLX" TYPE="%-16s" FUNCTIONS="X(#GHLX)"/>

<!-- 2006 9 22 martin 取消HSFS相关 增加贷方帐户和户名
  <ITEM NAME="#HSFS" INPUT="SELECT" LINE="0" COL="40" TYPE="%-1s" FUNCTIONS="T(1)">
	<SELECT>
		<OPTION VALUE="1" TITLE="同城"/>
		<OPTION VALUE="2" TITLE="大额"/>
	</SELECT>
  </ITEM>	 
  <ITEM NAME="#FLAGHSFS" TYPE="%4s" FUNCTIONS="S(#HSFS,#HSFS)"/>
-->
  <ITEM NAME="#CJZH" INPUT="TEXT" ENABLE="FALSE" LINE="5" COL="10"  TYPE="%-24s" FUNCTIONS=""/>
  <ITEM NAME="#CJHM" INPUT="TEXT" ENABLE="FALSE" LINE="6" COL="10"  TYPE="%-50s" FUNCTIONS=""/>
  <ITEM NAME="#ZHYE" INPUT="TEXT" ENABLE="FALSE" LINE="7" COL="10"  TYPE="%-16s" FUNCTIONS=""/>
  <ITEM NAME="#DFZH" INPUT="TEXT" ENABLE="FALSE" LINE="8" COL="10"  TYPE="%-24s" FUNCTIONS=""/>
  <ITEM NAME="#CJJE" INPUT="TEXT" ENABLE="FALSE" LINE="9" COL="10"  TYPE="%-16s" FUNCTIONS=""/>
  <ITEM NAME="#CJLL" INPUT="TEXT" ENABLE="FALSE" LINE="10" COL="10" TYPE="%-8s"  FUNCTIONS=""/>
  <ITEM NAME="#YQLL" INPUT="TEXT" ENABLE="FALSE" LINE="10" COL="40" TYPE="%-8s"  FUNCTIONS=""/>   
  <ITEM NAME="#DQRQ" INPUT="TEXT" ENABLE="FALSE" LINE="11" COL="10" TYPE="%-8s"  FUNCTIONS=""/>
  <ITEM NAME="#CJQX" INPUT="TEXT" ENABLE="FALSE" LINE="11" COL="40" TYPE="%4d"   FUNCTIONS=""/>               
  </BLOCK>
  <!--输出变量--->
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT">
</ITEM>
   <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($FD5,1,4)"/>
   <ITEM NAME="#MON"   TYPE="%-2s" FUNCTIONS="T($FD5,5,2)"/>
   <ITEM NAME="#DAY"   TYPE="%-2s" FUNCTIONS="T($FD5,7,2)"/>

</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="同业拆出回收 显示内容">
NOTHING
</PACKAGE>
<PRINT>"{
	  print( 4, 30,'同业拆出回收');
	  print( 5, 20,'流 水 号:  [6]', $FD4);
 	  print( 6, 20,'合 同 号:[10]',#HTH);
 	  print( 7, 20,'拆借户名:[50]',#CJHM);
 	  print( 8, 20,'对方帐号:[30]',#DFZH);
 	  print( 9, 20,'拆借金额:[20]',#CJJE);
 	  print(10, 20,'拆借期限:[4 ] 天', #CJQX);
 	  print(11, 20,'拆借利率:[10]％',#CJLL);
    print(12, 20,'逾期利率:[10]％',#YQLL);
	  print(13, 20,'归还金额:[16]',#LGHJE);
	  print(14, 20,'归还利息:[16]',#LGHLX);
	}"
</PRINT>
 </RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER"   DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
<PRINT>"{
 $KINDNO='00';
 dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:6406');
	print( 5, 13,'交易:同业拆出收回');
	
 	print( 7,20,'合 同 号:[10]',#HTH);
 	print( 8,20,'拆借户名:[50]',#CJHM);
 	print( 9,20,'对方帐号:[30]',#DFZH);
 	print(10,20,'拆借金额:[20]',#CJJE);
 	print(11,20,'拆借期限:[4 ]天', #CJQX);
 	print(12,20,'拆借利率:[ 8]％',#CJLL);
	print(13,20,'逾期利率:[ 8]％',#YQLL);
	print(14,20,'归还金额:[16]',#LGHJE);
	print(15,20,'归还利息:[16]',#LGHLX);
	printacdtl_1();
	  
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4); 
}"
 </PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"   DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
<PRINT>"{
	$KINDNO == '00';
	dim @txtime  as string;
	@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	
	print( 2,35,'\H0贷款利息传票(同业拆出收回)\H1');
	print( 4,12,'      交易日期: [8       ] [8       ]                                      流 水 号: [5  ]',$HDATE,@txtime,$FD4);
	print( 5,20,' ┍━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┑');
	print( 6,20,' ┃  机构名称: [60                                                          ]                  ┃',$BRNAME);
	print( 7,20,' ┃  账    号: [19                   ]                   合 同 号: [20                  ]      ┃',#WHZH,#HTH);
	print( 8,20,' ┃  户    名: [60                                                ]                            ┃',#WHHM);
	print(10,20,' ┃--------------------------------------------------------------------------------------------┃');
	print(11,20,' ┃  拆借期限: [4   ]                                    到期日期: [8       ]                  ┃',#CJQX,#DQRQ);
	print(12,20,' ┃  拆借金额: [21                          ]            拆借利率: [8       ]                  ┃',#CJJE,#CJLL);
	print(13,20,' ┃  归还金额: [21                          ]            逾期利率: [8       ]                  ┃',#LGHJE,#YQLL);
	print(14,20,' ┃  归还利息: [21                          ]                                                  ┃',#LGHLX);
	print(15,20,' ┕━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┙');
	}"
 </PRINT>
</RESPONSE>
<OUTPUT>
</OUTPUT>
</TRANSACTION>
