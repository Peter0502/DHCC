<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="3430 存款扣划"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	commsend_001();
   	$FD16='2430';
   	$FD31=#ACTNO24;
   	$FD34=#ACTSEQ;  
   	$FD35=#HOLD_SEQ;  
   	$FD70=#KHLX; 
       
        $FD101=getitems('#101ACTNO#101ACSEQ#101AMT#101VOCTYPE#101VOCNUM#101DSCPT#101CARDFLAG#101CNAME#101AVBAL#101CURCD#101CASHFLAG#101DSCTYPE#101ACTYPE#101ACSEQ2#101PNAME');
        $FD39=#KKH_AMT;
        #FD102K=#CASHFLAG1;
	#FD102F=#TXAMT;
	$FD102=getitems('#FD1021#FD1022#FD1023#FD1024#FD1025#FD1026#FD1027#FD1028#FD1029#FD102A#FD102B#FD102C#FD102D#FD102E#FD102F#FD102G#FD102H#FD102I#FD102J#FD102K#FD102L#FD102M#FD102N#FD102O#FD102P#FD102Q#FD102R#FD102S#FD102T#FD102U#FD102V#FD102W#FD102X#FD102Y');

	//showmsg('102O=['+#FD102O+']#FD1026=['+#FD1026+']');
   	

}"
</COMMSEND>

<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>
<FIRSTWORK>
"{
  #PIC='';
  #PIC1='';
}"
</FIRSTWORK>
<VARIABLE >
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(3430                          存  款  扣  划)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>

  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=2430)"/>    
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM NAME="#TXCD"    TYPE="%-4s"  FUNCTIONS="T(3430)"/>
  <ITEM NAME="#TXNAME"  TYPE="%-10s" FUNCTIONS="T(存款扣划)"/><!---交易名称--->
  
  <ITEM NAME="#ACTNO24"   TYPE="%-24s" FUNCTIONS=""/>  
  <ITEM NAME="#PRDT_CODE"   TYPE="%-30s" FUNCTIONS=""/>  
  <ITEM NAME="#AC_TYPE" TYPE="%-1s" FUNCTIONS=""/>  
   
   <ITEM NAME="#ACT_LX"    TYPE="%-5s"  FUNCTIONS=""/>
   <ITEM NAME="#ACT_LX_CK" TYPE="%-5s"  FUNCTIONS=""/>
  <ITEM NAME="#SPACE96" TYPE="%-80s" FUNCTIONS=""/>  
  <ITEM NAME="#SPACE1" TYPE="%-1s" FUNCTIONS=""/> 
  <ITEM NAME="#SPACE6" TYPE="%-6s" FUNCTIONS=""/>   
  <ITEM NAME="#SPACE20" TYPE="%-20s" FUNCTIONS=""/>      
  <ITEM NAME="#SPACE16" TYPE="%-16s" FUNCTIONS="                "/>      
  <ITEM NAME="#HOLD_AMT"  TYPE="%17.2f" FUNCTIONS=""/>
  <ITEM NAME="#DJ_AMT"   TYPE="%17.2f"  FUNCTIONS=""/>
  <ITEM NAME="#HOLD_STS"  TYPE="%-1s" FUNCTIONS=""/>

  <ITEM NAME="#CUSTNAME_TMP" TYPE="%-50s" FUNCTIONS="T()"/> 
  <ITEM NAME="#CASHFLAG1" TYPE="%-50s" FUNCTIONS="T()"/>

  <!--<IMPORT>DATA_DIC.IMP</IMPORT>-->
	
	<ITEM NAME="#FD1020" TYPE="%0s" FUNCTIONS="" /> <!--取款交易结构,0 -->
	<ITEM NAME="#FD1021" TYPE="%24s" FUNCTIONS="" /> <!--账号,0 -->
	<ITEM NAME="#FD1022" TYPE="%4s" FUNCTIONS="" /> <!--账户序号,1 -->
	<ITEM NAME="#FD1023" TYPE="%3s" FUNCTIONS="" /> <!--凭证种类,0 -->
	<ITEM NAME="#FD1024" TYPE="%16s" FUNCTIONS="" /> <!--凭证号,0 -->
	<ITEM NAME="#FD1025" TYPE="%1s" FUNCTIONS="" /> <!--是否任意支取,0 -->
	<ITEM NAME="#FD1026" TYPE="%1s" FUNCTIONS="" /> <!--是否凭密,0 -->
	<ITEM NAME="#FD1027" TYPE="%6s" FUNCTIONS=""/> <!--查询密码,6 -->
	<ITEM NAME="#FD1028" TYPE="%6s" FUNCTIONS=""/> <!--支取密码,6 -->
	<ITEM NAME="#FD1029" TYPE="%1s" FUNCTIONS=""/> <!--是否凭证件支取,0 -->
	<ITEM NAME="#FD102A" TYPE="%20s" FUNCTIONS=""/> <!--证件号码,0 -->
	<ITEM NAME="#FD102B" TYPE="%1s" FUNCTIONS=""/> <!--是否凭印鉴支取,0 -->
	<ITEM NAME="#FD102C" TYPE="%1s" FUNCTIONS=""/> <!--是否支付密码器,0 -->
	<ITEM NAME="#FD102D" TYPE="%16s" FUNCTIONS=""/> <!--支付密码,0 -->
	<ITEM NAME="#FD102E" TYPE="%8s" FUNCTIONS=""/> <!--出票日期,1 -->
	<ITEM NAME="#FD102F" TYPE="%17.2f" FUNCTIONS=""/> <!--金额,4 -->
	<ITEM NAME="#FD102G" TYPE="%1s" FUNCTIONS=""/> <!--证件类型,0 -->
	<ITEM NAME="#FD102H" TYPE="%60s" FUNCTIONS=""/> <!--户名,0 -->
	<ITEM NAME="#FD102I" TYPE="%17.2f" FUNCTIONS=""/> <!--余额,4 -->
	<ITEM NAME="#FD102J" TYPE="%2s" FUNCTIONS=""/> <!--币种,0 -->
	<ITEM NAME="#FD102K" TYPE="%1s" FUNCTIONS=""/> <!--现转标志,0 -->
	<ITEM NAME="#FD102L" TYPE="%3s" FUNCTIONS=""/> <!--摘要选项,0 -->
	<ITEM NAME="#FD102M" TYPE="%1s" FUNCTIONS=""/> <!--帐户类型,0 -->
	<ITEM NAME="#FD102N" TYPE="%4s" FUNCTIONS=""/> <!--账户序号2,1 -->
	<ITEM NAME="#FD102O" TYPE="%1s" FUNCTIONS=""/> <!--打折标志,0 -->
	<ITEM NAME="#FD102P" TYPE="%17.2f" FUNCTIONS=""/> <!--应付利息,4 -->
	<ITEM NAME="#FD102Q" TYPE="%17.2f" FUNCTIONS=""/> <!--利息税,4 -->
	<ITEM NAME="#FD102R" TYPE="%17.2f" FUNCTIONS=""/> <!--保值利息,4 -->
	<ITEM NAME="#FD102S" TYPE="%17.2f" FUNCTIONS=""/> <!--应付总额,4 -->
	<ITEM NAME="#FD102T" TYPE="%16s" FUNCTIONS=""/> <!--新凭证号,0 -->
	<ITEM NAME="#FD102U" TYPE="%20s" FUNCTIONS=""/> <!--特殊标志,0 -->
	<ITEM NAME="#FD102V" TYPE="%30s" FUNCTIONS=""/> <!--产品名称,0 -->
	<ITEM NAME="#FD102W" TYPE="%24s" FUNCTIONS=""/> <!--账号,0 -->
	<ITEM NAME="#FD102X" TYPE="%1s" FUNCTIONS=""/> <!--教育证明,0 -->
	<ITEM NAME="#FD102Y" TYPE="%20s" FUNCTIONS=""/> <!--摘要,0 -->

  <PAGE NAME="DEFAULT">
    
  <ITEM LINE="6"  COL="10" TYPE="%-10s" FUNCTIONS="T(账/卡 号:)"/>
  
  <ITEM NAME="#ACTNO" INPUT="TEXT" LINE="6"  COL="20" TYPE="%-19s"  FUNCTIONS="T()V(NB)" >
  <ONLOSTFOCUS>
  "{
	#ACTNO24=#ACTNO;
 
  }"
  </ONLOSTFOCUS>
  </ITEM> 
  
  <ITEM LINE="6"  COL="40" TYPE="%-10s" FUNCTIONS="T(账户序号:)"/>  
  <ITEM NAME="#ACTSEQ" INPUT="TEXT" LINE="6"  COL="55" TYPE="%4d" FUNCTIONS="V(NB)" MESSAGE="活期默认为1, 定期序号为0"/>
  <ITEM LINE="9"     COL="40"  TYPE="%-10s" FUNCTIONS="T(照    片:)"/>
  <ITEM LINE="9"     COL="55"  TYPE="%-10s" FUNCTIONS="T(印    件:)"/>
  <!--added by liuyong 2009-9-15 显示图片信息 start-->
  <ITEM NAME="#LYACNO" TYPE="%-19s" FUNCTIONS="" />
  <ITEM LINE="9" COL="50" LINES="160" COLS="120" NAME="#PIC" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#ACTNO;
      call_96641();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="9" COL="65" LINES="220" COLS="160" NAME="#PIC1" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC1" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#ACTNO;
      call_96642();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 end-->
  <ITEM LINE="7"  COL="10"  TYPE="%-10s"  FUNCTIONS="T(扣划类型:)"/>
  <ITEM NAME="#KHLX"  INPUT="SELECT" LINE="7"   COL="20"  TYPE="%1s"  FUNCTIONS="V(NB)">
         <SELECT>
               <OPTION VALUE ="1" TITLE="普通扣划" />
               <OPTION VALUE ="2" TITLE="冻结扣划"/>
         </SELECT>
  </ITEM>
  <ITEM NAME="#LKHLX"   TYPE="%1s"   FUNCTIONS="">
  <ONLOSTFOCUS>
	"{   
			if(#KHLX=='2'){
                       		goitem(#HOLD_SEQ,true);
			}
			if(#KHLX=='1'){
                         		goitem(#K,true);
                         	enable(#HOLD_SEQ,false);
			}
  }"
  </ONLOSTFOCUS>
  
  </ITEM>      
  <ITEM LINE="8"   COL="10" INPUT="LABEL" VISABLE="TRUE"   ENABLE="TRUE"   NAME="#LHOLD_SEQ"  TYPE="%-10s" FUNCTIONS="T(冻结序号:)"/> 
  <ITEM NAME="#HOLD_SEQ" LINE="08"  COL="20"  VISABLE="TRUE" TYPE="%4d"  ENABLE="TRUE"    INPUT="TEXT" FUNCTIONS="V(0000,9999)">
  <ONLOSTFOCUS>"{
          if(msgbox('是否要扣划该笔金额?','提示','yes|no')!=0){break};
	dim @tota as string;
	$FD31=#ACTNO;
	$FD34=#ACTSEQ;	
	$FD125='_DJ_'+#HOLD_SEQ;
	commsend_001();
	$FD16='9702';
	callserver();
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	
	setitems('#CUR_NO',$FD21);     // 币种
	setitems('#CUSTNAME',$FD25);   
        setitems('#CUSTNAME_TMP',$FD25); 
	setitems('#PRDT_CODE',$FD26);   // 产品描述
	setitems('#ACTNO24',$FD31);  
	
	// setitems('#FROZEN_AMT',$FD41); 	
	// 已冻结的金额  	   	  	
	
	setitems('#AC_TYPE',$FD67);   
	setitems('#AVBAL#HOLD_AMT#SPACE96',$FD100);  // 余额 ？
	//showmsg('FD69=['+$FD69+']FD100=['+$FD100+']');
	if('1' != $FD69 and '0' != '68'){
		showmsg('E!--: 输入冻结序号未解冻,请先做解冻交易');
		return(false);
	}
	
	#HOLD_AVBAL=val(substr($FD100,16*3,16), 0.01);
	#HOLD_AMT=val(substr($FD100,16*2,16), 0.01);
//	#LFROZEN_AMT=#AVBAL-#HOLD_AMT;
//	#LUNFROZEN_AMT=val(substr($FD100,0,16), 0.01);
//	setitems('#FROZEN_AMT#SPACE96',$FD100);  // 余额 ？ 
//	setitems('#UNFROZEN_AMT#SPACE96',$FD100);  // 余额 ？ 
 	showblock('ACTINFO',true,true);			
    show(#CUSTNAME,true);
	//showmsg('$FD23=['+$FD23+'], FD68=['+$FD68+']');
	if($FD23 == '101'){  //储蓄户
		$FD16='9952';
	}else{
		$FD16='9955';
	}
	 setitems('#FD1021#FD1022#FD1023#FD1024#FD1025#FD1026#FD1027#FD1028#FD1029#FD102A#FD102B#FD102C#FD102D#FD102E#FD102F#FD102G#FD102H#FD102I#FD102J#FD102K#FD102L#FD102M#FD102N#FD102O#FD102P#FD102Q#FD102R#FD102S#FD102T#FD102U#FD102V#FD102W#FD102X#FD102Y',$FD102);
       $FD102=#ACTNO;
  //showmsg('$FD102==='+$FD102);

 	//commsend_001();
 	@tota=callserver();
 	if($FD12!='0000'){
 		//showmsg('帐号输入错误!');
 		showmsg(geterror());
                return(false);
        }
	setitems('#FD1021#FD1022#FD1023#FD1024#FD1025#FD1026#FD1027#FD1028#FD1029#FD102A#FD102B#FD102C#FD102D#FD102E#FD102F#FD102G#FD102H#FD102I#FD102J#FD102K#FD102L#FD102M#FD102N#FD102O#FD102P#FD102Q#FD102R#FD102S#FD102T#FD102U#FD102V#FD102W#FD102X#FD102Y', $FD102);
	//showmsg('102O=['+#FD102O+']#FD1026=['+#FD1026+'],FD68=['+$FD68+']');

	if($FD23=='101'){  //储蓄不检查密码
		#FD102O='0'; //无折
		#FD1026='N'; //不打印密码
		$FD19='11000      1001';
		$FD73='1';
	}
	#FD102Y='扣划业务';

	if('0' != $FD68){
		show(#LHOLD_SEQ, true);
		show(#HOLD_SEQ, true);
		//showmsg('需剩余冻结金额 -- '+comma(itoa(#HOLD_AVBAL/100, '%17.2f'), 20));
	}
	#HOLD_STS=$FD68;
		//showmsg('#HOLD_AVBAL=['+itoa(#HOLD_AVBAL, '%17.2f')+']#HOLD_AMT=['+itoa(#HOLD_AMT, '%17.2f'));
	enable(#TXAMT1, true);
	if('0' != #HOLD_STS){

		if(#AVBAL-#HOLD_AVBAL &gt; #HOLD_AMT){
			#TXAMT1= #HOLD_AMT;
			//showmsg('可扣划金额大于冻结金额');
		}else{
			#TXAMT1= (#AVBAL-#HOLD_AVBAL);
			showmsg('不足扣划,可扣划金额为'+itoa(#TXAMT1/100, '%13.2f'));
		}
		enable(#TXAMT1, true);
	}

  }"
  </ONLOSTFOCUS>
  </ITEM>   
  <ITEM NAME="#LKHLX2"   TYPE="%1s"   FUNCTIONS="">
      <ONLOSTFOCUS>
		  "{
        goitem(#LKHLX3,true);
      }"
      </ONLOSTFOCUS>
  
  </ITEM>    
  <ITEM   NAME="#K"   TYPE="%-1s"    FUNCTIONS="">
      <ONLOSTFOCUS> 
      "{
                       $FD31=#ACTNO;
                       $FD34=#ACTSEQ;
                       $FD125='_DJ_'+#HOLD_SEQ;
                       commsend_001();
                       $FD16='9702';
                       callserver();
                       if($FD12!='0000'){
                           showmsg(geterror());
                           return(false);
                       }
                      commsend_001();
                      setitems('#ACTNO24',$FD31);
                    //  showmsg(#ACTNO24);
                     // showmsg('$FD23=['+$FD23+'], FD68=['+$FD68+']');
                      if($FD23 == '101'){  //储蓄户
                      $FD16='9952';
                      }else{
                      $FD16='9955';
                      }
			$FD102=#ACTNO;
                      callserver();
                      if($FD12!='0000'){
                             showmsg(geterror());
                             return(false); 
                      }
                      setitems('#FD1021#FD1022#FD1023#FD1024#FD1025#FD1026#FD1027#FD1028#FD1029#FD102A#FD102B#FD102C#FD102D#FD102E#FD102F#FD102G#FD102H#FD102I#FD102J#FD102K#FD102L#FD102M#FD102N#FD102O#FD102P#FD102Q#FD102R#FD102S#FD102T#FD102U#FD102V#FD102W#FD102X#FD102Y', $FD102);
//showmsg('2222222');
//showmsg(#FD1021);
//showmsg(#FD1022);


                      $FD31=#ACTNO;
                      $FD34=#ACTSEQ;
                      commsend_001();
                      $FD16='9303';
                      callserver();
                          if($FD12!='0000'){
                               showmsg(geterror());
                               return(false); 
                          }
                        setitems('#KK1',$FD39);
                        setitems('#CUSTNAME',$FD25);
                        //showmsg($FD39);
                         show(#KK,true);
                         show(#LKK,true);
                         show(#LLKK,true);
                         show(#LLKK1,true);
                         show(#CASHFLAG,true);
                         show(#CUSTNAME,true);
                       //  showmsg(#ACTNO24);
      }"
      </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="8"  COL="40"  VISABLE="FALSE"  INPUT="LABEL" NAME="#LKK" TYPE="%-11s" FUNCTIONS="T(可扣划金额:)"/>
  <ITEM  NAME="#KK1"   TYPE="%17.2f"   FUNCTIONS="J(#KK)"/>
  <ITEM  LINE="8"  COL="52"  NAME="#KK"   VISABLE="FALSE"  INPUT="LABEL"   TYPE="%-21s"  FUNCTIONS="X(#KK1)"/>

  <ITEM LINE="10"   COL="10"  TYPE="%-10s" FUNCTIONS="T(现转标志:!)"/>
  <ITEM NAME="#CASHFLAG" LINE="10"  COL="20" TYPE="%-1s" INPUT="SELECT"  FUNCTIONS="V(NB)">
      <SELECT>
       <OPTION VALUE="1" TITLE="0.现金"/>
       <OPTION VALUE="2" TITLE="1.转帐"/>
     </SELECT>
     <ONLOSTFOCUS>
     "{
         #CASHFLAG1=#CASHFLAG;
         //showmsg(#CASHFLAG);     
      }"
    </ONLOSTFOCUS>
  </ITEM>   
 <ITEM NAME="#SCASHFLAG" TYPE="%-4s" FUNCTIONS="S(#CASHFLAG,#CASHFLAG)"/>
 <ITEM  LINE="11"  COL="10"  VISABLE="FALSE"  NAME="#LLKK"  TYPE="%-10s" INPUT="LABEL"   FUNCTIONS="T(扣划金额:)"/>
 
 <ITEM  LINE="11"  COL="21"  VISABLE="FALSE"  NAME="#LLKK1"  INPUT="TEXT"   TYPE="%17.2f"   FUNCTIONS="J(#LLKK2)">
     <ONLOSTFOCUS>  
     "{
        #TXAMT=#LLKK1;
     }"
     </ONLOSTFOCUS>
 </ITEM>
 <ITEM  NAME="#LLKK2"   TYPE="%-21s"   FUNCTIONS="X(#LLKK1)">
  <ONLOSTFOCUS> 
  "{  
      if((itoa(#LLKK1,'%13.2f')) &gt; (itoa(#KK1,'%13.2f'))  )
      {
       showmsg('金额['+itoa(#LLKK1,'%13.2f')+']大于可扣划金额['+itoa(#KK1,'%13.2f')+']!');
       return(false); 
      }
              // showmsg(#CASHFLAG);
                if(#CASHFLAG1=='2')
                {
                  show(#COMP,false);
                        show(#BUTTON1,true);
                }else{
                  show(#BUTTON1,false);
                  show(#COMP,true);
                }
  }"
  </ONLOSTFOCUS>

 </ITEM>  
  <ITEM LINE="9"  COL="10"  TYPE="%-10s" FUNCTIONS="T(户    名:)"/>
  <ITEM LINE="9"  COL="20" NAME="#CUSTNAME" INPUT="LABEL" DEVICE="KEYBOARD"  TYPE="%-60s" FUNCTIONS="T()"/>

  <ITEM NAME="#LKHLX3"   TYPE="%1s"   FUNCTIONS=""/>  
  <BLOCK NAME="ACTINFO" LINE="8" COL="0" VISABLE="FALSE" >  
  
  
   <ITEM LINE="2"  COL="10" TYPE="%-10s" FUNCTIONS="T(币    种:!)"/>
  <ITEM NAME="#CUR_NO" LINE="2"  COL="20" TYPE="%-2s"  FUNCTIONS="" ENABLE="FALSE">
	<SELECT>
		<OPTION VALUE="01" TITLE="0.人民币"/>
	</SELECT>
  </ITEM>  
  <ITEM NAME="#SCUR_NO" TYPE="%-10s" FUNCTIONS="S(#CUR_NO,#CUR_NO)"/> 
   <ITEM LINE="3"  COL="10" TYPE="%-10s" FUNCTIONS="T(余    额:)"/>   
   <ITEM LINE="3"  COL="45" TYPE="%-12s" FUNCTIONS="T(已冻结金额:)"/>   

  <ITEM LINE="3"  COL="20" NAME="#LAVBAL" TYPE="%-21s" FUNCTIONS="X(#AVBAL)" ENABLE="FALSE"/>
  <ITEM LINE="3"  COL="58" NAME="#LHOLD_AMT" TYPE="%-21s" FUNCTIONS="X(#HOLD_AMT)" ENABLE="FALSE"/>
  <ITEM NAME="#HOLD_AMT" TYPE="%17.2f" FUNCTIONS="J(#LHOLD_AMT)"/>     
  <ITEM NAME="#AVBAL" TYPE="%17.2f" FUNCTIONS="J(#LAVBAL)"/>     
  <ITEM NAME="#HOLD_AVBAL" TYPE="%17.2f" FUNCTIONS=""/>     

   
  <ITEM LINE="8"   COL="10"  TYPE="%-10s" FUNCTIONS="T(现转标志:!)"/> 
  <ITEM LINE="9"   COL="10"  TYPE="%-12s" FUNCTIONS="T(可扣划金额:)"/>
  <ITEM NAME="#CASHFLAG2" LINE="8"  COL="20" TYPE="%-1s" INPUT="SELECT"  FUNCTIONS="V(NB)">
      <SELECT>
                <OPTION VALUE="1" TITLE="0.现金"/>
                <OPTION VALUE="2" TITLE="1.转帐"/>
     </SELECT>

        <ONLOSTFOCUS>
        "{
                      //showmsg(#CASHFLAG1);
                      #CASHFLAG1=#CASHFLAG2;
                      $FD31=#ACTNO;
                      $FD34=#ACTSEQ;
                      $FD35=#HOLD_SEQ;
                      commsend_001();
                      $FD16='9202';
                      callserver();
                          if($FD12!='0000'){
                            showmsg(geterror());
                            return(false);
                           }
          setitems('#DJ_AMT',$FD39);
   //        #KKH_AMT=val(substr($FD39,16*3,16), 0.01);
           //showmsg($FD39);
            #KKH_AMT=#DJ_AMT;
           show(#KKH_AMT,true);
           show(#DJ_AMT,true);
        }"
        </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#SCASHFLAG2"  TYPE="%-4s"   FUNCTIONS="S(#CASHFLAG2,#CASHFLAG2)"/> 

  <ITEM NAME="#LKKH_AMT"  LINE="9"  COL="23"  TYPE="%-21s"  ENABLE="FALSE"  FUNCTIONS="X(#KKH_AMT)"/>
  <ITEM NAME="#KKH_AMT"   TYPE="%17.2f"   FUNCTIONS="J(#LKKH_AMT)"/>
                         
                      
  <ITEM LINE="10"  COL="10"  TYPE="%-10s" FUNCTIONS="T(扣划金额:)"/>

  <!---为了使取款大于五万时输入证件,将金额这一行放在这里---> 
  <ITEM NAME="#TXAMT1" LINE="10"  COL="20" TYPE="%17.2f"  INPUT="TEXT" FUNCTIONS="V(0000000000000001,9999999999999999)J(#LTXAMT)">
      <ONLOSTFOCUS> 
       "{
           #TXAMT=#TXAMT1;
       }"
      </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#LTXAMT" TYPE="%-16s" FUNCTIONS="X(#TXAMT1)">  
  <ONLOSTFOCUS>
  "{
if((itoa(#TXAMT1,'%13.2f')) &gt; (itoa(#KKH_AMT,'%13.2f'))  )
      {
       showmsg('金额['+itoa(#TXAMT1,'%13.2f')+']大于可扣划金额['+itoa(#KKH_AMT,'%13.2f')+']!');
       return(false); 
      }
//        #HOLD_AVBAL=val(substr($FD100,16*3,16), 0.01);
//              #HOLD_AMT=val(substr($FD100,16*2,16), 0.01);
               //showmsg(#CASHFLAG1);
                if(#CASHFLAG1=='2')
                {
                  show(#COMP,false);
                        show(#BUTTON1,true);
                }else{
                  show(#BUTTON1,false);
                  show(#COMP,true);
                }
  }"
  </ONLOSTFOCUS>
  </ITEM> 

  </BLOCK>   
  
      
  <ITEM LINE="21" COL="59"  TYPE="%-6s" NAME="#BUTTON1" FUNCTIONS="T(下一页)" INPUT="BUTTON" >
  <ONCLICK>
        "{
                loadpage('PAGE2');  
              
        }"
        </ONCLICK>
  </ITEM>
<ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT" NAME="#COMP"    VISABLE="TRUE"/>
  </PAGE> 

   <!-- 转帐对方账号 -->
  <IMPORT>TRANSINFO.IMP</IMPORT>
 
  
  
  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM NAME="#HOLD_SEQN_RET" TYPE="%-4s" FUNCTIONS="T()"/>
  
     

</VARIABLE>


<REQUEST>
</REQUEST>


<RESPONSE>
        <PACKAGE DEVICE="SCREEN" DESC="账户扣划成功">
      NOTHING
        </PACKAGE>

        <PRINT>"{
                  print(6, 25,'账户扣划成功 ！');               
                  print(8, 22,'账\[卡\]号:[19 ]',#ACTNO); 
                  if(#KHLX=='2'){              
                  print(9, 22,'交易金额:[21  ]',#LTXAMT);}  
                  if(#KHLX=='1'){
                  print(9, 22,'交易金额:[21  ]',#LLKK2 );}            

        }"
        </PRINT>
</RESPONSE>
<RESPONSE>
        <PACKAGE DEVICE="PRINTER" DESC="请打印普通凭证" LINESPACE="24">
      NOTHING
        </PACKAGE>

        <PRINT>"{
  $KINDNO='00';
  dim @txtime  as string;
  @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);

                print( 5, 20,'机构名称:[30]',$BRNAME);
                print( 5, 2,'代码:3430');
                print( 5, 13,'交易:存款扣划');

                print( 6, 20,'账\[卡\]号:[19 ]',#ACTNO); 
                //print( 7, 20,'户    名:[60]',#CUSTNAME);
                print( 7, 20,'户    名:[60]',$FD25);
                print( 9, 20,'币    种:[10]',#SCUR_NO);
                if(#KHLX=='2'){
                print(10, 20,'扣划类型:冻结扣划'); 
                print(11, 20,'现转标志:[21]',#SCASHFLAG2);
                print(12, 20,'交易金额:[21]',#LTXAMT); 
                if(#CASHFLAG2=='2'){
                print(13, 20,'对方帐号:[20                  ]    对方户名:[60]',#DFNO,#101CNAME);}
                }
                if(#KHLX=='1'){
                print(10, 20,'扣划类型:普通扣划');
                print(11, 20,'现转标志:[21]',#SCASHFLAG);
                print(12, 20,'交易金额:[21]',#LLKK2);
                if(#CASHFLAG=='2'){
                print(13, 20,'对方帐号:[20                  ]    对方户名:[60]',#DFNO,#101CNAME);}
                }
                print_sq();
                print( 24,20,'备注:');
                print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
                print( 24,5,'柜员:[4]',$FD7);
                print( 24,5,'流水号:[6]',$FD4);

        }"
        </PRINT>
</RESPONSE>
<IMPORT>CX_QK_VOC.IMP</IMPORT>
<IMPORT>CXCZ.IMP</IMPORT>
<IMPORT>CX_CK_PZ.IMP</IMPORT>

</TRANSACTION>



