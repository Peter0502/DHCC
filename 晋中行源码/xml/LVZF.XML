<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111111" TITLE="T(小额支付交易明细)"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">

<VARIABLE>

  <ITEM LINE="3"  COL="3" TYPE="%-52s" FUNCTIONS=
    "T(LVZF                          小额支付交易明细)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
    "T(─────────────────────────────────────)"/>
  <ITEM LINE="05"  COL="03" TYPE="%-12s"  FUNCTIONS="T(业务类型  :)"/>
  <ITEM LINE="05"  COL="35" TYPE="%-12s"  FUNCTIONS="T(交易日期  :)"/>
  <ITEM LINE="06"  COL="03" TYPE="%-12s"  FUNCTIONS="T(交易序号:)"/>
  <ITEM LINE="06"  COL="35" TYPE="%-12s"  FUNCTIONS="T(交易状态  :)"/>

  <ITEM LINE="07"  COL="03" TYPE="%-16s"  FUNCTIONS="T(发起行行号:)"/>
  <ITEM LINE="07"  COL="35" TYPE="%-12s" NAME="#LB0"  INPUT="LABEL" VISABLE="FALSE"   FUNCTIONS="T(回执状态  :)"/>
  <ITEM LINE="08"  COL="03" TYPE="%-16s"  FUNCTIONS="T(接收行行号:)"/>
  <ITEM LINE="08"  COL="35" TYPE="%-12s"  FUNCTIONS="T(交易类型  :)"/>

  <ITEM LINE="09" COL="03" TYPE="%-12s" FUNCTIONS="T(汇款金额  :)"/>
  <ITEM LINE="10" COL="03" TYPE="%-12s" FUNCTIONS="T(付款人帐号:)"/>
  <ITEM LINE="11" COL="03" TYPE="%-12s" FUNCTIONS="T(付款人名称:)"/>
  <ITEM LINE="12" COL="03" TYPE="%-12s" FUNCTIONS="T(付款人地址:)"/> 
  <ITEM LINE="13" COL="03" TYPE="%-12s" FUNCTIONS="T(收款人帐号:)"/>
  <ITEM LINE="14" COL="03" TYPE="%-12s" FUNCTIONS="T(收款人名称:)"/>

  <ITEM LINE="15" COL="03" TYPE="%-12s" FUNCTIONS="T(包  序  号:)"/> 
  <ITEM LINE="16" COL="03" TYPE="%-12s" FUNCTIONS="T(包  日  期:)"/> 
  <ITEM LINE="17" COL="03" TYPE="%-12s" FUNCTIONS="T(附      言:)"/>

	


 
  
  <ITEM NAME="#CMTNO" TYPE="%-3s" FUNCTIONS="T($BUFFER,4,3)">
  <ONLOSTFOCUS>
  "{
	
	if(#CMTNO=='002' or #CMTNO=='004' or #CMTNO=='006' or #CMTNO=='008' or #CMTNO=='010')
	{
		show(#LB0,	true);
		show(#RCPSTAT,	true);
	}
	if(#CMTNO=='001' or #CMTNO=='005' or #CMTNO=='008' or #CMTNO=='011')
	{
		show(#BACK,true);
	}
	if(#CMTNO=='001' or #CMTNO=='005' or #CMTNO=='007'  or #CMTNO=='008' or #CMTNO=='011')
	{
		show(#CANCEL,true);
	}
	if(#CMTNO=='003' or #CMTNO=='004' )
	{
		show(#REBACK,true);
	}
	if(#CMTNO=='002' or #CMTNO=='006' )
	{
		show(#STOPPAY,true);
	}
	
	LV_SET_CMTNAME();
   }"
  </ONLOSTFOCUS>
  </ITEM> 
  <ITEM LINE="5"   COL="15" NAME="#CMT_DES"    TYPE="%-20s"   FUNCTIONS="V(NB)"/>
  <ITEM LINE="5"   COL="47" NAME="#TX_DATE" TYPE="%-8s"   FUNCTIONS="V(NB)T($BUFFER,491,8)"/>
  <ITEM LINE="6"   COL="15" NAME="#ORDERNO"   TYPE="%-8s"   FUNCTIONS="V(NB)T($BUFFER,7,8)"/>
  <ITEM NAME="#TMP_TXSTAT"  TYPE="%-1s" FUNCTIONS="T($BUFFER,658,1)">
  <ONLOSTFOCUS>
  "{
	LV_SET_STAT();	
   }"
   </ONLOSTFOCUS>
   </ITEM>
  <ITEM LINE="6"   COL="47" NAME="#TXSTAT"    TYPE="%-20s"   FUNCTIONS="V(NB)"/>
  <ITEM LINE="7"   COL="15" NAME="#PAYBRNO"   TYPE="%-12s"  FUNCTIONS="V(NB)T($BUFFER,20,12)"/>
  <ITEM NAME="#TMP_RCPSTAT"   TYPE="%-2s"     FUNCTIONS="V(NB)T($BUFFER,639,2)">
  <ONLOSTFOCUS>
  "{
	LV_SET_RCPSTAT();
   }"
   </ONLOSTFOCUS>
   </ITEM>
  <ITEM LINE="7"   COL="47" NAME="#RCPSTAT"     INPUT="LABEL" VISABLE="FALSE"  TYPE="%-20s"  FUNCTIONS=""/>
  <ITEM LINE="8"   COL="15" NAME="#CASHBRNO"  TYPE="%-12s"  FUNCTIONS="V(NB)T($BUFFER,32,12)"/>
  <ITEM NAME="#TMP_TXNUM"	TYPE="%-5s" FUNCTIONS="T($BUFFER,15,5)">
  <ONLOSTFOCUS>
  "{
	LV_SET_TXNUM();
   }"
   </ONLOSTFOCUS>
   </ITEM>
  <ITEM LINE="8"   COL="47" NAME="#TXNUM_DES"  TYPE="%-20s"  FUNCTIONS=""/>
   
 
  <ITEM NAME="#HTXAMT1" TYPE="%15s"   FUNCTIONS="T($BUFFER,44,15)">
  <ONLOSTFOCUS>
  "{
	#HTXAMT = atoi(#HTXAMT1)/100;
   }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#HTXAMT" TYPE="%16.2f"   FUNCTIONS="T($BUFFER,44,15)"/>
  <ITEM LINE="9"  COL="15" NAME="#LHTXAMT" TYPE="%-20s"   FUNCTIONS="X(#HTXAMT)"/>

   <ITEM LINE="10"  COL="15" NAME="#PAYACTNO"   TYPE="%-32s"  FUNCTIONS="T($BUFFER,83,32)"/>
  
   
  <ITEM LINE="11"  COL="15" NAME="#PAYNAME"   TYPE="%-60s"  FUNCTIONS="V(NB)T($BUFFER,115,60)"/>
  <ITEM LINE="12"  COL="15" NAME="#PAYADDR"    TYPE="%-60s" FUNCTIONS="T($BUFFER,175,60)"/>

  <ITEM LINE="13"  COL="15" NAME="#CASHACTNO"  TYPE="%-32s" FUNCTIONS="T($BUFFER,267,32)"/>
  <ITEM LINE="14"  COL="15" NAME="#CASHNAME"   TYPE="%-60s" FUNCTIONS="V(NB)T($BUFFER,299,60)"/>

  <ITEM LINE="15"  COL="15" NAME="#PACKID"    TYPE="%-8s" FUNCTIONS="T($BUFFER,536,8)"/>
  <ITEM LINE="16"  COL="15" NAME="#PACKDATE"    TYPE="%-8s" FUNCTIONS="T($BUFFER,528,8)"/>

  <ITEM LINE="17"  COL="15" NAME="#RESUME1"    TYPE="%-60s" FUNCTIONS="T($BUFFER,431,60)"/>
  <ITEM NAME="#PRINTER_FLAG" TYPE="%-1s" FUNCTIONS="T(0)"/>
  
  <ITEM LINE="20"  COL="35" NAME="#CLOSE"  INPUT="BUTTON" TYPE="%-6s" FUNCTIONS="T(确 定)">
  <ONCLICK>"{
  	close();
  }"
  </ONCLICK>
  </ITEM>
    <ITEM LINE="20"  COL="45" NAME="#QUERY"    INPUT="BUTTON" TYPE="%-6s" FUNCTIONS="T(打 印)">
  <ONCLICK>"{
  		#PRINTER_FLAG = '1';	
  		runoutput();		
  }"
  </ONCLICK>
  </ITEM>
  <ITEM LINE="20"  COL="55" NAME="#QUERY"    INPUT="BUTTON" TYPE="%-6s" FUNCTIONS="T(查 询)">
  <ONCLICK>"{
  		open('5324.XML','#OORDERNO='+#ORDERNO+';#O_WT_DAY='+#TX_DATE+';#OR_BR_NO='+#PAYBRNO+';');
  					
  }"
  </ONCLICK>
  </ITEM>
  <ITEM LINE="21"  COL="35" NAME="#CANCEL"  VISABLE="FALSE"   INPUT="BUTTON" TYPE="%-8s" FUNCTIONS="T(撤销)">
  <ONCLICK>"{
	dim @pack_date as number;
	@pack_date = atoi(#PACKDATE);
  	if(#TMP_TXSTAT=='4' or #TMP_TXSTAT=='7' and @pack_date!=0){
  		open('5320.XML','#OORDERNO='+#PACKID+';#O_WT_DAY='+#PACKDATE+';#O_CMTNO='+#CMTNO+';#AC_BR_NO='+#CASHBRNO+';');
  	}else{
  		showmsg('此种状态交易无法申请撤销');
  	}
  					
  }"
  </ONCLICK>
  </ITEM>
   <ITEM LINE="21"  COL="45" NAME="#BACK"    INPUT="BUTTON" VISABLE="FALSE"  TYPE="%-8s" FUNCTIONS="T(退回)">
  <ONCLICK>"{
  	if(#TMP_TXSTAT=='4' or  #TMP_TXSTAT=='6'){
  		open('5318.XML','#OORDERNO='+#ORDERNO+';#O_WT_DAY='+#TX_DATE+';#O_TXNUM='+#TMP_TXNUM+';');
  	}else{
  		showmsg('此种状态交易无法申请退回');
  	}
  					
  }"
  </ONCLICK>
  </ITEM>
   <ITEM LINE="21"  COL="55" NAME="#REBACK"    INPUT="BUTTON"  VISABLE="FALSE" TYPE="%-8s" FUNCTIONS="T(冲正)">
  <ONCLICK>"{
  	if(#TMP_TXSTAT=='4'){
  		open('5321.XML','#OORDERNO='+#PACKID+';#O_WT_DAY='+#PACKDATE+';#O_CMTNO='+#CMTNO+';');
  	}else{
  		showmsg('此种状态交易无法申请退回');
  	}
  					
  }"
  </ONCLICK>
  </ITEM>
   <ITEM LINE="21"  COL="67" NAME="#STOPPAY"    INPUT="BUTTON" VISABLE="FALSE"  TYPE="%-8s" FUNCTIONS="T(止付)">
  <ONCLICK>"{
  	if(#TMP_TXSTAT=='4'){
  		open('5322.XML','#OORDERNO='+#ORDERNO+';#O_WT_DAY='+#TX_DATE+';#O_TXNUM='+#TMP_TXNUM+';');
  	}else{
  		showmsg('此种状态交易无法申请退回');
  	}
  					
  }"
  </ONCLICK>
  </ITEM>
</VARIABLE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" DESC="按任意键退出"  CHECK="#PRINTER_FLAG=1">
NOTHING
</PACKAGE> 
    
    <PRINT>"{
    	
   	print(3,25,'小额支付交易明细');
        print(05,15,'交易日期 :[08]          业务类型 :[20]',#TX_DATE,#CMT_DES);
        print(06,15,'交易序号 :[08]          发起行号 :[12]',#ORDERNO,#PAYBRNO);
        print(07,15,'交易状态 :[08]          回执状态 :[20]',#TXSTAT,#RCPSTAT);
        print(08,15,'接受行号 :[12]      业务类型 :[20]',#CASHBRNO,#TXNUM_DES);
        print(09,15,'交易金额 :[20]',#LHTXAMT);
        print(10,15,'付款帐号 :[60]',#PAYACTNO); 
        print(11,15,'付款名称 :[60]',#PAYNAME);
        print(12,15,'收款帐号 :[60]',#CASHACTNO);
        print(13,15,'收款名称 :[60]',#CASHNAME);
        print(14,15,'组包序号 :[08]          组包日期 :[08]' ,#PACKID,#PACKDATE);
        print(15,15,'交易附言 :[60]',#RESUME1);
        
        
}"
</PRINT>
</RESPONSE>
</TRANSACTION>
