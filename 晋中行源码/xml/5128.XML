<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111100" TITLE="5128  大额系统业务清单"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	initfd();
	commsend_001();
	$FD91=#BR_NO;
	$FD44 = #WT_DATE;
}"
</COMMSEND>
<COMMRECV>"{
	setitems('#QURY1#QURY2#QURY3#BACK1#BACK2#BACK3#STOP1#STOP2#STOP3#PTJJ1#PTJJ2#PTJJ3#DQJJ1#DQJJ2#DQJJ3',$FD123);
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="4"  COL="3" TYPE="%-44s" FUNCTIONS="T(5128                      大额系统业务清单)"/>
  <ITEM LINE="5"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5902)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>


  <ITEM LINE="8"   COL="15" TYPE="%-10s"  FUNCTIONS="T(交易机构:)"/>
  <ITEM LINE="10"   COL="15" TYPE="%-10s"  FUNCTIONS="T(交易日期:)"/>
    <!--输入变量-->
  <ITEM LINE="8" COL="25" NAME="#BR_NO"   TYPE="%-5s"   INPUT="TEXT" FUNCTIONS="T($KINBR)"/> 
   <ITEM LINE="10" COL="25" NAME="#WT_DATE"   TYPE="%-8s"   INPUT="TEXT" FUNCTIONS="D()T($HDATE)"/> 
 
  <ITEM NAME="#BRNO" TYPE="%-5s" FUNCTIONS=""/> 
  
  <ITEM NAME="#HD1" TYPE="%-4s" FUNCTIONS=""/> 
  <ITEM NAME="#WT1" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#TS1" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#GK1" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#CJ1" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#TH1" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#CX1" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#UQ1" TYPE="%-4s" FUNCTIONS=""/>
  
  <ITEM NAME="#HD2" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#WT2" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#TS2" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#GK2" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#CJ2" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#TH2" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#CX2" TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#UQ2" TYPE="%-4s" FUNCTIONS=""/>

    
  
  
   <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/> 
  <ITEM LINE="21" COL="59"  TYPE="%-6s" NAME ="#PRINTER"  FUNCTIONS="T(打  印)" INPUT="BUTTON">  
  <ONCLICK>
  "{
  	dim @tota as string;
  	dim @f as file;
  	dim @line as string;
  	dim @cnt as number;
  	dim @selid as number;
  	
  	dim @len0  as number;
  	dim @len1  as number;
  	dim @len2  as number;
  	dim @len3  as number;
  	dim @len4  as number;
  	dim @len5  as number;
  	dim @len6  as number;
  	dim @len7  as number;
  	dim @len8  as number;
  	dim @len9  as number;
  	dim @len10  as number;
  	dim @len11  as number;
  	dim @len12  as number;
  	dim @len13  as number;
  	dim @len14  as number;
  	dim @len15  as number;
  	dim @len16  as number;
  	
  	
  	
  	dim @val0  as string;
  	dim @val1  as string;
  	dim @val2  as string;
  	dim @val3  as string;
  	dim @val4  as string;
  	dim @val5  as string;
  	dim @val6  as string;
  	dim @val7  as string;
  	dim @val8  as string;
  	dim @val9  as string;
  	dim @val10  as string;
  	dim @val11 as string;
  	dim @val12  as string;
  	dim @val13  as string;
  	dim @val14  as string;
  	dim @val15  as string;
  	dim @val16  as string;
  	
    	initfd();
    	commsend_001();
	$FD44=#WT_DATE;
	$FD91=#BR_NO;
	@tota=callserver();
	if($FD12!='0000')
    	 {
		showmsg(geterror());
		return(false);
    	 }
       	 	 
    	if(autolist(@tota))
        {
	    @cnt=list_getrowcnt();
	}	
	@f=openfile('../tmp/大额系统业务清单['+$KINBR++$TLRNO+']','w');
	
	@selid=list_getselid();
	
	@avl0	=	delspace(list_gettext(@selid,0));
	@avl1	=	delspace(list_gettext(@selid,1));
	@avl2	=	delspace(list_gettext(@selid,2));
	@avl3	=	delspace(list_gettext(@selid,3));
	@avl4	=	delspace(list_gettext(@selid,4));
	@avl5	=	delspace(list_gettext(@selid,5));
	@avl6	=	delspace(list_gettext(@selid,6));
	@avl7	=	delspace(list_gettext(@selid,7));
	@avl8	=	delspace(list_gettext(@selid,8));
	@avl9	=	delspace(list_gettext(@selid,9));
	@avl10	=	delspace(list_gettext(@selid,10));
	@avl11	=	delspace(list_gettext(@selid,11));
	@avl12	=	delspace(list_gettext(@selid,12));
	@avl13	=	delspace(list_gettext(@selid,13));
	@avl14	=	delspace(list_gettext(@selid,14));
	@avl15	=	delspace(list_gettext(@selid,15));
	@avl16	=	delspace(list_gettext(@selid,16));
	
	
	writeline(@f,'                                  大额支付来往交易清单');
	writeline(@f,'                                                                   说明:[查复] 指的是对查询未被回复的笔数');
	writeline(@f,'┏━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┓');
	writeline(@f,'┃        ┃                   大 额 往 帐                ┃             大  额  来  帐                   ┃');
	writeline(@f,'┃机构编号┣━━┳━━┳━━┳━━┳━━┳━━┳━━┳━━╋━━┳━━┳━━┳━━┳━━┳━━┳━━┳━━┫');
	writeline(@f,'┃        ┃汇兑┃委托┃托收┃国库┃拆借┃退汇┃查询┃查复┃汇兑┃委托┃托收┃国库┃拆借┃退汇┃查询┃查复┃');
	writeline(@f,'┣━━━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━┫');

				
	
        @len0=len(@val0);
        @len1=len(@val1);
        @len2=len(@val2);
        @len3=len(@val3);
        @len4=len(@val4);
        @len5=len(@val5);
        @len6=len(@val6);
        @len7=len(@val7);
        @len8=len(@val8);
        @len9=len(@val9);
        @len10=len(@val10);
        @len11=len(@val11);
        @len12=len(@val12);
        @len13=len(@val13);
        @len14=len(@val14);
        @len15=len(@val15);
        @len16=len(@val16);
        
        #BRNO 	= 	@val0+space(5-@len0);
        #HD1	=	@val1+space(4-@len1);
        #WT1	=	@val2+space(4-@len2);
       	#TS1	=	@val3+space(4-@len3);
       	#GK1	=	@val4+space(4-@len4);
       	#CJ1	=	@val5+space(4-@len5);
       	#TH1	=	@val6+space(4-@len6);
       	#CX1	=	@val7+space(4-@len7);
       	#UQ1	=	@val8+space(4-@len8);
       	#HD2	=	@val9+space(4-@len9);
       	#WT2	=	@val10+space(4-@len10);
       	#TS2	=	@val11+space(4-@len11);
       	#GK2	=	@val12+space(4-@len12);
       	#CJ2	=	@val13+space(4-@len13);
       	#TH2	=	@val14+space(4-@len14);
       	#CX2	=	@val15+space(4-@len15);
       	#UQ2	=	@val16+space(4-@len16);
       
       
        while(true)
	{   
	    
	 writeline(@f,'┃'+#BRNO+'┃'+#HD1+'┃'+#WT1+'┃'+#TS1+'┃'+#GK1+'┃'+#CJ1+'┃'+#TH1+'┃'+#CX1+'┃'+#UQ1+'┃'+#HD2+'┃'+#WT2+'┃'+#TS2+'┃'+#GK2+'┃'+#CJ2+'┃'+#TH2+'┃'+#CX2+'┃'+#UQ2+'┃');
	    
	 list_rmitem(@selid);	        	        	        
	 @selid=list_getselid();
	 @cnt=list_getrowcnt();
	 if(@cnt==0)
	 {
	    
	    break;
	 }
	writeline(@f,'┣━━━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━╋━━┫');	
	               
        
	@avl0	=	delspace(list_gettext(@selid,0));
	@avl1	=	delspace(list_gettext(@selid,1));
	@avl2	=	delspace(list_gettext(@selid,2));
	@avl3	=	delspace(list_gettext(@selid,3));
	@avl4	=	delspace(list_gettext(@selid,4));
	@avl5	=	delspace(list_gettext(@selid,5));
	@avl6	=	delspace(list_gettext(@selid,6));
	@avl7	=	delspace(list_gettext(@selid,7));
	@avl8	=	delspace(list_gettext(@selid,8));
	@avl9	=	delspace(list_gettext(@selid,9));
	@avl10	=	delspace(list_gettext(@selid,10));
	@avl11	=	delspace(list_gettext(@selid,11));
	@avl12	=	delspace(list_gettext(@selid,12));
	@avl13	=	delspace(list_gettext(@selid,13));
	@avl14	=	delspace(list_gettext(@selid,14));
	@avl15	=	delspace(list_gettext(@selid,15));
	@avl16	=	delspace(list_gettext(@selid,16));
	
        @len0=len(@val0);
        @len1=len(@val1);
        @len2=len(@val2);
        @len3=len(@val3);
        @len4=len(@val4);
        @len5=len(@val5);
        @len6=len(@val6);
        @len7=len(@val7);
        @len8=len(@val8);
        @len9=len(@val9);
        @len10=len(@val10);
        @len11=len(@val11);
        @len12=len(@val12);
        @len13=len(@val13);
        @len14=len(@val14);
        @len15=len(@val15);
        @len16=len(@val16);
            
        #BRNO 	= 	@val0+space(5-@len0);
        #HD1	=	@val1+space(4-@len1);
        #WT1	=	@val2+space(4-@len2);
       	#TS1	=	@val3+space(4-@len3);
       	#GK1	=	@val4+space(4-@len4);
       	#CJ1	=	@val5+space(4-@len5);
       	#TH1	=	@val6+space(4-@len6);
       	#CX1	=	@val7+space(4-@len7);
       	#UQ1	=	@val8+space(4-@len8);
       	#HD2	=	@val9+space(4-@len9);
       	#WT2	=	@val10+space(4-@len10);
       	#TS2	=	@val11+space(4-@len11);
       	#GK2	=	@val12+space(4-@len12);
       	#CJ2	=	@val13+space(4-@len13);
       	#TH2	=	@val14+space(4-@len14);
       	#CX2	=	@val15+space(4-@len15);
       	#UQ2	=	@val16+space(4-@len16);
	}
	writeline(@f,'┗━━━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┻━━┛');
	
 	closefile(@f);
 	call('fview ../tmp/大额系统业务清单['+$KINBR++$TLRNO+']');
	
   }"
 </ONCLICK>
  </ITEM> 
  </VARIABLE>
<REQUEST>
</REQUEST>
<OUTPUT>
</OUTPUT>
</TRANSACTION>
