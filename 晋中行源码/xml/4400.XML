<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11000000" TITLE="4400 贷款审批打印"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{ 
	commsend_001();
	$FD16 = '4400';
	$MSGTYPE='03001';
	$FD30=#PACT_NO;
	
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(4400                            贷款审批打印)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>

  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4400)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM NAME="#F125" TYPE="%-300s"/>
  <ITEM LINE="12"   COL="15"  TYPE="%-12s" FUNCTIONS="T(审批借据号:)"/>
  
  <!--add by gong 20110904 输入审批借据号，借据号来源可以根据9208交易查询-->
  <ITEM NAME="#PACT_NO" LINE="12"  COL="25" TYPE="%-20s" INPUT="TEXT" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
	dim @baktxno as string;
	initfd();
	@baktxno=$TXNO;
	$TXNO='9939';
	$FD63=#PACT_NO;
	commsend_001();
	callserver();
	$TXNO=@baktxno;
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	#F125 = $FD125;
	//showmsg('该笔借据的信息为:'+#F125+'。');
	//showmsg('开户前借据打印');
	//showmsg('贷款期限【'+delspace(substr(#F125,0,3))+'】'+'贷款金额【'+delspace(substr(#F125,3,16))+'】'+'贷款利率【'+substr(#F125,16,6)+'】');
  }"
  </ONLOSTFOCUS>
	</ITEM>

  
  <ITEM NAME="#CONFIRM"  LINE="21" COL="59"  TYPE="%-8s" FUNCTIONS="T(确定打印)" INPUT="SUBMIT"/>
  
    
  
  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
    <PACKAGE DEVICE="SCREEN" DESC="显示内容">
    JKJJ|@name|@rate|@amt1|@amt2|@amt3|@beg_date|@mtr_date|@prdt_no|@title|@cif_no|@ht_no|@num|@dzy_name|@dzy_amt|@db_cif|
    </PACKAGE>
    <PRINT>"{
        print( 4.5,40,'借款日期：[16]',@beg_date);
        print( 5, 20,'借款单位名称：[60] 月利率：[9]',@name,@rate);
        print( 6, 20,'借款金额：[64]      ',@amt1);
        print( 7, 20,'还款日期：[16]      产品种类：[30]   产品用途：[30]',@mtr_date,@prdt_no,@title);
        print( 8, 20,'客户号：[9 ]    合同号：[16]  合同金额：[16]  合同笔数：[4]',@cif_no,@ht_no,@amt3,@num);
        print( 10,21,'抵质押名称：[32]他项权利金额：[16]   担保户单位客户号[16]',@dzy_name,@dzy_amt,@db_cif);
    }"
    </PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER"  DESC="借款借据打印开始"> 
 JKJJ|@name|@rate|@amt1|@amt2|@amt3|@beg_date|@mtr_date|@prdt_no|@title|@cif_no|@ht_no|@num|@dzy_name|@dzy_amt|@db_cif|
</PACKAGE>
<INIT>
"{
}"
</INIT>
<PRINT>
"{
        print( 2, 52,'[16]',@beg_date);
        print( 4, 34,'[60]              [9]‰',@name,@rate);
        print( 5, 34,'[64]                         ',@amt1);
        print( 6, 92,'[40]',@amt2);
        print( 7, 34,'[16]                   [30] [30]',@mtr_date,@prdt_no,@title);
        print( 9, 25,'[9 ]            [16]                     [16]         [4]',@cif_no,@ht_no,@amt3,@num);
        print( 10,21,'[28][16]        [30]',@dzy_name,@dzy_amt,@db_cif);


}"
</PRINT>
</RESPONSE>

</TRANSACTION>
