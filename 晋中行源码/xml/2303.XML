<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111001" TITLE="2303 个人客户信息维护"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	//与神码通讯开始
	initfd();
	commsend_001();
	$FD16='7015';
	$FD28=#KHH;
	$FD25=#KHZC;
	$FD70=#XB;
	$FD40=itoa(#GRYSR*100);
	$FD46=#GLSR;
	callagn();
	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}
//	showmsg('与神码通讯成功结束');
	initfd();
	//与神码通讯结束
	commsend_001();
	$FD28=#KHH;
	$FD67=#XB;
	$FD27=#KHZC;
	$FD44=#GLSR;
	$FD45=#NLSR;
	$FD81=#CSD;
	$FD23=#GJDM;
	$FD24=#JZG;
	$FD21=#MZDM;
	$FD70=#ZJXY;
	$FD22=#YYDM;
	$FD69=#JKZK;
	$FD71=#ZGXL;
	$FD72=#XG;
	$FD68=#HYZK;
	$FD89=#ZW;
	$FD29=#JHRQ;
	$FD90=#ZC;
	$FD50=#FDJTCYSM;
	$FD65=#ZYBH;
	$FD40=itoa(#GRYSR,'%13.2f');
	$FD41=itoa(#JTYSR,'%13.2f');
 
}"
</COMMSEND>
<COMMRECV>"{
		commrecv_001();
if($FD12!='0000'){
			return(false);}
    showmsg('交易成功!')}"
</COMMRECV>
<FIRSTWORK>
"{
   #PIC='';
}"
</FIRSTWORK>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(2303                        个人客户信息维护)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=1304)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  
  <!--输入变量-->
  <ITEM LINE="6" COL="12" TYPE="%-10s" FUNCTIONS="T(客 户 号:)"/>
  <ITEM NAME="#KHH" INPUT="TEXT" LINE="6" COL="22" TYPE="%8s" FUNCTIONS="">
  <ONLOSTFOCUS>
 "{	initfd();
 		dim @tota as string;	
    commsend_001();
 		$FD16='9897';
		$FD28=#KHH;
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
	#XB=delspace($FD67);
	#KHZC=delspace($FD27);
	#GLSR=delspace($FD44);
	#NLSR=delspace($FD45);
	#CSD=delspace($FD81);
	#GJDM=delspace($FD23);
	#JZG=delspace($FD24);
	#MZDM=delspace($FD21);
	#ZJXY=delspace($FD70);
	#YYDM=delspace($FD22);
	#JKZK=delspace($FD69);
	#ZGXL=delspace($FD71);
	#HYZK=delspace($FD68);
	#ZW=delspace($FD89);
	#JHRQ=delspace($FD29);
	#ZC=delspace($FD90);
	#FDJTCYSM=delspace($FD50);
	#ZYBH=delspace($FD65);
	#GRYSR=delspace($FD40);
	#JTYSR=delspace($FD41);
		show(#XB,true);
		show(#KHZC,true);
		show(#GLSR,true);
		show(#NLSR,true);
		show(#CSD,true);
		show(#GJDM,true);
		show(#JZG,true);
		show(#MZDM,true);
		show(#ZJXY,true);
		show(#YYDM,true);
		show(#JKZK,true);
		show(#ZGXL,true);
		show(#HYZK,true);
		show(#ZW,true);
		show(#JHRQ,true);
		show(#ZC,true);
		show(#FDJTCYSM,true);
		show(#ZYBH,true);
		show(#GRYSR,true);
		show(#JTYSR,true);
		setitems('#GRYSR',$FD40);
	  setitems('#JTYSR',$FD41);
	  showall();
 }"
 </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 start-->
  <ITEM NAME="#SETPIC" TYPE="%-10" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      dim @txno_bak as string;
      dim @totl as string; 
      @txno_bak = $TXNO;
      $TXNO = '9666';
      $FD28 = #KHH;
      $FD72 = '1';//1代表个人照片，2代表印件
      commsend_001();
      @totl = callserver();
      if($FD12 != '0000')
      {
         
      }
      $TXNO = @txno_bak;
      setpicture(#PIC,0,1);//第三个参数0代表图片不可更改，1为可更改 
  }"
  </ONLOSTFOCUS>
  </ITEM>
  
  <!--added by liuyong 2009-9-1 显示图片信息 end-->
  <ITEM LINE="7"  COL="3" TYPE="%-74s" FUNCTIONS=
   "T(--------------------------------------------------------------------------)"/>
  <ITEM LINE="6"  COL="39" TYPE="%-9s" FUNCTIONS="T(照    片:)"/>
  <ITEM LINE="9"  COL="12" TYPE="%-9s" FUNCTIONS="T(性    别!)"/>
  <ITEM LINE="9"  COL="39" TYPE="%-9s" FUNCTIONS="T(客户尊称:)"/>
  <ITEM LINE="10" COL="12" TYPE="%-9s" FUNCTIONS="T(公历生日:)"/>
  <ITEM LINE="10" COL="39" TYPE="%-9s" FUNCTIONS="T(农历生日:)"/>
  <ITEM LINE="11" COL="12" TYPE="%-9s" FUNCTIONS="T(出 生 地:)"/>
  <ITEM LINE="12" COL="12" TYPE="%-9s" FUNCTIONS="T(国籍代码!)"/>
  <ITEM LINE="12" COL="39" TYPE="%-9s" FUNCTIONS="T(居 住 国!)"/>
  <ITEM LINE="13" COL="12" TYPE="%-9s" FUNCTIONS="T(民族代码!)"/>
  <ITEM LINE="13" COL="39" TYPE="%-9s" FUNCTIONS="T(宗教信仰!)"/>
  <ITEM LINE="14" COL="12" TYPE="%-9s" FUNCTIONS="T(语言代码!)"/>
  <ITEM LINE="14" COL="39" TYPE="%-9s" FUNCTIONS="T(健康状况!)"/>
  <ITEM LINE="15" COL="12" TYPE="%-9s" FUNCTIONS="T(最高学历!)"/>
  <ITEM LINE="15" COL="39" TYPE="%-9s" FUNCTIONS="T(婚姻状况!)"/>
  <ITEM LINE="16" COL="12" TYPE="%-9s" FUNCTIONS="T(职    务!)"/>
  <ITEM LINE="16" COL="39" TYPE="%-9s" FUNCTIONS="T(结婚日期:)"/>
  <ITEM LINE="17" COL="12" TYPE="%-9s" FUNCTIONS="T(职    称!)"/>
  <ITEM LINE="17" COL="39" TYPE="%-18s" FUNCTIONS="T(负担家庭成员数目:)"/>
  <ITEM LINE="18" COL="12" TYPE="%-9s" FUNCTIONS="T(职员编号:)"/>
  <ITEM LINE="19" COL="12" TYPE="%-11s" FUNCTIONS="T(个人月收入:)"/>
  <ITEM LINE="19" COL="45" TYPE="%-11s" FUNCTIONS="T(家庭月收入:)"/>
  <!--added by liuyong 2009-9-1 上传图片信息 start-->
  <ITEM LINE="6" COL="48" TYPE="%-10s" LINES="160" COLS="120" FUNCTIONS="A(1)" NAME="#PIC" VISABLE="FALSE"/>
  <ITEM NAME="#SETPICCONTENT" FUNCTIONS="" TYPE="%-10s">
  <ONLOSTFOCUS>
  "{
        setvfile(true,true);
        addvfile(#PIC);
  }"
  </ONLOSTFOCUS>
  </ITEM>

<ITEM NAME="#TRANPIC" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
        if(#PIC !='')
        {
          $FD70='1';
        }
        else
        {
          $FD70='0';
        }
        dim @txnobak as string;
        @txnobak = $TXNO;
        $TXNO = '9667';
        $FD28 = #KHH;
        $FD62 = '';
        $FD72 = '1';
        commsend_001();
        callserver();
        if($FD12 !='0000')
        {
            showmsg(geterror());
            return(false);
        }
        $TXNO = @txnobak;
        setvfile(false,false);
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-1 上传图片信息 end-->
  <ITEM NAME="#XB" INPUT="SELECT" LINE="9" COL="21" TYPE="%-1s" FUNCTIONS="T(F)">
   <SELECT>
		<OPTION VALUE="F" TITLE="女"/>
		<OPTION VALUE="M" TITLE="男"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#S_XB" TYPE="%-2s" FUNCTIONS="S(#XB,#XB)"/>
  <ITEM NAME="#KHZC" INPUT="TEXT" LINE="9" COL="48" TYPE="%-20s" FUNCTIONS=""/>
  <ITEM NAME="#GLSR" INPUT="TEXT" LINE="10" COL="21" TYPE="%-8s" FUNCTIONS=""/>
  <ITEM NAME="#NLSR" INPUT="TEXT" LINE="10" COL="48" TYPE="%-8s" FUNCTIONS=""/>
  <ITEM NAME="#CSD" INPUT="TEXT" LINE="11" COL="21" TYPE="%-50s" FUNCTIONS=""/>
  <ITEM NAME="#GJDM" INPUT="SELECT" LINE="12" COL="21" TYPE="%-2s" FUNCTIONS="T(02)">
  <SELECT>
		<OPTION VALUE="01" TITLE="中国"/>
		<OPTION VALUE="02" TITLE="美国"/>
		<OPTION VALUE="03" TITLE="俄罗斯"/>
		<OPTION VALUE="04" TITLE="法国"/>
		<OPTION VALUE="05" TITLE="日本"/>
		<OPTION VALUE="06" TITLE="英国"/>
		<OPTION VALUE="07" TITLE="韩国"/>
		<OPTION VALUE="11" TITLE="德国"/>
		<OPTION VALUE="99" TITLE="其他"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#S_GJDM" TYPE="%-8s" FUNCTIONS="S(#GJDM,#GJDM)"/>
  <ITEM NAME="#JZG" INPUT="SELECT" LINE="12" COL="48" TYPE="%-1s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="01" TITLE="中国"/>
		<OPTION VALUE="02" TITLE="美国"/>
		<OPTION VALUE="03" TITLE="俄罗斯"/>
		<OPTION VALUE="04" TITLE="法国"/>
		<OPTION VALUE="05" TITLE="日本"/>
		<OPTION VALUE="06" TITLE="英国"/>
		<OPTION VALUE="07" TITLE="韩国"/>
		<OPTION VALUE="11" TITLE="德国"/>
		<OPTION VALUE="99" TITLE="其他"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#S_JZG" TYPE="%-8s" FUNCTIONS="S(#JZG,#JZG)"/>
  <ITEM NAME="#MZDM" INPUT="SELECT" LINE="13" COL="21" TYPE="%-2s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="01" TITLE="汉族"/>
		<OPTION VALUE="02" TITLE="满族"/>
		<OPTION VALUE="03" TITLE="回族"/>
		<OPTION VALUE="04" TITLE="维吾尔族"/>
		</SELECT>
  </ITEM>
  <ITEM NAME="#S_MZDM" TYPE="%-10s" FUNCTIONS="S(#MZDM,#MZDM)"/>
  <ITEM NAME="#ZJXY" INPUT="SELECT" LINE="13" COL="48" TYPE="%-1s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="0" TITLE="无"/>
		<OPTION VALUE="1" TITLE="佛教"/>
		<OPTION VALUE="2" TITLE="道教"/>
		<OPTION VALUE="3" TITLE="伊斯兰教"/>
		<OPTION VALUE="4" TITLE="基督教"/>
		<OPTION VALUE="5" TITLE="其他"/>
		</SELECT>
  </ITEM>
  <ITEM NAME="#S_ZJXY" TYPE="%-10s" FUNCTIONS="S(#ZJXY,#ZJXY)"/>
   <ITEM NAME="#YYDM" INPUT="SELECT" LINE="14" COL="21" TYPE="%-2s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="1" TITLE="汉语"/>
		<OPTION VALUE="2" TITLE="英语"/>
		<OPTION VALUE="3" TITLE="俄语"/>
		<OPTION VALUE="4" TITLE="法语"/>
		<OPTION VALUE="5" TITLE="德语"/>
		</SELECT>
  </ITEM>
  <ITEM NAME="#S_YYDM" TYPE="%-10s" FUNCTIONS="S(#YYDM,#YYDM)"/>
  <ITEM NAME="#JKZK" INPUT="SELECT" LINE="14" COL="48" TYPE="%-1s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="1" TITLE="健康"/>
		<OPTION VALUE="2" TITLE="良好"/>
		<OPTION VALUE="3" TITLE="较健康"/>
		<OPTION VALUE="4" TITLE="亚健康状态"/>
		<OPTION VALUE="5" TITLE="体弱多病"/>
		<OPTION VALUE="6" TITLE="卧床不起"/>
		<OPTION VALUE="7" TITLE="生命垂危"/>
		</SELECT>
  </ITEM>
  <ITEM NAME="#S_JKZK" TYPE="%-10s" FUNCTIONS="S(#JKZK,#JKZK)"/>
  <ITEM NAME="#ZGXL" INPUT="SELECT" LINE="15" COL="21" TYPE="%-1s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="1" TITLE="小学"/>
		<OPTION VALUE="2" TITLE="初中"/>
		<OPTION VALUE="3" TITLE="高中"/>
		<OPTION VALUE="4" TITLE="中专"/>
		<OPTION VALUE="5" TITLE="专科"/>
		<OPTION VALUE="6" TITLE="本科"/>
		<OPTION VALUE="7" TITLE="研究生"/>
		<OPTION VALUE="8" TITLE="博士"/>
		<OPTION VALUE="9" TITLE="博士后"/>
		</SELECT>
  </ITEM>
  <ITEM NAME="#S_ZGXL" TYPE="%-10s" FUNCTIONS="S(#ZGXL,#ZGXL)"/>
  <ITEM NAME="#HYZK" INPUT="SELECT" LINE="15" COL="48" TYPE="%-1s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="1" TITLE="未婚"/>
		<OPTION VALUE="2" TITLE="已婚"/>
		<OPTION VALUE="3" TITLE="离婚"/>
		<OPTION VALUE="4" TITLE="分居"/>
		<OPTION VALUE="5" TITLE="丧偶"/>
		</SELECT>
  </ITEM>
  <ITEM NAME="#S_HYZK" TYPE="%-8s" FUNCTIONS="S(#HYZK,#HYZK)"/>
  <ITEM NAME="#ZW" INPUT="SELECT" LINE="16" COL="21" TYPE="%-3s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="1" TITLE="职工"/>
		<OPTION VALUE="2" TITLE="组长"/>
		<OPTION VALUE="3" TITLE="副经理"/>
		<OPTION VALUE="4" TITLE="经理"/>
		<OPTION VALUE="5" TITLE="副总经理"/>
		<OPTION VALUE="6" TITLE="总经理"/>
		<OPTION VALUE="7" TITLE="董事长"/>
		</SELECT>
  </ITEM>
  <ITEM NAME="#S_ZW" TYPE="%-10s" FUNCTIONS="S(#ZW,#ZW)"/>
  <ITEM NAME="#JHRQ" LINE="16" COL="48" TYPE="%-8s" FUNCTIONS=""/>
  <ITEM NAME="#ZC" INPUT="SELECT" LINE="17" COL="21" TYPE="%-3s" FUNCTIONS="">
  <SELECT>
		<OPTION VALUE="1" TITLE="初级"/>
		<OPTION VALUE="2" TITLE="中级"/>
		<OPTION VALUE="3" TITLE="高级"/>
		<OPTION VALUE="4" TITLE="其他"/>
		</SELECT>
  </ITEM>
  <ITEM NAME="#S_ZC" TYPE="%-8s" FUNCTIONS="S(#ZC,#ZC)"/>
  <ITEM NAME="#FDJTCYSM" INPUT="TEXT" LINE="17" COL="53" TYPE="%3s" FUNCTIONS=""/>
  <ITEM NAME="#ZYBH" INPUT="TEXT" LINE="18" COL="21" TYPE="%-7s" FUNCTIONS=""/>
  
<!-- <ITEM NAME="#GRYSR" TYPE="%17.2f" FUNCTIONS="J(#LGRYSR)"/>
  <ITEM NAME="#LGRYSR" INPUT="TEXT" LINE="19" COL="23" TYPE="%-16s" FUNCTIONS="X(#GRYSR)"/> -->
<ITEM NAME="#GRYSR" INPUT="TEXT" LINE="19" COL="23" TYPE="%17.2f" FUNCTIONS=""/>

<!--  <ITEM NAME="#JTYSR" TYPE="%17.2f" FUNCTIONS="J(#LJTYSR)"/>
  <ITEM NAME="#LJTYSR" INPUT="TEXT" LINE="19" COL="52" TYPE="%-16s" FUNCTIONS="X(#JTYSR)"/> -->
 <ITEM NAME="#JTYSR" INPUT="TEXT" LINE="19" COL="56" TYPE="%17.2f" FUNCTIONS=""/>

  <ITEM NAME="#XG" TYPE="%1s" FUNCTIONS="T(1)"/>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE>
NOTHING
</PACKAGE>
	<PRINT>
	"{
		print(8,20,'个 人 信 息 维 护 成 功!');
	}"
	</PRINT>
</RESPONSE>

<RESPONSE>
 <PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印业务专用凭证">
  NOTHING
 </PACKAGE>
  <PRINT> 
  "{
        $KINDNO='00';
        dim @txtime  as string;
        @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);
  	print( 5, 2,'代码:2303');
  	print( 5, 13,'交易:个人客户信息维护');
	print( 8,20,'客 户 号:[8       ]',#KHH);
	print( 9,20,'客户尊称:[20                  ]            性    别:[2 ]',#KHZC,#S_XB);
	print(10,20,'公历生日:[8       ]                        农历生日:[8       ]',#GLSR,#NLSR);
	print(11,20,'出 生 地:[50                                                ]',#CSD);
	print(12,20,'国    籍:[8       ]                        居 住 国:[8      ]',#S_GJDM,#S_JZG);
	print(13,20,'民    族:[10        ]                      宗教信仰:[10        ]',#S_MZDM,#S_ZJXY);
	print(14,20,'语    言:[10        ]',#S_YYDM);
	print(15,20,'健康状况:[10        ]                      婚姻状况:[8       ]',#S_JKZK,#S_HYZK);
	print(16,20,'最高学历:[10        ]',#S_ZGXL);
	print(17,20,'职    务:[10        ]                      职    称:[8       ]',#S_ZW,#S_ZC);
	print(18,20,'负担家庭成员数目:[3  ]',#FDJTCYSM);
	print(19,20,'个人月收入:[18              ]              家 庭  月  收 入:[18              ]',itoa(#GRYSR,'%13.2f'),itoa(#JTYSR,'%13.2f'));
	      print( 24,20,'备注:')
        print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
        print( 24,5,'柜员:[4]',$FD7);
        print( 24,5,'流水号:[6]',$FD4); 
}" 
  </PRINT>
</RESPONSE>
</TRANSACTION>
