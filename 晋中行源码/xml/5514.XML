<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="01000000000000000000000000000000" TITLE="5514 财政集中支付记账"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>
"{
	dim @tota as string;
	dim @traceno as string; 
	initfd();
	commsend_001();
	$FD21=#CUR_NO;    //货币标志
	$FD16='6820';
	$FD40=itoa(#TX_AMT*100,'%16.0f');
	$FD69 = #paybilltype;
	$FD33 = #printid;
	$FD59 = #CZCODE;
	$FD60 = #BANKNO;
	$FD71 = #txtype;  
	$FD82 = #BRF;
	#OPCD='10';
	#LW_IND='1';
	if(#txtype=='1')
	{
		$FD49='0001';	
		$FD99='2';
		$FD98='1';
		$FD66 = '1';
		$FD89=#VOCTYPE1;
		$FD58=#VOCNUM;
		if( #CTIND == '1' )  //现转标志 1-现金 2-转账
		{
			$FD70='1';
			$FD67='1'; 
		}
		else if( #CTIND == '2' )
		{
			$FD70='2';
			$FD67='2';
		}
		$FD68='1';
		$FD22='01';
		#AC_NO=substr(#paybankaccount,0,24)+space(24-len(#paybankaccount))+'';
		#TXAMT15=itoa(#TX_AMT*100,'%016.0f');
		#AC_NO1=substr(#CASH_AC_NO,0,24)+space(24-len(#CASH_AC_NO))+'';
		$FD21 = #CUR_NO;
		$FD26=#CASH_NAME;
		$FD88='零余额户支付';
		$FD30=delspace(#paybankaccount)+space(24-len(delspace(#paybankaccount)));
		$FD31=delspace(#CASH_AC_NO)+space(24-len(delspace(#CASH_AC_NO)));
		#FD101_1=#AC_NO1;
		#FD101_2=#AC_SEQN;
		#FD101_4='';
		#FD101_5='';
		#FD101_6='';
		#FD101_7='';
		#FD101_8='';
		#FD101_9='';
		#FD101_10='01';
		#FD101_11='2';
		#FD101_12='';
		#FD101_13='';
		#FD101_14='';
		#FD101_15='';
		#FD101_16='';
		$FD101 = getitems('#FD101_1#FD101_2#TXAMT15#FD101_4#FD101_5#FD101_6#FD101_7#FD101_8#FD101_9#FD101_10#FD101_11#FD101_12#FD101_13#FD101_14#FD101_15#FD101_16');
	}
	else if(#txtype=='2')
	{
		$FD49='0002';
		$FD67='2'; //现转标志	
		$FD68='1';
		$FD99='2';
		$FD98='6';
		$FD22='01'; 
		#OPERLEVEL='1';
		$FD30=delspace(#paybankaccount)+space(24-len(delspace(#paybankaccount)));
		$FD31=delspace(#CASH_AC_NO)+space(24-len(delspace(#CASH_AC_NO)));
		$FD44 = #WT_DAY;
		$FD45 = #O_WT_DAY;
		$FD46 = #NOTPAY_DATE;
		$FD39 = itoa( #TX_AMT*100,'%016.0f');
		$FD21 = #CUR_NO;
		//$FD69 = #TX_TYPE;
		$FD89 = #NOTE_TYPE;
		$FD66 = '1';
		$FD58 = #NOTE_NO;
		$FD20 = #LW_IND;
		#OTYPE='1';
		#TXNUM='';
		#LV_YW_IND='';
		#CASH_OPN_BR_NO=#AC_BR_NO;
		$FD123 = getitems('#CMTNO#O_CMTNO#PAY_QS_NO#OR_BR_NO#SENDCO#PAY_OPN_BR_NO#paybankaccount#PAY_NAME#PAY_ADDR#CASH_QS_NO#AC_BR_NO#RECECO#CASH_OPN_BR_NO#CASH_AC_NO#CASH_NAME#CASH_ADDR#YW_TYPE#ORDERNO#CONTENT#RATE#RATEDATE#OORDERNO#PROCODE#CR_DATE#CR_BR_NO#CR_TX_NUM#QR_BR_NO#QR_TX_NUM#TX_TYPE#NOTPAY_CONTENT#NOTPAY_ORDERNO#O_NOTPAY_ORDERNO#RESP_DE#OPERLEVEL#PROC_STS#OPCD#LW_IND#HP_ADD_PWD#PACKID#O_PACKID#PACK_DATE#O_PACK_DATE#TXNUM#O_TXNUM#LV_YW_IND#RESP_DATE#RCP_STS#RESP2#RETCODE#YW_DTL_ID#ACC_IND#REQ_TYPE#DF_FREEAMT#PROTNO#PO_NO#PO_TYPE_DE#OTYPE#CR_TX_DATE#CR_TX_TLNO#CR_TX_TRCE');
	}
	else if( #txtype=='3' )
	{
		$FD49='0003';
		#ACTYPE='1';
		$FD22='01';
		$FD67='2'; //现转标志
		$FD68='1';
		$FD99='2';
		$FD98='6'; 
		$FD30=delspace(#paybankaccount)+space(24-len(delspace(#paybankaccount)));
		$FD31='303101';
		$FD91=#TXNUM; 
		$FD50=#YWTYPE2;
		$FD66 = '1';
		$FD52=#AC_BR_NO;
		$FD30=#paybankaccount;
		$FD25=#PAY_NAME;
		$FD81=#CASH_AC_NO;
		$FD26=#CASH_NAME;
		//$FD44=#CR_TX_DATE;
		//$FD55=#CR_TX_TRCE;
		//$FD92=#CR_TX_TLNO;
		$FD32=#paybankaccount;
		$FD42=itoa(#TX_AMT*100,'%015.0f');
		#CASH_OPN_BR_NO=#AC_BR_NO;
		$FD123 = getitems('#CRDB#OPCD#PKGNO#ORDERNO#TXNUM#OR_BR_NO#AC_BR_NO#TX_AMT#PAY_OPN_BR_NO#PAY_QS_NO#paybankaccount#PAY_NAME#PAY_ADDR#PWD#CASH_QS_NO#CASH_OPN_BR_NO#CASH_AC_NO#CASH_NAME#CASH_ADDR#YWTYPE2#BRF#WT_DATE#OPERLEVEL#AUTH_TEL#AUTH_PWD#NOTE_TYPE#NOTE_NO#PACK_DATE#PACK_ID#CHRG_IND#CHRG_AMT#RESP_DAY#PO_TYPE_XE#PO_DATE#PO_NUM#PC_TX_AMT#JF_TX_AMT#O_WT_DATE#O_TXNUM#O_ORDERNO#RET_CODE#RCP_STS#RESP_XE#RESP2#PACK_END#LV_STS#LW_IND#DFXYNO#OORBRNO#OACBRNO#paybankaccount#CR_TX_DATE#CR_TX_TLNO#CR_TX_TRCE');
	}
	else
	{
		$FD49='0004';
		#ACTYPE='1';
		$FD22='01';
		$FD67='2'; //现转标志
		$FD68='1';
		$FD99='2';
		$FD98='6'; 
		$FD30=delspace(#paybankaccount)+space(24-len(delspace(#paybankaccount)));
		$FD31='303101';
		$FD91=#TXNUM; 
		$FD50=#YWTYPE2;
		$FD66 = '1';
		$FD52=#AC_BR_NO;
		$FD30=#paybankaccount;
		$FD25=#PAY_NAME;
		$FD81=#CASH_AC_NO;
		$FD26=#CASH_NAME;
		//$FD44=#CR_TX_DATE;
		//$FD55=#CR_TX_TRCE;
		//$FD92=#CR_TX_TLNO;
		$FD32=#paybankaccount;
		$FD42=itoa(#TX_AMT*100,'%015.0f');
		#CASH_OPN_BR_NO=#AC_BR_NO;
		$FD123 = getitems('#CRDB#OPCD#PKGNO#ORDERNO#TXNUM#OR_BR_NO#AC_BR_NO#TX_AMT#PAY_OPN_BR_NO#PAY_QS_NO#paybankaccount#PAY_NAME#PAY_ADDR#PWD#CASH_QS_NO#CASH_OPN_BR_NO#CASH_AC_NO#CASH_NAME#CASH_ADDR#YWTYPE2#BRF#WT_DATE#OPERLEVEL#AUTH_TEL#AUTH_PWD#NOTE_TYPE#NOTE_NO#PACK_DATE#PACK_ID#CHRG_IND#CHRG_AMT#RESP_DAY#PO_TYPE_XE#PO_DATE#PO_NUM#PC_TX_AMT#JF_TX_AMT#O_WT_DATE#O_TXNUM#O_ORDERNO#RET_CODE#RCP_STS#RESP_XE#RESP2#PACK_END#LV_STS#LW_IND#DFXYNO#OORBRNO#OACBRNO#paybankaccount#CR_TX_DATE#CR_TX_TLNO#CR_TX_TRCE');
	} 
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
	if( #txtype=='2' )
	{
		setitems('#CMTNO#O_CMTNO#PAY_QS_NO#OR_BR_NO#SENDCO#PAY_OPN_BR_NO#paybankaccount#PAY_NAME#PAY_ADDR#CASH_QS_NO#AC_BR_NO#RECECO#CASH_OPN_BR_NO#CASH_AC_NO#CASH_NAME#CASH_ADDR#YW_TYPE#ORDERNO#CONTENT#RATE#RATEDATE#OORDERNO#PROCODE#CR_DATE#CR_BR_NO#CR_TX_NUM#QR_BR_NO#QR_TX_NUM#TX_TYPE#NOTPAY_CONTENT#NOTPAY_ORDERNO#O_NOTPAY_ORDERNO#RESP_DE#OPERLEVEL#PROC_STS#OPCD#LW_IND#HP_ADD_PWD#PACKID#O_PACKID#PACK_DATE#O_PACK_DATE#TXNUM#O_TXNUM#LV_YW_IND#RESP_DATE#RCP_STS#RESP2#RETCODE#YW_DTL_ID#ACC_IND#REQ_TYPE#DF_FREEAMT#PROTNO#PO_NO#PO_TYPE_DE#OTYPE#CR_TX_DATE#CR_TX_TLNO#CR_TX_TRCE',$FD123);
		#ORDERNO=substr($FD123,392,8);
		#CASH_QS_NO=substr($FD123,198,12);
		#CASH_OPN_BR_NO=substr($FD123,210,12);
	}
	else if( #txtype=='3' )
	{
		setitems('#CRDB#OPCD#PKGNO#ORDERNO#TXNUM#OR_BR_NO#AC_BR_NO#TX_AMT#PAY_OPN_BR_NO#PAY_QS_NO#paybankaccount#PAY_NAME#PAY_ADDR#PWD#CASH_QS_NO#CASH_OPN_BR_NO#CASH_AC_NO#CASH_NAME#CASH_ADDR#YWTYPE2#BRF#WT_DATE#OPERLEVEL#AUTH_TEL#AUTH_PWD#NOTE_TYPE#NOTE_NO#PACK_DATE#PACK_ID#CHRG_IND#CHRG_AMT#RESP_DAY#PO_TYPE_XE#PO_DATE#PO_NUM#PC_TX_AMT#JF_TX_AMT#O_WT_DATE#O_TXNUM#O_ORDERNO#RET_CODE#RCP_STS#RESP_XE#RESP2#PACK_END#LV_STS#LW_IND#DFXYNO#OORBRNO#OACBRNO#paybankaccount#CR_TX_DATE#CR_TX_TLNO#CR_TX_TRCE',$FD123);
		#ORDERNO=substr($FD123,6,8);
		#CASH_OPN_BR_NO=substr($FD123,254,12);
	}
}"
</COMMRECV>

<VARIABLE>
	<ITEM LINE="3"  COL="3" TYPE="%-54s" FUNCTIONS=
	"T(5514                          财政集中支付记账)"/>
	<ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
	"T(─────────────────────────────────────)"/>
	<ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=6820)"/>
	<ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
	<ITEM NAME="#TXNUMBER"  TYPE="%-4s"  FUNCTIONS="T(5514)"/>     <!---交易序号--->
	<ITEM NAME="#TXNAME"    TYPE="%-18s" FUNCTIONS="T(财政集中支付记账)"/><!---交易名称---> 	
	<ITEM LINE="5" COL="2"   TYPE="%10s" FUNCTIONS="T(支付凭证:)"/>
	<ITEM LINE="5" COL="30"  TYPE="%10s" FUNCTIONS="T(财政编码:)"/>
	<ITEM LINE="6" COL="2"   TYPE="%10s" FUNCTIONS="T(银行编码:)"/>
	<ITEM LINE="6" COL="30"  TYPE="%14s" FUNCTIONS="T(财政凭证编号:)"/>
	<ITEM LINE="7" COL="2"   TYPE="%12s" FUNCTIONS="T(收款人账号:)"/>		
	<ITEM LINE="8" COL="2"   TYPE="%12s" FUNCTIONS="T(收款人名称:)"/>
	<ITEM LINE="9" COL="2"   TYPE="%18s" FUNCTIONS="T(收款人开户行名称:)"/> 		
	<ITEM LINE="10" COL="2"  TYPE="%12s" FUNCTIONS="T(金      额:)"/>		
	<ITEM LINE="11" COL="2"  TYPE="%12s" FUNCTIONS="T(付款人账号:)"/>
	<ITEM LINE="12" COL="2"  TYPE="%12s" FUNCTIONS="T(付款人名称:)"/>
	<ITEM LINE="13" COL="2"  TYPE="%18s" FUNCTIONS="T(付款人开户行名称:)"/>
	<ITEM NAME="#PKGNO"   TYPE="%3d"  FUNCTIONS="T(001)"/>
	<ITEM NAME="#TXNUM"   TYPE="%5d"  FUNCTIONS="T(00100)"/>
	<ITEM NAME="#YWTYPE2"   TYPE="%12s"  FUNCTIONS="T(11)"/>
	<ITEM NAME="#YW_TYPE"   TYPE="%2s"  FUNCTIONS="T(11)"/>
	<ITEM INPUT="SELECT" NAME="#paybilltype" LINE="5" COL="12"   TYPE="%-1s" FUNCTIONS="T(1)V(NB)" >		
	<SELECT>
		<OPTION VALUE="1" TITLE="1.直接支付 "/>
		<OPTION VALUE="2" TITLE="2.授权支付 "/>
		<OPTION VALUE="3" TITLE="3.公务卡 "/>
	</SELECT>
	</ITEM> 
	<ITEM INPUT="TEXT" NAME="#CZCODE" LINE="5" COL="40"   TYPE="%-16s"  FUNCTIONS="V(NB)">
	<ONLOSTFOCUS>"{
		//dim @tota as string;
		//dim @tmp1 as string;
		//dim @tmp2 as string;  
		//if(len(#qybm) != 6){
		//	showmsg('区域编码长度不对');
		//	return(false);
		//} 	
	}"</ONLOSTFOCUS>
	</ITEM>
	<ITEM INPUT="TEXT" NAME="#BANKNO" LINE="6" COL="12"   TYPE="%-16s"  FUNCTIONS="V(NB)" /> 		
	<ITEM INPUT="TEXT" NAME="#printid" LINE="6" COL="44"   TYPE="%-20s"  FUNCTIONS="T()V(NB)" >
	<ONLOSTFOCUS>"{
		dim @tota as string;
		dim @tmp1 as string;
		dim @tmp2 as string;
		dim @amt  as number;
		if(len(#printid) == 0)
		{
			showmsg('电子支付令号不能为空');
			return(false);
		}
		initfd();
		commsend_001();
		$FD33 = #printid;
		$FD67 = #paybilltype;
		$FD59 = #CZCODE;
		$FD60 = #BANKNO;
		$FD16 = '1250';
		calltips(); //调用财税系统交易
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#guid= delspace($FD30);
		#createdate= delspace($FD44);
		#clearbank= delspace($FD58);
		#clearbankname= delspace($FD25);
		#paybankaccount= delspace($FD32);   //付款人账号
		#PAY_NAME= delspace($FD26);         //付款人名称
		//showmsg('111='+#PAY_NAME);
		#paybankname= delspace($FD81);     //付款人开户行名称
		//showmsg('222='+#paybankname);
		#CASH_AC_NO= delspace($FD31);      //收款人账号
		#CASH_NAME= delspace($FD83);       //收款人名称
		#BRF=delspace($FD25);              //摘要
		#payeebankname= delspace($FD82);   //收款行名称
		#CTIND=delspace($FD71);           //支付方式
		#ZFIND=delspace($FD72);           //支付类型
		#fd95= $FD95; 
		#amt	= itoa(val($FD40,0.01),'%.2f');
		//showmsg('支付方式='+#CTIND);
		if( #CTIND == '1' and #ZFIND == '1' )
		{
			showmsg('直接支付凭证不能支付现金,请检查!');
			return(false);
		}
	}"</ONLOSTFOCUS>
	</ITEM>
	<ITEM INPUT="LABEL" NAME="#CASH_AC_NO"      LINE="7"  COL="14"   TYPE="%-32s" />
	<ITEM INPUT="LABEL" NAME="#CASH_NAME"       LINE="8"  COL="14"   TYPE="%-60s" />
	<ITEM INPUT="LABEL" NAME="#payeebankname"   LINE="9"  COL="20"   TYPE="%-60s" /> 
	<ITEM INPUT="LABEL" NAME="#amt"             LINE="10" COL="14"   TYPE="%-16s" />
	<ITEM INPUT="LABEL" NAME="#paybankaccount"  LINE="11" COL="14"   TYPE="%-32s" >
	<ONLOSTFOCUS>
	"{
		dim @baktxno as string;
		dim @name as string;
		dim @avbal as string;
		dim @prdt_name as string;
		if(substr(#paybankaccount,0,6)!='622947')
		{
			@baktxno=$TXNO;
			commsend_001();
			$FD16='9654';
			$FD30=#paybankaccount;
			callserver();
			$TXNO=@baktxno;
			if($FD12!='0000')
			{
				if(#paybankaccount=='100101')
				{
					showmsg('现金办理此交易，请核实!');
				}
				else
				{
					showmsg(geterror());
					showmsg('预算单位账号非本行账号，不能办理此交易，请核实');
					return(false);
				}
			}
		}
		@baktxno=$TXNO;
		$TXNO='9731';
		#paybankaccount=rtrim(#paybankaccount);
		#AC_NO=substr(#paybankaccount,0,24)+space(24-len(#paybankaccount))+'';
		$FD102=#AC_NO+#AC_SEQN;
		commsend_001();
		callserver();
		$TXNO=@baktxno;
		if($FD12!='0000')
		{
			showmsg(geterror());
			return(true);
		}
		@name=substr($FD102,145,60);
		@avbal=substr($FD102,205,16);
		#PAY_NAME=rtrim(@name);
		enable(#PAY_NAME,true);
		@prdt_name=rtrim(substr($FD102,333,30));
		#AVBAL=atoi(@avbal)/100;
		//showhelp(4,68,5,10,'帐户信息','户名:'+@name+' 余额:'+itoa(val(@avbal,0.01),'%16.2f')+space(6)+' 产品名称:'+@prdt_name);
		if((atoi(substr(#paybankaccount,0,1)) &gt;=5) and (len(#paybankaccount) &lt; 19))
		{
			dim @sql as string;
			dim @file as file;
			dim @filename as string;
			dim @line as string;
			dim @index as number;
			dim @tota as string;
			@sql='select mdm_code,note_no from mdm_ac_rel where ac_no='+chr(39)+#paybankaccount+chr(39)+'';
			commsend_001();
			$FD16='9598';
			$FD123=@sql;
			@tota=callserver();
			if($FD12!='0000')
			{
				showmsg(geterror());
				return(false);
			}
			if(@tota!='')
			{
				@filename='../tmp/'+$KINBR+$TTYNAME+'.mdmtype2';
				savefiletxt(@filename,@tota);
				@file=openfile(@filename,'rb');
				if(@file &lt; 0)
				{
					showmsg(geterror());
					return(false);
				}
				@line=readline(@file);
				@index=0;
				while(@line!='')
				{
					#VOCTYPETMP	= strfld(@line,'|',0);
					#VOCNUMTMP	= strfld(@line,'|',1);
					@line			= readline(@file);
				}
				closefile(@file);
			}
		}
	}"
	</ONLOSTFOCUS>
	</ITEM> 
	<ITEM INPUT="LABEL" NAME="#PAY_NAME"    LINE="12" COL="14"  		TYPE="%-60s" />
	<ITEM INPUT="LABEL" NAME="#paybankname" LINE="13" COL="20"  		TYPE="%-60s" /> 
	<ITEM NAME="#VOCTYPETMP"     TYPE="%-4s"   FUNCTIONS=""/>
	<ITEM NAME="#VOCNUMTMP"      TYPE="%16d"   FUNCTIONS=""/>
	<ITEM NAME="#VOCNAMETMP"     TYPE="%-20s"  FUNCTIONS=""/>
	<ITEM NAME="#FD123"          TYPE="%-999s" FUNCTIONS=""/>
	<ITEM NAME="#FD66"           TYPE="%-1s"   FUNCTIONS=""/>  	  	
	<ITEM NAME="#CRDB"           TYPE="%1d"    FUNCTIONS="T(1)"/>
	<ITEM NAME="#OPCD"           TYPE="%2d"    FUNCTIONS="T(10)"/>
	<ITEM NAME="#CMTNO"          TYPE="%3d"    FUNCTIONS="T(100)"/>
	<ITEM NAME="#OR_BR_NO"       TYPE="%-12s"  FUNCTIONS="T()"/>    <!--发起行行号     ---->
	<ITEM NAME="#PAY_OPN_BR_NO"  TYPE="%-12s"  FUNCTIONS="T()"/>    <!--付款人开户行   ---->
	<ITEM NAME="#PAY_QS_NO"      TYPE="%-12s"  FUNCTIONS="T()"/>    <!--付款清算行行号 ---->
	<ITEM NAME="#PAY_ADDR"       TYPE="%-60s"  FUNCTIONS="T()"/>    <!--付款人地址     ---->
	<ITEM NAME="#CASH_QS_NO"     TYPE="%-12s"  FUNCTIONS="T()"/>    <!--收款清算行行号 ---->
	<ITEM NAME="#OPERLEVEL"      TYPE="%-1s"   FUNCTIONS="T(1)"/>   <!--优先级         ---->
	<ITEM NAME="#AUTH_TEL"       TYPE="%-6s"   FUNCTIONS="T()"/>    <!--授权操作员号   ---->
	<ITEM NAME="#AUTH_PWD"       TYPE="%-8s"   FUNCTIONS="T()"/>    <!--授权操作员密码 ---->
	<ITEM NAME="#NOTE_TYPE"      TYPE="%-2s"   FUNCTIONS="T()"/>    <!--凭证种类       ---->
	<ITEM NAME="#NOTE_NO"        TYPE="%-12s"  FUNCTIONS="T()"/>    <!--凭证号码       ---->
	<ITEM NAME="#PACK_DATE"      TYPE="%-8s"   FUNCTIONS="T()"/>    <!--包日期,定期用  ---->
	<ITEM NAME="#PACK_ID"        TYPE="%-8s"   FUNCTIONS="T()"/>    <!--包id,定期用    ---->
	<ITEM NAME="#CHRG_IND"       TYPE="%-1s"   FUNCTIONS="T()"/>    <!--手续费标志     ---->
	<ITEM NAME="#CHRG_AMT"       TYPE="%-15s"  FUNCTIONS="T()"/>    <!--手续费金额     ---->
	<ITEM NAME="#RESP_DAY"       TYPE="%-8s"   FUNCTIONS="T()"/>    <!--期待应答日期  ---->
	<ITEM NAME="#O_WT_DATE"      TYPE="%-8s"   FUNCTIONS="T()"/>    <!--原委托日期    ---->
	<ITEM NAME="#O_TXNUM"        TYPE="%-5s"   FUNCTIONS="T()"/>    <!--原业务编号    ---->
	<ITEM NAME="#O_ORDERNO"      TYPE="%-8s"   FUNCTIONS="T()"/>    <!--原支付交易序号---->
	<ITEM NAME="#RET_CODE"       TYPE="%-2s"   FUNCTIONS="T()"/>    <!--退汇原因代码  ---->
	<ITEM NAME="#RCP_STS"        TYPE="%-2s"   FUNCTIONS="T()"/>    <!--业务回执状态  ---->
	<ITEM NAME="#RESP_DE"        TYPE="%-1s"   FUNCTIONS="T()"/>    <!--Mbfe应答码    ---->
	<ITEM NAME="#RESP_XE"        TYPE="%-8s"   FUNCTIONS="T()"/>    <!--Mbfe应答码    ----> 
	<ITEM NAME="#RESP2"          TYPE="%-8s"   FUNCTIONS="T()"/>    <!--Ccpc应答码    ---->
	<ITEM NAME="#PACK_END"       TYPE="%-1s"   FUNCTIONS="T()"/>    <!--包结束标志    ---->
	<ITEM NAME="#LV_STS"         TYPE="%-1s"   FUNCTIONS="T()"/>    <!--交易状态      ---->
	<ITEM NAME="#DFXYNO"         TYPE="%-60s"  FUNCTIONS="T()"/>        <!--多方协议号-->
	<ITEM NAME="#OORBRNO"        TYPE="%-12s"  FUNCTIONS="T()"/>    <!--原发起行行号 -->
	<ITEM NAME="#OACBRNO"        TYPE="%-12s"  FUNCTIONS=""/>       <!--原接收行行号-->
	<ITEM NAME="#ORDERNO"        TYPE="%8d"    FUNCTIONS=""/>
	<ITEM NAME="#CTIND"          TYPE="%-1s"   FUNCTIONS=""/>       <!---现转标志--->   
	<ITEM NAME="#ZFIND"          TYPE="%-1s"   FUNCTIONS=""/>       
	<ITEM NAME="#WT_DATE"        TYPE="%8d"    FUNCTIONS=""/>
	<ITEM NAME="#LV_YW_IND"      TYPE="%12s"   FUNCTIONS="T(1)"/>
	<ITEM NAME="#RETCODE"        TYPE="%-2s"   FUNCTIONS="T()"/>
	<ITEM NAME="#YW_DTL_ID"      TYPE="%-8s"   FUNCTIONS="T()"/>
	<ITEM NAME="#ACC_IND"        TYPE="%-1s"   FUNCTIONS="T()"/>
	<ITEM NAME="#REQ_TYPE"       TYPE="%-1s"   FUNCTIONS="T()"/>
	<ITEM NAME="#CASH_OPN_BR_NO" TYPE="%-12s"  FUNCTIONS="T()"/>  
	<ITEM NAME="#DF_FREEAMT"     TYPE="%-16s"  FUNCTIONS="T()"/>
	<ITEM NAME="#PROTNO"         TYPE="%-60s"  FUNCTIONS="T()"/>
	<ITEM NAME="#PO_NUM"         TYPE="%-8s"   FUNCTIONS="T()"/>
	<ITEM NAME="#PO_DATE"        TYPE="%-8s"   FUNCTIONS="T()"/>
	<ITEM NAME="#PO_TYPE_DE"     TYPE="%-1s"   FUNCTIONS="T()"/>
	<ITEM NAME="#PO_TYPE_XE"     TYPE="%-2s"   FUNCTIONS="T()"/>  
	<ITEM NAME="#OTYPE"          TYPE="%-1s"   FUNCTIONS="T(1)"/>        <!-- 表示小额 -->
	<ITEM NAME="#PC_TX_AMT"      TYPE="%-15s"  FUNCTIONS="T(1)"/>        <!--赔偿金额---->
	<ITEM NAME="#JF_TX_AMT"      TYPE="%-15s"  FUNCTIONS="T(2)"/>        <!--拒付金额---->
	<ITEM NAME="#ACTYPE"         TYPE="%-1s"   FUNCTIONS="T(1)"/>        <!--默认帐户类型为帐户1，7表示现金 -->
	<ITEM NAME="#CUR_NO"         TYPE="%-2s"   FUNCTIONS="T(01)"/> 		
	<ITEM NAME="#WT_DAY"         TYPE="%-8s"   FUNCTIONS="T($HDATE)"/>
	<ITEM NAME="#O_WT_DAY"       TYPE="%-8s"   FUNCTIONS=""/>
	<ITEM NAME="#NOTPAY_DATE"    TYPE="%-8s"   FUNCTIONS=""/>	 
	<!-- 102域变量 -->
	<ITEM NAME="#PWD"  TYPE="%8s" FUNCTIONS="T($XPASS)"/>
	<ITEM NAME="#ACTNO24"     TYPE="%-24s"  FUNCTIONS=""/>
	<ITEM NAME="#ACTSEQ"      TYPE="%-4s"   FUNCTIONS=""/>
	<ITEM NAME="#FETCHFLAG"   TYPE="%1s"    FUNCTIONS=""/>
	<ITEM NAME="#PWDFLAG"     TYPE="%-1s"   FUNCTIONS=""/>
	<ITEM NAME="#VOCTYPE"     TYPE="%-3s"   FUNCTIONS=""/>  
	<ITEM NAME="#QUE_PWD"     TYPE="%16s"   FUNCTIONS=""/>
	<ITEM NAME="#CERTFLAG"    TYPE="%-1s"   FUNCTIONS=""/>
	<ITEM NAME="#CERTNO20"    TYPE="%-20s"  FUNCTIONS=""/>
	<ITEM NAME="#STAMPFLAG"   TYPE="%1s"    FUNCTIONS=""/>
	<ITEM NAME="#PWDFLAG2"    TYPE="%1s"    FUNCTIONS=""/>
	<ITEM NAME="#PWD16"       TYPE="%-16s"  FUNCTIONS=""/>
	<ITEM NAME="#PRINTDATE"   TYPE="%-8s"   FUNCTIONS=""/>
	<ITEM NAME="#TXAMT15"     TYPE="%-16s"  FUNCTIONS=""/>
	<ITEM NAME="#CUSTNAME"    TYPE="%-60s"  FUNCTIONS=""/>
	<ITEM NAME="#AVBAL"       TYPE="%17.2f" FUNCTIONS=""/>
	<ITEM NAME="#CURCD"       TYPE="%-2s"   FUNCTIONS="T(01)"/>
	<ITEM NAME="#CT_IND"      TYPE="%-1s"   FUNCTIONS="T(2)"/>
	<ITEM NAME="#DSCPT"       TYPE="%-3s"   FUNCTIONS=""/>
	<ITEM NAME="#ACTTYPE"     TYPE="%-1s"   FUNCTIONS=""/>
	<ITEM NAME="#ACTSEQ_2"    TYPE="%-4s"   FUNCTIONS=""/>
	<ITEM NAME="#ACCOUNTFLAG" TYPE="%-1s"   FUNCTIONS=""/>
	<ITEM NAME="#INTEREST1"   TYPE="%-16s"  FUNCTIONS=""/>
	<ITEM NAME="#INTEREST2"   TYPE="%-16s"  FUNCTIONS=""/>
	<ITEM NAME="#INTEREST3"   TYPE="%-16s"  FUNCTIONS=""/>
	<ITEM NAME="#PAYAMOUNT"   TYPE="%-16s"  FUNCTIONS=""/>
	<ITEM NAME="#NEWVOCNUM"   TYPE="%-16s"  FUNCTIONS=""/>
	<ITEM NAME="#SPEFLAG"     TYPE="%-20s"  FUNCTIONS=""/>
	<ITEM NAME="#PRODNAME"    TYPE="%-30s"  FUNCTIONS=""/>
	<ITEM NAME="#ACTNO_24"    TYPE="%-24s"  FUNCTIONS=""/>
	<ITEM NAME="#EDUCREDIT"   TYPE="%-1s"    FUNCTIONS=""/>
	<ITEM NAME="#DESC10"      TYPE="%-20s"  FUNCTIONS=""/>
	<ITEM NAME="#MDMCODE"     TYPE="%-4s"  FUNCTIONS=""/>
	<ITEM NAME="#FD79_DRPWD"  TYPE="%16s"  	FUNCTIONS=""/>  	
	<ITEM NAME="#AC_SEQN"   TYPE="%-4s"     FUNCTIONS="T(0001)"/>
	<ITEM NAME="#AC_NO"     TYPE="%-24s"      FUNCTIONS=""/> 
	<ITEM NAME="#AC_NO1"    TYPE="%-24s"     FUNCTIONS=""/> 
	<ITEM NAME="#FD101_1"   TYPE="%-24s"  FUNCTIONS=""/>
	<ITEM NAME="#FD101_2"   TYPE="%-4s"   FUNCTIONS=""/>
	<ITEM NAME="#FD101_3"   TYPE="%17.2f" FUNCTIONS=""/>
	<ITEM NAME="#FD101_4"   TYPE="%-3s"   FUNCTIONS=""/>
	<ITEM NAME="#FD101_5"   TYPE="%-16s"  FUNCTIONS=""/>
	<ITEM NAME="#FD101_6"   TYPE="%-10s"  FUNCTIONS=""/>
	<ITEM NAME="#FD101_7"   TYPE="%-1s"   FUNCTIONS=""/>
	<ITEM NAME="#FD101_8"   TYPE="%-60s"  FUNCTIONS=""/>
	<ITEM NAME="#FD101_9"   TYPE="%17.2f" FUNCTIONS=""/>
	<ITEM NAME="#FD101_10"  TYPE="%-2s"   FUNCTIONS=""/>
	<ITEM NAME="#FD101_11"  TYPE="%-1s"   FUNCTIONS=""/>
	<ITEM NAME="#FD101_12"  TYPE="%-3s"   FUNCTIONS=""/>
	<ITEM NAME="#FD101_13"  TYPE="%-1s"   FUNCTIONS=""/>
	<ITEM NAME="#FD101_14"  TYPE="%-4s"   FUNCTIONS=""/>
	<ITEM NAME="#FD101_15"  TYPE="%-30s"  FUNCTIONS=""/>
	<ITEM NAME="#FD101_16"  TYPE="%-4s"  FUNCTIONS=""/>
	<ITEM NAME="#FD0680"    TYPE="%-1s"/>
	<ITEM NAME="#FD120_1"   TYPE="%-20s"  FUNCTIONS=""/>
	<ITEM NAME="#FD120_2"   TYPE="%-60s"   FUNCTIONS=""/>
	<ITEM NAME="#FD120_3"   TYPE="%17.2f" FUNCTIONS=""/>
	<ITEM NAME="#FD120_4"   TYPE="%-2s"   FUNCTIONS=""/>
	<ITEM NAME="#FD120_5"   TYPE="%-1s"  FUNCTIONS=""/>
	<ITEM NAME="#FD120_6"   TYPE="%-3s"  FUNCTIONS=""/>
	<ITEM NAME="#FD120_7"   TYPE="%-16s"   FUNCTIONS=""/>
	<ITEM NAME="#FD120_8"   TYPE="%17.2f"  FUNCTIONS=""/>
	<ITEM NAME="#FD120_9"   TYPE="%-2s" FUNCTIONS=""/>
	<ITEM NAME="#FD120_10"  TYPE="%-20s"   FUNCTIONS=""/>
	<ITEM NAME="#FD120_11"  TYPE="%-2s"   FUNCTIONS=""/>
	<ITEM NAME="#O_CMTNO"   TYPE="%-3s"       FUNCTIONS=""/>   	  
	<ITEM NAME="#ID_TYPE"   TYPE="%-1s"       FUNCTIONS=""/>
	<ITEM NAME="#ID_NO"     TYPE="%-20s"      FUNCTIONS=""/>    
	<ITEM NAME="#CERTTYPE"  TYPE="%-1s"       FUNCTIONS=""/>  			   
		
	<ITEM NAME="#guid"      TYPE="%-24s"/>
	<ITEM NAME="#FD126"     TYPE="%-40s"/>
	<ITEM NAME="#createdate" TYPE="%-8s"/>
	<ITEM NAME="#clearbank"  TYPE="%-12s"/>
	<ITEM NAME="#clearbankname"  TYPE="%-60s"/>
	<ITEM NAME="#paybank"        TYPE="%-12s"/>
	<ITEM NAME="#payeebank"      TYPE="%-12s"/>		
	<ITEM NAME="#program"        TYPE="%-12s"/>
	<ITEM NAME="#programname"    TYPE="%-64s"/>
	<ITEM NAME="#bdgagency"      TYPE="%-12s"/>
	<ITEM NAME="#bdgagencyname"  TYPE="%-64s"/>		
	<ITEM NAME="#department"     TYPE="%-12s"/>
	<ITEM NAME="#departmentname" TYPE="%-64s"/>
	<ITEM NAME="#expfune"        TYPE="%-2s"/>
	<ITEM NAME="#expfuncname"    TYPE="%-64s"/>
	<ITEM NAME="#expeco"         TYPE="%-2s"/>
	<ITEM NAME="#expeconame"     TYPE="%-64s"/>
	<ITEM NAME="#paytype"        TYPE="%-2s"/>
	<ITEM NAME="#paytypename"    TYPE="%-64s"/>
	<ITEM NAME="#settlemode"     TYPE="%-2s"/>
	<ITEM NAME="#settlemodename" TYPE="%-64s"/>
	<ITEM NAME="#remark"         TYPE="%-100s"/>
	<ITEM NAME="#fd95"           TYPE="%-600s"/>
	<ITEM NAME="#CR_TX_DATE"     TYPE="%-8s"/>
	<ITEM NAME="#CR_TX_TLNO"     TYPE="%-6s"/>
	<ITEM NAME="#CR_TX_TRCE"     TYPE="%8d"/>		
	<ITEM NAME="#SENDCO"            TYPE="%-4s"       FUNCTIONS=""/>
	<ITEM NAME="#RECECO"            TYPE="%-4s"      FUNCTIONS=""/>
	<ITEM NAME="#OORDERNO"          TYPE="%-8s"       FUNCTIONS=""/>
	<ITEM NAME="#PROCODE"           TYPE="%-8s"       FUNCTIONS=""/>
	<ITEM NAME="#CR_DATE"           TYPE="%-8s"       FUNCTIONS=""/>
	<ITEM NAME="#CR_BR_NO"          TYPE="%-12s"      FUNCTIONS=""/>
	<ITEM NAME="#CR_TX_NUM"         TYPE="%-8s"       FUNCTIONS=""/>
	<ITEM NAME="#QR_BR_NO"          TYPE="%-12s"      FUNCTIONS=""/>
	<ITEM NAME="#QR_TX_NUM"         TYPE="%-8s"       FUNCTIONS=""/>
	<ITEM NAME="#TX_TYPE"           TYPE="%-1s"       FUNCTIONS=""/>
	<ITEM NAME="#NOTPAY_CONTENT"    TYPE="%-255s"     FUNCTIONS=""/>
	<ITEM NAME="#NOTPAY_ORDERNO"    TYPE="%-3s"       FUNCTIONS=""/>
	<ITEM NAME="#O_NOTPAY_ORDERNO"  TYPE="%-3s"       FUNCTIONS=""/>
	<ITEM NAME="#LW_IND"            TYPE="%-1s"       FUNCTIONS="T(1)"/>
	<ITEM NAME="#PROC_STS"          TYPE="%-1s"       FUNCTIONS=""/>	
	<ITEM NAME="#HP_ADD_PWD"        TYPE="%-1s"       FUNCTIONS=""/>
	<ITEM NAME="#PACKID"            TYPE="%8d"        FUNCTIONS=""/>
	<ITEM NAME="#O_PACKID"          TYPE="%8d"        FUNCTIONS=""/>
	<ITEM NAME="#O_PACK_DATE"       TYPE="%8d"        FUNCTIONS=""/>
	<ITEM NAME="#XZFLG"             TYPE="%-1s"       FUNCTIONS=""/>
	<ITEM NAME="#RESP_DATE"         TYPE="%8d"        FUNCTIONS=""/>
	<ITEM NAME="#AMT_TMP"           TYPE="%16s"       FUNCTIONS=""/>
	<ITEM NAME="#PO_NO"             TYPE="%8d"        FUNCTIONS=""/>
	<ITEM NAME="#CASH_ADDR"         TYPE="%-60s"      FUNCTIONS=""/> 
	<ITEM NAME="#CONTENT"           TYPE="%-60s"      FUNCTIONS=""/>  
	<ITEM NAME="#RATE"              TYPE="%-7s"       FUNCTIONS=""/> 
	<!--ITEM NAME="#BRF"               TYPE="%-60s"      FUNCTIONS=""/-->    
	<ITEM NAME="#RATEDATE"          TYPE="%-5s"       FUNCTIONS=""/>       
	<ITEM NAME="#TX_AMT1"           TYPE="%19s"       FUNCTIONS=""/>  
	<ITEM LINE="14" COL="2" TYPE="%10s"    FUNCTIONS="T(付款方式:)"/>  
	<ITEM INPUT="SELECT" NAME="#txtype" LINE="14" COL="12"   TYPE="%-4s" FUNCTIONS="T(1)V(NB)" >		
	<SELECT>
		<OPTION VALUE="1" TITLE="1.行内付款 "/>
		<OPTION VALUE="2" TITLE="2.大额支付 "/>
		<OPTION VALUE="3" TITLE="3.小额支付 "/> 
		<OPTION VALUE="4" TITLE="4.代理财政款项 "/>
	</SELECT> 	
	<ONLOSTFOCUS>
	"{
		if(#txtype=='1' or #txtype=='4')  //行内支付
		{
			show(#NOTETYPE,true);
			show(#VOCTYPE1,true);
			show(#PZXH,true);
			show(#VOCNUM,true);
			show(#CTNAME,true);
			show(#CTTYPE,true);
		}
		else 
		{
			show(#NOTETYPE,false);
			show(#VOCTYPE1,false);
			show(#PZXH,false);
			show(#VOCNUM,false);
			show(#CTNAME,false);
			show(#CTTYPE,false);
		}
		if( #txtype=='2' or #txtype=='3' )
		{
			initfd();
			commsend_001();
			$FD16 = '2492';
			$FD30 = #CASH_AC_NO;
			callserver(); 
			if($FD12 == '0000' )
			{
				showmsg('收款账号是行内账号，不能通过大小额支付');
				return(false);
			}
		}
	}"
	</ONLOSTFOCUS>
	</ITEM>	
	<ITEM NAME="#TXTYPENAME"   TYPE="%10s"  FUNCTIONS="S(#txtype,#txtype)"/>
	<ITEM LINE="15"  COL="2"   TYPE="%10s"  NAME="#CTNAME"  VISABLE="FALSE" INPUT="LABEL" FUNCTIONS="T(现转标志:)"/>
	<ITEM LINE="15"  COL="12" NAME="#CTTYPE" TYPE="%-3s" INPUT="SELECT" VISABLE="FALSE"  DEVICE="KEYBOARD" FUNCTIONS="V(NB)T(1)">
	<SELECT>
		<OPTION VALUE="1"  TITLE="0.现金"/>
		<OPTION VALUE="2"  TITLE="1.转账"/>
	</SELECT>
	<ONLOSTFOCUS>
	"{
		if( #CTIND=='1' and #CTTYPE=='2' )
		{
			showmsg('支付凭证为现金支付,请检查!');
			return(false);
		}
		else if( (#CTIND=='2' or #CTIND=='7') and #CTTYPE=='1' )
		{
			showmsg('支付凭证为转账支付,请检查!');
			return(false);
		}
	}"
	</ONLOSTFOCUS>
	</ITEM>
	<ITEM LINE="16"  COL="2"   TYPE="%10s"  NAME="#NOTETYPE"  VISABLE="FALSE" INPUT="LABEL" FUNCTIONS="T(凭证类型:)"/>
	<ITEM LINE="16"  COL="12" NAME="#VOCTYPE1" TYPE="%-3s" INPUT="SELECT" VISABLE="FALSE"  DEVICE="KEYBOARD" FUNCTIONS="V(NB)T(299)">
	<SELECT>
		<OPTION VALUE="001"  TITLE="0.现金支票"/>
		<OPTION VALUE="002"  TITLE="1.转账支票"/>
		<OPTION VALUE="299"  TITLE="2.其他"/>
	</SELECT>
	<ONLOSTFOCUS>
	"{
		if(#CTTYPE == '1' and #VOCTYPE1 == '002')
		{
			showmsg('现转标志为现金,请选择现金支票或其他凭证!');
			return(false);
		}
		else if( #CTTYPE=='2' and #VOCTYPE1 =='001' )
		{
			showmsg('现转标志为转账,请选择转账支票或其他凭证!');
			return(false);
		}
		
	}"
	</ONLOSTFOCUS>
	</ITEM>
	<ITEM NAME="#VOCNAME"     TYPE="%8s"    FUNCTIONS="S(#VOCTYPE1,#VOCTYPE1)"/>
	<ITEM LINE="16"  COL="28"  TYPE="%-7s"  NAME="#PZXH" VISABLE="FALSE" INPUT="LABEL"  FUNCTIONS="T(凭证号:)"/>
	<ITEM LINE="16"  COL="35"  NAME="#VOCNUM"   TYPE="%16d"  INPUT="TEXT"  VISABLE="FALSE" DEVICE="KEYBOARD" FUNCTIONS="T()" >
		<ONLOSTFOCUS>
	"{
		if(#VOCTYPE!='299' and #VOCNUM=='')
		{
			showmsg('非其他凭证不能为空!');
			return(false);
		}
		
		if(#VOCTYPE1 == '002' or #VOCTYPE1 == '001')
		{
			commsend_001();
			$FD16 = '3405';
			$FD30 = #paybankaccount;
			$FD58 = #VOCNUM;
			$FD89 = #VOCTYPE1;
			$FD48 = $TXNO;
			callserver();
			if($FD12!='0000')
			{
				showmsg(geterror());
				return(false);
			}
		}
	}"
	</ONLOSTFOCUS>
	</ITEM>

	<ITEM LINE="15"  COL="3"   TYPE="%12s"  NAME="#LB0"  VISABLE="FALSE" INPUT="LABEL" FUNCTIONS="T(接 收 行 号:)"/>
	<!----
	<ITEM NAME="#AC_BR_NO"     TYPE="%12s" LINE="15" COL="15"  VISABLE="FALSE" INPUT="TEXT"   DEVICE="KEYBOARD" FUNCTIONS="V(NB)T()">
	------>
	<ITEM NAME="#AC_BR_NO"     TYPE="%12s" LINE="15" COL="15"  VISABLE="FALSE" INPUT="TEXT"   DEVICE="KEYBOARD" FUNCTIONS="V()T()">
	<!-----
	<ONLOSTFOCUS>
	"{
		dim @baktxno as string;
		@baktxno='6821';
		$TXNO='9552';
		$FD91=$KINBR;
		commsend_001();
		callserver();
		$TXNO=@baktxno;
		if($FD12!='0000')
		{
			showmsg(geterror());
			return(false);
		}
		if(delspace($FD32)==#AC_BR_NO)
		{
			showmsg('不允许自己行内发支付系统报文!');
			return(false);
		}

		@baktxno=$TXNO;
		$TXNO='9553';
		$FD32=#AC_BR_NO;
		commsend_001();
		callserver();
		$TXNO=@baktxno;
		if($FD12!='0000')
		{
			showmsg(geterror());
			return(false);
		}
		showhelp(3,70,8,3,'支付系统行名信息',substr($FD96,0,60));

		if(delspace($FD33)=='402871099996')
		{
			showmsg('不允许给黄行其他网点做此业务!');
			return(false);
		}

	}"
	</ONLOSTFOCUS>
	----->
	</ITEM> 
	<ITEM LINE="17" COL="2"  TYPE="%10s" FUNCTIONS="T(支付金额:)"/>				
	<ITEM LINE="17"   COL="12" NAME="#TX_AMT"      TYPE="%16.2f" DEVICE="KEYBOARD" FUNCTIONS="V(0000000000000001,9999999999999999)">
	<ONLOSTFOCUS>
	"{
		dim @avbal as string;
		dim @tota as string;
		dim @tpacno as string;
		dim @tpacno1 as string;
		dim @tpamt as string;	
		@tpamt=itoa(#TX_AMT,'%16.2f');
		@tpamt=delspace(@tpamt);
		if(@tpamt==#amt)
		{
		}
		else
		{
			showmsg('输入的支付金额与金额不符');
			return(false);
		}	
		$TXNO='9731';
		#paybankaccount=rtrim(#paybankaccount);
		#AC_NO=substr(#paybankaccount,0,24)+space(24-len(#paybankaccount))+'';
		$FD102=#AC_NO+#AC_SEQN;
		commsend_001();
		callserver();
		if($FD12!='0000')
		{
			showmsg(geterror());
			return(true);
		}
		@avbal=substr($FD102,205,16);
		#AVBAL=atoi(@avbal)/100;	
	}"
	</ONLOSTFOCUS>
	</ITEM>
	<ITEM LINE="19" COL="4" TYPE="%-6s" FUNCTIONS="T(摘要:)"/>
  <ITEM LINE="19" COL="10" TYPE="%-50s" NAME="#BRF" INPUT="TEXT" FUNCTIONS="V(NB)" />
	<ITEM LINE="21"  COL="65" NAME="#SUBMIT" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT" />

</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
	<PACKAGE DEVICE="SCREEN"  DESC="交易完成">  
		NOTHING
 </PACKAGE>
	<PRINT>
	"{
		//print( 6,10,' 财政支付成功');
		print( 8, 5,' 财政凭证编号: [20] ',#printid);
		//print( 9, 5,' 支付交易序号: [20] ',#ORDERNO);
		print(10, 5,' 付款    方式: [20] ',#TXTYPENAME);
	}"
	</PRINT>
</RESPONSE>

<RESPONSE>
	<PACKAGE DEVICE="PRINTER" LINESPACE="24"  DESC="请打印支票"  CHECK="#txtype=1">
		NOTHING
	</PACKAGE>
	<PRINT>
	"{
		dim @tx_code as string;
		dim @pjmc as string;
		@tx_code='5514';
     if(#VOCTYPE1=='001')
        {
          @pjmc='现金支票';
        }
        else if (#VOCTYPE1=='002')
        {
          @pjmc='转账支票';
        }
		print(14,10,'[4]  [8]  [24]  [16]',@tx_code,$HDATE,#paybankaccount,#VOCNUM);
		print(15,10,'借:[16]  [6]          [6]',delspace(ltrim(comma(itoa(#TX_AMT,'%14.2f'),14))),$TLRNO,substr($FD126,2,6));
	}"
	</PRINT>
</RESPONSE>

<RESPONSE>
<!----
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="请打印业务专用凭证" CHECK="#txtype=1">
---->
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="请打印业务专用凭证" >
NOTHING
</PACKAGE>
<PRINT>
"{
        $KINDNO='00';
        dim @txtime as string;
        dim @tptype as string;
        @txtime = substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
        if(#paybilltype=='1')
        {
          @tptype='直接支付';
        }
        else
        {
          @tptype='授权支付';
        }
        print( 5,10,'机构名称:[30]',$BRNAME);
        print( 5, 5,'代码:[4]',#TXNUMBER);
        print( 5, 5,'交易名称:财政拨款支付');
        print( 6,10,'委 托 日 期:[8]',$HDATE);
        print( 7,10,'财政凭证编号:[30] 支付方式:[8] ',#printid,@tptype);
        print( 8,10,'付款人帐号:[24]',#paybankaccount);
        print( 9,10,'付款人名称:[60]',#PAY_NAME);
        print( 10,10,'收款人帐号:[32]',#CASH_AC_NO);
        print(11,10,'收款人名称:[60]',#CASH_NAME);
        print(12,10,'金      额:[21]',delspace(ltrim(comma(itoa(#TX_AMT,'%14.2f'),14))));
        if( #txtype=='1' )  //当行内支付并且支付类型为授权支付时打印凭证
        {
        print(13,10,'凭证  类型:[8 ]',#VOCNAME);
        print(14,10,'凭证  号码:[16]',#VOCNUM);
        }
        
        printacdtl_1();
        print(21,10,'交易日期:[8]',$HDATE);
        print(21,5,'柜员:[6]',$FD7);
        print(21,5,'柜员流水号:[6]',substr($FD126,2,6));

      }"
  </PRINT>
</RESPONSE>
<!-------------------------
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="24"  DESC="请打印业务专用凭证" CHECK="#txtype=2">
NOTHING
</PACKAGE>
<PRINT>
"{
        $KINDNO='00';
        dim @txtime as string;
        dim @tptype as string;
        @txtime = substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
        if(#paybilltype=='1')
        {
          @tptype='直接支付';
        }else{
          @tptype='授权支付';
        }    
        print( 4,10,'机构名称:[30]',$BRNAME);
        print( 4, 5,'代码:[4]',#TXNUMBER);
        print( 4, 5,'交易名称:财政拨款大额支付');
        print( 5,10, '财政凭证编号:[30] 支付方式:[8] ',#printid,@tptype);
        print( 6,10, '委 托 日 期:[8]                  支付交易序号:[8]     ',$HDATE,#ORDERNO);
        print( 7,10, '业 务 类 型:[20]      接收行行号:[12]',#CMTNO,#AC_BR_NO);
        print( 8,10, '付款人帐号 :[24]       ',#paybankaccount);
        print(9,10, '付款人名称 :[60]',#PAY_NAME);
       
        print(10,10, '汇款金额:[21] ',delspace(ltrim(comma(itoa(#TX_AMT,'%14.2f'),14))));
        print(11,10, '收款人开户行:[12]             对方清算行号: [12]',#CASH_OPN_BR_NO,#CASH_QS_NO);
        print(12,10,'收款人帐号:[32]',#CASH_AC_NO);
        print(13,10,'收款人名称:[60]',#CASH_NAME);
        printacdtl_1();
        print(20,10,'交易日期:[8]',$HDATE);
        print(20,5,'柜员:[6]',$FD7);
        print(20,5,'柜员流水号:[6]',substr(#FD126,2,6));

      }"
  </PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="24"     DESC="请打印业务专用凭证" CHECK="#txtype=3">
NOTHING
</PACKAGE>
<PRINT>
	"{
          $KINDNO='00';
          dim @txtime as string;
          dim @tptype as string;
          @txtime = substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
          if(#paybilltype=='1'){
            @tptype='直接支付';
          }else{
            @tptype='授权支付';
          }    
          print( 4, 10,'机构名称:[30]',$BRNAME);  
          print( 4, 5,'代码:1250');
          print( 4, 5,'交易名称:财政拨款小额支付');
          print( 5,10, '财政凭证编号:[30] 支付方式:[8] ',#printid,@tptype);
          print( 7,10, '支付交易序号:[8       ]                      委托日期:[8       ]',#ORDERNO,$HDATE);
          print( 8,10, '接收行 行 号:[12          ]',#AC_BR_NO);
          print( 9,10, '收款人开户行:[12          ]',#CASH_OPN_BR_NO);

          print(10,10, '付款人 帐 号:[24                      ]',#paybankaccount);
          print(11,10, '付款人 名 称:[60                                                          ]',#PAY_NAME);

          print(13,10, '交 易  金 额:[21                   ]',delspace(ltrim(comma(itoa(#TX_AMT,'%14.2f'),14))));
          print(14,10, '收款人 帐 号:[32                              ]',#CASH_AC_NO);
          print(15,10, '收款人 名 称:[60                                                          ]',#CASH_NAME);
          print(16,10, '附        言:[60                                                          ]',#BRF);
          printacdtl_1();     
          print(23,10,'交易日期:[8]',$HDATE);
          print(23,5,'柜员:[6]',$FD7);
          print(23,5,'流水号:[6]',substr(#FD126,2,6));
          print(24,10,'备注:');
      }"
  </PRINT>
</RESPONSE>
------------->
<LASTWORK>
"{
       if(#txtype == '2')
       {
           open('5101.XML', '');
       }
       else if(#txtype == '3')
       {
           open('5301.XML', '');
       }
       else if(#txtype == '4')
       {
           open('6131.XML', '');
       }
}"
</LASTWORK>
</TRANSACTION>
