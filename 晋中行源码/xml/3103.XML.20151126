<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11000000" TITLE="3103 储蓄定期开户"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
  initfd();
	commsend_001();
	if(#CASHCD == '1')  //现金
	{
		$FD102 = space(24)+#SEQNO+space(72)+space(8,'0')+getitems('#TXAMT')+space(51)+space(16,'0')+space(6)+#SEQNO2+#PRTNB;
	}
	else                //转帐
	{
		$FD102 = #TRAN_AC_NO+space(24-len(#TRAN_AC_NO))+#SEQNO_102+#TRAN_CTY+#TTRAN_CNM+space(1)+#TRAN_PDOT+space(6)+#TRAN_PWD+#TRAN_CDOT+#TRAN_CNUM+space(20-len(#TRAN_CNUM))+#TRAN_SDOT+space(17)+#STDAY+space(8-len(#STDAY))+getitems('#TXAMT')+#TRAN_CET+#TRAN_NAME+getitems('#TRAN_BAL')+#TRAN_CUR+#CASHCD+#ZY_TP+space(3-len(#ZY_TP))+#ACTLX+#SEQNO2+#PRTNB+space(80)+#SPECIAL+#TRAN_PDN+#TRAN_AC_NO+space(24-len(#TRAN_AC_NO))+space(1)+#ZY;  
	}
	//$FD103=getitems('#PRDTNO#CPMC#CURCD_P#ACTYPE#ZHZL#INTSTYPE#AVBAL#NAME_P#XSZH#CQ#CQDW#DQCKLX#ACTSEQ_P#CASHFLAG');
	commsend_103();
	commsend_116();
	//$FD115 = space(1)+#PSWDCD+space(6)+#PASSWD+#CERTCD+#ZJHM2+space(1)+#ZJLX2;2010.01.15注销此行，刘海军邮件，梁皓然修改
	$FD115 = space(1)+#PSWDCD+space(6)+getitems('#PASSWD')+#CERTCD+#ZJHM2+space(1)+#ZJLX2;
	$FD118 = #CURCD+space(19)+space(16,'0');
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>
<FIRSTWORK>
"{
  #PIC='';
}"
</FIRSTWORK>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-54s" FUNCTIONS=
    "T(3103                          储蓄定期开户)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
   
  <ITEM NAME="#TXNO"        TYPE="%-4s"  FUNCTIONS="T($TXNO=2103)"/>
  <ITEM NAME="#MSGTYPE"     TYPE="%-5s"  FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM NAME="#TX_ACT_TYPE" TYPE="%-1s"  FUNCTIONS="T(2)"/>
  <ITEM NAME="#SEQNO"       TYPE="%4s"   FUNCTIONS="T(0000)"/>         <!---帐户序号---> 
  <ITEM NAME="#SEQNO2"      TYPE="%4s"   FUNCTIONS="T(0000)"/>         <!---帐户序号2---> 
  <ITEM NAME="#PRTNB"       TYPE="%1s"   FUNCTIONS="T(1)"/>            <!---打折标志---> 
  <ITEM NAME="#TXCD"        TYPE="%4s"   FUNCTIONS="T(3103)"/>         <!---交易代码---> 
  <ITEM NAME="#TXNAME"      TYPE="%-12s" FUNCTIONS="T(储蓄定期开户)"/> <!---交易名称---> 
  
  
  <!-- 输入客户信息 -->  
  <ITEM NAME="#CP_SERV"   TYPE="%-4s"  FUNCTIONS="T(9728)"/>
  <ITEM NAME="#JZ_SERV"   TYPE="%-4s"  FUNCTIONS="T(9729)"/>
  <ITEM NAME="#CARD_SERV" TYPE="%-4s"  FUNCTIONS="T(9738)"/>
  <ITEM NAME="#PZ_SERV"   TYPE="%-4s"  FUNCTIONS="T(9782)"/>
  <ITEM NAME="#RETACTNO"  TYPE="%-19s" FUNCTIONS=""/>       <!---刷磁条用帐号--->
	<IMPORT>OPN_ACCT_DEFAULT.IMP</IMPORT>

  
  <!-- 输入产品信息 -->
  <IMPORT>OPN_ACCT_PAGE1.IMP</IMPORT>
  
  <!-- 转帐：输入对方帐户信息 -->
  <IMPORT>OPN_ACCT_PAGE2.IMP</IMPORT>
  <!----晋中目前对公和储蓄都用一种存单,因此设此标志  20070429---->
  <ITEM NAME="#LP_FLAG"   TYPE="%-1s"  FUNCTIONS="j(#TXCD=3103and#JZZL=0013,T{1})"/><!----储蓄存单打印标志---->
  <ITEM NAME="#SELFYN"    TYPE="%-1s"  FUNCTIONS="T(1)"/><!----因打凭证需要设此变量,意为是否本人---->
  <ITEM NAME="#AGENTNAME" TYPE="%-20s" FUNCTIONS=""/>    <!----因打凭证需要设此变量---->
  <ITEM NAME="#SATCETYPE" TYPE="%-20s" FUNCTIONS=""/>    <!----因打凭证需要设此变量---->
  <ITEM NAME="#ATCENUM"   TYPE="%-1s"  FUNCTIONS=""/>    <!----因打凭证需要设此变量---->
  <!----
  <ONLOSTFOCUS>
  "{
	showmsg('FLAG='+#LP_FLAG);
  }"
  </ONLOSTFOCUS>
  </ITEM>
  ---->
 <REQUEST>
 </REQUEST>
 </VARIABLE>
 <REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN"  DESC="交易完成">  
CZFY|@ac_no|@name|@tx_amt1|@title|@opn_date|@opn_br_no|@cif_no|||||@tx_amt1|@email|@zy|@deac_type|@cur_name|@tx_code|@memo|@ac_no1||@ct_name|@ac_seqn|@ic_date|@prt_line|@prdt_no||@brf|@tmp_ac_no|@tmp_tx_name|@tel|@id_name|@id_no|@br_name|@br_tele|@note_no|
</PACKAGE>
<INIT>
"{
}"
</INIT>
<PRINT>
"{
print(8,0,'                       账 /卡号:  [24                       ]                           ',@ac_no);
print(9,0,'                       账户序号:  [24                       ]                           ',@ac_seqn);
#RETACTNO=@ac_no;
}"
</PRINT>
</RESPONSE>
<IMPORT>CX_QK_VOC.IMP</IMPORT>
<IMPORT>CX_CK_VOC.IMP</IMPORT>
<IMPORT>OPN_PRT_VOC.IMP</IMPORT>
<IMPORT>CXCZ.IMP</IMPORT>
<LASTWORK>"{
	if(#JZZL!='0013'){
		showmsg('请按任意键刷存折...');
		if(writemsr(#RETACTNO,'')){
			showmsg('写磁成功!');
		}else{
			showmsg('写磁失败!');
		}
	}
}"
</LASTWORK>
</TRANSACTION>
