<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110100000000000000000000000000" TITLE="1250 退款凭证录入支付信息"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	 
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-50s" FUNCTIONS=
	"T(1250                       退款凭证录入支付信息)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5630)"/>
  <ITEM NAME="#TXNAME" TYPE="%-12s" FUNCTIONS="T(退款凭证录入支付信息)"/><!---交易名称--->
  <ITEM NAME="#TXNUMBER" TYPE="%-4s" FUNCTIONS="T(1250)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  
  <BLOCK LINE="4" COL="10" >
  <ITEM LINE="4" COL="0" TYPE="%-60s"  FUNCTIONS="T(请输入 退款请求报文导入 交易产生的报文流水号)"/>
  
  <ITEM LINE="6" COL="8" TYPE="%-14s"  FUNCTIONS="T(  报文流水号:)"/>
  <ITEM LINE="6" COL="22" TYPE="%-10s" NAME="#PackNo" INPUT="TEXT" FUNCTIONS="V(NB)" />	
 
   
  <ITEM LINE="7" COL="8"  TYPE="%-14s" NAME="#LOri_NOTE_NO" INPUT="LABEL"    FUNCTIONS="T(原支付凭证号: )"/>
  <ITEM LINE="7" COL="22" TYPE="%-16s" NAME="#Ori_NOTE_NO" INPUT="TEXT"   FUNCTIONS="V(NB)"/>
  
  <ITEM LINE="8" COL="8"  TYPE="%-14s"  NAME="#LCMTNO"  INPUT="LABEL"      FUNCTIONS="T(CMT     编号:)"/>
  <ITEM LINE="8" COL="22" TYPE="%3s"   NAME="#CMTNO"    INPUT="SELECT"    DEVICE="KEYBOARD" FUNCTIONS="T(100)V(NB)">
    <SELECT>
        <OPTION VALUE="100" TITLE="汇兑"/>
        <OPTION VALUE="101" TITLE="委托收款"/>
        <OPTION VALUE="102" TITLE="托收承付"/>
        <OPTION VALUE="103" TITLE="国库资金汇划"/>
        <OPTION VALUE="105" TITLE="银行间拆借"/>
    </SELECT>
    </ITEM>
  <ITEM LINE="9" COL="8" TYPE="%-14s" INPUT="LABEL" NAME="#LORDER_NO"   FUNCTIONS="T(退款支付序号: )"/>
  <ITEM LINE="9" COL="22" TYPE="%-8s" INPUT="TEXT"  NAME="#ORDER_NO"     FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
	"{
		dim @l as number;
		@l = len(#ORDER_NO);
		if(@l != 8 )
		{
			showmsg('退款支付序号位数错误');
			return(false);
		}
  }"
	</ONLOSTFOCUS>
  </ITEM>
 
  
  </BLOCK>
   
   <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM LINE="21"  COL="59" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>
    "{
        dim @tota as string; 
        dim @filename as string; 
        initfd();
	      commsend_001();
	      $FD16=#TXNO;
	       $FD60=#PackNo;  
	       $FD62=#Ori_NOTE_NO;
	       $FD23=#CMTNO;
         $FD73=#ORDER_NO;
        
	      @tota=calltips();
        if( $FD12!='0000')
        {
            showmsg(geterror());
  		      return(false);
        }
        @filename='../tmp/'+$KINBR+$TTYNAME+#TXNO;
        savefiletxt(@filename,@tota);  
        runoutput();
        call('fview '+@filename); 
    }"
  </ONCLICK> 
   </ITEM> 
</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
	<PACKAGE DEVICE="SCREEN"  DESC="交易完成">  
		NOTHING
	</PACKAGE>
		<PRINT>
		"{
		dim @txtime as string;
		dim @feetype as string;
		@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
		print( 5,20,'报文流水号:[10]',#PackNo);
		print( 7,20,'原支付凭证号:[16]',#Ori_NOTE_NO);
		print( 9,20,'CMT     编号:[3]',#CMTNO);
		print(11,20,'退款支付序号:[3]',#ORDER_NO");	
		print_sq();
		print(23,20,'备注:');
		print(23,27,'交易日期:[8] [8]',$HDATE,@txtime);
		print(23,5,'柜员:[4]',$FD7);
		print(23,5,'流水号:[6]',$FD4);	
			
		}"
		</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" DESC="请打印凭证" LINESPACE="24" >
NOTHING
</PACKAGE>
<INIT>
"{
$KINDNO='00';
}"
</INIT>
<PRINT>
"{
		dim @txtime as string;
		dim @feetype as string;
		@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
		print( 5,20,'机构名称:[30]',$BRNAME);
		print( 5, 2,'代码:[4]',#TXNUMBER);
		print( 5,13,'交易名称:[20]',#TXNAME);	
		print( 7,30,'\L0退款凭证录入支付信息凭证\L1');			
		print( 9,20,'报文流水号:[10]',#PackNo);
		print( 10,20,'原支付凭证号:[16]',#Ori_NOTE_NO);
		print( 11,20,'CMT     编号:[3]',#CMTNO);
		print(12,20,'退款支付序号:[10]',#ORDER_NO");	
		print_sq();
		print(24,20,'备注:');
		print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
		print(24,5,'柜员:[4]',$FD7);
		print(24,5,'流水号:[6]',$FD4);	

}"
</PRINT>
</RESPONSE>

<OUTPUT>
</OUTPUT>

</TRANSACTION>

