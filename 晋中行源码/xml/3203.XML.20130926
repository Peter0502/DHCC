<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11000000" TITLE="3203 储蓄部提业务"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	  commsend_001();
    $MSGTYPE='03001';
    $TXNO='2203';
    $FD2=$OPNBR;
    $FD3=$KINBR;
    $FD5=$HDATE;
    $FD6='';
    $FD7=$TLRNO;
    $FD8='';
    $FD9='';
    $FD10=$TTYNAME;
    $FD16='2203';

   #NEWVOCNUM=#NVOCNUM;
   #TXAMT15=itoa(#TXAMT*100,'%016.0f');
   if(#CASHFLAG=='2')
    {
	$FD101=getitems('#101ACTNO#101ACSEQ#101AMT#101VOCTYPE#101VOCNUM#101DSCPT#101CARDFLAG#101CNAME#101AVBAL#101CURCD#101CASHFLAG#101DSCTYPE#101ACTYPE#101ACSEQ2#101PNAME');
    }
  else
  {
   $FD101=getitems('#ACTNO24#ACTSEQ#TXAMT15#VOCTYPE#VOCNUM#DESC10#NBCD#CUSTNAME#AVBAL#CURCD#CASHFLAG#DSCPT#ACTTYPE#PRODNAME');
  }
   $FD102=getitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PASSWDFLAG#QUE_PWD#DRAW_PWD#CERTFLAG#CERTNO#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CASHFLAG#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10');

}"
</COMMSEND>

<COMMRECV>"{
	commrecv_001();
	$PBLINE='05';
	$KINDNO='02';
}"
</COMMRECV>
<FIRSTWORK>
"{
  #PIC='';
}"
</FIRSTWORK>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(3203                          储蓄部提业务)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO"      TYPE="%-4s"  FUNCTIONS="T($TXNO=2203)"/>
  <ITEM NAME="#MSGTYPE"   TYPE="%-5s"  FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM NAME="#ACT_LX"    TYPE="%-1s"  FUNCTIONS="T(1)"/>
  <ITEM NAME="#ACT_LX_CK" TYPE="%-1s"  FUNCTIONS=""/>
  <ITEM NAME="#JZZL_3203" TYPE="%-1s"  FUNCTIONS="T()"/> 
  <ITEM NAME="#TXCD"      TYPE="%4s"   FUNCTIONS="T(3203)"/>      <!---交易代码---> 
  <ITEM NAME="#TXNAME"    TYPE="%-10s" FUNCTIONS="T(储蓄部提)"/>  <!---交易名称---> 
  
 <PAGE NAME="DEFAULT">
  <ITEM LINE="5" COL="5"  TYPE="%-12s" FUNCTIONS="T(账 /卡号:)"/>
  <ITEM LINE="5" COL="41" TYPE="%-12s" FUNCTIONS="T(账户序号:)" NAME="#S_SEQNO" INPUT="LABEL" VISABLE="FALSE"/>
  <ITEM LINE="5" COL="40" TYPE="%-10s" FUNCTIONS="T(照    片:)"/>
  <ITEM LINE="7" COL="4"  TYPE="%-16s" VISABLE="TRUE" FUNCTIONS="T(【产品信息】)"/>
  <ITEM LINE="8" COL="5"  TYPE="%-70s" VISABLE="TRUE" FUNCTIONS="T(-----------------------------------------------------------------------)"/>
  
  <ITEM NAME="#ACTNO" LINE="5" COL="15" TYPE="%-19s" INPUT="TEXT" FUNCTIONS=""/>

  <ITEM NAME="#CON1"    TYPE="%-1s" >
  <ONLOSTFOCUS>
 "{
        $MSGTYPE='03001';
        $TXNO='9953';
        $FD2=$OPNBR;
        $FD3=$KINBR;
        $FD5=$HDATE;
        $FD6='';
        $FD7=$TLRNO;
        $FD8='';
        $FD9='';
        $FD10=$TTYNAME;
        $FD16='9953';
        $FD102=#ACTNO;

        callserver();
        if($FD12!='0000')
        {
            showmsg(geterror());
            return(false);
        }
       if($FD2!=$FD3)
       {
            showmsg('部提请到开户行!');
            return(false);
        }

		#SEQNO=substr($FD102,24,4);
		if(atoi(#SEQNO) &gt; 0)
		{
			show(#SEQNO,true);
			show(#S_SEQNO,true);
			show(#S_NVOCNUM,false);
			show(#NVOCNUM,false);
			#JZZL_3203='2';
			return(true);
		}else{
		  #JZZL_3203='1';
			show(#S_NVOCNUM,true);
			show(#NVOCNUM,true);
		}
		setitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PASSWDFLAG#QUE_PWD#SDRAW_PWD#CERTFLAG#CERTNO#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CASHFLAG#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10',$FD102);
		//#AVBAL2=atoi(#AVBAL)/100;
		//showmsg('2序号='+#SEQNO);

		showblock('ACTINFO',true,true);

		if(#PASSWDFLAG=='N')
		{
			show(#S_PASS,false);
			show(#DRAW_PWD,false);
		}else{
			show(#S_PASS,true);
			show(#DRAW_PWD,true);
			#DRAW_PWD='';
		}
		if(#CERTFLAG=='N')
		{
			show(#CERTTYPE,false);
			show(#CERTNO,false);
			show(#S_CERTTYPE,false);
			show(#S_CERTNUM,false);
		}else{
			show(#S_CERTTYPE,true);
			show(#S_CERTNUM,true);
			show(#CERTTYPE,true);
			show(#CERTNO,true);
		}

		enable(#CUSTNAME,false);
		enable(#CURCD,false);
		//enable(#AVBAL2,false);
		enable(#AVBAL,false);
		enable(#PRODNAME,false);
		enable(#VOCTYPE,false);
		enable(#VOCNUM,false);
		enable(#PASSWDFLAG,false);
		enable(#CERTFLAG,false);
		enable(#CERTTYPE,false);

  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 start-->
  <ITEM NAME="#LYACNO" TYPE="%-19s" FUNCTIONS="" />
  <ITEM LINE="5" COL="50" LINES="160" COLS="120" NAME="#PIC" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#ACTNO;
      call_96641();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 end-->
  <ITEM NAME="#SEQNO" LINE="5" COL="51" TYPE="%4d"   INPUT="TEXT" FUNCTIONS="" VISABLE="FALSE"/>

  <ITEM NAME="#CON5"    TYPE="%-1s" >
  <ONLOSTFOCUS>
 "{
		if(atoi(#SEQNO)==0)
		{
			return(true);
		}
        $MSGTYPE='03001';
        $TXNO='9928';
        $FD2=$OPNBR;
        $FD3=$KINBR;
        $FD5=$HDATE;
        $FD6='';
        $FD7=$TLRNO;
        $FD8='';
        $FD9='';
        $FD10=$TTYNAME;
        $FD16='9928';
        $FD102=#ACTNO+space(24-len(#ACTNO))+#SEQNO;

        callserver();
        if($FD12!='0000')
        {
            showmsg(geterror());
            return(false);
        }
        if($FD2!=$FD3)
        {
            showmsg('部提请到开户行!');
            return(false);
        }

		setitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PASSWDFLAG#QUE_PWD#SDRAW_PWD#CERTFLAG#CERTNO#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CASHFLAG#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10',$FD102);		
		//#AVBAL2=atoi(#AVBAL)/100;

		if(len(#ACTNO)==13)
		{
		#ACCOUNTFLAG='1';
		}
		showblock('ACTINFO',true,true);

		if(#PASSWDFLAG=='N')
		{
			show(#S_PASS,false);
			show(#DRAW_PWD,false);
		}else{
			show(#S_PASS,true);
			show(#DRAW_PWD,true);
			#DRAW_PWD='';
		}
		if(#CERTFLAG=='N')
		{
			show(#CERTTYPE,false);
			show(#CERTNO,false);
			show(#S_CERTTYPE,false);
			show(#S_CERTNUM,false);
		}else{
			show(#S_CERTTYPE,true);
			show(#S_CERTNUM,true);
			show(#CERTTYPE,true);
			show(#CERTNO,true);
		}

		enable(#CUSTNAME,false);
		enable(#CURCD,false);
		//enable(#AVBAL2,false);
		enable(#AVBAL,false);
		enable(#PRODNAME,false);
		enable(#VOCTYPE,false);
		enable(#VOCNUM,false);
		enable(#PASSWDFLAG,false);
		enable(#CERTFLAG,false);
		enable(#CERTTYPE,false);

  }"
  </ONLOSTFOCUS>
  </ITEM>

  <BLOCK NAME="ACTINFO" LINE="9" COL="5" VISABLE="FALSE">
	  <ITEM LINE="0"  COL="0"  TYPE="%-12s" FUNCTIONS="T(户    名:)"/>
	  <ITEM LINE="1"  COL="0"  TYPE="%-12s" FUNCTIONS="T(币    种:)"/>
	  <ITEM LINE="2"  COL="0"  TYPE="%-12s" FUNCTIONS="T(金    额:)"/>
	  <ITEM LINE="3"  COL="0"  TYPE="%-12s" FUNCTIONS="T(产品名称:)"/>
	  <ITEM LINE="5"  COL="0"  TYPE="%-12s" FUNCTIONS="T(凭证种类:)"/>
	  <ITEM LINE="5"  COL="41" TYPE="%-12s" FUNCTIONS="T(原凭证号:)"/>
	  <ITEM LINE="6"  COL="0"  TYPE="%-12s" FUNCTIONS="T(密码支取:)"/>
	  <ITEM LINE="6"  COL="41" TYPE="%-12s" FUNCTIONS="T(输入密码:)" NAME="#S_PASS" INPUT="LABEL" VISABLE="FALSE"/>
	  <ITEM LINE="7"  COL="0"  TYPE="%-12s" FUNCTIONS="T(现转标志:!)"/>
	  <ITEM LINE="7"  COL="41" TYPE="%-12s" FUNCTIONS="T(证件支取:)"/>
	  <ITEM LINE="8"  COL="41" TYPE="%-12s" FUNCTIONS="T(证件类型:!)" NAME="#S_CERTTYPE" INPUT="LABEL" VISABLE="FALSE"/>
	  <ITEM LINE="9"  COL="41" TYPE="%-12s" FUNCTIONS="T(证件号码:)"  NAME="#S_CERTNUM"  INPUT="LABEL" VISABLE="FALSE"/>
	  <ITEM LINE="9"  COL="0"  TYPE="%-12s" FUNCTIONS="T(发 生 额:)"/>
	  <ITEM LINE="10" COL="0"  TYPE="%-12s" FUNCTIONS="T(新凭证号:)"  NAME="#S_NVOCNUM"  INPUT="LABEL" VISABLE="FALSE"/>

	  <ITEM NAME="#CUSTNAME"  LINE="0" COL="10" TYPE="%-60s" INPUT="TEXT" FUNCTIONS=""/>
	  <ITEM NAME="#CURCD"     LINE="1" COL="10" TYPE="%-2s" INPUT="SELECT" FUNCTIONS="">
	  <SELECT>
        <OPTION VALUE="01" TITLE="0.人民币"/>
        <OPTION VALUE="12" TITLE="0.英镑"/>
        <OPTION VALUE="13" TITLE="0.港元"/>
        <OPTION VALUE="14" TITLE="0.美元"/>
        <OPTION VALUE="15" TITLE="0.瑞士法郎"/>
        <OPTION VALUE="27" TITLE="0.日元"/>
        <OPTION VALUE="28" TITLE="0.加元"/>
        <OPTION VALUE="29" TITLE="0.澳元"/>
        <OPTION VALUE="38" TITLE="0.欧元"/>
	  </SELECT>
	  </ITEM>
	<!---
	  <ITEM NAME="#AVBAL2"   LINE="3" COL="10" TYPE="%17.2f" INPUT="TEXT" FUNCTIONS=""/>
	--->
	  <ITEM NAME="#AVBAL"    LINE="2" COL="10" TYPE="%17.2f" INPUT="TEXT" FUNCTIONS=""/>
	  <ITEM NAME="#PRODNAME" LINE="3" COL="10" TYPE="%-30s"  INPUT="TEXT" FUNCTIONS=""/>

	  <ITEM NAME="#VOCTYPE" LINE="5" COL="10" TYPE="%-3s" INPUT="SELECT" FUNCTIONS="">
	  <SELECT>
        <OPTION VALUE="000" TITLE="无单折            "/>
        <OPTION VALUE="006" TITLE="单位通知存单      "/>
        <OPTION VALUE="007" TITLE="单位定期证实书    "/>
        <OPTION VALUE="008" TITLE="单位定期存单      "/>
        <OPTION VALUE="010" TITLE="储蓄活期存折      "/>
        <OPTION VALUE="011" TITLE="储蓄零整存折      "/>
        <OPTION VALUE="012" TITLE="贺卡定期储蓄存单  "/>
        <OPTION VALUE="013" TITLE="储蓄整整定期存单  "/>
        <OPTION VALUE="014" TITLE="储蓄存款特种存单  "/>
        <OPTION VALUE="015" TITLE="储蓄定活两便存单  "/>
        <OPTION VALUE="016" TITLE="定期一本通存折    "/>
        <OPTION VALUE="017" TITLE="储蓄通知存款存单  "/>
        <OPTION VALUE="018" TITLE="整零及存本取息存折"/>
        <OPTION VALUE="019" TITLE="人民币定期存单    "/>
        <OPTION VALUE="020" TITLE="储蓄卡（普通）    "/>
        <OPTION VALUE="021" TITLE="储蓄卡（职工）    "/>
        <OPTION VALUE="022" TITLE="储蓄卡（银联）    "/>
        <OPTION VALUE="023" TITLE="储蓄卡（国际）    "/>
        <OPTION VALUE="024" TITLE="神农借记磁卡      "/>
        <OPTION VALUE="025" TITLE="神农联名卡        "/>
	  </SELECT>
	  </ITEM>
	  <ITEM NAME="#VOCNUM"  LINE="5" COL="51" TYPE="%-16s"  INPUT="TEXT"   FUNCTIONS=""/>
	  <ITEM NAME="#PASSWDFLAG"   LINE="6" COL="10" TYPE="%-1s"  INPUT="SELECT" FUNCTIONS="V(Y|N)">
      <SELECT>
	  <OPTION VALUE="Y"  TITLE="是"/> 
	  <OPTION VALUE="N"  TITLE="否"/> 
      </SELECT>
      </ITEM>
	  <ITEM NAME="#DRAW_PWD" LINE="6" COL="51" TYPE="%6d"    DEVICE="PINPAD" FUNCTIONS="i()V(NB)">
<ONLOSTFOCUS>
"{
// 直接在这里校验密码了
dim @baktxno as string;
@baktxno=$TXNO;
$TXNO='9317';
commsend_001();
$FD30=#ACTNO;
$FD79=getitems('#DRAW_PWD');
callserver();
$TXNO=@baktxno;
if($FD12!='0000'){
showmsg(geterror());
return (false);
}
}"
</ONLOSTFOCUS>
</ITEM>

	  <ITEM NAME="#CASHFLAG" LINE="7" COL="10" TYPE="%-1s"   INPUT="SELECT" FUNCTIONS="">
      <SELECT>
	  <OPTION TITLE="现金" VALUE="1"/>
	  <!--	只要求现金
	  <OPTION TITLE="转帐" VALUE="2"/>
	  <OPTION TITLE="同城" VALUE="3"/>
	  <OPTION TITLE="大额" VALUE="4"/>
	  -->
      </SELECT>
      </ITEM>
	  <ITEM NAME="#CERTFLAG"   LINE="7" COL="51" TYPE="%-1s"  INPUT="SELECT" FUNCTIONS="">
      <SELECT>
	  <OPTION TITLE="是" VALUE="Y"/>
	  <OPTION TITLE="否" VALUE="N"/>
      </SELECT>
      </ITEM>

	  <ITEM NAME="#TXAMT"   LINE="9" COL="10" TYPE="%17.2f"  INPUT="TEXT" FUNCTIONS="V(0000000000000100,9999999999999999)">
	  <ONLOSTFOCUS>
	  "{  //五万以上输入证件号码
	      //if(#TXAMT &gt; 50000 or #CERTFLAG == 'Y')
	      if(#TXAMT)
		{
			show(#S_CERTTYPE,true);
			show(#S_CERTNUM,true);
			show(#CERTTYPE,true);
			enable(#CERTTYPE,true);
			show(#CERTNO,true);
		}else{
			show(#CERTTYPE,false);
			show(#CERTNO,false);
			show(#S_CERTTYPE,false);
			show(#S_CERTNUM,false);
		}
	  }"
	  </ONLOSTFOCUS>
	  </ITEM>
	  <ITEM NAME="#UTXAMT"  TYPE="%-40s"       FUNCTIONS="U(#TXAMT)"/><!---大写金额--->

	  <ITEM NAME="#CERTTYPE"   LINE="8" COL="51" TYPE="%-1s"  INPUT="SELECT" FUNCTIONS="V(NB)" VISABLE="FALSE">
      <SELECT>
            <OPTION VALUE="1" TITLE="0.身份证"/>
            <OPTION VALUE="2" TITLE="1.户口簿"/>
            <OPTION VALUE="3" TITLE="2.护照"/>
            <OPTION VALUE="4" TITLE="3.军人证"/>
            <OPTION VALUE="5" TITLE="4.回乡证"/>
            <OPTION VALUE="8" TITLE="7.企业代码证"/>
            <OPTION VALUE="9" TITLE="8.组织机构号"/>
            <OPTION VALUE="A" TITLE="9.营业执照"/>
            <OPTION VALUE="B" TITLE="a.经营许可证"/>
            <OPTION VALUE="C" TITLE="b.事业法人证书"/>
      </SELECT>
      </ITEM>
	  <ITEM NAME="#CERTNO"  LINE="9" COL="51" TYPE="%-20s"   INPUT="TEXT" FUNCTIONS="" VISABLE="FALSE">
  <ONLOSTFOCUS>
  "{
	initfd();
    	commsend_001();
    	$FD16='9961';
	$FD30=#ACTNO;    
	callserver();
    	if($FD12!='0000'){
    		showmsg(geterror());
    		return(false);
    	}
	#C_CERTNO=delspace($FD62);
	#C_CERTTYPE=$FD67;
	if(#C_CERTNO != delspace(#CERTNO)) 
	{
	    showmsg('输入的证件号与帐户不匹配');
	    return(false);
	}
	if(#C_CERTTYPE != #CERTTYPE)
	{
	    showmsg('输入的证件类型与帐户不匹配');
	    return(false);
	}
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#C_CERTNO" TYPE="%-20s" FUNCTIONS=""/>
  <ITEM NAME="#C_CERTTYPE" TYPE="%1s" FUNCTIONS=""/>
  <ITEM NAME="#NVOCNUM" LINE="10" COL="10" TYPE="%16d"    INPUT="TEXT" FUNCTIONS="V(NB)"/>


<!-- 定义 FD102 取款交易结构  Added by chenming 2006-6-21  -->
<!-- 
#ACTNO24           24         	账号
#ACTSEQ            4	         账户序号
#VOCTYPE           3	         凭证种类
#VOCNUM            16         	凭证号
#FETCHFLAG         1	         是否任意支取
#PASSWDFLAG        1	         是否凭密
#QUE_PWD           6	         查询密码
#DRAW_PWD          6	          支取密码
#CERTFLAG          1	         是否凭证件支取
#CERTNO           20  	       证件号码
#STAMPFLAG         1	          是否凭印鉴支取
#PASSWDFLAG        1	        是否支付密码器
#PASSWD            16         	支付密码
#PRINTDATE          8	         出票日期
#TXAMT15             16         	金额
#CERTTYPE            1	       证件类型
#CUSTNAME          50         	户名
#AVBAL             16         	余额
#CURCD             2	         币种
#CASHFLAG          1	         现转标志
#DSCPT             3	         摘要选项
#ACTTYPE           1	         帐户类型
#ACTSEQ_2          4	         账户序号2
#ACCOUNTFLAG       1	         打折标志
#INTEREST1        16  	       应付利息
#INTEREST2        16  	       利息税
#INTEREST3        16  	       保值利息
#PAYAMOUNT        16  	       应付总额
#NEWVOCNUM          16         	新凭证号
#SPEFLAG          20  	       特殊标志
#PRODNAME          30         	产品名称
#ACTNO24           24         	账号
#EDUCREDIT   				1	         教育证明
#DESC10            20         	摘要 
--> 
  <ITEM NAME="#ACTNO24"     TYPE="%-24s" FUNCTIONS=""/>  
  <ITEM NAME="#ACTSEQ"      TYPE="%-4s"  FUNCTIONS=""/>
  <!--#VOCTYPE-->
  <!--#VOCNUM-->
  <ITEM NAME="#FETCHFLAG"   TYPE="%1s"   FUNCTIONS=""/>
  <!--#PASSWDFLAG-->
  <ITEM NAME="#QUE_PWD"     TYPE="%6s"   FUNCTIONS=""/>
  <!--#DRAW_PWD-->  <!--保存支取密码--> 
  <ITEM NAME="#SDRAW_PWD"   TYPE="%6s"   FUNCTIONS=""/>
  <!--#CERTFLAG-->
  <!--#CERTNO-->     
  <ITEM NAME="#STAMPFLAG"   TYPE="%1s"   FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG2"    TYPE="%1s"   FUNCTIONS=""/>  
  <ITEM NAME="#PWD16"       TYPE="%-16s" FUNCTIONS=""/>    
  <ITEM NAME="#PRINTDATE"   TYPE="%-8s"  FUNCTIONS=""/>      
  <ITEM NAME="#TXAMT15"     TYPE="%-16s" FUNCTIONS=""/>
  <!--#CERTTYPE-->  
  <!--#CUSTNAME" --> 
  <!--<ITEM NAME="#AVBAL"       TYPE="%-16s" FUNCTIONS=""/>--><!--同名ITEM liangq注-->
  <!--#CURCD"-->
  <!--#CASHFLAG-->
  <ITEM NAME="#DSCPT"       TYPE="%-3s"  FUNCTIONS=""/>
  <ITEM NAME="#ACTTYPE"     TYPE="%-1s"  FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ_2"    TYPE="%-4s"  FUNCTIONS=""/>
  <ITEM NAME="#ACCOUNTFLAG" TYPE="%-1s"  FUNCTIONS=""/>
  <ITEM NAME="#INTEREST1"   TYPE="%-16s" FUNCTIONS=""/>
  <ITEM NAME="#INTEREST2"   TYPE="%-16s" FUNCTIONS=""/>  
  <ITEM NAME="#INTEREST3"   TYPE="%-16s" FUNCTIONS=""/>
  <ITEM NAME="#PAYAMOUNT"   TYPE="%-16s" FUNCTIONS=""/>  
  <ITEM NAME="#NEWVOCNUM"   TYPE="%-16s" FUNCTIONS=""/> 
  <ITEM NAME="#SPEFLAG"     TYPE="%-20s" FUNCTIONS=""/>    
  <!--#PRODNAME --> 
  <ITEM NAME="#ACTNO_24"    TYPE="%-24s" FUNCTIONS=""/> 
  <ITEM NAME="#EDUCREDIT"   TYPE="%1s"   FUNCTIONS=""/>   
  <ITEM NAME="#DESC10"      TYPE="%-10s" FUNCTIONS=""/>
  <ITEM NAME="#NBCD"        TYPE="%-1s"  FUNCTIONS=""/>

	<ITEM NAME="#CON2"    TYPE="%-1s" >
	<ONLOSTFOCUS>
	"{
		if(#SEQNO!='0000')
		{
			return(true);
		}

		$MSGTYPE='03001';
		$TXNO='9971';
		$FD2=$OPNBR;
		$FD3=$KINBR;
		$FD5=$HDATE;
		$FD6='';
		$FD7=$TLRNO;
		$FD8='';
		$FD9='';
		$FD10=$TTYNAME;
		$FD16='9971';
		
		#NEWVOCNUM=#NVOCNUM;
		$FD102=getitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PASSWDFLAG#QUE_PWD#DRAW_PWD#CERTFLAG#CERTNO#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CASHFLAG#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10');
		
		callserver();
		if($FD12!='0000')
		{
			showmsg(geterror());
			return(false);
		}
	}"
	</ONLOSTFOCUS>
	</ITEM>
  </BLOCK>
  </PAGE>
  
  <ITEM NAME="#CON3" TYPE="%-1s" >
  <ONLOSTFOCUS>
  "{
  		if(#CASHFLAG=='2')
  		{
  		  show(#COMP,false);
  			show(#NT_PAGE,true);
  		}else{
  		  show(#NT_PAGE,false);
  		  show(#COMP,true);
  		}
  }"
  </ONLOSTFOCUS>
  </ITEM> 
  
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(下一页)" INPUT="BUTTON" NAME="#NT_PAGE" VISABLE="FALSE">
  <ONCLICK>"{
    loadpage('PAGE2');
  }"
  </ONCLICK>
  </ITEM>
  
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT" NAME="#COMP"    VISABLE="TRUE"/>

 	 <IMPORT>TRANSINFO.IMP</IMPORT>

  <!--输出变量--->

  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD"   TYPE="%-6s"   FUNCTIONS="T()"/>
  <ITEM NAME="#TXAVBAL"  TYPE="%17.2f" FUNCTIONS="J(#UTXAVBAL)"/> <!---新存单金额--->
  <ITEM NAME="#UTXAVBAL" TYPE="%-40s"  FUNCTIONS="U(#TXAVBAL)"/> <!---新存单大写金额--->

 

</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="显示信息">
NOTHING
</PACKAGE>
<PRINT>
"{
print(03,30,'储蓄部提');
print(05,20,'新 帐 号:[24                        ]',substr($FD102,343,24));
print(06,20,'本    金:[21                        ]',ltrim(comma(substr($FD102,108,14)+'.'+substr($FD102,122,2))));
print(07,20,'应付利息:[21                        ]',ltrim(comma(substr($FD102,213,14)+'.'+substr($FD102,227,2))));
print(08,20,'利 息 税:[21                        ]',ltrim(comma(substr($FD102,229,14)+'.'+substr($FD102,243,2))));
print(09,20,'保值利息:[21                        ]',ltrim(comma(substr($FD102,245,14)+'.'+substr($FD102,259,2))));
print(11,20,'应付总额:[21                        ]',ltrim(comma(substr($FD102,261,14)+'.'+substr($FD102,275,2))));
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="11" DESC="请打印原存单" CHECK="#JZZL_3203=1"><!---根据现在的存单格式，只能用利息清单的内容--->
LXQD|@ac_no|@name|@tx_amt|@title|@opn_date|@opn_br_no|@av_bal|@all_inter|@in_tax|@tax_rate|@tax_inter|@after_inter|@c_txamt|@zero_amt|@inst_type|@memo|@ac_seqn|@term||@brf|@ac_no1||@mtr_date||@rate|@prdt_no|
</PACKAGE>
<INIT>
"{
$KINDNO='00';
}"
</INIT>
<PRINT>
"{
dim @txamt as string;
dim @avbal as string;     //部提或销户后余额
dim @interest as string;  //总利息
dim @taxamt as string;    //利息税
dim @realint as string;   //实付利息
dim @realbal as string;   //实付本息

@avbal    = ltrim(comma(@av_bal,16));
@txamt    = ltrim(comma(@tx_amt,16));
@interest = ltrim(comma(@all_inter,16));
@taxamt   = ltrim(comma(@in_tax,16));
@realint  = ltrim(comma(@after_inter,16));
@realbal  = ltrim(comma(@c_txamt,16));

print(24,47,'\L0已部提\L1');
print(26, 4,'部提流水号: [6     ]   支取操作员: [4]',$FD4,$TLRNO);
print(28, 4,'交易日期:[8       ]    交易金额:[16              ] 利息:[10        ] 利息税:[10        ]', $HDATE,@txamt,@interest,@taxamt);
print(30,25,'实付本息:[16         ] 新帐号: [19]',@realbal,@ac_no1);
}"
</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24"  DESC="请打印业务专用凭证(储蓄部提)" CHECK="#JZZL_3203=2">
QKPT|@ac_no|@name|@tx_amt1|@title|@opn_date|@opn_br_no|@cif_no||@term|@term_type|@rate|@av_bal|@email|@zy|@deac_type|@cur_name|@tx_code|@memo|@ac_no1||@ct_name|@ac_seqn|@ic_date|@prt_line|@prdt_no||@brf|@tmp_ac_no|@tmp_tx_name|@tel|@id_name|@id_no|@br_name|@br_tele|@note_no||@acc_hrt|
</PACKAGE>
<INIT>
"{
$KINDNO='00';
}"
</INIT>
<PRINT>
"{
dim @txamt  as string;
dim @avbal  as string;
dim @txday  as string;
dim @txtime as string; //交易时间

@txamt  =ltrim(comma(@tx_amt1,16));
@avbal  =ltrim(comma(@av_bal,16));
@txday  =substr($HDATE,0,4)+'-'+substr($HDATE,4,2)+'-'+substr($HDATE,6,2);
@txtime =substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);

print( 5, 20,'机构名称:[30]',$BRNAME);  
print( 5, 2,'代码:3203');
print( 5, 13,'交易:储蓄部提');
print(10, 20,'帐    号:[20                    ]   户    名:[20                    ]',@ac_no,@name);
print(11, 20,'储    种:[20                    ]   利    率:[ 7       ]%               ',@title,@rate);
print(12, 20,'存    期:[2 ][2 ]                   交易金额:[21                       ]',@term,@term_type,@txamt);
print(13, 20,'余    额:[21                       ]  开 户 行:[5    ]',@avbal,@opn_br_no);
print(14, 20,'交易类型:[ 4    ]                   交 易 行:[7       ]',@memo,$KINBR);
print_sq();
print( 24,20,'备注:');
print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
print( 24,5,'柜员:[4]',$FD7);
print( 24,5,'流水号:[6]',$FD4);

}"
</PRINT>
</RESPONSE>

<IMPORT>CX_PRT_LXQD.IMP</IMPORT>

<IMPORT>CX_CK_PZ.IMP</IMPORT>

<IMPORT>CXCZ.IMP</IMPORT>

<!--储蓄定期存单-->
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="11"  DESC="请打印储蓄定期存单" CHECK="#JZZL_3203=1">  
CZFY|@ac_no|@name|@tx_amt1|@title|@opn_date|@opn_br_no|@cif_no|@end_date|@term|@unit|@rate|@av_bal|@email|@zy|@deac_type|@cur_name|@tx_code|@memo|@ac_no1|@intr|@ct_name|@ac_seqn|@ic_date|@prt_line|@prdt_no||@brf|@tmp_ac_no|@tmp_tx_name|@tel|@id_name|@id_no|@br_name|@br_tele|@note_no|@zdzc|@acc_hrt|
</PACKAGE>
<PRINT>
"{
dim @txamt as string;
dim @interest as string;
dim @crate as string;    //打印用利率
dim @percent as string;    //百分号  
dim @autoflg as string;    //自动转存标志
$KINDNO='00';

@txamt=ltrim(comma(substr(@tx_amt1,0,len(@tx_amt1)-4),16));
if(len(@txamt) &lt; 21)
{
	@txamt=space(21-len(@txamt))+@txamt;
}
@interest=ltrim(comma(@intr,16));
setitems('#TXAVBAL',itoa(val(substr(@tx_amt1,0,len(@tx_amt1)-4),100),'%016.0f'));

if(@prdt_no=='241' or @prdt_no=='242' or @prdt_no=='243') //当为定活和通知时,打印利率、到期息和到期日都为空
{
	@crate   = '';
	@interest= '';
	@end_date= '';
	@percent = '';
}
else
{
	@crate   = @rate;
	@percent = '%';
}
if(@zdzc == '【 自动转存 】')
{
	@autoflg = '是';
}
else
{
	@autoflg = '否';
}

	print( 5,11,'[8]',@opn_date);
	print(10, 4,'[8       ]  [2 ][2 ]  [7      ][1]      [8       ]     [8       ]         [11         ]    [2 ]             [20]',@title,@term,@unit,@crate,@percent,@ic_date,@end_date,@interest,@autoflg,@zy);
	print(14, 9,'\L0[18                ] [20]\L1',@ac_no,@name);
	print(19,20,'\Z0[40]\Z1',#UTXAVBAL);
	print(22,20,'\L0[21]\L1',ltrim(@txamt));
	print(32,91,'[4]',@tel);
	print_sq();
 }"
</PRINT>
</RESPONSE>

</TRANSACTION>
