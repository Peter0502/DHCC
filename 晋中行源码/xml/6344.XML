<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="6344 银 行 本 票 兑 付"
xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>
"{
     initfd();
     //call_9986();
     commsend_001();
     $FD32=#iPoNo;         //本票号码
     $FD44=#iQfDay;        //签发日期
     $FD39=itoa(#iTxAmt*100,'%016.0f'); //出票金额

     $FD3 =$KINBR;
     $FD20='1';
     $FD7=$TLRNO;
     $FD21=#CUR_NO;     // 货币标志
     $FD93='9';
     $FD99='2';
     $FD66='1';         // 借贷标志
  
     //没有了现金和转账本票的区别，现金本票必须先转到挂账科目上
     $FD68='7';         // 帐户类型 1活期帐号 6内部帐户 7科目
     $FD67='2';         // 现转标志

     $FD40=$FD39;       // 交易金额
     #FD10101=#ACTNO24;
     #FD10102=#ACTSEQ;
     #FD10103=$FD39;
     #FD10110='01';
     #FD10111='2';
     $FD27=#O_CashActno;
     $FD101 = getitems('#FD10101#FD10102#FD10103#FD10104#FD10105#FD10106#FD10107#FD10108#FD10109#FD10110#FD10111#FD10112#FD10113#FD10114#FD10115');
     if(#iBpType=='1')
     {
         $FD123=#iBpType+#iAvbalType+#iPoNo+#iCFlag+#iReqNo+getitems('#iPayActNo')+getitems('#iPayName')+getitems('#oCashActno')+getitems('#oCashName')+getitems('#iResume')+getitems('#MAC')+getitems('#TEMPXYY');
     }
     else
     {
         $FD123=#iBpType+#iAvbalType+#iPoNo+#iCFlag+#iReqNo+getitems('#iPayActNo')+getitems('#iPayName')+getitems('#iCashActNo')+getitems('#iCashName')+getitems('#iResume')+getitems('#MAC')+getitems('#TEMPXYY');
     }
    }"
</COMMSEND>
<COMMRECV>
"{
    commrecv_001();
}"
</COMMRECV>
<FIRSTWORK>
"{
  #PIC='';
  #PIC1='';
  show(#PIC,false);
  show(#PIC1,false);
  show(#LBLPIC,false);
  show(#LBLPIC1,false);
  enable(#SETPIC,false);
  enable(#SETPIC1,false);
}"
</FIRSTWORK>
<VARIABLE>
<!--显示内容 -->
<ITEM LINE="3"  COL="3" TYPE="%-70s" FUNCTIONS=
"T(6344                        银 行 本 票 兑 付)"/>
<ITEM LINE="4"  COL="3"  TYPE="%-70s" FUNCTIONS=
"T(───────────────────────────────────)"/>
<ITEM NAME="#TXNO"       TYPE="%-4s"     FUNCTIONS="T($TXNO=6344)"/>
<ITEM NAME="#MSGTYPE"    TYPE="%-5s"     FUNCTIONS="T()"/>
<ITEM LINE="5"   COL="3"  TYPE="%-9s"    FUNCTIONS="T(签发日期:)"/>
<ITEM LINE="6"   COL="3"  TYPE="%-9s"    FUNCTIONS="T(本票号码:)"/>
<ITEM LINE="7"   COL="3"  TYPE="%-9s"    FUNCTIONS="T(签发种类:)"/>

<ITEM LINE="09"  COL="3" TYPE="%-12s"   FUNCTIONS="T(付款人帐号: )"/>
<ITEM LINE="9"     COL="40"  NAME="#LBLPIC" TYPE="%-10s" FUNCTIONS="T(照    片:)"/>
<ITEM LINE="9"     COL="55"  NAME="#LBLPIC1" TYPE="%-10s" FUNCTIONS="T(印    件:)"/>
<ITEM LINE="10"  COL="3" TYPE="%-12s"   FUNCTIONS="T(付款人名称: )"/>
<ITEM LINE="11"  COL="3" TYPE="%-12s"   FUNCTIONS="T(金      额: )"/>
<ITEM LINE="12"  COL="3" TYPE="%-12s"   FUNCTIONS="T(密      押: )"/>

<ITEM LINE="14"  COL="3" TYPE="%-12s"   FUNCTIONS="T(收款人帐号: )"/>
<ITEM LINE="15"  COL="3" TYPE="%-12s"   FUNCTIONS="T(收款人名称: )"/>
<ITEM LINE="16"  COL="3" TYPE="%-14s" NAME="#YSKRHM" INPUT="LABEL" VISABLE="FALSE" FUNCTIONS="T(原收款人名称: )"/>
<ITEM LINE="17"  COL="3" TYPE="%-14s" NAME="#YSKRZH" INPUT="LABEL" VISABLE="FALSE" FUNCTIONS="T(原收款人帐户: )"/>
<ITEM LINE="18"  COL="3" TYPE="%-14s" NAME="#YSKRMC" INPUT="LABEL" VISABLE="FALSE" FUNCTIONS="T(原收款人名称: )"/>
<ITEM LINE="19"  COL="3" TYPE="%-14s"   FUNCTIONS="T(附        言: )"/>
<ITEM LINE="5" COL="12" NAME="#iQfDay" INPUT="TEXT" DEVICE="KEYBOARD" TYPE="%8d"  FUNCTIONS="V(NB)T($HDATE)D()"/>

<ITEM LINE="6" COL="12" NAME="#iPoNo"   TYPE="%16s" DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)">
<ONLOSTFOCUS>
"{
    dim @baktxno as string;
    @baktxno=$TXNO;
    $TXNO='9696';
    $FD11='0';          //  操作类型0,查询
    $FD30=#iPoNo;       //  本票号码
    $FD44=#iQfDay;      //  签发日期
    commsend_001();
    callserver();
    $TXNO=@baktxno;
    if($FD12!='0000')
    {
        showmsg(geterror());
        return(false);
    }
    if($FD98 !='1')
    {
        showmsg('本票状态错误!非签发状态');
        return(false);
    }
    show(#oCashActno,false);
    show(#oCashName,false);
    show(#YSKRZH,false);
    show(#YSKRMC,false);
    enable(#oCashActno,false);
    enable(#oCashName,false);
    
    #iBpType=$FD68;                // 本票类型
    #iCFlag=$FD69;                 // 转出标志
    #iPayActNo=$FD33;              // 付款人帐号
    #iPayName=$FD25;               // 付款人名称
    #tCashActNo=$FD31;             // 收款人帐号
    #tCashName=$FD26;              // 收款人名称
    #iTxAmt=val($FD39,0.01);       // 出票金额

    #iPayName   = rtrim(#iPayName);
    #iPayActNo  = rtrim(#iPayActNo);
    $FD26='';
    $FD30='';
    $FD31='';
    $FD39='';
    $FD68='';
    $FD69='';
    #iPayActNo18 = substr(#iPayActNo,0,32);
    enable(#iBpType    ,true);  
    enable(#iCFlag     ,true);
    enable(#iPayActNo18,false);
    enable(#iPayName   ,false);
    enable(#iTxAmt     ,false);
    #tCashName  = rtrim(#tCashName);
    #tCashActNo = rtrim(#tCashActNo);
}"
</ONLOSTFOCUS>
</ITEM>
    
<ITEM NAME="#iAvbalType" TYPE="%-1s"  FUNCTIONS="T(1)"/>
<!--
<ITEM LINE="6" COL="15" NAME="#iAvbalType" TYPE="%-1s"  DEVICE="KEYBOARD" FUNCTIONS="T(0)V(0|1)">
<SELECT LINE="7" COL="17">
    <OPTION VALUE="0 定额本票"    TITLE="0.定额本票"/>
    <OPTION VALUE="1 不定额本票"  TITLE="1.不定额本票"/>
</SELECT>
</ITEM>
--> 
<ITEM LINE="7" COL="12" NAME="#iBpType" TYPE="%-1s"  DEVICE="KEYBOARD" FUNCTIONS="T(0)V(0|1)">
<SELECT LINE="7" COL="13">
    <OPTION VALUE="0 转帐本票"  TITLE="0.转帐本票  "/>
    <OPTION VALUE="1 现金本票"  TITLE="1.现金本票  "/>
</SELECT>
<ONLOSTFOCUS>
"{
    if(#iBpType=='1')
    {
         #iCFlag='1';
		     dim @baktxno as string;
         @baktxno=$TXNO;
         $TXNO='9406';
         $FD48 = '0008';
         $FD91 = $KINBR;
         commsend_001();
         callserver();
         $TXNO=@baktxno;
         if($FD12!='0000')
         {
              showmsg(geterror());
              return (false);
         }
         #iCashActNo19=substr($FD120,0,20);

         showmsg(#iCashActNo19);
         enable(#iCashActNo19,false);
         show(#oCashActno,true);
         show(#oCashName,true);
         enable(#oCashActno,true);
         enable(#oCashName,true);
         show(#YSKRZH,true);
         show(#YSKRMC,true);
    }
    else
    {
         show(#O_CashActno,true);
         enable(#O_CashActno,true);
         show(#YSKRHM,true);
    }
}"
</ONLOSTFOCUS>
</ITEM>
<ITEM NAME="#iCFlag"   TYPE="%1s"    FUNCTIONS="T(1)"/>
<ITEM NAME="#iReqNo"   TYPE="%10d"   FUNCTIONS="T(1111111111)"/>
<ITEM NAME="#AC_NO"    TYPE="%-24s"  FUNCTIONS=""/>
<ITEM NAME="#AC_SEQN"  TYPE="%-4s"   FUNCTIONS="T()"/>
<ITEM NAME="#ACTYPE"   TYPE="%-1s"   FUNCTIONS="T(1)"/><!--默认帐户类型为帐户1，7表示现金 -->
<ITEM NAME="#CUR_NO"   TYPE="%-2s"   FUNCTIONS="T(01)"/>
<ITEM NAME="#VOCTYPE1" TYPE="%-3s"   FUNCTIONS=""/>
<ITEM NAME="#VOCNUM1"  TYPE="%16d"   FUNCTIONS=""/>
<ITEM NAME="#XZFLG"    TYPE="%-1s"   FUNCTIONS=""/>
<ITEM LINE="09" COL="15" NAME="#iPayActNo18" TYPE="%-19s" DEVICE="KEYBOARD" FUNCTIONS="V(NB)"/>
<ITEM NAME="#iPayActNo" TYPE="%-32s"  FUNCTIONS="T(#iPayActNo18)"/>
<!--added by liuyong 2009-9-15 显示图片信息 start-->
  <ITEM  NAME="#CHECKACNO"  TYPE="%10s" FUNCTIONS="">
 <ONLOSTFOCUS>
 "{
     dim @txnobak as string;
     dim @len as number;
     @len = len(rtrim(#iPayActNo18));
     if(@len != 0 and @len != 3 and @len != 5 and @len != 7)
     {
       @txnobak = $TXNO;
       $TXNO = '9663';
       $FD30 = #iPayActNo18;
       commsend_001();
       callserver();
       if($FD12 !='0000')
       {
         show(#PIC,false);
         show(#PIC1,false);
         show(#LBLPIC,false);
         show(#LBLPIC1,false);
         enable(#SETPIC,false);
         enable(#SETPIC1,false);
       }
       else
       {
         show(#PIC,true);
         show(#PIC1,true);
         show(#LBLPIC,true);
         show(#LBLPIC1,true);
         enable(#SETPIC,true);
         enable(#SETPIC1,true);
       }
       $TXNO = @txnobak;
     }
     
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM NAME="#LYACNO" TYPE="%-19s" FUNCTIONS="" />
  <ITEM LINE="9" COL="50" LINES="160" COLS="120" NAME="#PIC" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#iPayActNo18;
      call_96641();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="9" COL="65" LINES="220" COLS="160" NAME="#PIC1" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC1" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#iPayActNo18;
      call_96642();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 end-->
<ITEM LINE="10"   COL="15" NAME="#iPayName"  TYPE="%-60s"   DEVICE="KEYBOARD"  FUNCTIONS="V(NB)">
    <ONLOSTFOCUS>
    "{
         if(strfldcnt(#iPayName,':') != 1 or strfldcnt(#iPayName,'{') != 1 or strfldcnt(#iPayName,'}') != 1) 
         {
               showmsg('输入内容中不能含有半角:{}字符,请修改为全角其它字符');
               return(false);
         }
    }"
    </ONLOSTFOCUS>
</ITEM>
<ITEM LINE="11"  COL="15" NAME="#iTxAmt"  TYPE="%16.2f" DEVICE="KEYBOARD" FUNCTIONS="V(0000000000000001,0000099999999999)"/>
<ITEM LINE="12"  COL="15" NAME="#MAC"     TYPE="%-20s"   DEVICE="KEYBOARD" FUNCTIONS="V(NB)"/>

<ITEM NAME="#ERRDATE"  TYPE="%1s"  FUNCTIONS=""/>

<ITEM LINE="14"  COL="15" NAME="#iCashActNo19" TYPE="%-32s"   DEVICE="KEYBOARD" FUNCTIONS=""/>
<ITEM NAME="#iCashActNo" TYPE="%-32s"  FUNCTIONS="T(#iCashActNo19)">
  <ONLOSTFOCUS>"{
  	  dim @baktxno as string;
      dim @name as string;
      dim @avbal as string;
      dim @pwd_ind as string;
      dim @actype as string;
      dim @prdt_name as string;
      @baktxno=$TXNO;
      $TXNO='9731';
      #AC_NO=substr(#iCashActNo,0,24)+space(24-len(#iCashActNo))+'';
      $FD102=#AC_NO+#AC_SEQN;
      commsend_001();
      callserver();
      $TXNO=@baktxno;
      if($FD12!='0000')
      {
      	showmsg(geterror());
      	return(false);
      }
      @name=substr($FD102,125,60);
      @avbal=substr($FD102,185,16);
      @pwd_ind=substr($FD102,48,1);
      @actype=substr($FD102,207,1);
      #iCashName=rtrim(@name);
      
      enable(#iCashName,false);
      
      @prdt_name=rtrim(substr($FD102,313,30));
      #TXAMT15=itoa(#iTxAmt*100,'%16.0f');
      showhelp(4,68,5,10,'帐户信息','户名:'+@name+' 余额:'+itoa(val(@avbal,0.01),'%16.2f')+space(6)+' 产品名称:'+@prdt_name);
      setitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PWDFLAG#QUE_PWD#DRAW_PWD#ID_TYPE#CERTNO20#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CT_IND#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10',$FD102);
      
      #ID_NO=rtrim(#CERTNO20);// for test
      #iCashActNo=rtrim(#iCashActNo);
      if(len(#iCashActNo)!=7 and len(#iCashActNo)!=3 and len(#iCashActNo)!=5 )
      {
      	@baktxno=$TXNO;
      	$TXNO = '9405';
        #iCashActNo=substr(#iCashActNo,0,24)+space(24-len(#iCashActNo))+'';
        $FD32=#iCashActNo;
      	commsend_001();
      	callserver();
      	if($FD12!='0000')
      	{
      		showmsg(geterror());
      		return (false);
      	}
      	$TXNO=@baktxno;
      }
 }"	
 </ONLOSTFOCUS>
  </ITEM>
<ITEM LINE="15"  COL="15" NAME="#iCashName"  TYPE="%-60s"  DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
  "{
        if (strfldcnt(#iCashName,':') != 1 or strfldcnt(#iCashName,'{') != 1 or strfldcnt(#iCashName,'}') != 1) 
        {
            showmsg('输入内容中不能含有半角:{}字符,请修改为全角其它字符');
            return(false);
        }
        
    }"
    </ONLOSTFOCUS>
</ITEM>
<ITEM NAME="#O_CashActno"  LINE="16" COL="17" INPUT="TEXT"  VISABLE="FALSE" TYPE="%-60s"   FUNCTIONS="V(NB)"/>
<ITEM NAME="#QS_NO"  TYPE="%-12s"  FUNCTIONS=""/>
<ITEM NAME="#oCashActno"  LINE="17" COL="17" INPUT="TEXT"  VISABLE="FALSE" TYPE="%-32s"   FUNCTIONS="">
 <ONLOSTFOCUS>
"{
if(len(#tCashActNo)!=0)
{
     if(#oCashActno!=#tCashActNo)
      {
          showmsg('原收款帐号与原输入不符!');
          return(false);
      }  
}
}"	
</ONLOSTFOCUS>
</ITEM>
<ITEM NAME="#oCashName"  LINE="18" COL="17"  INPUT="TEXT"  VISABLE="FALSE" TYPE="%-60s"   FUNCTIONS="V(NB)">
 <ONLOSTFOCUS>
"{
     if(#oCashName!=#tCashName)
     {
         showmsg('收款名称与原输入不符!');
         return(false);
     }
     if (strfldcnt(#oCashName,':') != 1 or strfldcnt(#oCashName,'{') != 1 or strfldcnt(#oCashName,'}') != 1) 
     {
         showmsg('输入内容中不能含有半角:{}字符,请修改为全角其它字符');
         return(false);
     }   
}"	
</ONLOSTFOCUS>
</ITEM>
<ITEM LINE="19"  COL="17" NAME="#iResume" TYPE="%-60s"  DEVICE="KEYBOARD" FUNCTIONS="T()">
<ONLOSTFOCUS>
"{
    if(strfldcnt(#iResume,':') != 1 or strfldcnt(#iResume,'{') != 1 or strfldcnt(#iResume,'}') != 1) 
    {
        showmsg('输入内容中不能含有半角:{}字符,请修改为全角其它字符');
        return(false);
    }
}"
</ONLOSTFOCUS>
</ITEM>
  <!-- 102域变量 -->
  <ITEM NAME="#ACTNO24"   	TYPE="%-24s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ"    	TYPE="%-4s" 	FUNCTIONS=""/>
  <ITEM NAME="#VOCTYPE" 	  TYPE="%-3s"  	FUNCTIONS=""/>
  <ITEM NAME="#VOCNUM" 		  TYPE="%16d" 	FUNCTIONS=""/>
  <ITEM NAME="#FETCHFLAG" 	TYPE="%1s" 	  FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG" 	  TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#QUE_PWD" 	  TYPE="%6s" 	  FUNCTIONS=""/>
  <ITEM NAME="#ID_NO" 		  TYPE="%-20s"  FUNCTIONS=""/>
  <ITEM NAME="#CERTFLAG" 	  TYPE="%-1s"  	FUNCTIONS=""/>
  <ITEM NAME="#CERTNO20"    TYPE="%-20s" 	FUNCTIONS=""/>
  <ITEM NAME="#STAMPFLAG" 	TYPE="%1s" 	  FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG2" 	  TYPE="%1s" 	  FUNCTIONS=""/>  
  <ITEM NAME="#PWD16"  		  TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#PRINTDATE" 	TYPE="%-8s" 	FUNCTIONS=""/>      
  <ITEM NAME="#TXAMT15"   	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#CERTTYPE"  	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#CUSTNAME" 	  TYPE="%-50s" 	FUNCTIONS=""/>
  <ITEM NAME="#AVBAL" 		  TYPE="%17.2f" FUNCTIONS=""/>
  <ITEM NAME="#CURCD" 		  TYPE="%-2s"  	FUNCTIONS=""/>
  <ITEM NAME="#CT_IND" 		  TYPE="%-1s"  	FUNCTIONS="T(2)"/>
  <ITEM NAME="#DSCPT"     	TYPE="%-3s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTTYPE"   	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ_2"  	TYPE="%-4s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACCOUNTFLAG" TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#INTEREST1" 	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#INTEREST2" 	TYPE="%-16s" 	FUNCTIONS=""/>  
  <ITEM NAME="#INTEREST3" 	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#PAYAMOUNT" 	TYPE="%-16s" 	FUNCTIONS=""/>  
  <ITEM NAME="#NEWVOCNUM" 	TYPE="%-16d" 	FUNCTIONS=""/>
  <ITEM NAME="#SPEFLAG" 	  TYPE="%-20s" 	FUNCTIONS=""/>    
  <ITEM NAME="#PRODNAME" 	  TYPE="%-30s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTNO_24"   	TYPE="%-24s" 	FUNCTIONS=""/> 
  <ITEM NAME="#EDUCREDIT" 	TYPE="%1s" 	  FUNCTIONS=""/>   
  <ITEM NAME="#DESC10"    	TYPE="%-10s" 	FUNCTIONS=""/>
  <ITEM NAME="#DRAW_PWD"   	TYPE="%-6s"   FUNCTIONS=""/>
  <ITEM  NAME="#ID_TYPE"  	TYPE="%-1s" 	FUNCTIONS=""/>
  <!-----以上是FD102域的内容---->
<!--临时变量-->
<ITEM NAME="#KINBR"   TYPE="%-7s"        FUNCTIONS="T($KINBR)"/>
<ITEM NAME="#tTitle"      TYPE="%-4s"    FUNCTIONS="T(6344)"/>
<ITEM NAME="#tYear"       TYPE="%-4s"    FUNCTIONS="T($HDATE,1,4)J(#oYear)"/>
<ITEM NAME="#tMonth"      TYPE="%-2s"    FUNCTIONS="T($HDATE,5,2)J(#oMonth)"/>
<ITEM NAME="#tDay"        TYPE="%-2s"    FUNCTIONS="T($HDATE,7,2)J(#oDay)"/>
<ITEM NAME="#TEMPXYY"     TYPE="%-656s" FUNCTIONS=""/>
<ITEM NAME="#tCashActNo" TYPE="%-32s"    FUNCTIONS=""/>
<ITEM NAME="#tCashName" TYPE="%-60s"     FUNCTIONS=""/>
<!-- 输出变量 -->                        
<ITEM NAME="#oXTxAmt"    TYPE="%-20s"    FUNCTIONS="X(#iTxAmt)"/>
<ITEM NAME="#oUTxAmt"    TYPE="%-40s"    FUNCTIONS="U(#iTxAmt)"/>
<ITEM NAME="#oXFeeAmt"   TYPE="%-20s"    FUNCTIONS="X(#rFeeAmt)"/>
<ITEM NAME="#oUFeeAmt"   TYPE="%-40s"    FUNCTIONS="U(#rFeeAmt)"/>
<ITEM NAME="#oAvbalType" TYPE="%6s"      FUNCTIONS="j(#iAvbalType=0,T{定额})j(#iAvbalType=1,T{不定额})"/>
<ITEM NAME="#oBpType"    TYPE="%-12s"    FUNCTIONS="j(#iBpType=0,T{转帐本票})j(#iBpType=1,T{现金本票}))"/>
<ITEM NAME="#oYear"      TYPE="%-8s"     FUNCTIONS="Z(#tYear)"/>
<ITEM NAME="#oMonth"     TYPE="%-6s"     FUNCTIONS="Z(#tMonth)"/>
<ITEM NAME="#oDay"       TYPE="%-6s"     FUNCTIONS="Z(#tDay)"/> 
<ITEM NAME="#oPayName"   TYPE="%-40s"    FUNCTIONS="T(#iPayName,1,40)"/>
<ITEM NAME="#oPayBrNo"   TYPE="%-12s"    FUNCTIONS=""/>
<ITEM NAME="#oBrName"    TYPE="%-20s"    FUNCTIONS="j($KINBR=7010,T{营业部}T{#rBrName,1,20})"/>
<!-- 返回变量 -->                        
<ITEM NAME="#rFeeAmt"   TYPE="%7.2f"     FUNCTIONS="J(#oXFeeAmt)J(#oUFeeAmt)"/>
<ITEM NAME="#rWssrNo"   TYPE="%5s"/>     
<ITEM NAME="#rBrName"   TYPE="%-30s"     FUNCTIONS="J(#oBrName)"/>
<ITEM NAME="#rMsg"      TYPE="%-4s"      FUNCTIONS="j($HCODE=1,T{取消}T{})"/>
<ITEM NAME="#rDrAcNo1"  TYPE="%-7s"      FUNCTIONS=""/>
<ITEM NAME="#rCrAcNo1"  TYPE="%-7s"      FUNCTIONS=""/>
<ITEM NAME="#rDrAcNo2"  TYPE="%-7s"      FUNCTIONS=""/>
<ITEM NAME="#rCrAcNo2"  TYPE="%-7s"      FUNCTIONS=""/>
<ITEM NAME="#rDrAcNo3"  TYPE="%-7s"      FUNCTIONS=""/>
<ITEM NAME="#rCrAcNo3"  TYPE="%-7s"      FUNCTIONS=""/>
<ITEM NAME="#rPassWd"   TYPE="%-10s"     FUNCTIONS=""/>
<ITEM NAME="#XTxAmt"    TYPE="%-20s"     FUNCTIONS="X(#iTxAmt)"/>
<!--系统变量 -->
<!-- 101域变量 -->
  <ITEM NAME="#FD10101"    TYPE="%-24s"  FUNCTIONS=""/>     <!--1账号-->
  <ITEM NAME="#FD10102"    TYPE="%4d"    FUNCTIONS=""/>     <!--2账户序号-->
  <ITEM NAME="#FD10103"    TYPE="%-16s" FUNCTIONS="T()"/>  <!--3金额-->
  <ITEM NAME="#FD10104"    TYPE="%-3s"   FUNCTIONS="" />    <!--4凭证种类-->
  <ITEM NAME="#FD10105"    TYPE="%16d"   FUNCTIONS=""/>     <!--5凭证号-->
  <ITEM NAME="#FD10106"    TYPE="%-10s"  FUNCTIONS=""/>     <!--6摘要-->
  <ITEM NAME="#FD10107"    TYPE="%-1s"   FUNCTIONS=""/>     <!--7有折无折-->
  <ITEM NAME="#FD10108"    TYPE="%-60s"  FUNCTIONS=""/>     <!--8户名-->
  <ITEM NAME="#FD10109"    TYPE="%17.2f" FUNCTIONS=""/>     <!--9余额-->
  <ITEM NAME="#FD10110"    TYPE="%-2s"   FUNCTIONS=""/>     <!--A币种-->
  <ITEM NAME="#FD10111"    TYPE="%-1s"   FUNCTIONS=""/>     <!--B现转标志-->
  <ITEM NAME="#FD10112"    TYPE="%-3s"   FUNCTIONS=""/>     <!--C摘要选项-->
  <ITEM NAME="#FD10113"    TYPE="%-1s"   FUNCTIONS=""/>     <!--D帐户类型-->
  <ITEM NAME="#FD10114"    TYPE="%-4s"   FUNCTIONS=""/>     <!--E账户序号2-->
  <ITEM NAME="#FD10115"    TYPE="%-30s"  FUNCTIONS=""/>     <!--F产品名称-->
  <!-------以上是FD101域的内容-------->
<ITEM LINE="21"  COL="65"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
</VARIABLE>
<!--打印信息-->
<OUTPUT>
</OUTPUT>
<!--输出模块-->
<RESPONSE>
<PACKAGE DEVICE="SCREEN"  DESC="显示内容">
NOTHING
</PACKAGE>
<PRINT>
"{
    print(02,0,'                        银行本票兑付');
    print(05,0,'               本票  号码: [16]',#iPoNo);
    print(06,0,'               签发  日期: [8]',#iQfDay);
    print(08,0,'               付款人帐号: [32]',#iPayActNo);
    print(09,0,'               付款人名称: [60]',#iPayName);
    print(10,0,'               收款人帐号: [32]',#iCashActNo);
    print(11,0,'               收款人名称: [60]',#iCashName);
    print(14,0,'               金      额: [20]',#XTxAmt);
    print(15,0,'               附      言: [60]',#iResume);
    print(16,0,'               流  水　号: [ 6]',$FD4);
}"
</PRINT>
</RESPONSE>
<!--将显示打印出来-->
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印普通凭证">
NOTHING
</PACKAGE>
<PRINT>
"{
    dim @txdate as string;
    @txdate=substr($HDATE,0,4)+'/'+substr($HDATE,4,2)+'/'+substr($HDATE,6,2);
    dim @txtime  as string;
    @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
    print( 5, 20,'机构名称:[30]',$BRNAME);
	  print( 5, 2,'代码:6344');
	  print( 5, 13,'交易:银行本票兑付');   
    print(07,11,'         签发日期:[10]                                                  兑付日期:[10]',#iQfDay,@txdate);
    print(08,11,'         本票  号码: [16          ]                 [12          ]',#iPoNo,#oBpType);
    print(09,11,'         签发  日期: [8]',#iQfDay);
    print(10,11,'         付款人帐号: [32]',#iPayActNo);
    print(11,11,'         付款人名称: [60]',#iPayName);
    print(12,11,'         收款人帐号: [32]',#iCashActNo);
    print(13,11,'         收款人名称: [60]',#iCashName);
    print(14,11,'         金      额: [20]',#XTxAmt);
    print(15,11,'         摘      要: [60]',#iResume);
    print(24,20,'备注:');
    print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
    print(24,5,'柜员:[4]',$FD7);
    print(24,5,'流水号:[6]',$FD4);
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="24" DESC="打印专用凭证" >
NOTHING  
</PACKAGE>
<PRINT>
"{
 $KINDNO='00';
dim @txtime  as string;
@txtime=substr($HDATE,0,2)+':'+substr($HDATE,2,2)+':'+substr($HDATE,4,2);
  print( 5, 20,'机构名称:[30]',$BRNAME);
	print( 5, 2,'代码:6344');
	print( 5, 13,'交易:银行本票兑付');
	printacdtl_1();
	print(24,20,'备注:');
  print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
  print(24,5,'柜员:[4]',$FD7);
  print(24,5,'流水号:[6]',$FD4);
}"
</PRINT>
</RESPONSE>
</TRANSACTION>
