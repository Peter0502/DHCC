<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111001" TITLE="9101 活期账户信息查询"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
	}"
</COMMRECV>
<FIRSTWORK>"{
	setsel(#CPBH,getfiletxt('../etc/prodt.dat'),'v3o1t20o2');
}"
</FIRSTWORK>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(9101                        活期账户信息查询)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=8101)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  
  <ITEM NAME="#DOLIST" TYPE="%1s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
	dim @selid as number;
	dim @ac_no as string;
	dim @ac_seqn as string;
	dim @name as string;
	dim @prdt_name as string;
	dim @bal as string;
	dim @opn_br_no as string;
	dim @opn_date as string;
	dim @ac_sts as string;
	dim @ys_bal as string;
	dim @rate as string;
	dim @sttl_type as string;
	dim @ac_type as string;
	dim @intst_type as string;
	dim @lst_date as string;
	dim @hold_sts as string;
	dim @note_sts as string;
	dim @hold_amt as string;
	dim @ctl_amt as string;
	dim @mdm_ind as string;
	dim @cif_no as string;
	dim @note_no as string;
	dim @type_name as string;
	dim @id_no as string;
	dim @intst_acm as string;
	dim @cif_addr as string;
	dim @draw_pwd as string;
	dim @draw_id as string;


	if(#DOLIST == '1')
	{
	    @selid=list_work();
	    if(@selid &lt; 0)
	    {
		list_del();
		rerun();
		return(true);
	    }
                @selid=list_getselid();
                if(@selid &lt; 0)
                {
                        list_del();
                        rerun();
                        return(true);
                }

	    @ac_no=ltrim((list_gettext(@selid,0)));
	    @name=ltrim((list_gettext(@selid,1)));
	    @prdt_name=ltrim((list_gettext(@selid,2)));
	    @bal=ltrim((list_gettext(@selid,3)));
	    @opn_br_no=ltrim((list_gettext(@selid,4)));
	    @opn_date=ltrim((list_gettext(@selid,5)));
	    @ac_sts=ltrim((list_gettext(@selid,6)));
	    @ys_bal=ltrim((list_gettext(@selid,7)));
	    
	    @sttl_type=ltrim((list_gettext(@selid,9)));
	    @ac_type=ltrim((list_gettext(@selid,10)));
	    
	    @lst_date=ltrim((list_gettext(@selid,12)));
	    @hold_sts=ltrim((list_gettext(@selid,13)));
	    @note_sts=ltrim((list_gettext(@selid,14)));
	    @hold_amt=ltrim((list_gettext(@selid,15)));
	    @ctl_amt=ltrim((list_gettext(@selid,16)));
	    @mdm_ind=ltrim((list_gettext(@selid,17)));
	    @cif_no=ltrim((list_gettext(@selid,18)));
	    @note_no=ltrim((list_gettext(@selid,19)));
	    @type_name=ltrim((list_gettext(@selid,20)));
	    @id_no=ltrim((list_gettext(@selid,21)));
	    
	    @draw_pwd=ltrim((list_gettext(@selid,23)));
	    @draw_id=ltrim((list_gettext(@selid,24)));
	    @cif_addr=ltrim((list_gettext(@selid,25)));
	    
	    if(len(@ac_no)==19 and substr(@ac_no,0,8)=='62178010' )
			{
				 @intst_type='靠档计息';
				 //@intst_acm=ltrim((list_gettext(@selid,22)));
				 //@rate=ltrim((list_gettext(@selid,8)));
			}else{
				 @intst_type=ltrim((list_gettext(@selid,11)));
				 @intst_acm=ltrim((list_gettext(@selid,22)));
				 @rate=ltrim((list_gettext(@selid,8)));
			}
	    
	    
	     //9101的明细
	    open('8125.XML','#AC_NO='+@ac_no+';#NAME='+@name+';#PRDT_NAME='+@prdt_name+';#BAL='+@bal+
		';#OPN_BR_NO='+@opn_br_no+';#OPN_DATE='+@opn_date+';#AC_STS='+@ac_sts+';#YS_BAL='+@ys_bal+';#RATE='+@rate+
		';#STTL_TYPE='+@sttl_type+';#AC_TYPE='+@ac_type+';#INTST_TYPE='+@intst_type+';#LST_DATE='+@lst_date+';#HOLD_STS='+@hold_sts+
		';#NOTE_STS='+@note_sts+';#HOLD_AMT='+@hold_amt+';#CTL_AMT='+@ctl_amt+';#MDM_IND='+@mdm_ind+';#CIF_NO='+@cif_no+
		';#NOTE_NO='+@note_no+';#TYPE_NAME='+@type_name+';#ID_NO='+@id_no+';#INTST_ACM='+@intst_acm+';#DRAW_PWD='+@draw_pwd+';#DRAW_ID='+@draw_id+';#CIF_ADDR='+@cif_addr+';');
		return(true);
	}
	list_del();
	#DOLIST='';
  }"
  </ONLOSTFOCUS>
  </ITEM>
 <!-- <ITEM NAME="#DOLIST" TYPE="%1s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
	showall();
  }"
  </ONLOSTFOCUS>
  </ITEM> -->
  <!--输入变量-->
  <BLOCK NAME="COMMON" LINE="7" COL="12">
  <ITEM LINE="0" COL="0" TYPE="%-10s" FUNCTIONS="T(账/卡 号:)"/>
  <ITEM LINE="1" COL="0" TYPE="%-10s" FUNCTIONS="T(帐户序号:)"/>
  <ITEM LINE="1" COL="28" TYPE="%-10s" FUNCTIONS="T(账户状态:)"/>
  <ITEM LINE="2" COL="0" TYPE="%-10s" FUNCTIONS="T(客 户 号:)"/>
  <ITEM LINE="4" COL="0" TYPE="%-10s" FUNCTIONS="T(户    名:)"/>
  <ITEM LINE="5" COL="0" TYPE="%-10s" FUNCTIONS="T(余    额:)"/>
  <ITEM LINE="5" COL="31" TYPE="%-3s" FUNCTIONS="T( → )"/>
  <ITEM LINE="7" COL="0" TYPE="%-10s" FUNCTIONS="T(产品编号:!)"/>
  <ITEM LINE="8" COL="0" TYPE="%-10s" FUNCTIONS="T(开户机构:)"/>
  <ITEM LINE="9" COL="0" TYPE="%-10s" FUNCTIONS="T(开户日期:)"/>
  <ITEM LINE="9" COL="18" TYPE="%-3s" FUNCTIONS="T( → )"/>
  <ITEM NAME="#ZH" INPUT="TEXT" LINE="0" COL="10" TYPE="%-19s" FUNCTIONS="T()">
  <ONLOSTFOCUS>
  "{ dim @txno as string;
	initfd();
     @txno=$TXNO;
     $TXNO='9958';
     commsend_001();
     $FD38=#ZH;
     callserver();
     $TXNO=@txno;
     
     if($FD12!='0000')
        {showmsg(geterror());
         return(false);
     }
     if(#ZH != '')
     {
         initfd();
         @txno=$TXNO;
         $TXNO='6700';
         commsend_001();
         $FD30=#ZH;
         $FD67='1';
         callserver();
         $TXNO=@txno;
     
         if($FD12!='0000')
            {showmsg(geterror());
             return(false);
         }
         if($KINBR!=$FD91 and $KINBR != '10001')
         {
             showmsg('只能查询本机构帐户!');
             return(false);
         } 
     }
     else if($KINBR == '10001')
     {
	return(true);
     }
     
  }"
  </ONLOSTFOCUS>       
   </ITEM>  
  <ITEM NAME="#ZHXH" INPUT="TEXT" LINE="1" COL="10" TYPE="%-3s" FUNCTIONS="T()"/>
  <ITEM NAME="#ZHZT" INPUT="SELECT" LINE="1" COL="35" TYPE="%-4s" FUNCTIONS="T(0000)">  
     <SELECT>
		<OPTION VALUE="0" TITLE="0.开户待确认"/>
		<OPTION VALUE="1" TITLE="0.正常"/>
		<OPTION VALUE="3" TITLE="0.挂失结清"/>
		<OPTION VALUE="4" TITLE="0.开户更正"/>
		<OPTION VALUE="5" TITLE="0.临时销户"/>
		<OPTION VALUE="*" TITLE="0.销户"/>
	  </SELECT>
	  </ITEM>
  <ITEM NAME="#KHH" INPUT="TEXT" LINE="2" COL="10" TYPE="%-10s" FUNCTIONS="T()"/>
  <ITEM NAME="#NAME" INPUT="TEXT" LINE="4" COL="10" TYPE="%-50s" FUNCTIONS="T()"/>
  <ITEM NAME="#YE" INPUT="TEXT" LINE="5" COL="10" TYPE="%17.2f" FUNCTIONS="T()"/>
  <ITEM NAME="#YEE" INPUT="TEXT" LINE="5" COL="35" TYPE="%17.2f" FUNCTIONS="T()"/>
  
  <ITEM NAME="#CPBH" INPUT="SELECT" LINE="7" COL="10" TYPE="%-3s" FUNCTIONS="">
  <!--
	<SELECT>
		<OPTION VALUE="101" TITLE="0.储蓄活期"/>
	</SELECT>
	-->
  </ITEM>
  <ITEM NAME="#KHJG" INPUT="LABEL" LINE="8" COL="10" TYPE="%5s" FUNCTIONS="T($KINBR)"/>
  <ITEM NAME="#KHRQ" INPUT="TEXT" LINE="9" COL="10" TYPE="%-8s" FUNCTIONS="T()"/>
  <ITEM NAME="#KHRQQ" INPUT="TEXT" LINE="9" COL="22" TYPE="%-8s" FUNCTIONS="T()"/>
  </BLOCK>
  <!--输出变量--->
  <ITEM NAME="#TXCNT"   TYPE="%2d"  FUNCTIONS="T($OCCURS=#TXCNT)J(#TOTCNT)" />
  <ITEM NAME="#TOTCNT"  TYPE="%5d"  FUNCTIONS="E(#TOTCNT+#TXCNT)J(#TOTCNTC)"/>
  <ITEM NAME="#TOTCNTC" TYPE="%5d"  FUNCTIONS="T($TOTCNT=#TOTCNT)"/>
  <ITEM NAME="#O_TXDAY" TYPE="%-8s" FUNCTIONS=""/>
  <ITEM NAME="#O_PBDSC" TYPE="%-3s" FUNCTIONS="J(#OL_PBDSC)"/>
  <ITEM NAME="#OL_PBDSC" TYPE="%-2s" FUNCTIONS="T(  )j(#O_PBDSC=001,T{存})j(#O_PBDSC=002,T{取})"/>
  <ITEM NAME="#O_TXAMT" TYPE="%16.2f" FUNCTIONS="J(#OL_TXAMT)"/>
  <ITEM NAME="#OL_TXAMT" TYPE="%-16s" FUNCTIONS="X(#O_TXAMT)"/>
  <ITEM NAME="#O_CRDB" TYPE="%-1s" FUNCTIONS="J(#OL_SIGN)"/>
  <ITEM NAME="#OL_SIGN" TYPE="%-1s" FUNCTIONS="T( )j(#O_CRDB=1,T{-})"/>
  <ITEM NAME="#O_AVBAL" TYPE="%16.2f" FUNCTIONS="J(#OL_AVBAL)"/>
  <ITEM NAME="#OL_AVBAL" TYPE="%-16s" FUNCTIONS="X(#O_AVBAL)"/>
  <ITEM NAME="#O_TLRNO" TYPE="%-4s" FUNCTIONS=""/>

  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
	<ONCLICK>"{
		dim @tota as string;
		initfd();
		commsend_001();
	$FD38=#ZH;
	$FD51=#ZHXH;
	$FD70=#ZHZT;
	$FD54=#KHH;
	$FD26=#NAME;
	$FD100=getitems('#YE#YEE');
	$FD23=#CPBH;
	$FD2=#KHJG;
	$FD29=#KHRQ;
	$FD44=#KHRQQ;
	$FD91=#KHJG;
		@tota=callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		autolist(@tota);
		#DOLIST='1';
	}"
 	</ONCLICK>
  </ITEM>

</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCRREN" DESC="按任意键继续">
NOTHING
</PACKAGE>
<PRINT>"{
	print(5,5,'3333333333');
}"
</PRINT>
</RESPONSE>
<OUTPUT>
</OUTPUT>
</TRANSACTION>

