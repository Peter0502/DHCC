<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111000" TITLE="4411    委托贷款利息查询"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
}"
</COMMSEND>
<COMMRECV>"{
}"
</COMMRECV>
<VARIABLE>
<ITEM NAME="#DOLIST" TYPE="%-1s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
  		dim @selid as number;
  		dim @tota as string;
  		dim @cnt as number;
  		if(#DOLIST!='')
  		{
   			@selid=list_getselid();
	  		#AC_NO			=delspace(list_gettext(@selid,0));
	  		#OPN_BR_NO  =delspace(list_gettext(@selid,1));
	  		#NAME		    =delspace(list_gettext(@selid,2));
	  		#BAL      	=delspace(list_gettext(@selid,3));
	  		#ACM		    =delspace(list_gettext(@selid,4));
	  		#OPN_DATE   =delspace(list_gettext(@selid,5));
	  		#IC_DATE    =delspace(list_gettext(@selid,6));
	  		#MTR_DATE   =delspace(list_gettext(@selid,7));
	  		#RATE       =delspace(list_gettext(@selid,8));
	  		#LX         =delspace(list_gettext(@selid,9));
	  		#DAYS       =delspace(list_gettext(@selid,10));

  			while(true)
  			{
  					@selid=list_getselid();
  					if(@selid &lt; 0)
  					{
  						list_del();
  						break;
  					}	  				
						if(msgbox('打印此笔交易吗?'+chr(10)+
	  									'   帐    号:   '+#AC_NO+chr(10)+
	  							'─────────────'
	  							,'提示','yes|no')!=0)
	  				{
	        					break;
	       		}  	   	    	   	    	
	        	runoutput();
	        	list_rmitem(@selid);	        	        	        
	      		@selid=list_getselid();
	      		@cnt=list_getrowcnt();
	      		if(@cnt==0)
	      		{
	        			msgbox('          打印完毕    '+chr(10)+'─────────────');
	        			break;
	        	 }
	  		#AC_NO			=delspace(list_gettext(@selid,0));
	  		#OPN_BR_NO  =delspace(list_gettext(@selid,1));
	  		#NAME		    =delspace(list_gettext(@selid,2));
	  		#BAL      	=delspace(list_gettext(@selid,3));
	  		#ACM		    =delspace(list_gettext(@selid,4));
	  		#OPN_DATE   =delspace(list_gettext(@selid,5));
	  		#IC_DATE    =delspace(list_gettext(@selid,6));
	  		#MTR_DATE   =delspace(list_gettext(@selid,7));
	  		#RATE       =delspace(list_gettext(@selid,8));
	  		#LX         =delspace(list_gettext(@selid,9));
	  		#DAYS       =delspace(list_gettext(@selid,10));
  		
  		}
  		list_del();
  		
  		#DOLIST='';
  	}
  
  }"
  </ONLOSTFOCUS>
</ITEM>
<ITEM NAME="#DOLIST" TYPE="%-1s" FUNCTIONS="">
   <ONLOSTFOCUS>
   "{
 			showall();
  	}"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="3"  COL="3" TYPE="%-52s" FUNCTIONS=
    "T(4411                         委托贷款利息查询)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5925)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/> 
  <ITEM LINE="7"   COL="05"   TYPE="%-10s" FUNCTIONS="T(帐    号:)"/>
  <ITEM LINE="9"   COL="05"   TYPE="%-10s" FUNCTIONS="T(起始日期:)"/>
  <ITEM LINE="9"   COL="30"   TYPE="%-10s" FUNCTIONS="T(终止日期:)"/>
  <ITEM LINE="7"   COL="16"  NAME="#ACNO"        TYPE="%-24s"        INPUT="TEXT"    FUNCTIONS=""/>
  <ITEM LINE="9"   COL="16"  NAME="#SDATE"       TYPE="%8d"          INPUT="TEXT"    FUNCTIONS="V(NB)D()"/>
  <ITEM LINE="9"   COL="40"  NAME="#EDATE"       TYPE="%8d"          INPUT="TEXT"    FUNCTIONS="V(NB)D()">
  <ONLOSTFOCUS>
  "{
     if(#EDATE &lt; #SDATE)
     {
      	showmsg('终止日期必须大于起始日期');
      	return (false);
     }
  }"
  </ONLOSTFOCUS>
  </ITEM>
	 <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" 	 TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM LINE="21"  COL="59" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>
  "{
        dim @tota   as string;
       
        initfd();
        commsend_001();
        $FD30=#ACNO;
    		$FD44=#SDATE;
    		$FD45=#EDATE;
     		@tota=callserver();
     		if($FD12!='0000')
    	 {
					showmsg(geterror());
					return(false);
    	 }    	 
    	 autolist(@tota);
	    		list_work();
	    		
	        #DOLIST='1';
  }"
 </ONCLICK>
  </ITEM>
<ITEM NAME="#AC_NO"			TYPE="%-24s" FUNCTIONS=""/>
<ITEM NAME="#OPN_BR_NO" TYPE="%-5s" FUNCTIONS=""/>
<ITEM NAME="#NAME"		  TYPE="%-50s" FUNCTIONS=""/>
<ITEM NAME="#BAL"      	TYPE="%-21s" FUNCTIONS=""/>
<ITEM NAME="#ACM"		    TYPE="%-21s" FUNCTIONS=""/>
<ITEM NAME="#OPN_DATE"  TYPE="%8d" FUNCTIONS=""/>
<ITEM NAME="#IC_DATE"   TYPE="%8d" FUNCTIONS=""/>
<ITEM NAME="#MTR_DATE"  TYPE="%8d" FUNCTIONS=""/>
<ITEM NAME="#RATE"      TYPE="%-10s" FUNCTIONS=""/>
<ITEM NAME="#LX"        TYPE="%-21s" FUNCTIONS=""/>
<ITEM NAME="#DAYS"      TYPE="%-4s"  FUNCTIONS=""/>
</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="委托贷款利息查询打印">
 NOTHING
</PACKAGE>
  <PRINT>
  "{
       
			    print(1, 1,'	                                  长治市商业银行委托贷款利息传票 ');			 
					print(3, 1,'  机    构: [5    ]                                                        [8        ]',#OPN_BR_NO,$HDATE);
					print(4, 1,'  起始日期: [8       ]                终止日期: [8       ]                 结息天数:[4    ]天  ',#IC_DATE,#MTR_DATE,#DAYS);
					print(5, 1,' ┌─────────────────────────────────────────────┐');
					print(6, 1,' │户    名: [50]                              │',#NAME);
					print(7, 1,' ├─────────────────┬─────┬─────────────────────┤');
					print(8, 1,' │贷方账号: [20                   ]    │产品名称: │ 委托贷款                                 │',#AC_NO);
					print(9, 1,' ├─────────────────┼─────┼──────┬─────┬────────┤');
					print(10,1,' │本金基数: [21                   ]   │月 利 率: │[10        ]  │应缴利息: │[21            ]│',#ACM,#RATE,#LX);
					print(11,1,' └─────────────────┴─────┴──────┴─────┴────────┘');
			
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="20" DESC="委托贷款利息查询打印">
 NOTHING
</PACKAGE>
  <PRINT>"{

			    print(1, 1,'	                                  长治市商业银行委托贷款利息传票 ');			 
					print(3, 1,'  机    构: [5    ]                                                           [8        ]',#OPN_BR_NO,$HDATE);
					print(4, 1,'  起始日期: [8       ]                  终止日期: [8       ]                  结息天数:[4    ]天  ',#IC_DATE,#MTR_DATE,#DAYS);
					print(5, 1,' ┌───────────────────────────────────────────────┐');
					print(6, 1,' │户    名: [50]                                  │',#NAME);
					print(7, 1,' ├─────────────────┬─────┬───────────────────────┤');
					print(8, 1,' │贷方账号: [20                   ]    │产品名称: │ 委托贷款                                     │',#AC_NO);
					print(9, 1,' ├─────────────────┼─────┼──────┬─────┬──────────┤');
					print(10,1,' │本金基数: [21                   ]   │月 利 率: │[10        ]  │应缴利息: │[21           ]│',#ACM,#RATE,#LX);
					print(11,1,' └─────────────────┴─────┴──────┴─────┴──────────┘');
			
}"
</PRINT>
</RESPONSE>
</TRANSACTION>
