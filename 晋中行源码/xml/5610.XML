<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00110000" TITLE="5610 承兑汇票号与协议编号的维护"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
        commsend_001();
        $FD32 = #HTNUM;
        $FD33 = #XYNUM;
        $FD39 = space(16);  
	$FD70 = #CZFLAG;
}"
</COMMSEND>
<COMMRECV>"{
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(5610                    承兑汇票号与协议编号的维护)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>

  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4349)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>

  <ITEM LINE="9"  COL="19"  TYPE="%-14s" FUNCTIONS="T(操作标志:!)"/>
  <ITEM LINE="11" COL="15"  TYPE="%-14s" FUNCTIONS="T(承兑协议编号:)"/>
  <ITEM LINE="13" COL="17"  TYPE="%-14s" FUNCTIONS="T(承兑汇票号:)"/>


  <ITEM LINE="9"   COL="29" TYPE="%-1s" NAME="#CZFLAG"   DEVICE="KEYBOARD" FUNCTIONS="T(2)">
    <SELECT LINE="0" COL="0">
        <OPTION VALUE="1" TITLE="维护"/>
        <OPTION VALUE="2" TITLE="查询"/>
    </SELECT>
  </ITEM>

  <ITEM LINE="11"  COL="29" TYPE="%-20s"  NAME="#XYNUM"   DEVICE="KEYBOARD" FUNCTIONS=""/>
  <ITEM LINE="13"  COL="29" TYPE="%16d"  NAME="#HTNUM"   DEVICE="KEYBOARD" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
        dim @l as number;
        @l = len(#HTNUM);

		if(@l != 16 and  #CZFLAG=='1')
		{
			showmsg('汇票号应为16位');
			return(false);
		}
  }"
  </ONLOSTFOCUS>
  </ITEM>

  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  
  <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($FD5,1,4)"/>
  <ITEM NAME="#MON"  TYPE="%-2s" FUNCTIONS="T($FD5,5,2)"/>
  <ITEM NAME="#DAY"  TYPE="%-2s" FUNCTIONS="T($FD5,7,2)"/>

  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>

</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
	<PACKAGE DEVICE="SCREEN" DESC="显示内容" CHECK="#CZFLAG=1">
	NOTHING
	</PACKAGE>
	<PRINT>
	"{
	        print(7,20,'承兑协议编号: [16]',#XYNUM);
	        print(8,20,'承兑合同号: [16]',#HTNUM);
	}"
	</PRINT>
</RESPONSE>

<RESPONSE>
    <PACKAGE DEVICE="PRINTER" DESC="打印内容" CHECK="#CZFLAG=1">
    NOTHING
    </PACKAGE>
    <PRINT>
    "{
        print( 5, 16,'[4]      [2]     [2]',#YEAR,#MON,#DAY);
        print( 7,  8,'[5]',$FD2);
        print( 7, 24,'5609承兑汇票查询书管理');
        print( 7, 46,'[4]',$FD7);
        print( 7, 62,'[6]',$FD4);
        print( 8,  8,'承兑协议编号: [16]',#XYNUM);
        print( 9,  8,'承兑合同号: [16]',#HTNUM);
    }"
    </PRINT>
</RESPONSE>

</TRANSACTION>
