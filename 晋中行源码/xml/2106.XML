<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111001" TITLE="2106 客户地址信息录入"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	commsend_001();
	$FD23=#CONTRY;
	$FD28=#CUSTNO;
	$FD65=#POSTALCODE;
	$FD66=#KHTYPE;
	$FD67=#DZTYPE;
	$FD81=#ADDRESS;

}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
	#ORDERNO=$FD35;
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(2106                      客户地址信息录入)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO"    TYPE="%-4s" FUNCTIONS="T($TXNO=1106)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <!--输入变量-->
  <ITEM LINE="7"  COL="10" TYPE="%-10s" FUNCTIONS="T(客 户 号:)"/>
  <ITEM LINE="9"  COL="10" TYPE="%-10s" FUNCTIONS="T(客户类型:)"/>
  <ITEM LINE="11" COL="10" TYPE="%-10s" FUNCTIONS="T(地址类型:)"/>
  <ITEM LINE="13" COL="10" TYPE="%-10s" FUNCTIONS="T(所在国家:)"/>
  <ITEM LINE="15" COL="10" TYPE="%-10s" FUNCTIONS="T(地    址:)"/>
  <ITEM LINE="17" COL="10" TYPE="%-10s" FUNCTIONS="T(邮政编码:)"/>
  <ITEM NAME="#SHOW"   LINE="19" COL="10" TYPE="%-10s"  VISABLE="FALSE" INPUT="LABEL" FUNCTIONS="T(地址序号:)"/>
  <ITEM NAME="#CUSTNO" INPUT="TEXT" LINE="7" COL="20" TYPE="%-8s" FUNCTIONS="T()V(NB)">
      <ONLOSTFOCUS>
	"{
		dim @txno_bak as string;
		@txno_bak=$TXNO;
		$TXNO='9942';
		commsend_001();
		$FD28=#CUSTNO;
		callserver();
		$TXNO=@txno_bak;
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#KHTYPE=$FD66;
		show(#KHTYPE,true);
		enable(#KHTYPE,false);
	}"
    </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#KHTYPE" INPUT="SELECT"   LINE="9"  COL="20" TYPE="%-1s" FUNCTIONS="">
	<SELECT>
		<OPTION VALUE="1" TITLE="对私客户"/>
		<OPTION VALUE="2" TITLE="对公客户"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#DZTYPE" INPUT="SELECT"   LINE="11" COL="20" TYPE="%-1s" FUNCTIONS="T(1)">
  	<SELECT>
		<OPTION VALUE="1" TITLE="1.单位地址"/>
		<OPTION VALUE="2" TITLE="1.家庭地址"/>
		<OPTION VALUE="3" TITLE="1.其他地址"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#CONTRY" INPUT="SELECT" LINE="13" COL="20" TYPE="%-2s" FUNCTIONS="T(01)">
  	<SELECT>
		<OPTION VALUE="01" TITLE="1.中国"/>
		<OPTION VALUE="02" TITLE="1.美国"/>
		<OPTION VALUE="03" TITLE="1.俄罗斯"/>
		<OPTION VALUE="04" TITLE="1.法国"/>
		<OPTION VALUE="05" TITLE="1.日本"/>
		<OPTION VALUE="06" TITLE="1.英国"/>
		<OPTION VALUE="07" TITLE="1.韩国"/>
		<OPTION VALUE="11" TITLE="1.德国"/>
		<OPTION VALUE="99" TITLE="1.其他"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#ADDRESS" INPUT="TEXT" LINE="15" COL="20" TYPE="%-50s" FUNCTIONS="T()V(NB)"/>
  <ITEM NAME="#POSTALCODE" INPUT="TEXT" LINE="17" COL="20" TYPE="%-6s" FUNCTIONS="">
  	<ONLOSTFOCUS>
	"{
		dim @l as number;
		@l = len(#POSTALCODE);
		if(@l &lt; 6)
		{
			showmsg('邮政编码必须为6位!');
			return(false);
		}
	}"
  	</ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#ORDERNO" INPUT="TEXT" LINE="19" COL="20" TYPE="%-4s"  VISABLE="FALSE" FUNCTIONS=""/>

  <!--输出变量--->
  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
<!--	
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT">-->

  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
    	<ONCLICK>
    	"{
    		dim @tota as string;
    		dim @ch as string;
		commsend_001();
		$FD23=#CONTRY;
		$FD28=#CUSTNO;
		$FD65=#POSTALCODE;
		$FD66=#KHTYPE;
		$FD67=#DZTYPE;
		$FD81=#ADDRESS;
    		@tota=callserver();
    		#ORDERNO=$FD35;
    		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
			}
		else{
			showall();
			show(#SHOW,true);
			//showmsg(#ORDERNO);
			show(#ORDERNO,true);
			runoutput();
    	@ch=showmsg('下一步执行 客户工作信息录入，Y-继续;N-退出：');
				if(@ch == 'Y' or @ch == 'y'){	
					open('2107.XML', '#CUSTNO='+#CUSTNO+';');
					return(true);
					}
					else{
					return(true);
					}
    			}
    		}"
		</ONCLICK>    		
  </ITEM>

</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
	<PACKAGE DEVICE="SCREEN" DESC="按任意键继续">
	NOTHING
	</PACKAGE>
	<PRINT>"{
		print(8,30,        '录入成功！')
    print(9,10,' 客 户 号:[8]',#CUSTNO);
		print(10,10,'地    址:[50]',#ADDRESS);
		print(11,10,'邮政编码:[6]',#POSTALCODE);
		}"
	</PRINT>
</RESPONSE>
<RESPONSE>
	<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="请打印业务专用凭证">
	NOTHING
	</PACKAGE>
	<PRINT>
	"{
	  $KINDNO='00';
    dim @txtime  as string;
    @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	  print( 5, 20,'机构名称:[30]',$BRNAME);
    print( 5, 2,'代码:2106');
	  print( 5, 13,'交易:客户地址信息录入');
	  print( 8, 20,'客 户 号:[8]',#CUSTNO);
	  print( 9, 20,'地    址:[50]',#ADDRESS);
	  print(10, 20,'邮政编码:[6]',#POSTALCODE);
	  print( 24,20,'备注:');
	  print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	  print( 24,5,'柜员:[4]',$FD7);
	  print( 24,5,'流水号:[6]',$FD4);
	}"
	</PRINT>
</RESPONSE>
</TRANSACTION>



