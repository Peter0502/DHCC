<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="6346 银 行 本 票 退 回"
xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>
"{
    initfd();
    $FD32=#iPoNo;    // 本票号码
    $FD45=#iSignDay; // 签发日
    $FD25=#iResume;  // 摘要
    $FD67=#iReType;  // 退回种类

    $FD39=itoa(#iTxAmt*100,'%016.0f'); // 出票金额

    $FD3 =$KINBR;
    $FD20='1';
    $FD7=$TLRNO;
    $FD21=#CUR_NO;   // 货币标志
    $FD93='9';
    $FD99='2';
    $FD66='1';       // 借贷标志
    // NEWBP3
    if(#iBpType=='0')	   //转账本票
     {
         if(#iCFlag=='0')
         {
             $FD68='7';
             $FD67='1';     //现转标志
         }
         else
         {
             $FD68='1';     //帐务类型1转帐7现金
             $FD67='2';     //现转标志
         }
     }
     else
     {
         $FD68='7';
         $FD67='1';        //现转标志
     }
    // end NEWBP3
    
    $FD40=$FD39;     // 交易金额    
    #FD10101=#ACTNO24;
    #FD10102=#ACTSEQ;
    #FD10103=$FD39;
    #FD10110='01';
    #FD10111='2';
    $FD101 = getitems('#FD10101#FD10102#FD10103#FD10104#FD10105#FD10106#FD10107#FD10108#FD10109#FD10110#FD10111#FD10112#FD10113#FD10114#FD10115');
    commsend_001();
}"
</COMMSEND>
<COMMRECV>
"{
  commrecv_001();
}"
</COMMRECV>
<FIRSTWORK>
"{
  #PIC='';
  #PIC1='';
  show(#PIC,false);
  show(#PIC1,false);
  show(#LBLPIC,false);
  show(#LBLPIC1,false);
  enable(#SETPIC,false);
  enable(#SETPIC1,false);
}"
</FIRSTWORK>
<VARIABLE>
<ITEM LINE="3"  COL="3" TYPE="%-70s" FUNCTIONS=
"T(6346                    银 行 本 票 退 回)"/>
<ITEM LINE="4"  COL="3"  TYPE="%-70s" FUNCTIONS=
"T(───────────────────────────────────)"/>
<ITEM NAME="#TXNO"       TYPE="%-4s"     FUNCTIONS="T($TXNO=6346)"/>
<ITEM NAME="#MSGTYPE"    TYPE="%-5s"     FUNCTIONS="T()"/>
<ITEM LINE="6"   COL="3" TYPE="%-12s"    FUNCTIONS="T(出票  日期:)"/>
<ITEM LINE="7"   COL="3" TYPE="%-12s"    FUNCTIONS="T(本票  号码:)"/>
<ITEM LINE="9"   COL="3" TYPE="%-12s"    FUNCTIONS="T(签发  种类:!)"/>
<ITEM LINE="11"  COL="3" TYPE="%-12s"    FUNCTIONS="T(付款人帐号: )"/>
<ITEM LINE="11"     COL="40"  NAME="#LBLPIC" TYPE="%-10s" FUNCTIONS="T(照    片:)"/>
<ITEM LINE="11"     COL="55"  NAME="#LBLPIC1" TYPE="%-10s" FUNCTIONS="T(印    件:)"/>
<ITEM LINE="12"  COL="3" TYPE="%-12s"    FUNCTIONS="T(付款人名称: )"/>
<ITEM LINE="13"  COL="3" TYPE="%-12s"    FUNCTIONS="T(票面  金额: )"/>
<ITEM LINE="15"  COL="3" TYPE="%-12s"    FUNCTIONS="T(收款人帐号: )"/>
<ITEM LINE="16"  COL="3" TYPE="%-12s"    FUNCTIONS="T(收款人名称: )"/>
<ITEM LINE="17"  COL="3" TYPE="%-12s"    FUNCTIONS="T(兑付行行号: )"/> 
<ITEM LINE="18"  COL="3" TYPE="%-12s"    FUNCTIONS="T(兑付行行名: )"/>
<ITEM LINE="19"  COL="3" TYPE="%-12s"    FUNCTIONS="T(摘      要: )"/>
<ITEM LINE="6"   COL="15" NAME="#iSignDay" TYPE="%8d" DEVICE="KEYBOARD" FUNCTIONS="T($HDATE)D()">
<ONLOSTFOCUS>
"{
    if(atoi(#iSignDay) &gt; atoi($HDATE))
    {
        showmsg('出票日期不能大于当前系统日期!');
        return(false);
    }
}"
</ONLOSTFOCUS>
</ITEM>
<ITEM LINE="7" COL="15"  NAME="#iPoNo" TYPE="%16s" DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)">
<ONLOSTFOCUS>
"{
      dim @baktxno as string;
      @baktxno=$TXNO;
      $TXNO='9696';
      $FD11='0';          // 操作标志
      $FD30=#iPoNo;       // 本票号码
      $FD44=#iSignDay;    
      commsend_001();
      callserver();
      if($FD12!='0000')
      {
          showmsg('无此票号!');
          showmsg(geterror());
          return(false);
      }
      $TXNO=@baktxno;
      // if(delspace($FD91)!=$KINBR)
      // {
      //        showmsg('非本行签发,不能退回!');
      //        return(false);
      // }
      if($FD98!='1')
      {
            showmsg('本票不是签发状态,不可以退回!');
            return(false);
      }
      #iBpType=$FD68;              //  本票类型
      #iCFlag=$FD69;               //  转账现金标志
      #iPayActNo=$FD33;            //  付款人帐号
      #iPayName=delspace($FD25);   //  付款人名称
      #iTxAmt=val($FD39,0.01);     //  出票金额
      #iCashActNo=delspace($FD31); //  收款人帐号
      #iCashName=delspace($FD26);  //  收款人名称
      #iCashBrNo=delspace($FD58);  //  指定兑付机构
      #iCashBrName=delspace($FD82);//  指定兑付机构名称
      
      #iPayActNo18 = substr(#iPayActNo,0,32);
      enable(#iBpType,false);
      enable(#iCFlag,false);
      enable(#iTxAmt,true);
      enable(#iCashActNo,false);
      enable(#iCashName,false);
      enable(#iCashBrNo,false);
      enable(#iCashBrName,false);
      enable(#iPayActNo18,true);
      refresh();
}"
</ONLOSTFOCUS>
</ITEM>
<ITEM NAME="#iAvbalType" TYPE="%-1s"  FUNCTIONS="T(1)"/>
<ITEM NAME="#iReType"    TYPE="%-1s"  FUNCTIONS="T(0)V(0|1)">
</ITEM>
<ITEM LINE="9" COL="15" NAME="#iBpType" TYPE="%-1s"  DEVICE="KEYBOARD" FUNCTIONS="T(0)V(0|1)">
<SELECT LINE="10" COL="17">
    <OPTION VALUE="0 转帐本票"  TITLE="0.转帐本票"/>
    <OPTION VALUE="1 现金本票"  TITLE="1.现金本票"/>
</SELECT>
</ITEM>
<ITEM NAME="#iCFlag" TYPE="%1s" FUNCTIONS=""/>

<ITEM NAME="#AC_NO"   TYPE="%-24s"  FUNCTIONS=""/>
<ITEM NAME="#AC_SEQN" TYPE="%-4s"   FUNCTIONS="T()"/>
<ITEM NAME="#CUR_NO"  TYPE="%-2s"   FUNCTIONS="T(01)"/>
<ITEM LINE="11" COL="15" NAME="#iPayActNo18" TYPE="%-19s" DEVICE="KEYBOARD" FUNCTIONS="V(NB)"/>
<ITEM NAME="#iPayActNo" TYPE="%-32s"  FUNCTIONS="T(#iPayActNo18)">
    <ONLOSTFOCUS>
    "{
          dim @baktxno as string;
          dim @name as string;
          dim @avbal as string;
          dim @pwd_ind as string;
          dim @actype as string;
          dim @prdt_name as string;
          @baktxno=$TXNO;
          $TXNO='9731';
          #AC_NO=substr(#iPayActNo,0,24)+space(24-len(#iPayActNo))+'';
          $FD102=#AC_NO+#AC_SEQN;
          commsend_001();
          callserver();
          $TXNO=@baktxno;
          if($FD12!='0000')
          {
              showmsg(geterror());
              return(false);
          }
          @name=substr($FD102,125,60);
          @avbal=substr($FD102,185,16);
          @pwd_ind=substr($FD102,48,1);
          @actype=substr($FD102,207,1);

          #iPayName=rtrim(@name);
          enable(#iPayName,true);     
          
          @prdt_name=rtrim(substr($FD102,313,30));
          
          #TXAMT15=itoa(#iTxAmt*100,'%016.0f');
          showhelp(4,68,5,10,'帐户信息','户名:'+@name+' 余额:'+itoa(val(@avbal,0.01),'%16.2f')+space(6)+' 产品名称:'+@prdt_name);
          setitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PWDFLAG#QUE_PWD#DRAW_PWD#ID_TYPE#CERTNO20#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CT_IND#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10',$FD102);
          #ID_NO=rtrim(#CERTNO20);// for test
          #iPayActNo=rtrim(#iPayActNo);
          if(len(#iPayActNo)!=7 and len(#iPayActNo)!=5 and len(#iPayActNo)!=3 )
          {
              @baktxno=$TXNO;
              $TXNO = '9405';
              #iPayActNo=substr(#iPayActNo,0,24)+space(24-len(#iPayActNo))+'';
              $FD32=#iPayActNo;
              commsend_001();
              callserver();
              $TXNO=@baktxno;
              if($FD12!='0000')
              {
                  showmsg(geterror());
                  return (false);
              }
          }
    }"
    </ONLOSTFOCUS>
</ITEM>
<!--added by liuyong 2009-9-15 显示图片信息 start-->
  <ITEM  NAME="#CHECKACNO"  TYPE="%10s" FUNCTIONS="">
 <ONLOSTFOCUS>
 "{
     dim @txnobak as string;
     dim @len as number;
     @len = len(rtrim(#iPayActNo));
     if(@len != 0 and @len != 3 and @len != 5 and @len != 7)
     {
       @txnobak = $TXNO;
       $TXNO = '9663';
       $FD30 = #iPayActNo;
       commsend_001();
       callserver();
       if($FD12 !='0000')
       {
         show(#PIC,false);
         show(#PIC1,false);
         show(#LBLPIC,false);
         show(#LBLPIC1,false);
         enable(#SETPIC,false);
         enable(#SETPIC1,false);
       }
       else
       {
         show(#PIC,true);
         show(#PIC1,true);
         show(#LBLPIC,true);
         show(#LBLPIC1,true);
         enable(#SETPIC,true);
         enable(#SETPIC1,true);
       }
       $TXNO = @txnobak;
     }
     
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM NAME="#LYACNO" TYPE="%-32s" FUNCTIONS="" />
  <ITEM LINE="11" COL="50" LINES="160" COLS="120" NAME="#PIC" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#iPayActNo;
      call_96641();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="11" COL="65" LINES="220" COLS="160" NAME="#PIC1" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC1" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#iPayActNo;
      call_96642();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 end-->
<ITEM LINE="12"  COL="15" NAME="#iPayName"  TYPE="%-60s" DEVICE="KEYBOARD"  FUNCTIONS="V(NB)"/>
<ITEM LINE="13"  COL="15" NAME="#iTxAmt"  TYPE="%16.2f" DEVICE="KEYBOARD" FUNCTIONS="V(0000000000000001,0000099999999999)"/>
<ITEM LINE="15"  COL="15" NAME="#iCashActNo" TYPE="%-32s"  DEVICE="KEYBOARD" FUNCTIONS=""/>
<ITEM LINE="16"  COL="15" NAME="#iCashName"  TYPE="%-60s"  DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)"/>
<ITEM LINE="17"  COL="15" NAME="#iCashBrNo"  TYPE="%-12s"  DEVICE="KEYBOARD" FUNCTIONS=""/>
<ITEM LINE="18"  COL="15" NAME="#iCashBrName" TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS=""/>
<ITEM LINE="19"  COL="15" NAME="#iResume" TYPE="%-60s"  DEVICE="KEYBOARD" FUNCTIONS="T()"/>
<!--输出变量-->
<ITEM NAME="#oBpType" TYPE="%-12s" FUNCTIONS="j(#iBpType=0,T{转帐本票})j(#iBpType=1,T{现金本票}))"/>
<!--系统变量-->
<ITEM NAME="#HTRMSEQ" TYPE="%-2s"  FUNCTIONS="T($HTRMSEQ)"/>
<ITEM NAME="#HEJFNO"  TYPE="%-6s"  FUNCTIONS="T($HEJFNO)"/>
<ITEM NAME="#HCODE"   TYPE="%-1s"  FUNCTIONS="T($HCODE)"/>
<ITEM NAME="#KINBR"   TYPE="%-7s"  FUNCTIONS="T($KINBR)"/>
<ITEM NAME="#TXTYPE"  TYPE="%-2s"  FUNCTIONS="T()"/>
<ITEM NAME="#TRMSEQ"  TYPE="%-2s"  FUNCTIONS="T($TRMSEQ)"/>
<ITEM NAME="#EJFNO"   TYPE="%-6s"  FUNCTIONS="T($TXTNO)"/>
<ITEM NAME="#TASKID"  TYPE="%-2s"  FUNCTIONS="T(UM)"/>
<ITEM NAME="#TMTYPE"  TYPE="%-1s"  FUNCTIONS="T(0)"/>
<ITEM NAME="#APTYPE"  TYPE="%-1s"  FUNCTIONS="T(b)"/>
<!--<ITEM NAME="#TXNO"    TYPE="%-2s"  FUNCTIONS="T(06)"/>--><!--同名ITEM liangq注-->
<ITEM NAME="#DSCPT"   TYPE="%3d"   FUNCTIONS="T(001)"/>
<ITEM NAME="#PTYPE"   TYPE="%-1s"  FUNCTIONS="T(0)"/>
<ITEM NAME="#MULTTX"  TYPE="%-1s"  FUNCTIONS="T(0)"/>
<ITEM NAME="#CRDB"    TYPE="%-1s"  FUNCTIONS="T(2)"/>
<ITEM NAME="#SUPIN1"  TYPE="%-1s"  FUNCTIONS="T(0)"/>
<ITEM NAME="#SUPIN2"  TYPE="%-1s"  FUNCTIONS="T(0)"/>
<ITEM NAME="#REASON"  TYPE="%-6s"  FUNCTIONS="T(0)"/>
<ITEM NAME="#TLRNO"   TYPE="%6d"   FUNCTIONS="T($TLRNO)"/>
<ITEM NAME="#NBCD"    TYPE="%-1s"  FUNCTIONS="T(0)"/>
<ITEM NAME="#TRNMOD"  TYPE="%-1s"  FUNCTIONS="T(0)"/>
<ITEM NAME="#SBTMOD"  TYPE="%-1s"  FUNCTIONS="T(0)"/>
<!--<ITEM NAME="#CURCD"   TYPE="%-3s"  FUNCTIONS="T(RMB)"/>--><!--同名ITEM liangq注-->
<ITEM NAME="#XCRT"    TYPE="%-8s"  FUNCTIONS="T($XCRT)"/>
<ITEM NAME="#OPNBR"   TYPE="%-7s"  FUNCTIONS="T($KINBR)"/>
<ITEM NAME="#TXAMT"   TYPE="%13.2f" FUNCTIONS="T(#iTxAmt,4,12)"J(XTxAmt)/>
<ITEM NAME="#XTxAmt"  TYPE="%20s"   FUNCTIONS="X(#TXAMT)"/>
<!-- 101域变量 -->
  <ITEM NAME="#FD10101"    TYPE="%-24s"  FUNCTIONS=""/>     <!--1账号-->
  <ITEM NAME="#FD10102"    TYPE="%4d"    FUNCTIONS=""/>     <!--2账户序号-->
  <ITEM NAME="#FD10103"    TYPE="%-16s" FUNCTIONS="T()"/>  <!--3金额-->
  <ITEM NAME="#FD10104"    TYPE="%-3s"   FUNCTIONS="" />    <!--4凭证种类-->
  <ITEM NAME="#FD10105"    TYPE="%16d"   FUNCTIONS=""/>     <!--5凭证号-->
  <ITEM NAME="#FD10106"    TYPE="%-10s"  FUNCTIONS=""/>     <!--6摘要-->
  <ITEM NAME="#FD10107"    TYPE="%-1s"   FUNCTIONS=""/>     <!--7有折无折-->
  <ITEM NAME="#FD10108"    TYPE="%-60s"  FUNCTIONS=""/>     <!--8户名-->
  <ITEM NAME="#FD10109"    TYPE="%17.2f" FUNCTIONS=""/>     <!--9余额-->
  <ITEM NAME="#FD10110"    TYPE="%-2s"   FUNCTIONS=""/>     <!--A币种-->
  <ITEM NAME="#FD10111"    TYPE="%-1s"   FUNCTIONS=""/>     <!--B现转标志-->
  <ITEM NAME="#FD10112"    TYPE="%-3s"   FUNCTIONS=""/>     <!--C摘要选项-->
  <ITEM NAME="#FD10113"    TYPE="%-1s"   FUNCTIONS=""/>     <!--D帐户类型-->
  <ITEM NAME="#FD10114"    TYPE="%-4s"   FUNCTIONS=""/>     <!--E账户序号2-->
  <ITEM NAME="#FD10115"    TYPE="%-30s"  FUNCTIONS=""/>     <!--F产品名称-->
<!-------以上是FD101域的内容-------->
<!-- 102域变量 -->
<ITEM NAME="#ID_TYPE"     TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#ID_NO"       TYPE="%-20s" FUNCTIONS=""/>
<ITEM NAME="#ACTNO24"     TYPE="%-24s" FUNCTIONS=""/>
<ITEM NAME="#ACTSEQ"      TYPE="%-4s"  FUNCTIONS=""/>
<ITEM NAME="#VOCTYPE"     TYPE="%-3s"  FUNCTIONS=""/>
<ITEM NAME="#VOCNUM"      TYPE="%16d"  FUNCTIONS=""/>
<ITEM NAME="#FETCHFLAG"   TYPE="%1s"   FUNCTIONS=""/>
<ITEM NAME="#PWDFLAG"     TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#QUE_PWD"     TYPE="%6s"   FUNCTIONS=""/>
<ITEM NAME="#CERTFLAG"    TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#CERTNO20"    TYPE="%-20s" FUNCTIONS=""/>
<ITEM NAME="#STAMPFLAG"   TYPE="%1s"   FUNCTIONS=""/>
<ITEM NAME="#PWDFLAG2"    TYPE="%1s"   FUNCTIONS=""/>  
<ITEM NAME="#PWD16"       TYPE="%-16s" FUNCTIONS=""/>
<ITEM NAME="#PRINTDATE"   TYPE="%-8s"  FUNCTIONS=""/>      
<ITEM NAME="#TXAMT15"     TYPE="%-16s" FUNCTIONS=""/>
<ITEM NAME="#CERTTYPE"    TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#CUSTNAME"    TYPE="%-60s" FUNCTIONS=""/>
<ITEM NAME="#AVBAL"       TYPE="%17.2f" FUNCTIONS=""/>
<ITEM NAME="#CURCD"       TYPE="%-2s"  FUNCTIONS="T(YY)"/>
<ITEM NAME="#CT_IND"      TYPE="%-1s"  FUNCTIONS="T(2)"/>
<!--<ITEM NAME="#DSCPT"       TYPE="%-3s" FUNCTIONS=""/>--><!--同名ITEM liangq注-->
<ITEM NAME="#ACTTYPE"     TYPE="%-1s" FUNCTIONS=""/>
<ITEM NAME="#ACTSEQ_2"    TYPE="%-4s" FUNCTIONS=""/>
<ITEM NAME="#ACCOUNTFLAG" TYPE="%-1s" FUNCTIONS=""/>
<ITEM NAME="#INTEREST1"   TYPE="%-16s" FUNCTIONS=""/>
<ITEM NAME="#INTEREST2"   TYPE="%-16s" FUNCTIONS=""/>  
<ITEM NAME="#INTEREST3"   TYPE="%-16s" FUNCTIONS=""/>
<ITEM NAME="#PAYAMOUNT"   TYPE="%-16s" FUNCTIONS=""/>  
<ITEM NAME="#NEWVOCNUM"   TYPE="%-16d" FUNCTIONS=""/>
<ITEM NAME="#SPEFLAG"     TYPE="%-20s" FUNCTIONS=""/>    
<ITEM NAME="#PRODNAME"    TYPE="%-30s" FUNCTIONS=""/>
<ITEM NAME="#ACTNO_24"    TYPE="%-24s" FUNCTIONS=""/> 
<ITEM NAME="#EDUCREDIT"   TYPE="%1s"   FUNCTIONS=""/> 
<ITEM NAME="#DESC10"      TYPE="%-10s" FUNCTIONS=""/>
<ITEM NAME="#DRAW_PWD"       TYPE="%-6s"       FUNCTIONS=""/>
<!--定义102域变量over-->
<ITEM LINE="21"  COL="65"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT">
<ONCLICK>"{
  submit();
}"
</ONCLICK>
</ITEM>
</VARIABLE>
<RESPONSE>
<PACKAGE DEVICE="SCREEN"  DESC="显示内容">
NOTHING
</PACKAGE>
<PRINT>
"{
    print(02,0,'                    银行本票退回');
    print(05,0,'           出票  日期：[08]',#iSignDay);
    print(06,0,'           本票  号码: [16]',#iPoNo);
    print(08,0,'           付款人帐号: [32]',#iPayActNo);
    print(09,0,'           付款人名称: [60]',#iPayName);
    print(10,0,'           金      额: [20]',#XTxAmt);
    print(12,0,'           收款人帐号: [32]',#iCashActNo);
    print(13,0,'           收款人名称: [60]',#iCashName);
    print(15,0,'           兑付行行号: [12]',#iCashBrNo);
    print(16,0,'           兑付行行名: [60]',#iCashBrName);
    print(17,0,'           摘      要: [60]',#iResume);
    print(18,0,'           流  水　号: [ 6]',$FD4);
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印普通凭证">
NOTHING
</PACKAGE>
<PRINT>
"{
    dim @txdate as string;
    @txdate=substr($HDATE,0,4)+'/'+substr($HDATE,4,2)+'/'+substr($HDATE,6,2);
    dim @txtime  as string;
    @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
    print( 5, 20,'机构名称:[30]',$BRNAME);
	  print( 5, 2,'代码:6346');
	  print( 5, 13,'交易:银行本票退回');
    print(07,11,'                                                                          交易日期:[10]',@txdate);
    print(08,11,'         本票  号码: [16          ]                 [12          ]',#iPoNo,#oBpType);
    print(10,11,'         付款人帐号: [32]',#iPayActNo);
    print(11,11,'         付款人名称: [60]',#iPayName);
    print(12,11,'         收款人帐号: [32]',#iCashActNo);
    print(13,11,'         收款人名称: [60]',#iCashName);
    print(14,11,'         兑付行行号: [12]',#iCashBrNo);
    print(15,11,'         兑付行行名: [60]',#iCashBrName);
    print(16,11,'         金      额: [20]',#XTxAmt);
    print(17,11,'         摘      要: [60]',#iResume);
    print(24,20,'备注:');
    print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
    print(24,5,'柜员:[4]',$FD7);
    print(24,5,'流水号:[6]',$FD4);
   
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="24" DESC="打印专用凭证" >
NOTHING
</PACKAGE>
<PRINT>
"{
$KINDNO='00';
dim @txtime  as string;
@txtime=substr($HDATE,0,2)+':'+substr($HDATE,2,2)+':'+substr($HDATE,4,2);
  print( 5, 20,'机构名称:[30]',$BRNAME);
	print( 5, 2,'代码:6346');
	print( 5, 13,'交易:银行本票退回');
	printacdtl_1();
	print(24,20,'备注:');
  print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
  print(24,5,'柜员:[4]',$FD7);
  print(24,5,'流水号:[6]',$FD4);
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="24" DESC="请打印业务专用凭证" >
NOTHING
</PACKAGE>
<PRINT>
"{
$KINDNO='00';
dim @txtime  as string;
@txtime=substr($HDATE,0,2)+':'+substr($HDATE,2,2)+':'+substr($HDATE,4,2);
    print( 5, 20,'机构名称:[30]',$BRNAME);
	  print( 5, 2,'代码:6346');
	  print( 5, 13,'交易:银行本票退回'); 
		print( 9,20,'委托 日 期:[8       ]',$HDATE);
		print(10,20,'本票 号 码:[16]',#iPoNo);
		if(#iBpType=='0')
		{
		print(11,20,'出票人帐号:[32]',#iPayActNo);
    print(12,20,'出票人名称:[60]',#iPayName);
		}
		print(13,20,'退回 金 额:[20]',ltrim(#XTxAmt));
		print(18,80,'\L0经确认，银行打印无误\L1');
		print(20,80,'客户签名:_____________________');
		
		print( 24,20,'备注:');
		print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
		print( 24,5,'柜员:[4]',$FD7);
		print( 24,5,'流水号:[6]',$FD4);
}"
</PRINT>
</RESPONSE>
</TRANSACTION>

