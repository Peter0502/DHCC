<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="6823 回购式再贴现记账"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
  <COMMSEND>"{
		initfd();
		$MSGTYPE='03001';
		dim @baktxno as string;
		@baktxno=$TXNO;
		$FD12='4944';
		$TXNO='9986';
		$FD30=#RHZBJZH;
		$FD44=#ZTXRQ;
		$FD46=#HGRQ ;
		$FD62=#XYBH ;
		$FD100=getitems('#KKKK#HZPJJE');
		commsend_001();
		callserver();
		if($FD12!='0000')
		  {
			 showmsg(geterror());
			 return(false);
		  }
		$FD16='4944';
		$MSGTYPE='03001';
	}"
</COMMSEND>
<COMMRECV>"{
	if($FD12 == '0000')
	{
		showmsg('交易成功!');
	}
}"
</COMMRECV>
<FIRSTWORK>"{
	//dim @txno_bak as string;
	//dim @tota as string;
	//@txno_bak=$TXNO;
	//$TXNO='9885';
	//commsend_001();
	//@tota=callserver();
	//showmsg(@tota);	
	//setsel(#PZZL,@tota,'o5t20o1v3o2');
	//$FD11='';
}"
</FIRSTWORK>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(6823                        回购式再贴现记账  )"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
   <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4944)"/>
   <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
   <!--输入变量-->
  <ITEM LINE="7"   COL="3" TYPE="%-16s" FUNCTIONS="T(再贴现协议编号:)"/>
    <ITEM LINE="9"   COL="3" TYPE="%-16s" FUNCTIONS="T(人行准备金帐号:)"/>

  <ITEM LINE="11"   COL="3" TYPE="%-70s" FUNCTIONS="T(--------------------【以下为票面信息】-----------------------------)"/>
  <ITEM LINE="13"   COL="3" TYPE="%-14s" FUNCTIONS="T(汇总票据金额:)"/>
  <ITEM LINE="15"   COL="3" TYPE="%-14s" FUNCTIONS="T(再贴现日期:)"/>
  <ITEM LINE="15"   COL="33" TYPE="%-14s" FUNCTIONS="T(回购日期:)"/>



  <ITEM NAME="#XYBH" 	INPUT="TEXT" LINE="7" COL="19" TYPE="%-20s" 	FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
  "{
  	enable(#ZTXRQ , true);
	enable(#HGRQ  , true);
	enable(#HZPJJE, true);

	$TXNO='9883';
	$FD62=#XYBH;

		commsend_001();
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
			}



		#ZTXRQ =$FD44;
		#HGRQ  =$FD46;
		#HZPJJE= val(substr( $FD100, 16, 16), 0.01);



	enable(#ZTXRQ , false);
	enable(#HGRQ  , false);
	enable(#HZPJJE, false);

  }"
  </ONLOSTFOCUS>

   </ITEM>
  <ITEM NAME="#RHZBJZH" 	INPUT="TEXT" LINE="9" COL="19" TYPE="%-24s" 	FUNCTIONS="T()V(NB)"/>

  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>

   <ITEM NAME="#HZPJJE"	 LINE="13" COL="15" TYPE="%17.2f" INPUT="TEXT"	FUNCTIONS="T()V(NB)"/>
  <ITEM NAME="#ZTXRQ"	 LINE="15" COL="15" TYPE="%8d" INPUT="TEXT"	FUNCTIONS="T()D()V(NB)"/>
    <ITEM NAME="#HGRQ"	 LINE="15" COL="45" TYPE="%8d" INPUT="TEXT"	FUNCTIONS="T()D()V(NB)"/>

  <ITEM NAME="#FD" TYPE="%-1s">
  <ONLOSTFOCUS>
  "{

		$FD44=#ZTXRQ;
		$FD46=#HGRQ;
		$FD100=space(16)+itoa(#HZPJJE*100, '%016.0f');
		$FD30=#RHZBJZH;

	}"
  </ONLOSTFOCUS>
  </ITEM>


  <ITEM NAME="#SUBMIT" LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  <!---
  <ONCLICK>
  "{
  $FD12='4944';
		$TXNO='9986';

		commsend_001();
		//showmsg('$84=['+$FD84+']');
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
			}

	
		$FD12='';
		$FD16='4944';
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
			}
			
		//return(false);

  }"
  </ONCLICK>
  </ITEM>
  -->
	 <ITEM NAME="#KKKK" TYPE="%-16s" FUNCTIONS="T()"/>
     <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($FD5,1,4)"/>
	 <ITEM NAME="#MON"   TYPE="%-2s" FUNCTIONS="T($FD5,5,2)"/>
	 <ITEM NAME="#DAY"   TYPE="%-2s" FUNCTIONS="T($FD5,7,2)"/>
    </VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="回购式再贴现记账!">
NOTHING
</PACKAGE>
<PRINT>"{
	 print( 8, 20,'再贴现协议编号: [20]',#XYBH);
	 print( 9, 20,'人行准备金帐号: [24]',#RHZBJZH);
	 print(10, 20,'记帐成功');
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="38" DESC="打印凭条">
 NOTHING
</PACKAGE>
<PRINT>"{
      print( 5, 16,'[4]     [2]     [2]',#YEAR,#MON,#DAY);
      print( 7,  8,'[5]',$FD2);
	  print( 7, 24,'4944 回购式再贴现记账');
	  print( 7, 46,'[4]',$FD7);
      print( 7, 62,'[6]',$FD4);
      print( 8,  2,'再贴现协议编号: [20]',#XYBH);
      print( 9,  2,'人行准备金帐号: [24]',#RHZBJZH);
	  print(10,  2,'记帐成功');
}"
</PRINT>
</RESPONSE>
</TRANSACTION>
   
   
   
   
    
   
  
