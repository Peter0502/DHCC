<?xml version="1.0"  encoding="GBK" ?>
<TRANSACTION RIGHTS="11111111011100000000000001100010" TITLE="非税缴款"
xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<VARIABLE>
	<ITEM LINE="3" COL="3"   TYPE="%-70s"    FUNCTIONS="T(9993                           非税缴款 )"/>
	<ITEM LINE="4" COL="3"   TYPE="%-70s"    FUNCTIONS="T(────────────────────────────────────────)"/>
  <ITEM NAME="#VERSIONNO"  TYPE="%-3s"     FUNCTIONS="T(1.0)"/> 
  <ITEM NAME="#TXNO"       TYPE="%-4s"     FUNCTIONS="T($TXNO=2205)"/>
  <ITEM NAME="#MSGTYPE"    TYPE="%-5s"     FUNCTIONS="T($MSGTYPE=03001)"/>
	<ITEM NAME="#WDDM"       TYPE="%-10s"    FUNCTIONS="T($KINBR)"/>
	<ITEM NAME="#GYNAME"     TYPE="%-10s"    FUNCTIONS="T($TLRNO)"/>
	<ITEM NAME="#SKDATE"    TYPE="%-10s"    FUNCTIONS="T($HDATE)"/>
	 <ITEM   NAME="#UNIT"      TYPE="%-14s"    FUNCTIONS=""/>	
 <PAGE NAME="DEFAULT">	 
 
  <ITEM LINE="5" COL="3"   TYPE="%-12s"    FUNCTIONS="T(所属财政局:)"/>
  <ITEM LINE="5"  COL="15"  TYPE="%2s"      NAME="#JKDW"  INPUT="SELECT" FUNCTIONS="V(NB)T(00)">	
	<SELECT>
		<OPTION VALUE="00" TITLE="0.晋中市财政局"/>
		<OPTION VALUE="10" TITLE="1.榆次区财政局"/>
		<OPTION VALUE="20" TITLE="2.介休市财政局"/>
	</SELECT>
  </ITEM>
  <ITEM LINE="5" COL="40"   TYPE="%-12s"    FUNCTIONS="T(缴款流水号:)"/>
  <ITEM LINE="6" COL="3"   TYPE="%-12s"    FUNCTIONS="T(银 行 代 码:)"/>	
	<ITEM LINE="5" COL="52"  TYPE="%-20s"    NAME="#JJLSHAO" INPUT="TEXT"  FUNCTIONS="T()V(NB)">		
	  <ONLOSTFOCUS>
		 "{
		   //showmsg($HDATE);
		   show(#HEDUI1,false);
   		 show(#HEDUI,false);
			 initfd();
			 commsend_002();
			 $FD16 = '8305';    //银行向财政读取执收单位单笔开票信息
			 //$FD86 = #YHDM;     //银行代码
			 $FD30 = #JJLSHAO;  //缴款流水号	
			 if(#JKDW=='00')
			{
			$FD67='1';
			#UNIT='晋中市财政局';
			}
			else if(#JKDW=='10')
			{
			$FD67='2';
			#UNIT='榆次区财政局';
			}	
			else if(#JKDW=='20')
			{
			$FD67='3';
			#UNIT='介休市财政局';
			}	
			 callagnnew();
			 if($FD12 != '0000')
			 {
				 showmsg(geterror());
				 return(false);
			 }
			 else
			 {			
				#CZDM=$FD86;        //财政代码
				#YHDM=$FD87;        //银行代码
				#DWDM=$FD31;        //单位代码
				#KPID=$FD32;        //开票ID
				#KPDATE=delspace($FD62);      //开票日期
				#PJNO=$FD58;        //票据编号
				#PJYSNO=$FD37;      //票据印刷号				
				#AMT=val($FD40);       //金额				  
				#FKRNAME=$FD26;     //付款人名称				
				#SKRNAME=$FD25;      //收款人名称
				#SKRBANK=$FD76;     //收款人银行
				#SKRACCNO=$FD83;    //收款人账号				
				#JKFS=delspace($FD33);  //缴款方式
				#JKR=delspace($FD113);
				#FKHNO=delspace($FD59);
				#FKRBANK=delspace($FD27);
				#FKRACCNO=delspace($FD81);
				#SKHNO=delspace($FD82);
				#ZAIYAO=delspace($FD118);
				enable(#CZDM,false);
				enable(#YHDM,false);
				enable(#DWDM,false);
				enable(#KPID,false);
				enable(#KPDATE,false);
				enable(#PJNO,false);
				enable(#PJYSNO,false);		
				enable(#AMT,false);			
				enable(#FKRNAME,false);	
				enable(#FKRBANK,false);	
				enable(#FKHNO,false);
				enable(#FKRACCNO,false);
				enable(#SKRACCNO,false);	
				enable(#SKRNAME,false);
				enable(#SKRBANK,false);
				enable(#SKRACCNO,false);				
				enable(#JKFS,false);
				show(#HEDUI1,true);
				show(#HEDUI,true);   
				enable(#ZAIYAO,false);
				enable(#SKHNO,false);
				enable(#JKR,false);	
				enable(#JKFS,false);
		   }
		 }"
		</ONLOSTFOCUS>
	</ITEM>
	<ITEM LINE="6" COL="15"  TYPE="%-10s"    NAME="#YHDM"    INPUT="TEXT"  FUNCTIONS="T()V(NB)"/>
	<ITEM LINE="6"  COL="41" TYPE="%-12s"    FUNCTIONS="T(财 政 代 码:)"/>	
	<ITEM LINE="6"  COL="53" TYPE="%-10s"    NAME="#CZDM"    INPUT="TEXT"  FUNCTIONS="T()"/>
	<ITEM LINE="7"  COL="3"  TYPE="%-12s"    FUNCTIONS="T(单 位 代 码:)"/>	
	<ITEM LINE="7"  COL="15" TYPE="%-20s"    NAME="#DWDM"  INPUT="TEXT"    FUNCTIONS="T()"/>
	<ITEM LINE="7"  COL="41" TYPE="%-12s"    FUNCTIONS="T(开  票   ID:)"/>	
	<ITEM LINE="7"  COL="53" TYPE="%-10s"    NAME="#KPID"    INPUT="TEXT"  FUNCTIONS="T()"/>
	<ITEM LINE="8"  COL="3"  TYPE="%-12s"    FUNCTIONS="T(开 票 日 期:)"/>	
	<ITEM LINE="8"  COL="15" TYPE="%-20s"    NAME="#KPDATE"  INPUT="TEXT"  FUNCTIONS="T()"/>
	<ITEM LINE="8"  COL="41" TYPE="%-12s"    FUNCTIONS="T(票 据 编 号:)"/>	
	<ITEM LINE="8"  COL="53" TYPE="%-10s"    NAME="#PJNO"    INPUT="TEXT"  FUNCTIONS="T()"/>
	<ITEM LINE="9"  COL="3"  TYPE="%-12s"    FUNCTIONS="T(票据印刷号:)"/>	
	<ITEM LINE="9"  COL="15" TYPE="%-20s"    NAME="#PJYSNO"  INPUT="TEXT"  FUNCTIONS="T()"/>
	<ITEM LINE="9"  COL="41" TYPE="%-12s"    FUNCTIONS="T(金       额:)"/>	
	<ITEM LINE="9"  COL="53" TYPE="%-16.2f"  NAME="#AMT"   INPUT="TEXT"  FUNCTIONS="V(0000000000000001,9999999999999999)"/>		
	<ITEM LINE="10" COL="3"  TYPE="%-12s"    FUNCTIONS="T(缴  款  人:)"/>	
	<ITEM LINE="10" COL="15" TYPE="%-60s"    NAME="#JKR"     INPUT="TEXT"  FUNCTIONS="T()"/>
	<ITEM LINE="11" COL="3"  TYPE="%-12s"    FUNCTIONS="T(付款人名称:)"/>	
	<ITEM LINE="11" COL="15" TYPE="%-60s"    NAME="#FKRNAME" INPUT="TEXT"  FUNCTIONS="T()"/>
	<ITEM LINE="12" COL="3"  TYPE="%-12s"    FUNCTIONS="T(付款人银行:)"/>	
	<ITEM LINE="12" COL="15" TYPE="%-60s"    NAME="#FKRBANK" INPUT="TEXT"  FUNCTIONS="T()"/>
	<ITEM LINE="13" COL="3"  TYPE="%-12s"    FUNCTIONS="T(付款人帐号:)"/>	
	<ITEM LINE="13" COL="15" TYPE="%-40s"    NAME="#FKRACCNO" INPUT="TEXT" FUNCTIONS="T()"/>
	<ITEM LINE="14" COL="3"  TYPE="%-12s"    FUNCTIONS="T(付款行行号:)"/>	
	<ITEM LINE="14" COL="15" TYPE="%-20s"    NAME="#FKHNO"    INPUT="TEXT" FUNCTIONS="T()"/>				
	<ITEM LINE="15" COL="3"  TYPE="%-12s"    FUNCTIONS="T(收款人名称:)"/>	
	<ITEM LINE="15" COL="15" TYPE="%-60s"    NAME="#SKRNAME"  INPUT="TEXT" FUNCTIONS="T()"/>
	<ITEM LINE="16" COL="3"  TYPE="%-12s"    FUNCTIONS="T(收款人银行:)"/>	
	<ITEM LINE="16" COL="15" TYPE="%-60s"    NAME="#SKRBANK"  INPUT="TEXT" FUNCTIONS="T()"/>
	<ITEM LINE="17" COL="3"  TYPE="%-12s"    FUNCTIONS="T(收款人账号:)"/>	
	<ITEM LINE="17" COL="15" TYPE="%-19s"    NAME="#SKRACCNO" INPUT="TEXT" FUNCTIONS="T()"/>
	<ITEM LINE="18" COL="3"  TYPE="%-12s"    FUNCTIONS="T(收款行行号:)"/>	
	<ITEM LINE="18" COL="15" TYPE="%-12s"    NAME="#SKHNO"    INPUT="TEXT" FUNCTIONS="T()"/>	
	<ITEM LINE="18" COL="41" TYPE="%-12s"    FUNCTIONS="T(缴 款 方 式:)"/>	
	<ITEM LINE="18" COL="53" TYPE="%-8s"     NAME="#JKFS"     INPUT="TEXT" FUNCTIONS="T()"/>		
	<ITEM LINE="19" COL="3"  TYPE="%-12s"    FUNCTIONS="T(摘      要:)"/>	
	<ITEM LINE="19" COL="15" TYPE="%-20s"    NAME="#ZAIYAO"  INPUT="TEXT"  FUNCTIONS="T()"/>			
	<ITEM LINE="20"  COL="3"  NAME="#HEDUI1" TYPE ="%-16s"   INPUT="LABEL"  FUNCTIONS = "T(核对是否有误:!)"/>	
  <ITEM LINE="20"  COL="19" NAME="#HEDUI"  TYPE="%-1s"     INPUT="SELECT"  FUNCTIONS="T(0)V(NB)" >
	  <SELECT>
			<OPTION VALUE ="0" TITLE="0.信息正确" />
			<OPTION VALUE ="1" TITLE="1.信息有误" />
	  </SELECT> 
		<ONLOSTFOCUS>
		 "{		   
		   if(#HEDUI=='0') 
		   {
		   	loadpage('PAGE3');
			show(#HEDUI1,false);
   			show(#HEDUI,false);
		   }
		   else
		   {
		   	 goitem(#JJLSHAO,true);
		   	 enable(#YHDM,true);
		   }
		  }"
		</ONLOSTFOCUS>
  </ITEM>	
 </PAGE>
 <PAGE NAME="PAGE3">
	<ITEM LINE="07"   COL="11"  TYPE="%-10s"  FUNCTIONS="T(帐    号:)"/>
	<ITEM LINE="08"   COL="10"  TYPE="%-16s"  FUNCTIONS="T(【产品信息】)"/>
	<ITEM LINE="09"   COL="11"  TYPE="%-60s"  FUNCTIONS="T(-----------------------------------------------------------------)"/>
	<ITEM LINE="7"    COL="21"  NAME="#ACTNO" TYPE="%-19s" DEVICE="KEYBOARD"  FUNCTIONS="T()">
	<ONGOTFOCUS>
	"{
	}"
	</ONGOTFOCUS>
    <ONLOSTFOCUS>
     "{
		dim @s as string;
		dim @tota as string;
		dim @list1 as string;
		dim @list2 as string;
		dim @i as number;
		//add begin by zzz20121012
		dim @total as string ;
		dim @selid as number;
		//获取账号
		initfd();
		commsend_002();
		$FD16='9598';
		$FD123='select fsaccount ,memo from fsmap where class='+chr(39)+'fssraccount'+chr(39);
		callagnnew();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		@total=getfiletxt('../tmp/'+$KINBR+$TTYNAME);
		if(@total=='')
		{
			showmsg('记录异常!');
			return(false);
		}
		@total='~@账号|@用途|'+chr(10)+@total;
		autolist(@total);
		@selid=list_work();
		if(@selid &lt; 0)
		{
			showmsg('请选中记录!');
			return(false);
		}
		#ACTNO='';
		#ACTNO=list_gettext(@selid,0);
		enable(#ACTNO,true);
		//add end20121012
		initfd();
		$TXNO='9954';
		$FD101=#ACTNO;
		commsend_002();
		@tota=callserver();
		if($FD12!='0000')
		{
			showmsg(geterror());
			return(false);
		}
		setitems('#ACTNO24#ACTSEQ#TXAMT#VOCTYPE#VOCNUM#DESC10#NBFLAG#CUSTNAME#AVBAL#CURCD#CASHFLAG#DSCPT#ACTTYPE#ACTSEQ_2#PRODNAME',$FD101);//del by zzz
		show(#LNAME,true);
		show(#LCURCD,true);
		show(#LAVBAL,true);
		show(#LPRODNAME,true);
		show(#LVOCTYPE,true);
		show(#LCASHFLAG,true); //取消转帐
		show(#LTXAMT,true);
		show(#VOCTYPE,true);
		delspace(#CUSTNAME);
		show(#CUSTNAME,true);
		show(#CURCD,true);
		show(#XAVBAL,true);
		show(#PRODNAME,true);
		show(#VOCTYPE,true); 
		show(#CASHFLAG,true); //取消转帐
		show(#LVOCDSCPT,true);
		show(#VOCDSCPT,true);
		show(#TXAMT,true);
		#TXAMT = #AMT ;
		enable(#TXAMT,false);
		showblock('ACTINFO',true,true); //改为BLOCK形式	
		if(#ACTNO=='5001620300015')
		{
		if(#JKDW!='00')
		{
		showmsg('财政账号选择错误!');
		return (false);
		}
		}
		else if(#ACTNO=='5001530400012')
		{
		if(#JKDW!='10')
		{
		showmsg('财政账号选择错误!');
		return (false);
		}
		}
		else if(#ACTNO=='5009851600029')
		{
		if(#JKDW!='20')
		{
		showmsg('财政账号选择错误!');
		return (false);
		}
		}
		}
			}"
		</ONLOSTFOCUS>
	</ITEM>
	<ITEM LINE="7" COL="41"  TYPE="%-18s" FUNCTIONS="T(*按回车键选择账号)"/>	
  <BLOCK NAME="ACTINFO"  VISABLE="FALSE">
		<ITEM LINE="10"  COL="11" NAME="#LNAME"      INPUT="LABEL"  TYPE="%-10s" FUNCTIONS="T(户    名:)"/>
		<ITEM LINE="10"  COL="23" NAME="#CUSTNAME"   TYPE="%-60s"   FUNCTIONS=""/>
		
		<ITEM LINE="11"  COL="11" NAME="#LCURCD"     INPUT="LABEL"  TYPE="%-10s" FUNCTIONS="T(币    种:)"/>
		<ITEM LINE="11"  COL="21" NAME="#CURCD"      TYPE="%-2s"    FUNCTIONS="">
			<SELECT>
				 <OPTION VALUE="01" TITLE="人民币"/>
			</SELECT>
	     </ITEM>

		<ITEM  NAME="#LAVBAL"   TYPE="%-10s" FUNCTIONS="T(余    额:)"/>
		<ITEM NAME="#AVBAL" TYPE="%17.2f"  FUNCTIONS="J(#XAVBAL)"/>
		<ITEM  NAME="#XAVBAL"   TYPE="%-16s" FUNCTIONS="X(#AVBAL)"/>
		
		<ITEM LINE="13"  COL="11" NAME="#LPRODNAME"  INPUT="LABEL"  TYPE="%-10s" FUNCTIONS="T(产品名称:)"/>		  
		<ITEM LINE="13" COL="21" NAME="#PRODNAME" TYPE="%-30s"  FUNCTIONS=""/>
		
		<ITEM LINE="14"  COL="11" NAME="#LVOCTYPE"   INPUT="LABEL"  TYPE="%-10s" FUNCTIONS="T(凭证类型:)"/>
		<ITEM LINE="14" COL="21" NAME="#VOCTYPE"  TYPE="%-3s"   INPUT="SELECT"    DEVICE="KEYBOARD" FUNCTIONS="">
			<SELECT>
				 <OPTION VALUE="119" TITLE="现金交款单"/>
				 <OPTION VALUE="299" TITLE="其他凭证"/>
			</SELECT>
		</ITEM>
		
		<ITEM LINE="15"  COL="11" NAME="#LCASHFLAG"  INPUT="LABEL"  TYPE="%-10s" FUNCTIONS="T(现转标志:)"/>
		<ITEM LINE="15" COL="21" NAME="#CASHFLAG" TYPE="%-1s" INPUT="SELECT"   FUNCTIONS="">
		  <SELECT>
				<OPTION VALUE="1" TITLE="1.现金"/>
			</SELECT>
			<ONLOSTFOCUS>"{
		 if(#CASHFLAG=='2')
		 {
		 show(#ACCTNO,true);
		 show(#TJKRMC,true);
		 show(#VJKRZH,true);
		 show(#TJKRMC,true); 
     show(#JKRMC,true);
		 }
		else
		 {
		 show(#ACCTNO,false);
		 show(#TJKRMC,false);
		 show(#VJKRZH,false);
		 show(#TJKRMC,false); 
     show(#JKRMC,false);
		 }
		
	}"</ONLOSTFOCUS>
		</ITEM>
		<ITEM  LINE="16"  COL="11"   NAME="#ACCTNO" TYPE="%-6s"   FUNCTIONS="T(账号:)" INPUT="LABEL" VISABLE="FALSE" />
		<ITEM LINE="16"  COL="17"  NAME="#VJKRZH" 	TYPE="%-19s"  VISABLE="FALSE"    DEVICE="MSR" INPUT="TEXT"   FUNCTIONS="m($MSR2,1,19)V(NB)">
    <ONLOSTFOCUS>
  "{
    dim @note_sts as string;
    dim @name as string;
    dim @avbal as string;
    dim @pwd_ind as string;
    dim @actype as string;
    dim @js_lx   as string;
    dim @mdm_code as string;
    dim @opn_brno as string;
    dim @tota as string;
    dim @zj_ind as string;
	  dim @opn_br_no as string;
  	dim @prdt_no as string;
	  dim @lyezh as string;
	  #ACNO=#VJKRZH;
	  @lyezh=#VJKRZH;
	//处理旧账号
    if(len(#ACNO)==18)
    {
     showmsg('请用新帐号缴款');
     //return(false);
    }
    
    //取产品编号
  	initfd();
	commsend_001();
	$FD16='9598';	
	$FD123='select prdt_no from dd_mst where ac_id =(select ac_id from mdm_ac_rel where ac_no='+chr(39)+ #VJKRZH+chr(39)+' )';
	@tota=callserver();
	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}

	@prdt_no=strfld(@tota,'|',0);
	if(@prdt_no=='')
  	{
  		showmsg('此账号不存在!');
      	return(false);
  	}
    
    
	//根据帐号回显账户序号及信息
	//9331类似于9731
	  initfd();
    commsend_001();
    $FD16='9331';
    $FD102=#ACTNO;
    callserver();
    if($FD12 != '0000')
    {
     showmsg(geterror());
     return(false);
    }
     @js_lx = $FD70;
    #JKRMC=delspace($FD25);
    enable(#JKRMC,true);
    //余额
    @avbal=substr($FD102,185,16);
    //是否凭密支取
    @pwd_ind=substr($FD102,48,1);
    //帐户类型
    @actype=substr($FD102,207,1);
    //凭证种类==介质类型
    @mdm_code=substr($FD102,28,3);
    @opn_br_no=delspace($FD91);
    //凭证件支取标志
    @zj_ind =substr($FD102,61,1);         
    //证件类型        
		
		
	//检查账户类型
    if( substr($FD23,0,1)!='1')
    {
      showmsg('非活期账户,不能做此业务!');
      return(false);
    }
    
    //检查介质状态
    if( $FD98 != '0')
    {
     showmsg('介质状态异常!');
     return(false);
    }
    
    //检查账户状态
    if( $FD99 != '1')
    {
     showmsg('该账户处于非正常状态!');
     showmsg($FD99);
     return(false);
    }
    if( $FD71 == '1' or $FD71 == '2' or $FD71 == '3')
    {
     showmsg('该账户处于完全冻结或只进不出状态或部分冻结!');
     return(false);
    }
    showhelp(4,50,4,20,'账户信息:','户名:'+delspace(#JKRMC)+chr(10)+'余额:'+itoa(val(@avbal,0.01),'%16.2f'));
    if(#AMT &gt; val(@avbal,0.01) and @prdt_no != '12G')
    {
    	showmsg('该账户余额不足!');
     	return(false);
    }
    
    //凭密码支取
    if(@pwd_ind=='Y')
    {
      showmsg('需要检查密码');
      show(#ZQMM,true);
      show(#TXPWD,true);
    }
    else
    {
      show(#ZQMM,false);
      show(#TXPWD,false);
    } 
  }"
  </ONLOSTFOCUS>
 </ITEM>
    <ITEM LINE="16"   COL="40" TYPE="%-10s" INPUT="LABEL" VISABLE="FALSE"  FUNCTIONS="T(输入密码:)"  NAME="#ZQMM" />
     <ITEM NAME="#TXPWD"  LINE="16"  COL="50" TYPE="%6d"  DEVICE="PINPAD" INPUT="TEXT" VISABLE="FALSE" FUNCTIONS="I()i()V(NB)">
  <ONLOSTFOCUS>"{		
	//if(substr(#VJKRZH,0,6) == '621223' or substr(#VJKRZH,0,6)=='621780') 
   // {
	//	initfd();
	//	commsend_001();
	//	$FD16='7007';
	//	$FD30=#VJKRZH;
//$FD68='4';
	//	$FD79=#TXPWD;
	//	callagn();
	//	if( $FD12 != '0000')
	//	{
	//		showmsg(geterror());
	//		return(false);
	//	}
//	}
  		}"
       </ONLOSTFOCUS>
</ITEM>
  <ITEM  LINE="17"   COL="11" TYPE="%-12s" INPUT="LABEL"  NAME="#TJKRMC"  VISABLE="FALSE" FUNCTIONS="T(缴款人名称:)"/> 
  <ITEM  LINE="17"    COL="23" TYPE="%-50s" INPUT="TEXT"  NAME="#JKRMC"  VISABLE="FALSE" FUNCTIONS="T()V(NB)"/>  
 
		<ITEM LINE="18"  COL="11" NAME="#LTXAMT" INPUT="LABEL"  TYPE="%-10s" FUNCTIONS="T(发 生 额:)"/>
		<ITEM LINE="18"  COL="21" NAME="#TXAMT" TYPE="%17.2f" INPUT="TEXT"  DEVICE="KEYBOARD" FUNCTIONS="T(0000000000000000,9999999999999999)"/>
		
		<ITEM LINE="19"  COL="11" NAME="#LVOCDSCPT"  INPUT="LABEL"  TYPE="%-10s" FUNCTIONS="T(摘    要:)"/>
		<ITEM LINE="19" COL="21" NAME="#VOCDSCPT" TYPE="%-40s" INPUT="TEXT"   FUNCTIONS=""/>
		
		<ITEM LINE="20"  COL="11"  NAME="#HEDUI2"  TYPE ="%-10s" FUNCTIONS = "T(是否缴款:!)"/>	 
   		<ITEM LINE="20"  COL="21"  NAME="#HEDUI3"  TYPE="%-1s"   INPUT="SELECT"   FUNCTIONS="T(0)V(NB)" >
	    <SELECT>
			  <OPTION VALUE ="0" TITLE="0.是" />
			  <OPTION VALUE ="1" TITLE="1.否" />
	    </SELECT>
	    <ONLOSTFOCUS>
        "{
          if(#HEDUI3=='0')
          {
            //showmsg('开始缴款！');
          }
          else
          {
            //showmsg('退出缴款！');
            loadpage('DEFAULT');
            goitem(#JJLSHAO,true);
            enable(#YHDM,true);
          }
	      }"
		  </ONLOSTFOCUS>
    </ITEM> 
	</BLOCK>
	<!--下面变量是为了使9954能正确返回,不要删除begin-->
	<ITEM NAME="#ACTNO24"   TYPE="%-24s" FUNCTIONS="T(#ACTNO)"/>
	<ITEM NAME="#ACTSEQ"    TYPE="%-4s"  FUNCTIONS=""/>
	<ITEM NAME="#VOCNUM"    TYPE="%-16s" FUNCTIONS=""/>
	<ITEM NAME="#NBFLAG"    TYPE="%-1s"  FUNCTIONS=""/>
	<ITEM NAME="#DESC10"    TYPE="%-10s" FUNCTIONS=""/>
	<ITEM NAME="#DSCPT"     TYPE="%-3s"  FUNCTIONS=""/>
	<ITEM NAME="#ACTTYPE"   TYPE="%-1s"  FUNCTIONS=""/>
	<ITEM NAME="#ACTSEQ_2"  TYPE="%-4s"  FUNCTIONS=""/>	
	<!--上面变量是为了使9954能正确返回,不要删除end-->
 </PAGE>
 <ITEM  NAME="#BTN" LINE="21"  COL="63" TYPE="%-6s"    FUNCTIONS="T(确  定)" INPUT="BUTTON">
	<ONCLICK>
	"{	
		dim @enterIndex as number;
		initfd();
		commsend_002();
		@enterIndex = 1;
		$FD16='8306';
		$FD33 = #ACTNO ; //账号
		//showmsg('账号'+$FD33);
		$FD86=#CZDM;         //财政代码
		//showmsg('财政代码'+$FD86);
		$FD87=#YHDM;        //银行代码
		//showmsg('银行代码'+$FD87);
		$FD31=#DWDM;        //单位代码
		//showmsg('单位代码'+$FD31);
		$FD32=#KPID;        //开票ID
		//showmsg('开票ID'+$FD32);
		$FD30=#JJLSHAO;     //缴款流水号	
		//showmsg('缴款流水号'+$FD30);
		$FD59=#JKFS ;//缴款方式
		//showmsg('缴款方式'+$FD59);
		$FD38=#KPDATE;      //开票日期	
		//showmsg('开票日期'+$FD38);					
		$FD39=itoa(#AMT,'%-16.2f'); //交易金额
		//showmsg('$FD39='+$FD39);
		 $FD26=#FKRNAME;     //付款人名称
		 $FD27=#FKRBANK;     //付款人银行
		 $FD81=#FKRACCNO;    //付款人账号
		 $FD62=#FKHNO;       //付款行行号
		 $FD63=#VJKRZH;      //缴款人账号
		 $FD25=#SKRNAME;     //收款人名称
		 $FD76=#SKRBANK;     //收款人银行
		  $FD83=#JKR;     //缴款人姓名
		//$FD83=#SKRACCNO;    //收款人账号
		  $FD20=#CASHFLAG ;//现转标识
		  $FD58=#PJNO;//票据编码
		  $FD37=#PJYSNO;
		//$FD54=#WDDM;         //网点代码
		//$FD55=#GYNAME;       //银行人员
		  $FD82 = #SKHNO;
		  $FD118=#ZAIYAO; //摘要
		  $FD116=#VOCDSCPT;
		callagnnew();
		if($FD12!='0000')
		{
		  showmsg(geterror());
		  rerun();
		  return(false);
		}
		show(#BTN,false);
		runoutput();
		rerun();
	 }"
	</ONCLICK>
 </ITEM>
</VARIABLE>

<RESPONSE>
  <PACKAGE DEVICE="SCREEN"  DESC="银行向财政提交单笔缴款成功">
       NOTHING
  </PACKAGE>
  <PRINT>
   "{
    }"
  </PRINT>
</RESPONSE>

<RESPONSE>
  <PACKAGE DEVICE="SCREEN" DESC="显示内容">
   NOTHING
  </PACKAGE>
  <PRINT>
  	"{
	print(3,16,'晋中银行非税缴款凭条');
      	print(5,16,'机构:[8]  柜员:[8]',$FD3,$TLRNO); 
	print(6,16,'收款人帐号:[19]',#SKRACCNO); 
	print(7,16,'收款人全称:[60]',#SKRNAME); 
	print(8,16,'交易金额:[16]',delspace(comma(itoa(#AMT,'%.2f')))); 
	print(9,16,'入账单位:[16]',#UNIT);
	print(10,16,'缴款流水号:[20]',#JJLSHAO); 
	print(11,16,'日期:[8]  平台流水:[12]',$FD44,$FD52);
		
     }"
	</PRINT>
</RESPONSE>
<RESPONSE>
  <PACKAGE DEVICE="PRINTER" LINESPACE="22" DESC="请打印业务专用凭证"> 
    NOTHING
  </PACKAGE> 
  <PRINT>
   "{
	print(3,16,'晋中银行非税缴款凭条');
  print(5,16,'机构:[8]  柜员:[8]',$FD3,$TLRNO); 
	print(6,16,'收款人帐号:[19]',#SKRACCNO); 
	print(7,16,'收款人全称:[60]',#SKRNAME); 
	print(8,16,'交易金额:[16]',delspace(comma(itoa(#AMT,'%.2f')))); 
	print(9,16,'入账单位:[16]',#UNIT);
	print(10,16,'缴款流水号:[20]',#JJLSHAO); 
	print(11,16,'日期:[8]  平台流水:[12]',$FD44,$FD52);
	    //打印授权信息
      //print_sq(); 
    }"
  </PRINT>
</RESPONSE>
</TRANSACTION>
