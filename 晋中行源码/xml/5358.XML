<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111100" TITLE="5358 回执业务查询"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	    initfd();
	    commsend_001();
	    $FD28=#ORDERNO;
	    $FD44=#PACK_DATE;
	    $FD45=#WT_DATE;
	    $FD88=#BR_NO;
}"
</COMMSEND>
<COMMRECV>"{

}"
</COMMRECV>
<VARIABLE>
      <ITEM LINE="3"  COL="3" TYPE="%-50s" FUNCTIONS="T(5358                  回执业务查询)"/>
      <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
       "T(─────────────────────────────────────)"/>
      <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5898)"/>
      <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
      
      <BLOCK NAME="COMM" LINE="0" COL="7">
      <ITEM LINE="7"    COL="10" TYPE="%-12s"  FUNCTIONS="T(发起行行号:)"/>
      <ITEM LINE="9"    COL="10" TYPE="%-12s"  FUNCTIONS="T(委 托日 期: )"/>  
      <ITEM LINE="11"   COL="10" TYPE="%-12s"  FUNCTIONS="T(包  日  期: )"/>
      <ITEM LINE="13"   COL="10" TYPE="%-12s"  FUNCTIONS="T(包  编  号: )"/>
        <!--输入变量-->
      <ITEM LINE="7"   COL="22" NAME="#BR_NO"      TYPE="%-12s"  INPUT="TEXT"   FUNCTIONS="T()"/>
      <ITEM LINE="9"   COL="22" NAME="#WT_DATE"    TYPE="%-8s"   INPUT="TEXT"   FUNCTIONS="T(20060606)"/>
      <ITEM LINE="11"  COL="22" NAME="#PACK_DATE"  TYPE="%-8s"   INPUT="TEXT"   FUNCTIONS="T(20060605)"/>
      <ITEM LINE="13"  COL="22" NAME="#ORDERNO"    TYPE="%-8s"   INPUT="TEXT"   FUNCTIONS="T()"/>
      
      </BLOCK>
      <!---
      <BLOCK NAME="COMN" LINE="0" COL="7" VISABLE="FALSE">
        <ITEM LINE="5"  COL="22" TYPE="%-20s"  FUNCTIONS="T(CMT  802   查   询)"/>
        <ITEM LINE="6"  COL="3"  TYPE="%-14s"  FUNCTIONS="T(收报中心代码:)"/>
        <ITEM LINE="6"  COL="25" TYPE="%-10s"  FUNCTIONS="T(清算行号: )"/>
        <ITEM LINE="6"  COL="40" TYPE="%-10s"  FUNCTIONS="T(收费金额: )"/>
        <ITEM LINE="7"  COL="3"  TYPE="%-14s"  FUNCTIONS="T(计费开始日期: )"/>
        <ITEM LINE="7"  COL="30" TYPE="%-10s"  FUNCTIONS="T(终止日期: )"/>
        <ITEM LINE="7"  COL="51" TYPE="%-22s"  FUNCTIONS="T(月累计业务量收费比率: )"/>
        <ITEM LINE="8"  COL="3"  TYPE="%-20s"  FUNCTIONS="T(直接参与者收费比率:)"/>  
        <ITEM LINE="8"  COL="40" TYPE="%-10s"  FUNCTIONS="T(行别收费比率: )"/>
        <ITEM LINE="9"  COL="3"  TYPE="%-20s"  FUNCTIONS="T(单边类业务收费金额: )"/>
        <ITEM LINE="9"  COL="40" TYPE="%-10s"  FUNCTIONS="T(记录个数: )"/>
        <ITEM LINE="10" COL="3"  TYPE="%-20s"  FUNCTIONS="T(信息类业务收费金额:)"/>
        <ITEM LINE="10" COL="40" TYPE="%-10s"  FUNCTIONS="T(记录个数: )"/>
        <ITEM LINE="11" COL="3"  TYPE="%-20s"  FUNCTIONS="T(信息类业务收费金额: )"/>
        <ITEM LINE="11" COL="40" TYPE="%-10s"  FUNCTIONS="T(记录个数: )"/>
        -->
           <!----------接收后台传来的部分信息------------>
           <!---
        <ITEM NAME="#RECECO"    LINE="6"    COL="18"   TYPE="%-4s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#QSBRNO"    LINE="6"    COL="36"   TYPE="%-12s" FUNCTIONS="T()"/> 
        <ITEM NAME="#SDATE"     LINE="6"    COL="51"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#EDATE"     LINE="7"    COL="18"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#TXAMT"     LINE="7"    COL="41"   TYPE="%-15s" FUNCTIONS="T()"/> 
        <ITEM NAME="#IDRATE"    LINE="7"    COL="74"   TYPE="%-6s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#SERATE"    LINE="8"    COL="24"   TYPE="%-6s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#MORATE"    LINE="8"    COL="51"   TYPE="%-6s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#ZFTXAMT"   LINE="9"    COL="24"   TYPE="%-15s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#ZFNUM"     LINE="9"    COL="51"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#DBTXAMT"   LINE="10"   COL="24"   TYPE="%-15s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#DBNUM"     LINE="10"   COL="51"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#MESTXAMT"  LINE="11"   COL="24"   TYPE="%-15s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#MESNUM"    LINE="11"   COL="51"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        
        <ITEM NAME="#FILED1"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#FILED2"   TYPE="%-16s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#FILED3"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#FILED4"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#FILED5"   TYPE="%-16s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#FILED6"   TYPE="%-8s"  FUNCTIONS="T()"/> 
        <ITEM NAME="#FILED7"   TYPE="%-8s"  FUNCTIONS="T()"/> 
      
      </BLOCK>  
       -->                 
       <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
      <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/> 
      <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>  
     <!---
      <ONCLICK>
      "{
      	dim @tota as string;
      	dim @f as file;
      	dim @line as string;
      	dim @cnt as number;
      	dim @selid as number;
      	dim @i1 as number;
            dim @i2 as number;
      	dim @i3 as number;
      	dim @i4 as number;
      	dim @i5 as number;
      	dim @i6 as number;
      	dim @i7 as number;
      	dim @f1 as string;
      	dim @f2 as string;
      	dim @f3 as string;
      	dim @f4 as string;
      	dim @f5 as string;
      	dim @f6 as string;
      	dim @f7 as string;
        	initfd();
	    commsend_001();
	    $FD24=#ORDERNO;
	    $FD44=#PACK_DATE;
	    $FD45=#WT_DATE;
	    $FD88=#BR_NO;
	    @tota=callserver();
	    #RECECO=substr($FD123,0,4);
	    #QSBRNO=substr($FD123,4,12);
	    #SDATE=substr($FD123,31,8);
	    #EDATE=substr($FD123,39,8);
	    #TXAMT=substr($FD123,16,15);
	    #IDRATE=substr($FD123,47,6);
	    #SERATE=substr($FD123,53,6);
	    #MORATE=substr($FD123,59,6);
	    #ZFTXAMT=substr($FD123,65,15);
	    #ZFNUM=substr($FD123,80,8);
	    #DBTXAMT=substr($FD123,88,15);
	    #DBNUM=substr($FD123,103,8);
	    #MESTXAMT=substr($FD123,111,15);
	    #MESNUM=substr($FD123,126,8);
	    if($FD12!='0000')
        	 {
	    	showmsg(geterror());
	    	return(false);
        	 }
        	list_init(5,78,12,3);
        	list_setcolcnt(7);
        	list_setcol(0,'~CMT编号',4);
        	list_setcol(1,'计费金额',15);
        	list_setcol(2,'计费笔数',4);
        	list_setcol(3,'基础费率',6);
        	list_setcol(4,'计费单价',15);
        	list_setcol(5,'收发标志',4);
        	list_setcol(6,'打印标志',4);    	 	 
        	if(autolist(@tota))
            {
	        @cnt=list_getrowcnt();
	    }	
	    @f=openfile('../tmp/支付业务收费清单明细查询','w');
	    writeline(@f,'                          CMT  802   查   询                    ');
	    writeline(@f,' 收报中心代码: '+#RECECO+' 清算行号: '+#QSBRNO+' 收费金额: '+val(#TXAMT,0.01));
	    writeline(@f,' 计费开始日期: '+#SDATE+ ' 终止日期: '+#EDATE +' 月累计业务量收费比率: '+#IDRATE);
	    writeline(@f,' 直接参与者收费比率: '+#SERATE+  ' 行别收费比率: '+#MORATE);	
	    writeline(@f,' 支付类业务收费金额: '+#ZFTXAMT+ ' 记录个数: '+#ZFNUM);	
	    writeline(@f,' 单边类业务收费金额: '+#DBTXAMT+ ' 记录个数: '+#DBNUM);	
	    writeline(@f,' 信息类业务收费金额: '+#MESTXAMT+' 记录个数: '+#MESNUM);
	    writeline(@f,'┏━━━━┳━━━━━━━━┳━━━━┳━━━━┳━━━━━━━━┳━━━━┳━━━━┓');
	    writeline(@f,'┃CMT编号 ┃ 计费金额       ┃计费笔数┃基础费率┃ 计费单价       ┃收发标志┃打印标志┃');
	    writeline(@f,'┣━━━━╋━━━━━━━━╋━━━━╋━━━━╋━━━━━━━━╋━━━━╋━━━━┫');
	    @selid=list_getselid();
	    @f1=delspace(list_gettext(@selid,0));
	    @f2=delspace(list_gettext(@selid,1));
	    @f3=delspace(list_gettext(@selid,2));
	    @f4=delspace(list_gettext(@selid,3));
	    @f5=delspace(list_gettext(@selid,4));
	    @f6=delspace(list_gettext(@selid,5));
	    @f7=delspace(list_gettext(@selid,6));
            @i1=len(@f1);
            @i2=len(@f2);
            @i3=len(@f3);
            @i4=len(@f4);
            @i5=len(@f5);
            @i6=len(@f6);
            @i7=len(@f7);    
            #FILED1=@f1+space(8-@i1);
            #FILED2=@f2+space(16-@i2);
            #FILED3=@f3+space(8-@i3);
            #FILED4=@f4+space(8-@i4);
            #FILED5=@f5+space(16-@i5);
            #FILED6=@f6+space(8-@i6);
            #FILED7=@f7+space(8-@i7);
            while(true)
	    {   
	        
	     writeline(@f,'┃'+#FILED1+'┃'+#FILED2+'┃'+#FILED3+'┃'+#FILED4+'┃'+#FILED5+'┃'+#FILED6+'┃'+#FILED7+'┃');
	        
	     list_rmitem(@selid);	        	        	        
	     @selid=list_getselid();
	     @cnt=list_getrowcnt();
	     if(@cnt==0)
	     {
	        
	        break;
	     }
	     writeline(@f,'┣━━━━╋━━━━━━━━╋━━━━╋━━━━╋━━━━━━━━╋━━━━╋━━━━┫');	
      
	    @f1=delspace(list_gettext(@selid,0));
	    @f2=delspace(list_gettext(@selid,1));
	    @f3=delspace(list_gettext(@selid,2));
	    @f4=delspace(list_gettext(@selid,3));
	    @f5=delspace(list_gettext(@selid,4));
	    @f6=delspace(list_gettext(@selid,5));
	    @f7=delspace(list_gettext(@selid,6));
            @i1=len(@f1);
            @i2=len(@f2);
            @i3=len(@f3);
            @i4=len(@f4);
            @i5=len(@f5);
            @i6=len(@f6);
            @i7=len(@f7);    
            #FILED1=@f1+space(8-@i1);
            #FILED2=@f2+space(16-@i2);
            #FILED3=@f3+space(8-@i3);
            #FILED4=@f4+space(8-@i4);
            #FILED5=@f5+space(16-@i5);
            #FILED6=@f6+space(8-@i6);
            #FILED7=@f7+space(8-@i7);
	    }
	    writeline(@f,'┗━━━━┻━━━━━━━━┻━━━━┻━━━━┻━━━━━━━━┻━━━━┻━━━━┛');	
 	    closefile(@f);
 	    call('fview ../tmp/支付业务收费清单明细查询');
      
       }"
    </ONCLICK>
  </ITEM> 
   -->
  </VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="凭证打印!">
 NOTHING
 </PACKAGE>
</RESPONSE>
<OUTPUT>
</OUTPUT>
</TRANSACTION>
