<TRANSACTION RIGHTS="11000000" TITLE="5107    签 发 银 行 汇 票"
xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>
"{
	$FD39 = itoa( #TX_AMT*100,'%016.0f');

	call_9986();
	commsend_001();
	commsend_123();
	commsend_hv();
	$FD88 = #PWD;
	//#VOCNUM = #PO_NO;                             20110304 凭证号码变更为16位
	#VOCNUM ='90400041'+ #PO_NO;
	$FD60 = #VOCNUM;
	#TXAMT15 = itoa(#TX_AMT*100,'%016.0f');


	if($FD68=='6')
	{
		#ACTSEQ = '0';
	}
	if($FD68=='1')
	{
		#ACTSEQ = '1';
	}

  $FD102=getitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PWDFLAG#QUE_PWD#DRAW_PWD#ID_TYPE#ID_NO#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CT_IND#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10');
	$FD30=#ACTNO24;
	$FD66='1';
	$FD21='01';
	$FD68=#ACTYPE;
	$FD40=$FD39;
	if(#ACTYPE=='7')
	{
		$FD67='1';//要根据实际情况修改 现金转帐标志
	}
	else
	{
		$FD67='2'; // 要根据实际情况修改 现金转帐标志
	}
}"
</COMMSEND>
<COMMRECV>
"{
	#PWD = $FD88;
	commrecv_001();
	setitems('#FD9_AUTH_NO#FD9_AUTH_PWD#FD9_FEE_IND',$FD9);
	
}"
</COMMRECV>
<FIRSTWORK>
"{
  #PIC='';
  #PIC1='';
  show(#PIC,false);
  show(#PIC1,false);
  show(#LBLPIC,false);
  show(#LBLPIC1,false);
  enable(#SETPIC,false);
  enable(#SETPIC1,false);
}"
</FIRSTWORK>
<VARIABLE>
<ITEM LINE="3"  COL="3" TYPE="%-70s" FUNCTIONS=
"T(5107                         签 发 银 行 汇 票)"/>
<ITEM LINE="4"  COL="3"  TYPE="%-70s" FUNCTIONS=
"T(───────────────────────────────────)"/>

<ITEM NAME="#MSGTYPE"    TYPE="%-5s"     FUNCTIONS="T($MSGTYPE=03001)"/>
<ITEM NAME="#TXNO"       TYPE="%-4s"     FUNCTIONS="T($TXNO=5807)"/>
<ITEM NAME="#TXCD"       TYPE="%-4s"     FUNCTIONS="T(5107)"/>
<ITEM NAME="#TXNAME"     TYPE="%-24s"    FUNCTIONS="T(大额签发银行汇票)"/>


<ITEM NAME="#CMTNO"             TYPE="%-3s"       FUNCTIONS="T(121)"/>
<ITEM NAME="#O_CMTNO"           TYPE="%-3s"       FUNCTIONS=""/>
<ITEM NAME="#PAY_QS_NO"         TYPE="%-12s"      FUNCTIONS=""/>
<ITEM NAME="#OR_BR_NO"          TYPE="%-12s"      FUNCTIONS=""/>
<ITEM NAME="#SENDCO"            TYPE="%-4s"       FUNCTIONS=""/>
<ITEM NAME="#PAY_ADDR"          TYPE="%-60s"      FUNCTIONS=""/>
<ITEM NAME="#CASH_QS_NO"        TYPE="%-12s"      FUNCTIONS=""/>
<ITEM NAME="#AC_BR_NO"          TYPE="%-12s"      FUNCTIONS=""/>
<ITEM NAME="#RECECO"            TYPE="%-4s"       FUNCTIONS=""/>
<ITEM NAME="#CASH_ADDR"         TYPE="%-60s"      FUNCTIONS=""/>
<ITEM NAME="#YW_TYPE"           TYPE="%-2s"       FUNCTIONS=""/>
<ITEM NAME="#ORDERNO"           TYPE="%-8s"       FUNCTIONS=""/>
<ITEM NAME="#RATE"              TYPE="%-7s"       FUNCTIONS=""/>
<ITEM NAME="#RATEDATE"          TYPE="%-5s"       FUNCTIONS=""/>
<ITEM NAME="#OORDERNO"          TYPE="%-8s"       FUNCTIONS=""/>
<ITEM NAME="#PROCODE"           TYPE="%-8s"       FUNCTIONS=""/>
<ITEM NAME="#CR_DATE"           TYPE="%-8s"       FUNCTIONS=""/>
<ITEM NAME="#CR_BR_NO"          TYPE="%-12s"      FUNCTIONS=""/>
<ITEM NAME="#CR_TX_NUM"         TYPE="%-8s"       FUNCTIONS=""/>
<ITEM NAME="#QR_BR_NO"          TYPE="%-12s"      FUNCTIONS=""/>
<ITEM NAME="#QR_TX_NUM"         TYPE="%-8s"       FUNCTIONS=""/>
<ITEM NAME="#TX_TYPE"           TYPE="%-1s"       FUNCTIONS=""/>
<ITEM NAME="#NOTPAY_CONTENT"    TYPE="%-255s"     FUNCTIONS=""/>
<ITEM NAME="#NOTPAY_ORDERNO"    TYPE="%-3s"       FUNCTIONS=""/>
<ITEM NAME="#O_NOTPAY_ORDERNO"  TYPE="%-3s"       FUNCTIONS=""/>
<ITEM NAME="#RESP1"             TYPE="%-1s"       FUNCTIONS=""/>
<ITEM NAME="#OPERLEVEL"         TYPE="%-1s"       FUNCTIONS=""/><!--优先级别-->
<ITEM NAME="#PROC_STS"          TYPE="%-1s"       FUNCTIONS=""/><!--处理状态-->
<ITEM NAME="#WT_DAY"            TYPE="%-8s"       FUNCTIONS="T($HDATE)"/>
<ITEM NAME="#O_WT_DAY"          TYPE="%-8s"       FUNCTIONS=""/>
<ITEM NAME="#NOTPAY_DATE"       TYPE="%-8s"       FUNCTIONS=""/>
<ITEM NAME="#CUR_NO"            TYPE="%-3s"       FUNCTIONS=""/>
<ITEM NAME="#OPCD"              TYPE="%-2s"       FUNCTIONS="T(10)"/>
<ITEM NAME="#NOTE_TYPE"         TYPE="%-3s"       FUNCTIONS=""/>
<ITEM NAME="#NOTE_NO"           TYPE="%-16s"      FUNCTIONS=""/>
<ITEM NAME="#LW_IND"            TYPE="%-1s"       FUNCTIONS=""/>
<ITEM NAME="#PACKID"		TYPE="%8d"  	FUNCTIONS=""/>
<ITEM NAME="#O_PACKID"		TYPE="%8d"		FUNCTIONS=""/>
<ITEM NAME="#PACK_DATE"    	TYPE="%8d"  	FUNCTIONS=""/>
<ITEM NAME="#O_PACK_DATE"   	TYPE="%8d"  	FUNCTIONS=""/>
<ITEM NAME="#TXNUM"    		TYPE="%5d"  	FUNCTIONS=""/>
<ITEM NAME="#O_TXNUM"		TYPE="%5d"  	FUNCTIONS=""/>
<ITEM NAME="#LV_YW_IND"     	TYPE="%12s" 	FUNCTIONS=""/>
<ITEM NAME="#RESP_DATE"     	TYPE="%8d"  	FUNCTIONS=""/>
<ITEM NAME="#RCP_STS"       	TYPE="%2d"  	FUNCTIONS=""/>
<ITEM NAME="#RESP2"             TYPE="%8s"       FUNCTIONS=""/>
<ITEM NAME="#RETCODE"           TYPE="%2d"       FUNCTIONS=""/>
<ITEM NAME="#YW_DTL_ID"         TYPE="%8d"       FUNCTIONS=""/>
<ITEM NAME="#ACC_IND"           TYPE="%1d"       FUNCTIONS=""/>
<ITEM NAME="#REQ_TYPE"          TYPE="%1d"       FUNCTIONS=""/>
<ITEM NAME="#DF_FREEAMT"        TYPE="%16s"      FUNCTIONS=""/>
<ITEM NAME="#PROTNO"            TYPE="%60s"      FUNCTIONS=""/>
<ITEM NAME="#OTYPE"             TYPE="%1d"       FUNCTIONS="T(1)"/><!-- 表示大额 -->
<!-- 102域变量 -->

  <ITEM NAME="#ACTNO24"   		TYPE="%-24s"	 	FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ"   		TYPE="%-4s" 		FUNCTIONS=""/>
  <ITEM NAME="#VOCTYPE" 		TYPE="%-3s"  		FUNCTIONS=""/>
  <ITEM NAME="#FETCHFLAG" 		TYPE="%1s" 			FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG" 		TYPE="%-1s" 		FUNCTIONS=""/>
  <ITEM NAME="#QUE_PWD" 		TYPE="%6s" 			FUNCTIONS=""/>

  <ITEM NAME="#CERTFLAG" 		TYPE="%-1s"  		FUNCTIONS=""/>
  <ITEM NAME="#CERTNO20"    	TYPE="%-20s" 		FUNCTIONS=""/>
  <ITEM NAME="#STAMPFLAG" 		TYPE="%1s" 			FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG2" 		TYPE="%1s" 			FUNCTIONS=""/>
  <ITEM NAME="#PWD16"  			TYPE="%-16s" 		FUNCTIONS=""/>
  <ITEM NAME="#PRINTDATE" 		TYPE="%-8s" 		FUNCTIONS=""/>
  <ITEM NAME="#TXAMT15"   		TYPE="%-16s" 		FUNCTIONS=""/>
  <ITEM NAME="#CERTTYPE"  		TYPE="%-1s" 		FUNCTIONS=""/>
  <ITEM NAME="#CUSTNAME" 		TYPE="%-60s" 		FUNCTIONS=""/>
  <ITEM NAME="#AVBAL" 			TYPE="%17.2f" 		FUNCTIONS=""/>
  <ITEM NAME="#CURCD" 			TYPE="%-2s"  		FUNCTIONS=""/>
  <ITEM NAME="#CT_IND" 			TYPE="%-1s"  		FUNCTIONS="T(2)"/>
  <ITEM NAME="#DSCPT"     		TYPE="%-3s" 		FUNCTIONS=""/>
  <ITEM NAME="#ACTTYPE"   		TYPE="%-1s" 		FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ_2"  		TYPE="%-4s" 		FUNCTIONS=""/>
  <ITEM NAME="#ACCOUNTFLAG" 	TYPE="%-1s" 		FUNCTIONS=""/>
  <ITEM NAME="#INTEREST1" 		TYPE="%-16s" 		FUNCTIONS=""/>
  <ITEM NAME="#INTEREST2" 		TYPE="%-16s" 		FUNCTIONS=""/>
  <ITEM NAME="#INTEREST3" 		TYPE="%-16s" 		FUNCTIONS=""/>
  <ITEM NAME="#PAYAMOUNT" 		TYPE="%-16s" 		FUNCTIONS=""/>
  <ITEM NAME="#NEWVOCNUM" 		TYPE="%-16d" 		FUNCTIONS=""/>
  <ITEM NAME="#SPEFLAG" 		TYPE="%-20s" 		FUNCTIONS=""/>
  <ITEM NAME="#PRODNAME" 		TYPE="%-30s" 		FUNCTIONS=""/>
  <ITEM NAME="#ACTNO_24"   		TYPE="%-24s" 		FUNCTIONS=""/>
  <ITEM NAME="#EDUCREDIT" 		TYPE="%1s" 			FUNCTIONS=""/>
  <ITEM NAME="#DESC10"    		TYPE="%-10s" 		FUNCTIONS=""/>


 
<ITEM LINE="05"   COL="3"  TYPE="%-12s"    FUNCTIONS="T(汇票号码: )"/>
<ITEM LINE="05"   COL="47" TYPE="%-12s"    FUNCTIONS="T(签发行号: )"/>
<!--
<ITEM LINE="06"   COL="03" TYPE="%-12s"   INPUT="LABLE" VISABLE="FALSE" NAME="#LB0"   FUNCTIONS="T(证件支取: )"/>--> 
<ITEM LINE="06"   COL="03" TYPE="%-12s"   INPUT="LABEL" VISABLE="FALSE" NAME="#LB1"  FUNCTIONS="T(证件号码: )"/>
<ITEM LINE="07"   COL="03" TYPE="%-12s"   INPUT="LABEL" VISABLE="FALSE" NAME="#LB4"  FUNCTIONS="T(储户密码: )"/>
<!--
<ITEM LINE="07"   COL="47" TYPE="%-12s"    NAME="#LB4"  FUNCTIONS="T(凭证号码: )"/>
-->

<ITEM LINE="08"   COL="2" TYPE="%-70s"    FUNCTIONS=
"T(                         【票据信息】)"/>
<ITEM LINE="09"   COL="3" TYPE="%-72s"    FUNCTIONS="T(------------------------------------------------------------------------)"/>

<ITEM LINE="10"   COL="03" TYPE="%-12s"    FUNCTIONS="T(录入日期:)"/>
<ITEM LINE="10"   COL="47" TYPE="%-12s"    FUNCTIONS="T(录入机构:)"/>
<ITEM LINE="11"   COL="03" TYPE="%-12s"    FUNCTIONS="T(出票金额:)"/>
<ITEM LINE="12"   COL="03" TYPE="%-12s"    FUNCTIONS="T(汇票类别:!)"/>
<ITEM LINE="12"   COL="47" TYPE="%-12s"    FUNCTIONS="T(签出类型:!)"/>
<ITEM LINE="13"   COL="03" TYPE="%-12s"    FUNCTIONS="T(申请人帐号:)"/>
<ITEM LINE="13"     COL="40"  NAME="#LBLPIC" TYPE="%-10s" FUNCTIONS="T(照    片:)"/>
  <ITEM LINE="13"     COL="55"  NAME="#LBLPIC1" TYPE="%-10s" FUNCTIONS="T(印    件:)"/>
<ITEM LINE="14"   COL="03" TYPE="%-12s"    FUNCTIONS="T(申请人名称:)"/>
<ITEM LINE="15"   COL="03" TYPE="%-12s"    FUNCTIONS="T(收款人帐号:)"/>
<ITEM LINE="16"   COL="03" TYPE="%-12s"    FUNCTIONS="T(收款人姓名:)"/>
<ITEM LINE="17"   COL="03" TYPE="%-12s"    INPUT="LABEL" NAME="#LB5" VISABLE="FALSE"   FUNCTIONS="T(兑付行行号:)"/>
<ITEM LINE="18"   COL="3"  TYPE="%-12s"    INPUT="LABEL" NAME="#LB6" VISABLE="FALSE"   FUNCTIONS="T(兑付行名称:)"/>
<ITEM LINE="19"   COL="3"  TYPE="%-12s"    FUNCTIONS="T(编押  方式:!)"/>

<ITEM LINE="19"   COL="47" TYPE="%-12s"    INPUT="LABEL" NAME="#LB7" VISABLE="FALSE"    FUNCTIONS="T(手工编押码:)"/>
<ITEM LINE="20"   COL="03" TYPE="%-12s"    FUNCTIONS="T(备      注:)"/>

<ITEM NAME="#ACTYPE"            TYPE="%-1s"       FUNCTIONS=""/>

<ITEM LINE="05" COL="15" NAME="#PO_NO"   TYPE="%8d" INPUT="TEXT" FUNCTIONS="T()V(NB)"/>
<ITEM NAME="#T_PO_TYPE" TYPE="%-1s" FUNCTIONS=""/>
<ITEM NAME="#T_DEAL_MODE" TYPE="%-1s" FUNCTIONS=""/>
<ITEM  NAME="#VOCNUM" TYPE="%16d"    FUNCTIONS="V(NB)">
<ONLOSTFOCUS>
"{
	initfd();
	commsend_001();
	$FD89='165';//汇票签发凭证
	//#VOCNUM = #PO_NO;                        20110304 凭证号码变更为16位
	#VOCNUM = '90400041'+#PO_NO;
	$FD59=#VOCNUM;
	$FD16='0110';
// for test LiuHuafeng 
//	callserver();
//	if($FD12!='0000')
//	{
//		showmsg(geterror());
//		return(false);
//	}
	if(len(delspace($FD13))!=0)
	{
		showmsg($FD13);
		return (false);	
	}
	
}"
</ONLOSTFOCUS>
</ITEM>
<ITEM LINE="05" COL="59" NAME="#PAY_OPN_BR_NO"  TYPE="%-12s" INPUT="TEXT" FUNCTIONS="T()">
<ONLOSTFOCUS>
"{
	dim @po_no as string;
	initfd();
	commsend_001();
	commsend_123();
	$FD16 = '9560';
	callserver();
	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}

	@po_no = #PO_NO;
	setitems('#CMTNO#O_CMTNO#PAY_QS_NO#OR_BR_NO#SENDCO#PAY_OPN_BR_NO#PAY_AC_NO#PAY_NAME#PAY_ADDR#CASH_QS_NO#AC_BR_NO#RECECO#CASH_OPN_BR_NO#CASH_AC_NO#CASH_NAME#CASH_ADDR#YW_TYPE#ORDERNO#CONTENT#RATE#RATEDATE#OORDERNO#PROCODE#CR_DATE#CR_BR_NO#CR_TX_NUM#QR_BR_NO#QR_TX_NUM#TX_TYPE#NOTPAY_CONTENT#NOTPAY_ORDERNO#O_NOTPAY_ORDERNO#RESP1#OPERLEVEL#PROC_STS#OPCD#LW_IND#HP_ADD_PWD#PACKID#O_PACKID#PACK_DATE#O_PACK_DATE#TXNUM#O_TXNUM#LV_YW_IND#RESP_DATE#RCP_STS#RESP2#RETCODE#YW_DTL_ID#ACC_IND#REQ_TYPE#DF_FREEAMT#PROTNO#PO_NO#PO_TYPE#OTYPE',$FD123);
	enable(#PAY_OPN_BR_NO,true);
	#PO_NO = @po_no;
	#REG_DATE  = $FD45;	
	#BR_NO     = $FD3;
	//#TX_AMT    = atoi($FD39)/100;
	#TX_AMT    = val($FD39)/100;
	#T_PO_TYPE = #PO_TYPE;
	#T_DEAL_MODE = $FD72;
	#DEAL_MODE = $FD72;
	if($FD7==$FD92)
	{
	  showmsg('签发和录入不可以使用同一操作员!');
	  return(false);
	}
	if(#PO_TYPE=='1')
        {
	  showmsg('该笔汇票不可转让!');
	}
	if(#PO_TYPE=='2')
	{
		show(#LB5,true);
		show(#LB6,true);
		show(#CASH_OPN_BR_NO,true);
		show(#CASH_BR_NAME,true);
		show(#CASH_OPN_BR_NO,true);
		show(#CASH_BR_NAME,true);
	}
	else
	{
		show(#CASH_OPN_BR_NO,false);
		show(#CASH_BR_NAME,false);
		show(#LB5,false);
		show(#LB6,false);
	}
	if(#DEAL_MODE=='0')
	{
		#ACTYPE='7';//现金签发
		#ACTNO24='10101';
		$FD67='1';//要根据实际情况修改 现金转帐标志
	}
	else
	{
		#ACTYPE='1';
		$FD67='2'; // 要根据实际情况修改 现金转帐标志
	}
	initfd();
	//如果汇票是现金汇票需要检查,显示兑付行,否则不需要检查
	if(#PO_TYPE=='2')
	{
		commsend_001();
		$FD16 = '9553';
		$FD32 = #CASH_OPN_BR_NO;
		callserver();
		if($FD12!='0000')
		{
			showmsg(geterror());
			return (false);
		}
		#CASH_BR_NAME = substr($FD96,0,60);
	  }
	show(#BR_NO  ,true);
	show(#REG_DATE,true);
	show(#PO_TYPE,true);
	show(#PAY_AC_NO,true);
	show(#PAY_NAME,true);
	show(#TX_AMT,true);
	show(#CASH_AC_NO,true);
	show(#CASH_NAME,true);
	show(#CASH_BR_NAME,true);
	show(#DEAL_MODE,true);
	enable(#BR_NO,false);
	enable(#REG_DATE,false);
	enable(#PO_TYPE,false);
	enable(#PAY_AC_NO,false);
	enable(#PAY_NAME,false);
	enable(#TX_AMT,false);
	enable(#CASH_AC_NO,false);
	enable(#CASH_NAME,false);
	enable(#CASH_OPN_BR_NO,false);
	enable(#CASH_BR_NAME,false);
	enable(#DEAL_MODE,false);

	#PAY_AC_NO=rtrim(#PAY_AC_NO);
	if(len(#PAY_AC_NO)!=7 and len(#PAY_AC_NO)!=3 and len(#PAY_AC_NO)!=5 )
	{

		#PAY_AC_NO=substr(#PAY_AC_NO,0,24)+space(24-len(#PAY_AC_NO))+'';
		$FD32=#PAY_AC_NO;
		commsend_001();
		$FD16 = '9405';
		callserver();
		if($FD12!='0000')
		{
			showmsg(geterror());
			return (false);
		}
	}		

}"
</ONLOSTFOCUS>
</ITEM>
<ITEM NAME="#AC_NO" TYPE="%-24s" FUNCTIONS=""/>
<ITEM NAME="#AC_SEQN" TYPE="%-4s" FUNCTIONS="T(0001)"/>
<ITEM NAME="#ADDINFO" TYPE="%-1s" FUNCTIONS="T(1)">
<ONLOSTFOCUS>
"{
  //不是现金签发的汇票的时候
 if(#DEAL_MODE!='0')
 {
   dim @baktxno as string;
   dim @name as string;
   dim @avbal as string;
   dim @pwd_ind as string;
   dim @id_type as string;
   dim @actype as string;
   dim @prdt_name as string;
   dim @ct_ind as string;  //用于102域保存现转标志
   @baktxno=$TXNO;
   @ct_ind=#CT_IND;
   $TXNO='9731';
   #AC_NO=substr(#PAY_AC_NO,0,24)+space(24-len(#PAY_AC_NO))+'';
   $FD102=#AC_NO+#AC_SEQN;
   commsend_001();
   callserver();
   $TXNO=@baktxno;
   if($FD12!='0000'){
	    showmsg('9731提示'+geterror());
	    return(false);
   }
   @name=substr($FD102,125,60);
   @avbal=substr($FD102,185,16);
   @pwd_ind=substr($FD102,48,1);
   @actype=substr($FD102,207,1);
   #PAY_NAME=rtrim(@name);
   enable(#PAY_NAME,false);
   @prdt_name=rtrim(substr($FD102,313,30));
   showhelp(4,68,5,10,'帐户信息','户名:'+@name+' 余额:'+itoa(val(@avbal)/100,'%16.2f')+space(6)+' 产品名称:'+@prdt_name);
   @id_type=substr($FD102,61,1);
   #ID_TYPE= substr($FD102,61,1);
   if(@id_type=='Y'){
	     showmsg('该账户需要凭证件支取，需要输入证件');
	     show(#ID_TYPE,true);
	     show(#ID_NO,true);
	     show(#LB1,true);
   }else{
	     show(#ID_TYPE,false);
	     show(#ID_NO,false);
	     show(#LB1 ,false);
	 }
   if(@pwd_ind=='Y'){
	     showmsg('需要检查密码');
	     #DRAW_PWD='      ';
	     show(#DRAW_PWD,true);
       #ID_TYPE= substr($FD102,61,1);
	     show(#LB4,true);
   }else{
	     show(#LB4,false);
	     show(#DRAW_PWD ,false);
	     if(@actype=='1'){
	       showmsg(@prdt_name+'必需有密码才能办理大小额业务');
	       return(false);
	     }
   }
   setitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PWDFLAG#QUE_PWD#DRAW_PWD#ID_TYPE#CERTNO20#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CT_IND#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10',$FD102);
   #CT_IND=@ct_ind;


	#VOCNUM = '';
    }
}"
		</ONLOSTFOCUS>
		</ITEM>
  <ITEM  NAME="#ID_TYPE"  TYPE="%-1s"  FUNCTIONS=""/> 
<!--
	<SELECT>
    <OPTION VALUE="N"     TITLE="0.否"/>
    <OPTION VALUE="Y"     TITLE="1.是"/>
  </SELECT>
  </ITEM>
--->

  <ITEM LINE="06"   COL="15" NAME="#ID_NO"  INPUT="TEXT" VISABLE="FALSE"  TYPE="%-20s"  DEVICE="KEYBOARD" FUNCTIONS=""> 
<ONLOSTFOCUS>"{
     if(#ID_NO!=rtrim(#CERTNO20)){
       showmsg('输入的证件号码与原登记证件号码不同');
       return(false);
     }
  }"
</ONLOSTFOCUS>
  </ITEM>



<ITEM LINE="07" COL="15"  NAME="#DRAW_PWD" TYPE="%-6s"  INPUT="TEXT" VISABLE="FALSE" DEVICE="PINPAD" FUNCTIONS="V(NB)i()"/>
<ITEM LINE="10" COL="15"  NAME="#REG_DATE" TYPE="%-8s"  INPUT="TEXT" FUNCTIONS="J(#HP_ADD_PWD)"/>
<ITEM LINE="10" COL="56"  NAME="#BR_NO" 	  TYPE="%-7s"  INPUT="TEXT" FUNCTIONS=""/>
<ITEM NAME="#AVLA"        TYPE="%-16s" FUNCTIONS=""/>
<ITEM LINE="11"  COL="15" NAME="#TX_AMT"   TYPE="%16.2f" INPUT="TEXT"   FUNCTIONS=""/>
<ITEM NAME="#UTX_AMT"     TYPE="%-40s"     FUNCTIONS="U(#TX_AMT)"/><!---大写金额--->

<ITEM LINE="12"  COL="15" NAME="#PO_TYPE"  TYPE="%-1s"   INPUT="SELECT" FUNCTIONS="T(#PO_TYPE=#T_PO_TYPE)">
	<SELECT LINE="12" COL="17">
		<OPTION VALUE="0 可转让汇票  "     TITLE="可转让汇票  "/>
		<OPTION VALUE="1 不可转让汇票"     TITLE="不可转让汇票"/>
		<OPTION VALUE="2 现金汇票    "     TITLE="现金汇票    "/>
	</SELECT>
</ITEM>
<ITEM NAME="#SPO_TYPE"    TYPE="%-12s"       FUNCTIONS="S(#PO_TYPE,#PO_TYPE)"/>
<ITEM LINE="12"  COL="56" NAME="#DEAL_MODE"  TYPE="%-1s"  INPUT="SELECT" FUNCTIONS="T()S(#DEAL_MODE,#T_DEAL_MODE)">
	<SELECT LINE="12" COL="57">
		<OPTION VALUE="0 "     TITLE="现金"/>
		<OPTION VALUE="1 "     TITLE="转帐"/>
		<OPTION VALUE="2 "     TITLE="科目对转"/>
	</SELECT>
</ITEM>
<ITEM LINE="13"  COL="15" NAME="#PAY_AC_NO"       TYPE="%-32s"   INPUT="TEXT"   FUNCTIONS="V(NB)"/>
<!--added by liuyong 2009-9-15 显示图片信息 start-->
  <ITEM  NAME="#CHECKACNO"  TYPE="%10s" FUNCTIONS="">
 <ONLOSTFOCUS>
 "{
     dim @txnobak as string;
     dim @len as number;
     @len = len(rtrim(#PAY_AC_NO));
     if(@len != 0 and @len != 3 and @len != 5 and @len != 7)
     {
       @txnobak = $TXNO;
       $TXNO = '9663';
       $FD30 = #PAY_AC_NO;
       commsend_001();
       callserver();
       if($FD12 !='0000')
       {
         show(#PIC,false);
         show(#PIC1,false);
         show(#LBLPIC,false);
         show(#LBLPIC1,false);
         enable(#SETPIC,false);
         enable(#SETPIC1,false);
       }
       else
       {
         show(#PIC,true);
         show(#PIC1,true);
         show(#LBLPIC,true);
         show(#LBLPIC1,true);
         enable(#SETPIC,true);
         enable(#SETPIC1,true);
       }
       $TXNO = @txnobak;
     }
     
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM NAME="#LYACNO" TYPE="%-32s" FUNCTIONS="" />
  <ITEM LINE="13" COL="50" LINES="160" COLS="120" NAME="#PIC" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#PAY_AC_NO;
      call_96641();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="13" COL="65" LINES="220" COLS="160" NAME="#PIC1" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC1" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#PAY_AC_NO;
      call_96642();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 end-->

<ITEM LINE="14"  COL="15" NAME="#PAY_NAME"        TYPE="%-60s"   INPUT="TEXT"   FUNCTIONS="V(NB)"/>
<ITEM NAME="#SPAY_NAME"   TYPE="%-40s"            FUNCTIONS="T(#PAY_NAME,1,40)"/>

<ITEM LINE="15"  COL="15" NAME="#CASH_AC_NO"      TYPE="%-32s"   INPUT="TEXT"   FUNCTIONS=""/>
<ITEM LINE="16"  COL="15" NAME="#CASH_NAME"       TYPE="%-60s"   INPUT="TEXT"   FUNCTIONS="T()V(NB)"/>
<ITEM NAME="#SCASH_NAME"  TYPE="%-40s"            FUNCTIONS="T(#CASH_NAME,1,40)"/>

<ITEM LINE="17"  COL="15" NAME="#CASH_OPN_BR_NO"  TYPE="%-12s"   INPUT="TEXT"   VISABLE="FALSE" FUNCTIONS=""/>
<ITEM LINE="18"  COL="15" NAME="#CASH_BR_NAME"    TYPE="%-60s"   INPUT="TEXT"   VISABLE="FALAE"  FUNCTIONS=""/>
<ITEM NAME="#SCASH_BR_NAME"                       TYPE="%-20s"   FUNCTIONS="T(#CASH_BR_NAME,1,20)"/>

<ITEM LINE="19"  COL="15" NAME="#HP_ADD_PWD"      TYPE="%-1s"    INPUT="SELECT" FUNCTIONS="T(1)V(NB)">
	<SELECT LINE="19" COL="17">
		<OPTION VALUE="1"     TITLE="机器编押"/>
		<OPTION VALUE="2"     TITLE="手工编押"/>
	</SELECT>
<ONLOSTFOCUS>
"{
	show(#PWD,false);
	show(#LB7,false);
	if(#HP_ADD_PWD=='2')
	{
		show(#PWD,true);
		show(#LB7,true);
	}
}"
</ONLOSTFOCUS>
</ITEM>
<ITEM LINE="19"   COL="59" NAME="#PWD"     TYPE="%-10s"   INPUT="TEXT"  VISABLE="FALSE" FUNCTIONS="V(NB)"/>
<ITEM LINE="20"   COL="15" NAME="#CONTENT" TYPE="%-60s"   INPUT="TEXT"  FUNCTIONS="T()"/>
<ITEM NAME="#SCONTENT"     TYPE="%-40s"    FUNCTIONS="T(#CONTENT,1,40)"/>

<!---有关打印的变量--->
<ITEM NAME="#SBRNAME" TYPE="%-20s" FUNCTIONS="T($BRNAME,1,20)"/><!---行名--->


<!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
<ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>

  <ITEM NAME="#COMMDAY" TYPE="%-8s"  FUNCTIONS="T()"/><!---用于打印大写日期---专用--->
  <ITEM NAME="#WDAY"    TYPE="%-8s"  FUNCTIONS="T($HDATE)">
  <ONLOSTFOCUS>
  "{
	#COMMDAY = #WDAY;
	BIG5();//这里得到大写出票日期
	#SBDAY   = #BIGDAY;
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#BIGDAY"  TYPE="%-20s" FUNCTIONS=""/><!---打印用大写日期---专用--->
  <ITEM NAME="#SBDAY"   TYPE="%-20s" FUNCTIONS=""/><!---打印用大写出票日期--->
<ITEM NAME="#OK" LINE="21"  COL="65"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT">
<ONCLICK>
"{
	submit();
}"
</ONCLICK>
</ITEM>
</VARIABLE>
<!--发送信息包-->
<REQUEST>
</REQUEST>

<!--接收信息包-->
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="按任意键退出">
NOTHING
</PACKAGE>
    <PRINT>"{
		print(3,25,'5107 银行汇票签发');
		print(5,15,'汇票号码 :[20]',#PO_NO);
		print( 6,15,'签发金额 :[12]',ltrim(comma(itoa(#TX_AMT,'%17.2f'),16)));
		print( 7,15,'付款帐号 :[32]',#PAY_AC_NO);
		print( 8,15,'付款名称 :[60]',#PAY_NAME);
		print( 9,15,'流水号码 :[ 6]',$FD4);
		print( 10,15,'汇票密押 :[ 10]',#PWD);
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="13" DESC="打印银行汇票">
NOTHING
</PACKAGE>
  <PRINT>"{
 $KINDNO='00';
  //print( 7,48,'请向城商行或工行上海20304002申请清算');
  print( 6,48,'请向城商行或工行申请清算');//原7
	print( 8,12,'[8]  [6]  [6]',substr(#SBDAY,0,8),substr(#SBDAY,8,6),substr(#SBDAY,14,6)); //日期
	if(#PO_TYPE == '2')
	{
	print(9,48,'[20]  [12]',#SCASH_BR_NAME,#CASH_OPN_BR_NO); //代理付款行
	}
	//print(12,10,'[40]      [32]',#SCASH_NAME,#CASH_AC_NO); //收款人修改版前
	print(12,10,'[40][32]',#SCASH_NAME,#CASH_AC_NO); //收款人 
        if(#PO_TYPE == '2')
        {
        print(14,17,'\H0现金[40]\H1￥[12]',#UTX_AMT,ltrim(comma(itoa(#TX_AMT,'%17.2f'),16))); //出票金额
        }
        else
        {  
	      print(14,17,'\H0[40]\H1  ￥[12]',#UTX_AMT,ltrim(comma(itoa(#TX_AMT,'%17.2f'),16))); //出票金额
        }
	print(20,11,'[40][32]',#SPAY_NAME,#PAY_AC_NO); //申请人
	//print(22,11,'[20][12]',#SBRNAME,#PAY_OPN_BR_NO); //出票行修改版前
	print(22,11,'晋中商行[12][12]',#SBRNAME,#PAY_OPN_BR_NO); //出票行
	print(23,50,'[10]',#PWD);//密押
	print(24,11,'[40]',#SCONTENT);
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
    <PRINT>"{
 $KINDNO='00';
 dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:5107');
	print( 5, 13,'交易:签发银行汇票');     
	
	print( 6,20,'汇票号码 :[20] ',#PO_NO);
	print( 7,20,'签发金额 :[12]',ltrim(comma(itoa(#TX_AMT,'%17.2f'),16)));
	print( 8,20,'付款人帐号 :[32]',#PAY_AC_NO);
	print( 9,20,'付款人名称 :[60]',#PAY_NAME);
	print(10,20,'流水号码 :[ 6]',$FD4);
	print(11,20,'汇票密押 :[ 10]',#PWD);
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);
}"
</PRINT>
	</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
    <PRINT>"{
 $KINDNO='00';
dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
 	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:5107');
	print( 5, 13,'交易:签发银行汇票');  
	
	printacdtl_1();
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);
}"
</PRINT>
</RESPONSE>
<OUTPUT>
</OUTPUT>
<IMPORT>MBFEFEE.IMP</IMPORT>
</TRANSACTION>
