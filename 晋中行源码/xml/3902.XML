<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111001" TITLE="3902       票据查询"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{

}"
</COMMSEND>
<COMMRECV>"{
        commrecv_001();       
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-48s" FUNCTIONS= "T(3902                        票据查询)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS="T(─────────────────────────────────────)"/>
   
   <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=3902)"/>
   <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
<!--屏幕输入内容 --> 
 <ITEM LINE="06"      COL="7" TYPE="%-13s"     FUNCTIONS="T(批次号:!)"/> 
 
 
 <ITEM LINE="06"   COL="15"  NAME="#PCNO" TYPE="%-30s"  VISABLE="TRUE"  DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)">
        <ONLOSTFOCUS>
        "{
        
        }"
        </ONLOSTFOCUS>
 </ITEM>

<ITEM LINE="21"  COL="59" TYPE="%-6s" NAME="#OK" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>"{
   	dim @data as string;
<!--   			  @data = gettextfile();
-->
			 	 		 		initfd();
					commsend_001();
					
					$FD16='3902';
					$FD18='CBS';
					$FD82=#PCNO;
					
					@data=callagn_cnaps2();
			 		if($FD12 != '0000')
					{
							showmsg(geterror());
							return(false);
					}
		
   	 			autolist(@data);
   			#DOLIST='1';
				goitem('#DOLIST');
			return(true);
 }"
 </ONCLICK>
</ITEM>

<ITEM NAME="#DOLIST" TYPE="%1s" FUNCTIONS="">
	<ONLOSTFOCUS>
		"{
			dim @selid as number;
			dim @data as string;
			dim @file as file;
			dim @count as number;
			dim @line as string;
			dim @a0 as string;
			dim @a1 as string;
			dim @a2 as string;
			dim @a3 as string;
			dim @a4 as string;
			dim @a5 as string;
			dim @a6 as string;
			dim @a7 as string;
			dim @a8 as string;
			dim @a9 as string;
			dim @a10 as string;
			dim @a11 as string;
			dim @a12 as string;
			dim @a13 as string;
			dim @a14 as string;
			dim @a15 as string;
			dim @a16 as string;
			dim @a17 as string;
			dim @a18 as string;
			dim @a19 as string;
			dim @a20 as string;
			dim @a21 as string;
			dim @a22 as string;
			if(#DOLIST == '1')
			{
				@selid=list_work();
				if(@selid &lt; 0)
				{
					list_del();
					rerun();
					return(true);
				}
				@selid=list_getselid();
				if(@selid &lt; 0)
				{
					list_del();
					rerun();
					return(true);
				}
				@a0=ltrim(list_gettext(@selid,0));
				@a1=ltrim(list_gettext(@selid,1));
				@a2=ltrim(list_gettext(@selid,2));
				@a3=ltrim(list_gettext(@selid,3));
				@a4=ltrim(list_gettext(@selid,4));
				@a5=ltrim(list_gettext(@selid,5));
				@a6=ltrim(list_gettext(@selid,6));
				@a7=ltrim(list_gettext(@selid,7));	
			  list_del();	
						

				open('3902_1.XML','#PCNO='+@a0+';#PJBNO='+@a1+';#TXAMT='+@a2+';#REVBANKNAME='+@a3+';#REVBANKNO='+@a4+';#REVACCNO='+@a5+';#REVNAME='+@a6+';#CONTENT='+@a7+';');
			
				return(true);
			}
				
			 goitem('#OK');
	}"
	</ONLOSTFOCUS>
	</ITEM>

</VARIABLE>

</TRANSACTION>
	
