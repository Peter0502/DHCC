<TRANSACTION RIGHTS="11110000" TITLE="6349   银行本票基本信息查询"
xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>
"{
  initfd();
  commsend_001();
  $FD44=#SDATE;   //起始日期
  $FD45=#EDATE;   //结束日期
  $FD67=#STAT;    //本票状态
  $FD62=#PONO;    //本票号码
}"
</COMMSEND>
<COMMRECV>
"{
commrecv_001();
}"
</COMMRECV>
 <VARIABLE>
<ITEM LINE="3"  COL="3" TYPE="%-70s" FUNCTIONS=
"T(6349                         银行本票基本信息查询)"/>

<ITEM LINE="4"  COL="3"  TYPE="%-70s" FUNCTIONS=
"T(───────────────────────────────────)"/>

<ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=6349)"/>
<ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>

<ITEM NAME="#DOLIST" TYPE="%1s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
     dim @selid       as number;
	   dim @pono        as string;
	   dim @brno        as string;
	   dim @orbrno      as string;
	   dim @avbal       as string;
	   dim @payactno    as string;
	   dim @payname     as string;
	   dim @cashactno   as string;
	   dim @cashname    as string;
	   dim @cashbrno    as string;
	   dim @cashbrname  as string;
	   dim @holdbrno    as string;
	   dim @holdbrname  as string;
	   dim @holdactno   as string;
	   dim @holdname    as string;
	   dim @stat        as string;
	   dim @bptype      as string;
	   dim @signday     as string;
	   dim @cashday     as string;
	   dim @jqday       as string;
	   dim @endday      as string;
	   dim @mynum       as string;
	   dim @optlrno     as string;
	   dim @chktlrno    as string;
	   dim @cashtlrno   as string;
	     
		
	  if(#DOLIST == '1')
	  {
	      @selid=list_work();
	      if(@selid &lt; 0)
	      {
		       list_del();
		       rerun();
		       return(true);
	      }
        @selid=list_getselid();
        if(@selid &lt; 0)
        {
           list_del();
           rerun();
           return(true);
        }
	      @pono=rtrim(list_gettext(@selid,0));
	      @brno=rtrim(list_gettext(@selid,1));
	      @orbrno=rtrim(list_gettext(@selid,2));
	      @avbal=rtrim(list_gettext(@selid,3));
	      @payactno=rtrim(list_gettext(@selid,4));
	      @payname=rtrim(list_gettext(@selid,5));
	      @cashactno=rtrim(list_gettext(@selid,6));
	      @cashname=rtrim(list_gettext(@selid,7));
	      @cashbrno=rtrim(list_gettext(@selid,8));
	      @cashbrname=rtrim(list_gettext(@selid,9));
	      @holdbrno=rtrim(list_gettext(@selid,10));
	      @holdbrname=rtrim(list_gettext(@selid,11));
	      @holdactno=rtrim(list_gettext(@selid,12));
	      @holdname=rtrim(list_gettext(@selid,13));
	      @stat=rtrim(list_gettext(@selid,14));
	      @bptype=rtrim(list_gettext(@selid,15));
	      @signday=rtrim(list_gettext(@selid,16));
	      @cashday=rtrim(list_gettext(@selid,17));
	      @jqday=rtrim(list_gettext(@selid,18));
	      @endday=rtrim(list_gettext(@selid,19));
	      @mynum=rtrim(list_gettext(@selid,20));
	      @optlrno  =rtrim(list_gettext(@selid,21));
	      @chktlrno =rtrim(list_gettext(@selid,22));
	      @cashtlrno=rtrim(list_gettext(@selid,23));     
	       
	      //银行本票基本信息查询
	      open('6349_1.XML','#PONO='+@pono+';#BRNO='+@brno+';#ORBRNO='+@orbrno+';#AVBAL='+@avbal+';#CASHACTNO='+@cashactno+';#CASHNAME='+@cashname+';#CASHBRNO='+@cashbrno+';#CASHBRNAME='+@cashbrname+';#HOLDBRNO='+@holdbrno+';#HOLDBRNAME='+@holdbrname+';#HOLDACTNO='+@holdactno+';#HOLDNAME='+@holdname+';#STAT='+@stat+';#BPTYPE='+@bptype+';#SIGNDAY='+@signday+';#CASHDAY='+@cashday+';#JQDAY='+@jqday+';#ENDDAY='+@endday+';#MYNUM='+@mynum+';'); 

		    //showfooter();
		    return(true);
	   }
	   list_del();
	   #DOLIST='';
  }"
  </ONLOSTFOCUS>
  </ITEM>

<ITEM NAME="#DOLIST1" TYPE="%-1s" FUNCTIONS="">
<ONLOSTFOCUS>
"{
	showall();
}"
</ONLOSTFOCUS>
</ITEM>

<ITEM LINE="6"    COL="17" TYPE="%-9s"    FUNCTIONS="T(起始日期:)"/>
<ITEM LINE="8"    COL="17" TYPE="%-9s"    FUNCTIONS="T(结束日期:)"/>

<ITEM LINE="10"   COL="17" TYPE="%-9s"    FUNCTIONS="T(本票状态:)"/>
<ITEM LINE="12"   COL="17" TYPE="%-9s"    FUNCTIONS="T(本票号码:)"/>

<ITEM LINE="6"    COL="27" NAME="#SDATE"    TYPE="%8d"  DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)D()"/>
<ITEM LINE="8"    COL="27" NAME="#EDATE"    TYPE="%8d"  DEVICE="KEYBOARD" FUNCTIONS="T($HDATE)V(NB)D()"/>

<ITEM LINE="10"   COL="27" NAME="#STAT" TYPE="%-1s"  DEVICE="KEYBOARD" FUNCTIONS="T(9)">
	<SELECT   LINE="11" COL="29">
		<OPTION VALUE="9" TITLE="0.全    部"/>
		<OPTION VALUE="0" TITLE="1.登    记"/>
		<OPTION VALUE="1" TITLE="2.签    发"/>
		<OPTION VALUE="2" TITLE="3.兑    付"/>
		<OPTION VALUE="3" TITLE="4.解    付"/>
		<OPTION VALUE="4" TITLE="5.挂    失"/>
		<OPTION VALUE="5" TITLE="6.解    挂"/>
		<OPTION VALUE="6" TITLE="7.退    票"/>
		<OPTION VALUE="7" TITLE="8.签发取消"/>
		<OPTION VALUE="8" TITLE="9.兑付取消"/>
	</SELECT>
</ITEM>
<ITEM LINE="12"  COL="27"  NAME="#PONO1" TYPE="%12s"  DEVICE="KEYBOARD" INPUT="TEXT"  FUNCTIONS="T()"/>
<ITEM NAME="#TEMPBUF"    TYPE="%-4s"  FUNCTIONS="T(YHBP)"/>
<ITEM  NAME="#PONO"     TYPE="%12s" FUNCTIONS="T(#TEMPBUF+#PO_NO1)">

<ITEM LINE="21"  COL="65"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
<ONCLICK>
"{
	dim @tota as string;
	
	
	initfd();
	commsend_001();
  $FD44=#SDATE;   //起始日期
  $FD45=#EDATE;   //结束日期
  $FD67=#STAT;    //本票状态
  $FD62=#PONO;    //本票号码
   @tota=callserver();
  if($FD12!='0000')
  {
    showmsg(geterror());
    return(false);
  }
  if(substr(@tota,36,1)=='E')
  {
    showmsg(substr(@tota,36,5) +'  '+substr(@tota,44,40))
    list_del();
    return(true);
  }
  if(autolist(@tota))
  {
//    list_work();
  }
	#DOLIST='1';
}"
</ONCLICK>
</ITEM>     

</VARIABLE>

<REQUEST>        
</REQUEST>      
<RESPONSE>       
<PACKAGE>        
</PACKAGE>          
</RESPONSE>      
</TRANSACTION> 
