<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110100000000000000000000000000" TITLE="5596 办理支付退款请求"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	 
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-50s" FUNCTIONS=
	"T(5596                       办理支付退款请求)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5631)"/>
  <ITEM NAME="#TXNAME" TYPE="%-12s" FUNCTIONS="T(办理支付退款请求)"/><!---交易名称--->
  <ITEM NAME="#TXNUMBER" TYPE="%-4s" FUNCTIONS="T(5596)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  
  <BLOCK LINE="4" COL="10" >
  
  <ITEM LINE="4" COL="0" TYPE="%-60s"  FUNCTIONS="T(请输入 退款请求报文导入 交易产生的报文流水号)"/>
  
  <ITEM LINE="6" COL="8" TYPE="%-12s"  FUNCTIONS="T(报文流水号:)"/>
  <ITEM LINE="6" COL="19" TYPE="%-10s" NAME="#PackNo" INPUT="TEXT" FUNCTIONS="V(NB)" />
 <!--
  <ITEM LINE="7" COL="8" TYPE="%-14s"  FUNCTIONS="T(财政机关代码:)"/>
  <ITEM LINE="7" COL="21" TYPE="%-10s" NAME="#FinOrgCode" INPUT="TEXT" FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
  	"{
  	    if(len(#FinOrgCode)!=10)
  	    {
  	        showmsg('位数不足!');
            return(false);
  	    }
  	 }"	
  	</ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="8" COL="8" TYPE="%-14s" FUNCTIONS="T(国库主体代码:)"/>
  <ITEM LINE="8" COL="21" TYPE="%-10s" NAME="#TRECODE" INPUT="TEXT" FUNCTIONS="V(NB)">
    <ONLOSTFOCUS>
  	"{
  	    if(len(#TRECODE)!=10)
  	    {
  	        showmsg('位数不足!');
            return(false);
  	    }
  	 }"	
  	</ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="9" COL="8" TYPE="%-14s"  FUNCTIONS="T(支 付  类 型:)"/>
  <ITEM LINE="9" COL="21" TYPE="%-1s" NAME="#PAY_TYPE" INPUT="SELECT" FUNCTIONS="V(NB)">
    <SELECT>
  	  <OPTION VALUE="1"  TITLE="1.直接支付" />
  	  <OPTION VALUE="2"  TITLE="2.授权支付" />
  	</SELECT>
  </ITEM>
  -->
  
  </BLOCK>
   <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM LINE="21"  COL="59" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>
    "{
        dim @tota as string; 
        dim @filename as string; 
        initfd();
	      commsend_001();
	      $FD16=#TXNO;
	    
	      $FD60=#PackNo;
	     // $FD60=#TRECODE;
	     // $FD61=#FinOrgCode;
	     // $FD68=#PAY_TYPE;
	      
	      @tota=calltips();
        if( $FD12!='0000')
        {
            showmsg(geterror());
  		      return(false);
        }
        showmsg('退款申请报文发送成功!');
        @filename='../tmp/'+$KINBR+$TTYNAME+#TXNO;
        savefiletxt(@filename,@tota); 
 
        runoutput();         
        call('fview '+@filename);

    }"
  </ONCLICK> 
   </ITEM> 
</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
	<PACKAGE DEVICE="SCREEN"  DESC="交易完成">  
		NOTHING
	</PACKAGE>
		<PRINT>
		"{
		print( 3,5,'柜员:[4]',$FD7);
		print( 5,5,'流水号:[6]',$FD4);
		print( 7,20,'报文流水号: [12]',#PackNo);
			
		}"
		</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" DESC="请打印凭证" LINESPACE="24" >
NOTHING
</PACKAGE>
<INIT>
"{
$KINDNO='00';
}"
</INIT>
<PRINT>
"{
			dim @txtime as string;
		dim @feetype as string;
		@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
		print( 5,20,'机构名称:[30]',$BRNAME);
		print( 5, 2,'代码:[4]',#TXNUMBER);
		print( 5,13,'交易名称:[20]',#TXNAME);
		print( 7,30,'\L0办理支付退款请求凭证\L1');				
		print( 10,20,'报文流水号: [12]',#PackNo);
		print_sq();
		print(24,20,'备注:');
		print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
		print(24,5,'柜员:[4]',$FD7);
		print(24,5,'流水号:[6]',$FD4);

}"
</PRINT>
</RESPONSE>


</TRANSACTION>

