<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111111" TITLE="3701 IC卡个人活期开户"
	xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	dim @shuju as string;
	dim @update as string;

	//卡转账开户(相当于卡取款)首先从转出卡方做取款交易 add by hxc 091119
	if(( substr(#TRAN_AC_NO,0,6)==#CARDBIN1 or substr(#TRAN_AC_NO,0,6)==#CARDBIN2) and (#CASHCD == '2'))
	{
		initfd();
		commsend_001();
		$FD16='7005';
		$FD30=#TRAN_AC_NO;
		$FD75=$MSR2;
		$FD76=$MSR3;
		$FD79=#TRAN_PWD;
		$FD21=#TRAN_CUR;
		$FD39=itoa(#TXAMT*100);

		//showmsg('转账开户,准备进核心');
		callagn();
		if($FD12!='0000')
		{
			showmsg(geterror());
			return(false);
		}
		//#TRAN_FEE=$FD40;
		#CARD_TRACENO_TRAN=delspace(itoa(val($FD43),'%16d'));
	}
	//发往神码的开卡交易
	initfd();
	commsend_001();
	//dim @fee as string;
	if(#JZZL == '0024' or #JZZL == '0027' or #JZZL == '0028' or #JZZL == '0029' or #JZZL == '0031' or #JZZL == '0032')
	{
		$FD16='7101'; 
		$FD21=#CURCD;
		$FD39=itoa(#TXAMT*100);
		$FD28=#KHHM;
		$FD35=#ZJLX;
		$FD62=#ZJHM;
		$FD25=#Pinyin;
		$FD26=#CUSTNAME;
		//showmsg('#Pinyin='+#Pinyin);
		//showmsg('$FD26='+$FD26);
		$FD70=#KHXB;
		$FD82=#JTZZ;
		$FD17=#JTYB;
		$FD61=#JTDH;
		$FD119=#DWMC;
		$FD81=#DWDZ;
		$FD64=#DWYB;
		$FD60=#DWDH;
		$FD58=#SJHM;
		$FD100=#MAIL;
		$FD72=#XYDJ; 
		$FD40=itoa(#YSR*100);
		$FD47=#CSRQ;
		$FD71=#HYZK;
		$FD30=#CARDNO;
		$FD68=#KSX;
		$FD34=#PSWDCD;
		$FD79=#PASSWD;
		$FD75=#MSR2BAK;
		$FD76=#MSR3BAK;
		//showmsg('$FD70=['+$FD70+']');
		@shuju= initiccard('00','000000000000');
		showmsg(@shuju);
		#IC_ATC=strfld(@shuju,'|',2);
		#IC_AC=strfld(@shuju,'|',3);
		#IC_NUMB=strfld(@shuju,'|',4);
		//showmsg('应用计数器='+#IC_ATC);
		//showmsg('应用密文='+#IC_AC);
		showmsg('系列号='+#IC_NUMB);
		$FD73= #IC_ATC;//应用交易计数器
		$FD38= #IC_AC ;//应用密文
		$FD89= #IC_NUMB;//系列号
		if (isTxContinue()==false )
		{
			showmsg('请勿拔卡！');
			return(false);
		}
showmsg('send to card platm');
		callagn();
		if($FD12!='0000')
			{
				showmsg(geterror());
				showmsg('开卡失败！');
				//return (false);
			}
showmsg('card return');
		//卡转账开户交易卡处理开户失败时，往神码发送转出卡取款撤销交易 add by hxc 091120
		if(($FD12!='0000') and (substr(#TRAN_AC_NO,0,6)=='621223' or substr(#TRAN_AC_NO,0,6)=='621780') and (#CASHCD == '2'))
		{
			#RESP_CODE=$FD12;
			showmsg(geterror());
			initfd();
			commsend_001();
			$FD16='7777';
			$FD12=#RESP_CODE;
			$FD30=#TRAN_AC_NO;
			$FD39=itoa(#TXAMT*100);
			$FD43=#CARD_TRACENO_TRAN;
			callagn();
			if($FD12!='0000')
			{
				showmsg(geterror());
				showmsg('取款撤销失败!!...');
				return (false);
			}
			//showmsg('取款撤销成功!!...');
			//showmsg('卡系统销卡失败导致交易失败！');
			return(false);
		}
		else if( $FD12 != '0000')
		{
			showmsg(geterror());
			return(false);
		}
		#YEAR_FEE=val($FD40);
		#COST_FEE=val($FD41);
		#TRAN_FEE=val($FD42);
		#YEAR_FEE1=val($FD40,0.01);
		#COST_FEE1=val($FD41,0.01);
		#TRAN_FEE1=val($FD42,0.01);
		#CARD_TRACENO=delspace(itoa(val($FD43),'%16d'));
		//showmsg('#CARD_TRACENO1='+#CARD_TRACENO);
		//showmsg('SYS108='+$FD108);
		@update=updateiccard($FD108);
		//@update='6988';
		if(@update!='9000')
		{
		showmsg('@update='+@update);
		// 脚本执行错误时，往神码发撤销 add by hzh 120411
		
	    if((@update!='9000')  and ((substr(#CARDNO,0,6)=='621223') or (substr(#CARDNO,0,6)=='621780')))
	     {
		//showmsg(geterror());
		initfd();
		commsend_001();
		$FD16='7777';
		$FD12=@update;
		$FD30=#CARDNO;
		$FD39=itoa(#TXAMT*100);
		$FD43=#CARD_TRACENO;
		callagn();
		   if($FD12!='0000')
		    {
			    showmsg('撤销卡系统开户失败:['+geterror()+']');
			  //return (false);  //由于要执行2次撤销交易,故执行撤销错误的情况下只返回错误信息,不退出而继续执行下一次撤销
		    }
		   }
	
	   //卡转账开户核心处理失败往数码发送转出卡取款撤销交易 add by hxc 091120
	     if((@update!= '9000') and (substr(#TRAN_AC_NO,0,6)=='621223' or substr(#TRAN_AC_NO,0,6)=='621780') and (#CASHCD == '2'))
	      {
		
		initfd();
		commsend_001();
		$FD16='7777';
		$FD12=@update;
		$FD30=#TRAN_AC_NO;
		$FD39=itoa(#TXAMT*100);
		$FD43=#CARD_TRACENO_TRAN;
		callagn();
		    if($FD12!='0000')
		    {
			showmsg('撤销卡系统转取款失败:['+geterror()+']');
			//return (false);   //此处只提示错误信息而不返回,确保程序继续往下执行
		     }
		     showmsg('开户失败!!...');	
		     
		    }
		    showmsg('脚本更新错误导致交易失败!!');
		    return (false);
		}
		initfd();
		//增加开卡收手续费模块
		$FD39=itoa(#YEAR_FEE,'%16.0f');
		$FD40=itoa(#COST_FEE,'%16.0f');
		$FD41=itoa(#TRAN_FEE,'%16.0f');
		//showmsg('收费开始');
		call_9986_card();
		setitems('#FEETLRNO#FEE_PWD#FEEFLAG',$FD9);  //得到收费标志
		//showmsg('#FEEFLAG = ['+#FEEFLAG+']');
		if(#FEEFLAG != '3' and #FEEFLAG != '' and (#JZZL == '0024' or #JZZL == '0027'  or #JZZL == '0028' or #JZZL == '0029' or #JZZL == '0031' or #JZZL == '0032')) //费用为0时,#FEEFLAG为空
		{
			#FEEFLAG1 = '0';
		}
		else
		{
			#FEEFLAG1 = '1';
		}
		//initfd();
	}
	//showmsg('调用平台结束!');
	$FD70='';	
	commsend_001();
	//showmsg('$FD70 = ['+$FD70+']');
	if(#JZZL == '0024' or #JZZL == '0027' or #JZZL == '0028' or #JZZL == '0029' or #JZZL == '0031' or #JZZL == '0032')
	{
		$FD39=itoa(#YEAR_FEE,'%16.0f');
		$FD40=itoa(#COST_FEE,'%16.0f');
		$FD41=itoa(#TRAN_FEE,'%16.0f');	
		$FD30=#CARDNO;
	}
	if(#CASHCD=='1')  //现金
	{
		$FD102=space(24)+#SEQNO+space(72)+space(8,'0')+getitems('#TXAMT')+space(51)+space(16,'0')+space(6)+#SEQNO2+#PRTNB;
	}
	else                //转帐
	{
		//updated by liuhaijun 20111018 start
		//转帐开户时，102域没有补齐固定长度，应该使用getitems函数，因为#号变量直接相加时，如果变量为空，不会自动补齐固定长度，导致长度不够。
		//$FD102=#TRAN_AC_NO+space(24-len(#TRAN_AC_NO))+#SEQNO_102+#TRAN_CTY+#TTRAN_CNM+space(1)+#TRAN_PDOT+space(6)+#TRAN_PWD+#TRAN_CDOT+#TRAN_CNUM+space(20-len(#TRAN_CNUM))+#TRAN_SDOT+space(17)+#STDAY+space(8-len(#STDAY))+getitems('#TXAMT')+#TRAN_CET+#TRAN_NAME+getitems('#TRAN_BAL')+#TRAN_CUR+#CASHCD+#ZY_TP+space(3-len(#ZY_TP))+#ACTLX+#SEQNO2+#PRTNB+space(80)+#SPECIAL+#TRAN_PDN+#TRAN_AC_NO+space(24-len(#TRAN_AC_NO))+space(1)+#ZY; 
		$FD102=#TRAN_AC_NO+space(24-len(#TRAN_AC_NO))+#SEQNO_102+getitems('#TRAN_CTY')+getitems('#TTRAN_CNM')+space(1)+getitems('#TRAN_PDOT')+space(6)+getitems('#TRAN_PWD')+getitems('#TRAN_CDOT')+#TRAN_CNUM+space(20-len(#TRAN_CNUM))+#TRAN_SDOT+space(17)+#STDAY+space(8-len(#STDAY))+getitems('#TXAMT')+#TRAN_CET+#TRAN_NAME+getitems('#TRAN_BAL')+#TRAN_CUR+#CASHCD+#ZY_TP+space(3-len(#ZY_TP))+#ACTLX+#SEQNO2+#PRTNB+space(80)+#SPECIAL+#TRAN_PDN+#TRAN_AC_NO+space(24-len(#TRAN_AC_NO))+space(1)+#ZY; 
		//updated by liuhaijun 20111018 end
	}
	//$FD103=getitems('#PRDTNO#CPMC#CURCD_P#ACTYPE#ZHZL#INTSTYPE#AVBAL#NAME_P#XSZH#CQ#CQDW#DQCKLX#ACTSEQ_P#CASHFLAG');
	commsend_103();
	commsend_116();
	//$FD115=space(1)+#PSWDCD+space(6)+#PASSWD+#CERTCD+#ZJHM2+space(1)+#ZJLX2;2010.01.15注销这行,刘海军邮件,梁皓然修改
	$FD115=space(1)+#PSWDCD+space(6)+getitems('#PASSWD')+#CERTCD+#ZJHM2+space(1)+#ZJLX2;
	$FD118=#CURCD+space(19)+space(16,'0');  
	
	$FD68=#ATCETYPE;
	$FD63=#ATCENUM;
	$FD83=#ATCEPHONE+'|'+#AGENTNAME;   //add by lwb  20150330
	
	$FD16='2101';
	
	$FD30=#CARDNO;
	$FD49='1';
	$FD70='1';
}"
</COMMSEND>
<COMMRECV>"{
	//showmsg('commrecvzzz1');
	//added by liuhaijun 20111019 start
	//开卡时，解决交易不成功时打印空凭证的问题
	dim @tmpFD12 as string;
	@tmpFD12=$FD12;
	//added by liuhaijun 20111019 end	
	commrecv_001();
		

   //showmsg(geterror());
	//如果是转账开卡户,记录核心返回的12域返回错误代码,否则记为0000,确保是否需要进行转取款的撤销
	if(($FD12!='0000') and ($FD12!='Z003') and ($FD12!='Z201') and (#CASHCD == '2'))
	{
		#RESP_CODE_TRAN=$FD12;
	}
	else
	{
		#RESP_CODE_TRAN='0000';
	}
	
	//卡交易核心处理失败往数码发送取消交易
	if(($FD12!='0000') and ($FD12!='Z003') and ($FD12!='Z201') and ((substr(#CARDNO,0,6)=='621223') or (substr(#CARDNO,0,6)=='621780')))
	{
		//showmsg('#RESP_CODE='+$FD12);
		#RESP_CODE=$FD12;
		//showmsg('#RESP_CODE='+$FD12);
		//showmsg(geterror());
		initfd();
		commsend_001();
		$FD16='7777';
		$FD12=#RESP_CODE;
		$FD30=#CARDNO;
		$FD39=itoa(#TXAMT*100);
		$FD43=#CARD_TRACENO;
		//showmsg('#CARD_TRACENO2='+#CARD_TRACENO);
		callagn();
		if($FD12!='0000')
		{
			showmsg('撤销卡系统开户失败:['+geterror()+']');
			//return (false);  //由于要执行2次撤销交易,故执行撤销错误的情况下只返回错误信息,不退出而继续执行下一次撤销
		}
		//showmsg('开户失败!!...');	
	}
	//卡转账开户核心处理失败往数码发送转出卡取款撤销交易 add by hxc 091120
	if((#RESP_CODE_TRAN != '0000') and (#RESP_CODE_TRAN != 'Z003') and (#RESP_CODE_TRAN != 'Z201') and (substr(#TRAN_AC_NO,0,6)=='621223' or substr(#TRAN_AC_NO,0,6)=='621780') and (#CASHCD == '2'))
	{
		//#RESP_CODE=$FD12;
		//showmsg('#RESP_CODE='+$FD12);
		//showmsg(geterror());
		initfd();
		commsend_001();
		$FD16='7777';
		$FD12=#RESP_CODE_TRAN;
		$FD30=#TRAN_AC_NO;
		$FD39=itoa(#TXAMT*100);
		$FD43=#CARD_TRACENO_TRAN;
		callagn();
		if($FD12!='0000')
		{
			showmsg('撤销卡系统转取款失败:['+geterror()+']');
			//return (false);   //此处只提示错误信息而不返回,确保程序继续往下执行
		}
		//showmsg('开户失败!!...');		
		//deleted by liuhaijun 20111019 start
		//开卡时，解决交易不成功时打印空凭证的问题
		//rerun();
		//deleted by liuhaijun 20111019 end
	}
	  
	  //showmsg('开户失败!!...');
		if(#RESP_CODE_TRAN == '0000' and #SELFYN=='0')
		{
			$FD27=#AGENTNAME;
			$FD68=#ATCETYPE;
			$FD63=#ATCENUM;			
			$FD83=#ATCEPHONE;
		}
		//added by liuhaijun 20111019 start
		//开卡时，解决交易不成功时打印空凭证的问题
		$FD12=@tmpFD12;
		//added by liuhaijun 20111019 end
}"
</COMMRECV>
<FIRSTWORK>
"{
		#PIC='';
}"
</FIRSTWORK>
<VARIABLE>
	<ITEM LINE="3"  COL="3" TYPE="%-54s" FUNCTIONS=
		"T(3701                          IC卡开户)"/>
	<ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
	 "T(─────────────────────────────────────)"/>
	<ITEM NAME="#TXNO"         TYPE="%-4s"  FUNCTIONS="T($TXNO=2101)"/>
	<ITEM NAME="#MSGTYPE"      TYPE="%-5s"  FUNCTIONS="T($MSGTYPE=03001)"/>
	<ITEM NAME="#TX_ACT_TYPE"  TYPE="%-1s"  FUNCTIONS="T(1)"/>
	<ITEM NAME="#SEQNO"        TYPE="%4s"   FUNCTIONS="T(0000)"/>      <!---帐户序号--->
	<ITEM NAME="#SEQNO2"       TYPE="%4s"   FUNCTIONS="T(0000)"/>      <!---帐户序号2--->
	<ITEM NAME="#PRTNB"        TYPE="%1s"   FUNCTIONS="T(1)"/>         <!---打折标志--->
	<ITEM NAME="#TXCD"         TYPE="%4s"   FUNCTIONS="T(3701)"/>      <!---交易代码--->
	<ITEM NAME="#TXNAME"       TYPE="%-20s" FUNCTIONS="T(IC卡开户)"/>  <!---交易名称--->
	<ITEM NAME="#CARD_TRACENO" TYPE="%-16s" FUNCTIONS=""/>
	<ITEM NAME="#RESP_CODE"    TYPE="%-4s"  FUNCTIONS=""/>
	<ITEM NAME="#CARD_TRACENO_TRAN" TYPE="%-16s" FUNCTIONS=""/>
	<ITEM NAME="#RESP_CODE_TRAN"    TYPE="%-4s"  FUNCTIONS=""/>  
	<!-- 输入客户信息 -->  
	<ITEM NAME="#CP_SERV"   TYPE="%-4s"  FUNCTIONS="T(9838)"/> <!--根据证件类型、证件号码返回客户姓名-->
	<ITEM NAME="#JZ_SERV"   TYPE="%-4s"  FUNCTIONS="T(9917)"/> <!--根据介质种类返回支取方式,下载能使用的产品-->
	<ITEM NAME="#CARD_SERV" TYPE="%-4s"  FUNCTIONS="T(9738)"/> <!--根据卡号返回凭证号码-->
	<ITEM NAME="#PZ_SERV"   TYPE="%-4s"  FUNCTIONS="T(9782)"/> <!--检查最小介质号-->
<!--del by lwb 20150330	<ITEM NAME="#SELFYN"    TYPE="%-1s"  FUNCTIONS="T(1)"/>    <!----因打凭证需要设此变量,意为是否本人---->
<!--del by lwb	<ITEM NAME="#AGENTNAME" TYPE="%-20s" FUNCTIONS=""/>        <!----因打凭证需要设此变量---->
	<ITEM NAME="#SATCETYPE" TYPE="%-20s" FUNCTIONS=""/>        <!----因打凭证需要设此变量---->
<!--del by lwb	<ITEM NAME="#ATCENUM"   TYPE="%-1s"  FUNCTIONS=""/>        <!----因打凭证需要设此变量---->
	<!--add by luolz 20090923 -->  
	<ITEM NAME="#YEAR_FEE"   TYPE="%17.2f"  FUNCTIONS=""/>    <!----年费---->	
	<ITEM NAME="#COST_FEE"   TYPE="%17.2f"  FUNCTIONS=""/>    <!----工本费----> 
	<ITEM NAME="#TRAN_FEE"   TYPE="%17.2f"  FUNCTIONS=""/>    <!----交易手续费---->  
	<ITEM NAME="#YEAR_FEE1"  TYPE="%17.2f"  FUNCTIONS=""/>    <!----年费---->	
	<ITEM NAME="#COST_FEE1"  TYPE="%17.2f"  FUNCTIONS=""/>    <!----工本费----> 
	<ITEM NAME="#TRAN_FEE1"  TYPE="%17.2f"  FUNCTIONS=""/>    <!----交易手续费---->    
	<ITEM NAME="#FEETLRNO"   TYPE="%4s"     FUNCTIONS=""/>    <!---授权柜员号---> 
	<ITEM NAME="#FEE_PWD"    TYPE="%6s"     FUNCTIONS=""/>    <!---授权柜员口令---> 
	<ITEM NAME="#FEEFLAG"    TYPE="%1s"     FUNCTIONS=""/>    <!---收费标志---> 
	<ITEM NAME="#FEEFLAG1"   TYPE="%1s"     FUNCTIONS=""/>    <!---收费标志--->   
	<ITEM NAME="#IC_ATC"     TYPE="%-4s"    FUNCTIONS=""/>    <!--应用交易计数器-->
	<ITEM NAME="#IC_AC"      TYPE="%-16s"   FUNCTIONS=""/>    <!--应用密文-->
	<ITEM NAME="#IC_NUMB"    TYPE="%-3s"    FUNCTIONS=""/>    <!--序列号-->
	<ITEM NAME="#CARDBIN1"   TYPE="%-16s"   FUNCTIONS="T(621223)"/><!--卡bin 621223-->
	<ITEM NAME="#CARDBIN2"   TYPE="%-16s"   FUNCTIONS="T(621780)"/><!--卡bin 621780 fortest-->   
	<ITEM NAME="#TOTAMT"     TYPE="%13.2f"  FUNCTIONS=""/>
	<ITEM NAME="#RETACTNO"   TYPE="%-24s"   FUNCTIONS=""/>
	<IMPORT>ICOPNACCTDEFAULT.IMP</IMPORT>
	<!-- 输入产品信息 -->
	<IMPORT>ICOPNACCTPAGE3.IMP</IMPORT>
	<!-- 转帐：输入对方帐户信息 -->
	<IMPORT>ICOPNACCTPAGE2.IMP</IMPORT>
	<REQUEST>
	</REQUEST>
	</VARIABLE>
	<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN"  DESC="交易完成">  
	CZFY|@ac_no|@name|@tx_amt1|@title|@opn_date|@opn_br_no|@cif_no|||||@tx_amt1|@email|@zy|@deac_type|@cur_name|@tx_code|@memo|@ac_no1||@ct_name|@ac_seqn|@ic_date|@prt_line|@prdt_no||@brf|@tmp_ac_no|@tmp_tx_name|@tel|@id_name|@id_no|@br_name|@br_tele|@note_no|
</PACKAGE>
<INIT>
"{
}"
</INIT>
<PRINT>
"{
	print(8,0,'                       账 /卡号:  [24]',@ac_no);
	print(9,0,'                       账户序号:  [24]',@ac_seqn);
	#RETACTNO=@ac_no;
}"
</PRINT>
</RESPONSE>
<IMPORT>CX_QK_VOC.IMP</IMPORT>
<IMPORT>CX_CK_VOC.IMP</IMPORT>
<IMPORT>OPN_PRT_VOC.IMP</IMPORT>
<RESPONSE>
	<PACKAGE DEVICE="PRINTER" DESC="请打印业务专用凭证(手续费)" LINESPACE="24" CHECK="#FEEFLAG1=0">
		NOTHING
	</PACKAGE>
	<PRINT>"{
		dim @txtime as string;
		dim @feetype as string;
		@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
		$KINDNO='00';
		print( 5,20,'机构名称:[30]',$BRNAME);
		print( 5, 2,'交易代码: 3701');
		print( 5,13,'交易名称:[20]',#TXNAME);
		print( 7,30,'\L0开卡交易\L1');
		print( 9,20,'卡号:[19]    户名:[60]',#CARDNO,#CUSTNAME);
		//print(10,20,'帐户余额:[21]',#TXAMT);
		//add by luolz 20091026 begin
		switch( #FEEFLAG ) {
			case '1' :
				print(11,20,'缴费方式:现金');	
				break;
			case '2' :
				print(11,20,'缴费方式:转账');
				break;	
			default :
				print(11,20,'缴费方式:不收');	
				break;
		}
		if( delspace(itoa(#YEAR_FEE1,'%16.2f')) != '0.00')
		{
			print(12,20,'银行卡年费:[21]',delspace(itoa(#YEAR_FEE1,'%16.2f')));
		}
		if( delspace(itoa(#COST_FEE1,'%16.2f')) != '0.00' )	
		{
			print(13,20,'银行卡工本费:[21]',delspace(itoa(#COST_FEE1,'%16.2f')));
		}
		if( delspace(itoa(#TRAN_FEE1,'%16.2f')) != '0.00' )
		{
			print(14,20,'银行卡手续费:[21]',delspace(itoa(#TRAN_FEE1,'%16.2f')));
		}
		if( delspace(itoa((#YEAR_FEE1+#COST_FEE1+#TRAN_FEE1),'%16.2f')) != '0.00' )
		{
			print(15,20,'收费总额:[21]',delspace(itoa((#YEAR_FEE1+#COST_FEE1+#TRAN_FEE1),'%16.2f')));											
		}
		
		//add by luolz 20091026 end	
		//printacdtl_1();	
		print_sq();
		print(24,20,'备注:');
		print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
		print(24,5,'柜员:[4]',$FD7);
		print(24,5,'流水号:[6]',$FD4);
	}"
	</PRINT>
</RESPONSE>
<!--RESPONSE>
	<PACKAGE DEVICE="PRINTER" DESC="请打印业务专用凭证(会计分录)" LINESPACE="24" CHECK="#FEEFLAG1=0">
		NOTHING
	</PACKAGE>
	<PRINT>"{
		dim @txtime as string;
		dim @feetype as string;
		@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
		$KINDNO='00';
		print( 5,20,'机构名称:[30]',$BRNAME);
		print( 5, 2,'交易代码: 3701');
		print( 5,13,'交易名称:[20]',#TXNAME);
		print( 7,30,'\L0开卡交易\L1');
		print( 9,20,'卡号:[19]    户名:[60]',#CARDNO,#CUSTNAME);
		switch( #CASHCD ) {
			case '1' :
				print(10,20,'存入方式:现金');
				break;
			case '2' :
				print(10,20,'存入方式:转账');
				break;
			default :
				print(10,20,'存入方式:不收');
				break;
		}
		printacdtl_1();	
		//print_sq();
		print(24,20,'备注:');
		print(24,27,'交易日期:[8] [8]',$HDATE,@txtime);
		print(24,5,'柜员:[4]',$FD7);
		print(24,5,'流水号:[6]',$FD4);
	}"
	</PRINT>
</RESPONSE-->

</TRANSACTION>
