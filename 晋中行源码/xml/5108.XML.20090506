<TRANSACTION RIGHTS="11000000" TITLE="5108 汇票资金移存入帐"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">

<COMMSEND>"{
  commsend_001();
  commsend_123();
  $FD39=itoa(#TX_AMT*100,'%016.0f');
  $FD21='01'; //币种
  $FD30='2440402';
  $FD66='1';
  $FD21='01';
  $FD68='1';
  $FD40=$FD39;
  $FD68='1';
  $FD67='2';
  $FD44=$HDATE;
  $BUFFER=getitems('#CASH_BR_NO#REG_DATE#PO_NO#PO_TYPE#HPPASSWD');
  setvfile(true,true);
  addvfile($BUFFER);
}"
</COMMSEND>
<COMMRECV>"{
  commrecv_001();
	commrecv_123();
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-52s" FUNCTIONS=
      "T(5108                        汇票资金移存入帐)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5808)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=031)"/>

  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
  "T(─────────────────────────────────────)"/>  
  <ITEM LINE="5"  COL="3"  TYPE="%-12s" FUNCTIONS="T(票据  号码: )"/>
  <ITEM LINE="7"  COL="3"  TYPE="%-12s" FUNCTIONS="T(币      种:!)"/>
  <ITEM LINE="8"  COL="3"  TYPE="%-12s" FUNCTIONS="T(优先  级别:!)"/>
  <ITEM LINE="10" COL="3"  TYPE="%-12s" FUNCTIONS="T(票据  日期: )"/>
  <ITEM LINE="11" COL="3"  TYPE="%-12s" FUNCTIONS="T(汇票  类别:!)"/>
  <ITEM LINE="12" COL="3"  TYPE="%-12s" FUNCTIONS="T(兑  付  行:)"/>
  <ITEM LINE="13" COL="3"  TYPE="%-12s" FUNCTIONS="T(金      额: )"/>
  <ITEM LINE="14" COL="3"  TYPE="%-12s" FUNCTIONS="T(汇票  密押: )"/>
  <ITEM LINE="15" COL="3"  TYPE="%-12s" FUNCTIONS="T(付款  帐号: )"/>
  <ITEM LINE="16" COL="3"  TYPE="%-12s" FUNCTIONS="T(付款人名称:)"/>
  <ITEM LINE="17" COL="3"  TYPE="%-12s" FUNCTIONS="T(付款人地址:)"/>
  <ITEM LINE="18" COL="3"  TYPE="%-12s" FUNCTIONS="T(收款人名称:)"/>
  <ITEM LINE="19" COL="3"  TYPE="%-12s" FUNCTIONS="T(附      言:)"/>
  <ITEM NAME="#ACTYPE"            TYPE="%-1s"       FUNCTIONS=""/>
  <ITEM LINE="5" COL="15"  NAME="#PO_NO"    TYPE="%8d"    DEVICE="KEYBOARD"  FUNCTIONS="V(NB)T()">
<ONLOSTFOCUS>
"{
  dim @line as string;
  @line='';
  initfd();
  commsend_001();
  commsend_123();
  $FD16 = '9560';
  @line=callserver();
  if($FD12!='0000')
  {
    showmsg(geterror());
    return(false);
  }
  setitems('#CMTNO#O_CMTNO#PAY_QS_NO#OR_BR_NO#SENDCO#PAY_OPN_BR_NO#PAY_AC_NO#PAY_NAME#PAY_ADDR#CASH_QS_NO#AC_BR_NO#RECECO#CASH_OPN_BR_NO#CASH_AC_NO#CASH_NAME#CASH_ADDR#YW_TYPE#ORDERNO#CONTENT#RATE#RATEDATE#OORDERNO#PROCODE#CR_DATE#CR_BR_NO#CR_TX_NUM#QR_BR_NO#QR_TX_NUM#TX_TYPE#NOTPAY_CONTENT#NOTPAY_ORDERNO#O_NOTPAY_ORDERNO#RESP1#OPERLEVEL#PROC_STS#OPCD#LW_IND#HP_ADD_PWD#PACKID#O_PACKID#PACK_DATE#O_PACK_DATE#TXNUM#O_TXNUM#LV_YW_IND#RESP_DATE#RCP_STS#RESP2#RETCODE#YW_DTL_ID#ACC_IND#REQ_TYPE#DF_FREEAMT#PROTNO#PO_NO#PO_TYPE#OTYPE',$FD123);
  if($FD3!=$KINBR)
  {
    showmsg('非本机构签发汇票不可以移存');
    return(false);
  }
  #REG_DATE  = $FD45;
  #TX_AMT    = val($FD39)/100;
  enable(#CASH_OPN_BR_NO,false);
  enable(#PO_TYPE,false);
  if(#PO_TYPE=='2')
  {
    #ACTYPE='7';
  }
  else
  {
    #ACTYPE='1';
  }
  enable(#REG_DATE,true);
  enable(#PO_TYPE,true);
  enable(#PAY_AC_NO,true);
  enable(#PAY_NAME,true);
  enable(#TX_AMT,true);
  enable(#CASH_AC_NO,true);
  enable(#CASH_NAME,true);
  enable(#REG_DATE,false);
  enable(#PO_TYPE,false);
  enable(#TX_AMT,false);
  enable(#HPPASSWD,false);
  enable(#PAY_NAME,false);
  enable(#PAY_ADDR,false);
  enable(#CONTENT,false);
  enable(#CASH_NAME,false);
  enable(#PAY_AC_NO,false);
  #CASH_BR_NO=substr(@line,0,12);
  #CASH_BR_NO=rtrim(#CASH_BR_NO);
  #HPPASSWD=substr(@line,29,10);
  show(#HPPASSWD,true);
  enable(#CASH_BR_NO,false);
}"
</ONLOSTFOCUS>
</ITEM>
<ITEM NAME="#XTX_AMT"  TYPE="%-21s" FUNCTIONS="X(#TX_AMT)"/>

  <ITEM LINE="7" COL="15"  NAME="#CUR_NO"   TYPE="%-3s"   DEVICE="KEYBOARD"  FUNCTIONS="V(NB)T(01)">
   <SELECT>             
         <OPTION VALUE="01 人民币" TITLE="0.人民币"/>
     </SELECT> 
     </ITEM> 

    <ITEM LINE="8" COL="15"  NAME="#OPERLEVEL"        TYPE="%-1s"   DEVICE="KEYBOARD"   FUNCTIONS="V(0,2)T(0)">
    <SELECT LINE="9" COL="17" >
      <OPTION VALUE="0 普通" TITLE="普通"/>
      <OPTION VALUE="1 紧急" TITLE="紧急"/>
      <OPTION VALUE="2 特急" TITLE="特急"/>
    </SELECT>
  </ITEM>

  <ITEM NAME="#JUMP" TYPE="%1d" FUNCTIONS="T(1)G(1,#OK)"/> 
  <ITEM LINE="10" COL="15" NAME="#REG_DATE" TYPE="%-8s"  INPUT="TEXT" FUNCTIONS="T()"/>
  <ITEM LINE="11" COL="15"  NAME="#PO_TYPE"       TYPE="%-1s"   DEVICE="KEYBOARD"   FUNCTIONS="V(0,2)T(0)">
    <SELECT LINE="12" COL="17">
      <OPTION VALUE="0 可转让汇票  " TITLE="0.可转让汇票  "/>
      <OPTION VALUE="1 不可转让汇票" TITLE="1.不可转让汇票"/>
      <OPTION VALUE="2 现金汇票    " TITLE="2.现金汇票    "/>
    </SELECT>
  </ITEM>
  
  <ITEM LINE="12" COL="15"  NAME="#CASH_BR_NO"       TYPE="%12s"  DEVICE="KEYBOARD"   FUNCTIONS="T()"/>
  <ITEM LINE="13" COL="15"  NAME="#TX_AMT"           TYPE="%16.2f" DEVICE="KEYBOARD"  FUNCTIONS="V(NB)T()"/>
  <ITEM LINE="14" COL="15"  NAME="#HPPASSWD"         TYPE="%-10s"  DEVICE="KEYBOARD"   FUNCTIONS="V(NB)T()"/>
  <ITEM LINE="15" COL="15"  NAME="#PAY_AC_NO"       TYPE="%-32s"  DEVICE="KEYBOARD"   FUNCTIONS="T()"/>
  <ITEM LINE="16" COL="15"  NAME="#PAY_NAME"        TYPE="%-60s"  DEVICE="KEYBOARD"   FUNCTIONS="V(NB)T()"/>
  <ITEM LINE="17" COL="15"  NAME="#PAY_ADDR"        TYPE="%-60s"  DEVICE="KEYBOARD"   FUNCTIONS="V(NB)"/>
  <ITEM LINE="18" COL="15"  NAME="#CASH_NAME"       TYPE="%-60s"  DEVICE="KEYBOARD"   FUNCTIONS="V(NB)T()"/>
  <ITEM LINE="19" COL="15"  NAME="#CONTENT"          TYPE="%-60s"  DEVICE="KEYBOARD"   FUNCTIONS="T()"/>
<!-- FD44 -->
<ITEM NAME="#WT_DAY"            TYPE="%-8s"       FUNCTIONS="T($HDATE)"/>  
  <!--FD123域定义-->
<ITEM NAME="#CMTNO"             TYPE="%-3s"       FUNCTIONS="T(121)"/>
<ITEM NAME="#O_CMTNO"           TYPE="%-3s"       FUNCTIONS="T()"/>
<ITEM NAME="#PAY_QS_NO"         TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#OR_BR_NO"          TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#SENDCO"            TYPE="%-4s"       FUNCTIONS="T()"/>
<ITEM NAME="#PAY_OPN_BR_NO"     TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#CASH_QS_NO"        TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#AC_BR_NO"          TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#RECECO"            TYPE="%-4s"       FUNCTIONS="T()"/>
<ITEM NAME="#CASH_ADDR"         TYPE="%-60s"      FUNCTIONS="T()"/>
<ITEM NAME="#YW_TYPE"           TYPE="%-2s"       FUNCTIONS="T()"/>
<ITEM NAME="#ORDERNO"           TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#RATE"              TYPE="%-7s"       FUNCTIONS="T()"/>


<ITEM NAME="#NOTPAY_CONTENT"    TYPE="%-255s"     FUNCTIONS="T()"/>
<ITEM NAME="#O_NOTPAY_ORDERNO"  TYPE="%-3s"       FUNCTIONS="T()"/>
<ITEM NAME="#RESP1"             TYPE="%-1s"       FUNCTIONS="T()"/>

<ITEM NAME="#O_WT_DAY"          TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#NOTPAY_DATE"       TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#OPCD"              TYPE="%-2s"       FUNCTIONS="T(10)"/>
<ITEM NAME="#NOTE_TYPE"         TYPE="%-3s"       FUNCTIONS="T()"/>
<ITEM NAME="#NOTE_NO"           TYPE="%-16s"      FUNCTIONS="T()"/>

<ITEM NAME="#PROTNO"            TYPE="%-60s"      FUNCTIONS="T()"/>
<ITEM NAME="#CASH_OPN_BR_NO"    TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#CASH_AC_NO"        TYPE="%-32s"      FUNCTIONS="T()"/>
<ITEM NAME="#RATEDATE"          TYPE="%-5s"       FUNCTIONS="T()"/>
<ITEM NAME="#OORDERNO"          TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#PROCODE"           TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#CR_DATE"           TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#CR_BR_NO"          TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#CR_TX_NUM"         TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#QR_BR_NO"          TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#QR_TX_NUM"         TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#TX_TYPE"           TYPE="%-1s"       FUNCTIONS="T()"/>
<!--<ITEM NAME="#NOTPAY_CONTENT"    TYPE="%-255s"     FUNCTIONS="T()"/>--><!--同名ITEM liangq注-->
<ITEM NAME="#NOTPAY_ORDERNO"    TYPE="%-3s"       FUNCTIONS="T()"/>
<ITEM NAME="#PROC_STS"          TYPE="%-1s"       FUNCTIONS="T()"/><!--处理状态-->
<ITEM NAME="#LW_IND"            TYPE="%-1s"       FUNCTIONS="T()"/>
<ITEM NAME="#PACKID"            TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#O_PACKID"          TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#PACK_DATE"         TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#O_PACK_DATE"       TYPE="%-8s"       FUNCTIONS="T()"/>
<ITEM NAME="#TXNUM"             TYPE="%-5s"       FUNCTIONS="T()"/>
<ITEM NAME="#O_TXNUM"           TYPE="%-5s"       FUNCTIONS="T()"/>
<ITEM NAME="#LV_YW_IND"         TYPE="%-12s"      FUNCTIONS="T()"/>
<ITEM NAME="#RESP_DATE"         TYPE="%8d"       FUNCTIONS="T()"/>
<ITEM NAME="#RCP_STS"           TYPE="%2d"       FUNCTIONS="T()"/>
<ITEM NAME="#RESP2"             TYPE="%8s"       FUNCTIONS="T()"/>
<ITEM NAME="#RETCODE"           TYPE="%2d"       FUNCTIONS="T()"/>
<ITEM NAME="#YW_DTL_ID"         TYPE="%8d"       FUNCTIONS="T()"/>
<ITEM NAME="#ACC_IND"           TYPE="%1d"       FUNCTIONS="T()"/>
<ITEM NAME="#REQ_TYPE"          TYPE="%1d"       FUNCTIONS="T()"/>
<ITEM NAME="#DF_FREEAMT"        TYPE="%16s"      FUNCTIONS="T()"/>
<ITEM NAME="#OTYPE"             TYPE="%1d"       FUNCTIONS="T(1)"/><!-- 表示大额 -->
<ITEM NAME="#HP_ADD_PWD"        TYPE="%-1s"      FUNCTIONS="T()"/>
<!--<ITEM NAME="#OTYPE"             TYPE="%1d"       FUNCTIONS="T()"/><!-- 表示大额 -->--><!--同名ITEM liangq注-->
  <!--定义结束-->

<ITEM LINE="21"  COL="65"  TYPE="%-6s" NAME="#OK" FUNCTIONS="T(确  定)" INPUT="SUBMIT" />
</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="汇票资金移存入帐">
NOTHING
</PACKAGE>
  <PRINT>"{
        print(3,5, '         5108    汇票资金移存入帐');
        print(4,5, '委 托 日 期:[8]  支付交易序号:[8]',$HDATE,#ORDERNO);
        print(5,5, '汇 票 号 码:[8]  接收行行号:[12]',#PO_NO,#AC_BR_NO);
        print(6,5, '付款人帐号 :[24]   ',#PAY_AC_NO);
        print(7,5, '付款人名称 :[60]',#PAY_NAME);
        print(8,5, '汇 款 金 额:[21]',#XTX_AMT);
        print(9,5, '收款人开户行:[12]       对方清算行号: [12]',#CASH_OPN_BR_NO,#CASH_QS_NO);
        print(10,5,'收款人帐号:[24]',#CASH_AC_NO);
        print(11,5,'收款人名称:[60]',#CASH_NAME);
        print(12,5,'附      言:[60]',#CONTENT);
      }"
  </PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="24" DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
 <PRINT>"{
 $KINDNO='00';
 dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:5108');
	print( 5, 13,'交易:汇票资金移存入帐');
	
	print( 6,20, '委 托 日 期:[8]  支付交易序号:[8]',$HDATE,#ORDERNO);
	print( 7,20, '汇 票 号 码:[8]  接收行行号:[12]',#PO_NO,#AC_BR_NO);
	print( 8,20, '付款人帐号 :[24]     汇 款 金 额:[21]',#PAY_AC_NO,#XTX_AMT);
	print( 9,20, '付款人名称 :[60]',#PAY_NAME);
	print(10,20, '收款人开户行:[12]       对方清算行号: [12]',#CASH_OPN_BR_NO,#CASH_QS_NO);
	print(11,20,'收款人帐号:[24]',#CASH_AC_NO);
	print(12,20,'收款人名称:[60]',#CASH_NAME);
	print(13,20,'附      言:[60]',#CONTENT);
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);   
 }"
 </PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  LINESPACE="24" DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
 <PRINT>"{
 $KINDNO='00';
dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
 	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:5108');
	print( 5, 13,'交易:汇票资金移存入帐');
	
	printacdtl_1();
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);
 }"
 </PRINT>
</RESPONSE>
<OUTPUT>

</OUTPUT>
</TRANSACTION>
    
