<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11000000" TITLE="4507 委托协议"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
 
<COMMSEND>"{
		initfd();
	commsend_001();
       	$FD21=#CURCD;
	$FD25=#DKACTNM;
	$FD26=#WTACTNM;
	$FD27=#BJACTNM;
	$FD30=#WTACT;
	$FD31=#BJACT;
	$FD32=#LXACT;
	$FD34=#DKACTSEQ;
	$FD36=#LXACTSEQ;
	$FD37=#WTDKACT;
	$FD40=itoa(#WTAMT*100,'%016.0f');
	$FD48=#WTACTSEQ;
	$FD49=#BJACTSEQ;
	$FD62=#WTBH;
	$FD70=#GJTP;
	$FD81=#LXACTNM; //FD81是50位长
	$FD83=#WTNAME;
	$FD16='3307';
}"
</COMMSEND>
<COMMRECV>"{
	commrecv_001();
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
   "T(4507                            委托协议)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>

  <!--输入变量-->
  <ITEM LINE="5"   COL="05" TYPE="%-14s" FUNCTIONS="T(委 托  编 号:)"/>
  <ITEM LINE="6"   COL="05" TYPE="%-14s" FUNCTIONS="T(币        种!:)"/>
  <ITEM LINE="6"   COL="47" TYPE="%-14s" FUNCTIONS="T(委 托  金 额:)"/>
  <ITEM LINE="07"  COL="05" TYPE="%-16s" FUNCTIONS="T(是否公积金贷款!:)"/>
  <ITEM LINE="08"  COL="03" TYPE="%-16s" FUNCTIONS="T(委托存款人名称:)"/>

  <ITEM LINE="10"  COL="05" TYPE="%-16s" FUNCTIONS="T(贷款帐号:)"/>
  <ITEM LINE="10"  COL="47" TYPE="%-14s" FUNCTIONS="T(贷款帐户序号:)"/>
  <ITEM LINE="11"  COL="05" TYPE="%-14s" FUNCTIONS="T(贷款帐号户名:)"/>

  <ITEM LINE="13"  COL="03" TYPE="%-16s" FUNCTIONS="T(委托人收息帐号:)"/>
  <ITEM LINE="13"  COL="47" TYPE="%-14s" FUNCTIONS="T(帐户序号:)"/>
  <ITEM LINE="14"  COL="05" TYPE="%-14s" FUNCTIONS="T(帐户户名:)"/>

  <ITEM LINE="16"  COL="01" TYPE="%-20s" FUNCTIONS="T(存款人还本金帐号:)"/>
  <ITEM LINE="16"  COL="47" TYPE="%-14s" FUNCTIONS="T(归还帐号序号:)"/>
  <ITEM LINE="17"  COL="05" TYPE="%-14s" FUNCTIONS="T(归还帐户户名:)"/>

  <ITEM LINE="19"  COL="01" TYPE="%-20s" FUNCTIONS="T(存款人还利息帐号:)"/>
  <ITEM LINE="19"  COL="47" TYPE="%-14s" FUNCTIONS="T(利息帐号序号:)"/>
  <ITEM LINE="20"  COL="05" TYPE="%-14s" FUNCTIONS="T(利息帐号户名:)"/>


  <ITEM LINE="5"  COL="19" NAME="#WTBH"  INPUT="TEXT"   TYPE="%-20s" FUNCTIONS="T()"/>
  <ITEM LINE="6"  COL="19" NAME="#CURCD" INPUT="SELECT" TYPE="%-2s"  FUNCTIONS="T(01)">
  <SELECT>
  <OPTION VALUE="01" TITLE="人民币"/>
  </SELECT>
  </ITEM>
  <ITEM LINE="6"  COL="60" NAME="#WTAMT"  INPUT="TEXT"   TYPE="%13.2f" FUNCTIONS="T() J(#XWTAMT)"/>
  <ITEM LINE="7"  COL="19" NAME="#GJTP"   INPUT="SELECT" TYPE="%-1s"   FUNCTIONS="T(N)">
  <SELECT>
  <OPTION VALUE="N" TITLE="否"/>
  <OPTION VALUE="Y" TITLE="是"/>
  </SELECT>
  </ITEM>
  <ITEM NAME="#XWTAMT" TYPE="%-15s" FUNCTIONS="X(#WTAMT)"/>
  <ITEM LINE="8"   COL="19" NAME="#WTNAME"   INPUT="TEXT"   TYPE="%-50s" FUNCTIONS="T()"/>

  <ITEM LINE="10"  COL="19" NAME="#WTDKACT"  INPUT="TEXT"   TYPE="%-19s" FUNCTIONS="T()"/>

  <ITEM NAME="#CON1"    TYPE="%-1s" >
  <ONLOSTFOCUS>
 "{
	initfd();
	commsend_001();
        $FD16='9807';
        $FD17='';
        $FD37=#WTDKACT;

        callserver();
        if($FD12!='0000')
        {
			showmsg(geterror());
            return(false);
        }
		#DKACTSEQ=$FD34;
		show(#DKACTSEQ,true);
		if(len($FD34)==0)
		{
			enable(#DKACTSEQ,false);
		}else{
			enable(#DKACTSEQ,true);
		}

		$FD16='9882';
		callserver();
        if($FD12!='0000')
        {
			showmsg(geterror());
            return(false);
        }
		#DKACTNM=$FD25;
		show(#DKACTNM,true);
		enable(#DKACTNM,false);


  }"
  </ONLOSTFOCUS>
  </ITEM>

  <ITEM LINE="10"  COL="60" NAME="#DKACTSEQ" INPUT="TEXT"   TYPE="%4d"   FUNCTIONS="T()"/>
  <ITEM LINE="11"  COL="19" NAME="#DKACTNM"  INPUT="TEXT"   TYPE="%-60s" FUNCTIONS="T()"/>

  <ITEM LINE="13"  COL="19" NAME="#WTACT"    INPUT="TEXT"   TYPE="%-19s" FUNCTIONS="T()"/>
  <ITEM NAME="#CON2"    TYPE="%-1s" >
  <ONLOSTFOCUS>
 "{
	initfd();
	commsend_001();
    $FD16='9830';
    $FD17='';
    $FD21=#CURCD;
    $FD30=#WTACT;

	callserver();
        if($FD12!='0000')
        {
			showmsg(geterror());
            return(false);
        }
		#WTACTNM=$FD26;
		#WTACTSEQ=$FD48;
		show(#WTACTNM,true);
		enable(#WTACTNM,false);

		if(atoi($FD48)>1)
		{
				show(#WTACTSEQ,true);
				enable(#WTACTSEQ,true);
		}else{
				show(#WTACTSEQ,true);
				enable(#WTACTSEQ,false);
		}

  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="13"  COL="60" NAME="#WTACTSEQ" INPUT="TEXT"   TYPE="%4d"   FUNCTIONS="T()"/>
  <ITEM LINE="14"  COL="19" NAME="#WTACTNM"  INPUT="TEXT"   TYPE="%-60s" FUNCTIONS="T()"/>

  <ITEM LINE="16"  COL="19" NAME="#BJACT"    INPUT="TEXT"   TYPE="%-19s" FUNCTIONS="T()"/>
  <ITEM NAME="#CON3"    TYPE="%-1s" >
  <ONLOSTFOCUS>
 "{
		initfd();
		commsend_001();

        $FD16='9831';
        $FD17='';
        $FD21=#CURCD;
        $FD31=#BJACT;

		callserver();
        if($FD12!='0000')
        {
			showmsg(geterror());
            return(false);
        }
		#BJACTNM=$FD27;

		#BJACTSEQ=$FD49;
		show(#BJACTNM,true);
		enable(#BJACTNM,false);

		if(atoi($FD49)>1)
		{
				show(#BJACTSEQ,true);
				enable(#BJACTSEQ,true);
		}else{
				show(#BJACTSEQ,true);
				enable(#BJACTSEQ,false);
		}

  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="16"  COL="60" NAME="#BJACTSEQ" INPUT="TEXT"   TYPE="%4d"   FUNCTIONS="T()"/>
  <ITEM LINE="17"  COL="19" NAME="#BJACTNM"  INPUT="TEXT"   TYPE="%-60s" FUNCTIONS="T()"/>

  <ITEM LINE="19"  COL="19" NAME="#LXACT"    INPUT="TEXT"   TYPE="%-19s" FUNCTIONS="T()"/>
  <ITEM NAME="#CON4"    TYPE="%-1s" >
  <ONLOSTFOCUS>
 "{
		initfd();
		commsend_001();
        $FD16='9832';
        $FD17='';
        $FD21=#CURCD;
        $FD32=#LXACT;

		callserver();
        if($FD12!='0000')
        {
			showmsg(geterror());
            return(false);
        }
		#LXACTNM=$FD81;
		#LXACTSEQ=$FD36;
		show(#LXACTNM,true);
		enable(#LXACTNM,false);

		if(atoi($FD36)>1)
		{
				show(#LXACTSEQ,true);
				enable(#LXACTSEQ,true);
		}else{
				show(#LXACTSEQ,true);
				enable(#LXACTSEQ,false);
		}

  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="19"  COL="60" NAME="#LXACTSEQ" INPUT="TEXT"   TYPE="%4d"   FUNCTIONS="T()"/>
  <ITEM LINE="20"  COL="19" NAME="#LXACTNM"  INPUT="TEXT"   TYPE="%-50s" FUNCTIONS="T()"/>

  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
  </VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="PRINTER"  DESC="请打印业务专用凭证">
NOTHING
</PACKAGE>
<PRINT>"{
        dim @txtime  as string;
        @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);
        print( 5, 2,'代码:4507');
        print( 5, 13,'交易:委托协议');

        print( 7, 20,'委托编号:[20]            委托金额:[15               ]',#WTBH,#XWTAMT);
        print( 8, 20,'委 托 人:[20]',#WTNAME);
        print(10, 20,'贷款账号:[20]            账号序号:[6      ]',#WTDKACT,#DKACTSEQ);
        print(11, 20,'户    名:[60]',#DKACTNM);
        print(12, 20,'委托户存款账号:[20]      账户序号:[6      ]',#WTACT,#WTACTSEQ);
        print(13, 20,'户    名:[60]',#WTACTNM);
        print(15, 20,'归还本金账号:[20]        账户序号:[6      ]',#BJACT,#BJACTSEQ);
        print(16, 20,'户    名:[60]',#BJACTNM);
        print(17, 20,'归还利息账号:[20]        账户序号:[6      ]',#LXACT,#LXACTSEQ);
        print(18, 20,'户    名:[50]',#LXACTNM);

        print( 24,20,'备注:')
        print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
        print( 24,5,'柜员:[4]',$FD7);
        print( 24,5,'流水号:[6]',$FD4);
        }"
</PRINT>
</RESPONSE>
</TRANSACTION>

