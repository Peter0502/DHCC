<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110000" TITLE="5361 支付交易高级查询"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{	    
}"
</COMMSEND>
<COMMRECV>"{
commrecv_001();

}"
</COMMRECV>
<VARIABLE>

<ITEM NAME="#DOLIST" TYPE="%1s" FUNCTIONS="">
<ONLOSTFOCUS>
"{
	dim @selid as number;
	dim @ldxml as string;
	dim @filename as string;
	dim @tota as string;
	dim @CMTNO as string;
	if(#DOLIST !='')
	{
		while(true)
		{
			@selid=list_work();
			if(@selid &lt; 0)
			{
				list_del();
				rerun();
				return(true);
			}
			initfd();
			commsend_001();
			@CMTNO = rtrim(list_gettext(@selid,0));
			switch(@CMTNO)
			{
				case '001':
				case '002':
				case '003':
				case '004':
				case '005':
				case '006':
				case '007':
				case '008':
				case '009':
				case '010':
				case '011':
				case '012':
				case '013':
						$FD16 = '9568';
						#ORDERNO = rtrim(list_gettext(@selid,3));
						#WT_DATE = rtrim(list_gettext(@selid,4));
						#OR_BR_NO=rtrim(list_gettext(@selid,6));
						$FD123 = getitems('#CRDB#OPCD#PKGNO#ORDERNO#TXNUM#OR_BR_NO#AC_BR_NO#TX_AMT#PAY_OPN_BR_NO#PAY_QS_NO#PAY_AC_NO#PAY_NAME#PAY_ADDR#PWD#CASH_QS_NO#CASH_OPN_BR_NO#CASH_AC_NO#CASH_NAME#CASH_ADDR#YW_TYPE#BRF#WT_DATE#OPERLEVEL#AUTH_TEL#AUTH_PWD#NOTE_TYPE#NOTE_NO#PACK_DATE#PACK_ID#CHRG_IND#CHRG_AMT#RESP_DAY#PO_TYPE#PO_DATE#PO_NUM#PC_TX_AMT#JF_TX_AMT#O_WT_DATE#O_TXNUM#O_ORDERNO#RET_CODE#RCP_STS#RESP1#RESP2#PACK_END#LV_STS#LW_IND#DFXYNO#OORBRNO#OACBRNO');

						callserver();
						if($FD12!='0000')
						{
							showmsg(geterror());	
							return (false);
						}
						$BUFFER = $FD123;
						break;
				
			}

			switch(@CMTNO)
			{
				case '001':
				case '002':
				case '003':
				case '004':
				case '005':
				case '006':
				case '007':
				case '008':
				case '009':
				case '010':
				case '011':
				case '012':
				case '013':
					@filename = 'LVZF.XML';
					break;
			}
			open(@filename,'#TX_DATE='+$FD44+';#TMP_TXAMT='+$FD39+';#OWTDATE='+$FD45+';');	
			
			return(true);
		}
	}
	list_del();
	#DOLIST='';
}"
</ONLOSTFOCUS>
</ITEM>	
<ITEM NAME="#DOLIST1" TYPE="%-1s" FUNCTIONS="">
<ONLOSTFOCUS>
"{
	showall();
}"
</ONLOSTFOCUS>
</ITEM>
  <ITEM LINE="3"  COL="3" TYPE="%-46s" FUNCTIONS=
    "T(5361                      支付交易高级查询)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
    "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5906)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM LINE="8"  COL="15"  TYPE="%-10s"  FUNCTIONS="T(交易行号:)"/>
  <ITEM LINE="9"  COL="15"  TYPE="%-10s"  FUNCTIONS="T(来往标志:)"/>
  <ITEM LINE="9"  COL="40"  TYPE="%-10s"  FUNCTIONS="T(交易类型:)"/>
  <ITEM LINE="10" COL="15"  TYPE="%-10s"  FUNCTIONS="T(交易日期:)"/>
  <ITEM LINE="12" COL="15"  TYPE="%-60s" FUNCTIONS="T(--------------高级选项--------------------)"/>  
  <ITEM LINE="14" COL="15"  TYPE="%-10s"  FUNCTIONS="T(付款帐号:)"/>
  <ITEM LINE="15" COL="15"  TYPE="%-10s"  FUNCTIONS="T(收款帐号:)"/>
  <ITEM LINE="17" COL="15"  TYPE="%-10s"  FUNCTIONS="T(金额下限:)"/>
  <ITEM LINE="17" COL="48"  TYPE="%-6s"  FUNCTIONS="T([小值])"/>
  <ITEM LINE="19" COL="15"  TYPE="%-10s"  FUNCTIONS="T(金额上限:)"/>
  <ITEM LINE="19" COL="48"  TYPE="%-6s"  FUNCTIONS="T([大值])"/>  
  <ITEM LINE="8"  COL="25" NAME="#BR_NO"    TYPE="%-5s"     INPUT="TEXT"   FUNCTIONS="T($KINBR)"/>
  <ITEM LINE="9" COL="25"  NAME="#LW_IND"  TYPE="%-1s"     INPUT="SELECT" FUNCTIONS="T(1)V(NB)">
     <SELECT LINE="9" COL="27">
	<OPTION VALUE="1" TITLE="1.往包"/>
      	<OPTION VALUE="2" TITLE="2.来包"/>
     </SELECT>
  </ITEM>
  <ITEM LINE="9" COL="50" NAME="#PKGNO" TYPE="%-3s"        INPUT="SELECT" FUNCTIONS="T(000)V(NB)">
     <SELECT LINE="9" COL="52">
	     <OPTION VALUE="000 所    有"               TITLE="000.所    有"/>     
	     <OPTION VALUE="001 普通贷记"               TITLE="001.普通贷记"/>
	     <OPTION VALUE="002 普通借记"               TITLE="002.普通借记"/>
	     <OPTION VALUE="003 实时贷记"               TITLE="003.实时贷记"/>
	     <OPTION VALUE="004 实时借记"               TITLE="004.实时借记"/>
	     <OPTION VALUE="005 定期贷记"               TITLE="005.定期贷记"/>
	     <OPTION VALUE="006 定期借记"               TITLE="006.定期借记"/>     
	     <OPTION VALUE="007 贷记退汇"               TITLE="007.贷记退汇"/>
	     <OPTION VALUE="008 普通借记回执"           TITLE="008.普通借记回执"/>
	     <OPTION VALUE="009 实时借记回执"           TITLE="009.实时借记回执"/>
	     <OPTION VALUE="010 定期借记回执"           TITLE="010.定期借记回执"/>
	     <OPTION VALUE="011 实时贷记回执"           TITLE="011.实时贷记回执"/>
     </SELECT>
  </ITEM>

  <ITEM LINE="10" COL="25" NAME="#WT_DATE"  TYPE="%-8s"     INPUT="TEXT" FUNCTIONS="T($HDATE)"/>
  

  <ITEM LINE="14" COL="25"  NAME="#PAY_AC_NO"     INPUT="TEXT" TYPE="%-32s"   FUNCTIONS="T()"/>
  <ITEM LINE="15" COL="25"  NAME="#CASH_AC_NO"    INPUT="TEXT" TYPE="%-32s"   FUNCTIONS="T()"/>
  <ITEM LINE="17" COL="25"  NAME="#PC_TX_AMT"      INPUT="TEXT" TYPE="%16.2f"  FUNCTIONS=""/>
  <ITEM LINE="19" COL="25"  NAME="#JF_TX_AMT"      INPUT="TEXT" TYPE="%16.2f"  FUNCTIONS="">
    <ONLOSTFOCUS>
    "{
	if(#PC_TX_AMT&gt;#JF_TX_AMT)
	{
		showmsg('金额下限不能小于上限');
		goitem(#PC_TX_AMT);
	}	
   }"
   </ONLOSTFOCUS>  
  </ITEM>
   
<ITEM NAME="#PASSWD"  		TYPE="%-6s"  FUNCTIONS=""/>
<ITEM NAME="#CRDB"  		TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#OPCD"  		TYPE="%-2s"  FUNCTIONS=""/>
<ITEM NAME="#ORDERNO"  		TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#TXNUM"  		TYPE="%-5s"  FUNCTIONS=""/>
<ITEM NAME="#OR_BR_NO"  	TYPE="%-12s" FUNCTIONS=""/>
<ITEM NAME="#AC_BR_NO"  	TYPE="%-12s" FUNCTIONS=""/>
<ITEM NAME="#TX_AMT"  		TYPE="%-15s" FUNCTIONS=""/>
<ITEM NAME="#PAY_OPN_BR_NO"  	TYPE="%-12s" FUNCTIONS=""/>
<ITEM NAME="#PAY_QS_NO"  	TYPE="%-12s" FUNCTIONS=""/>
<ITEM NAME="#PAY_NAME"  	TYPE="%-60s" FUNCTIONS=""/>
<ITEM NAME="#PAY_ADDR"  	TYPE="%-60s" FUNCTIONS=""/>
<ITEM NAME="#PWD"  		TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#CASH_QS_NO"  	TYPE="%-12s" FUNCTIONS=""/>
<ITEM NAME="#CASH_OPN_BR_NO"  	TYPE="%-12s" FUNCTIONS=""/>
<ITEM NAME="#CASH_NAME"  	TYPE="%-60s" FUNCTIONS=""/>
<ITEM NAME="#CASH_ADDR"  	TYPE="%-60s" FUNCTIONS=""/>
<ITEM NAME="#YW_TYPE" 		TYPE="%-12s" FUNCTIONS=""/>
<ITEM NAME="#BRF"  		TYPE="%-60s" FUNCTIONS=""/>
<ITEM NAME="#OPERLEVEL"  	TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#AUTH_TEL"  	TYPE="%-6s"  FUNCTIONS=""/>
<ITEM NAME="#AUTH_PWD"  	TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#NOTE_TYPE"  	TYPE="%-2s"  FUNCTIONS=""/>
<ITEM NAME="#NOTE_NO"  		TYPE="%-12s" FUNCTIONS=""/>
<ITEM NAME="#PACK_DATE"  	TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#PACK_ID"  		TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#CHRG_IND"  	TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#CHRG_AMT"  	TYPE="%-15s" FUNCTIONS=""/>
<ITEM NAME="#RESP_DAY"  	TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#PO_TYPE"  		TYPE="%-2s"  FUNCTIONS=""/>
<ITEM NAME="#PO_DATE"  		TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#PO_NUM"  		TYPE="%-8s"  FUNCTIONS=""/>

<ITEM NAME="#O_WT_DATE"  	TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#O_TXNUM"  		TYPE="%-5s"  FUNCTIONS=""/>
<ITEM NAME="#O_ORDERNO"  	TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#RET_CODE"  	TYPE="%-2s"  FUNCTIONS=""/>
<ITEM NAME="#RCP_STS"  		TYPE="%-2s"  FUNCTIONS=""/>
<ITEM NAME="#RESP1"  		TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#RESP2"  		TYPE="%-8s"  FUNCTIONS=""/>
<ITEM NAME="#PACK_END"  	TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#LV_STS"  		TYPE="%-1s"  FUNCTIONS=""/>
<ITEM NAME="#DFXYNO"      	TYPE="%-60s"   	FUNCTIONS="T()"/>		<!--多方协议号-->
<ITEM NAME="#OORBRNO"     	TYPE="%-12s"   	FUNCTIONS="T()"/>	<!--原发起行行号 -->
  <ITEM NAME="#OACBRNO"      	TYPE="%-12s"   	FUNCTIONS=""/>		<!--原接收行行号-->
  <ITEM LINE="21"  COL="65" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON" >
 <ONCLICK>"{
	dim @tota as string;
	dim @offset as number;
	dim @cnt as number;
	dim @packlen as number;
	dim @flag as string;
	dim @id as number;
	list_init(17,78,5,1);
	list_setcolcnt(6);
	list_setcol(0,'交易行',9);
	list_setcol(1,'顺序号',8);
	list_setcol(2,'交   易   金   额',20);
	list_setcol(3,'开户行( 付 )',14);
	list_setcol(4,'开户行( 收 )',14);
	list_setcol(5,'状    态',8);
	initfd();

	commsend_001();
	$FD88  = #BR_NO;
	lvsend_123();
	$FD16 = '5906';
	@tota=callserver();
	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}
	if(substr(@tota,36,1)=='E')
	{
		showmsg(substr(@tota,36,5) +'  '+substr(@tota,44,40))
		list_del();
		return(true);
	}
	if(autolist(@tota))
	{
		list_work();
	}

	#DOLIST='1';
	}"
</ONCLICK>
</ITEM>
  
  </VARIABLE>

 <REQUEST>
 </REQUEST>
<RESPONSE>
</RESPONSE>
</TRANSACTION>
                  
 
