<TRANSACTION RIGHTS="11110000" TITLE="5303 定期贷记业务录入"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
  commsend_001();
	$FD3 =$KINBR;
	$FD44=$HDATE;
	$FD20='1';
	$FD7=$TLRNO;
	//showmsg('#DRAW_PWD'+#DRAW_PWD);
	$FD102 = getitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PWDFLAG#QUE_PWD#DRAW_PWD#ID_TYPE#CERTNO20#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CT_IND#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10');
	lvsend_123();
 //验印 start 20131212 yaofuqiang
 if(substr(#PAY_AC_NO,0,1)=='5' or substr(#PAY_AC_NO,0,1)=='6')
    {
			dim @rs as string;
			showhelp('系统提示','开始调取验印系统... ');
			if(#VOCTYPE!='005')
			{
				@rs = judgeone(#PAY_AC_NO,'299','0',$HDATE,#XTX_AMT,'1');
			}else
			{			
				@rs = judgeone(#PAY_AC_NO,#VOCTYPE,#VOCNUM,$HDATE,#XTX_AMT,'1');
			}
			
			if(@rs=='1')
			{
				showmsg('验印不通过！');
				return(false);
			}
			else if(@rs=='0')
			{       
				showmsg('验印通过！');
				return(true);			
			}else
			{       
				showmsg('验印失败请重新验印！');
				return(false);		
			}
		}
			//验印 end 20131212 yaofuqiang
}"
</COMMSEND>
<COMMRECV>"{
    commrecv_001();
    lvrecv_123();
}"
</COMMRECV>
<FIRSTWORK>
"{
  #PIC='';
  #PIC1='';
  show(#PIC,false);
  show(#PIC1,false);
  show(#LBLPIC,false);
  show(#LBLPIC1,false);
  enable(#SETPIC,false);
  enable(#SETPIC1,false);
}"
</FIRSTWORK>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-54s" FUNCTIONS=
    "T(5303                    定期贷记业务录入)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(------------------------------------------------------------------------------------------)"/>
  <ITEM NAME="#TXNO" 	TYPE="%-4s" FUNCTIONS="T($TXNO=5843)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM LINE="5"  COL="3"   TYPE="%-12s" FUNCTIONS="T(接收  行号:)"/>
  <ITEM LINE="6"  COL="3"   TYPE="%-12s" FUNCTIONS="T(读取  方式:)"/>	
  <ITEM LINE="7"  COL="3"   TYPE="%-12s" FUNCTIONS="T(付款  帐号:)"/>
  <ITEM LINE="7"  COL="35"  NAME="#LDRAW_PWD"  TYPE="%-10s" INPUT="LABEL" VISABLE="FALSE" FUNCTIONS="T(储户密码:)"/>
  <ITEM LINE="8"  COL="3"  TYPE="%-11s" INPUT="LABEL" VISABLE="FALSE" NAME="#SHOW_ID_TYPE" FUNCTIONS="T(证件类型:)"/>
  <ITEM LINE="8"  COL="45" TYPE="%-9s" INPUT="LABEL" VISABLE="FALSE" NAME="#SHOW_ID_NO" FUNCTIONS="T(证件号码:)"/>
  <ITEM LINE="7"     COL="55"  NAME="#LBLPIC" TYPE="%-10s" FUNCTIONS="T(照    片:)"/>
  <ITEM LINE="7"     COL="65"  NAME="#LBLPIC1" TYPE="%-10s" FUNCTIONS="T(印    件:)"/>
  <ITEM LINE="9"   COL="3"  TYPE="%-12s" FUNCTIONS="T(付款人名称:)"/>
  <ITEM LINE="10"  COL="3"  TYPE="%-12s" FUNCTIONS="T(交易  金额:)"/>
  <ITEM LINE="12"  COL="3"  TYPE="%-12s" FUNCTIONS="T(收款  帐号:)"/>
  <ITEM LINE="13"  COL="3"  TYPE="%-12s" FUNCTIONS="T(收款人名称:)"/>
  <ITEM LINE="14"  COL="3"  TYPE="%-12s" FUNCTIONS="T(收款人地址:)"/>
  <ITEM LINE="16"  COL="3"  TYPE="%-12s" FUNCTIONS="T(开户  行号:)"/>
  <ITEM LINE="17"  COL="3"  TYPE="%-12s" FUNCTIONS="T(业务  描述:)"/>
	<ITEM LINE="17"  COL="53"  TYPE="%-12s" FUNCTIONS="T(5位号码)"/>
  <ITEM LINE="19"  COL="3"  TYPE="%-12s" FUNCTIONS="T(附      言:)"/>
  

  <ITEM LINE="5" COL="15" NAME="#AC_BR_NO" TYPE="%-12s"   DEVICE="KEYBOARD" FUNCTIONS="V(NB)T()">
  <ONLOSTFOCUS>
  "{
	dim @baktxno as string;
	@baktxno=$TXNO;
	$TXNO='9553';
	$FD32=#AC_BR_NO;
	commsend_001();
	callserver();
	$TXNO=@baktxno;
	if($FD12!='0000'){
	showmsg(geterror());
	return(false);
    }
    showhelp(3,70,8,3,'支付系统行名信息',substr($FD96,0,60));
   
   if($FD20 == '0' or $FD20 == '2')
    {
   		 showmsg('支付行名行号过期或未生效！');
   		 return(false);
    }
    }"
  </ONLOSTFOCUS>
  </ITEM>
  
  <ITEM NAME="#AC_NO"   TYPE="%-24s" FUNCTIONS=""/>
  <ITEM NAME="#AC_SEQN"   TYPE="%-4s" FUNCTIONS=""/>
	<ITEM LINE="6" COL="15" TYPE="%-1s"  NAME="#DQFS" INPUT="SELECT"   FUNCTIONS="V(NB)T(0)">
				<SELECT>
					<OPTION VALUE="0" TITLE="读取磁条方式"/>
					<OPTION VALUE="1" TITLE="读取芯片方式"/>
					<OPTION VALUE="2" TITLE="手工输入方式"/>
				</SELECT>
		  <ONLOSTFOCUS>"{
		     if(#DQFS=='1')
		     {
		     enable(#ACTNO1,false);
		     enable(#ACTNO3,false);
		     enable(#ACTNO2,true);
		     show(#ACTNO1,false);
		     show(#ACTNO3,false);
		     show(#ACTNO2,true);
		     }
		     if(#DQFS=='0')
		     {
		     enable(#ACTNO1,true);
		     enable(#ACTNO2,false);
		     enable(#ACTNO3,false);
		     show(#ACTNO1,true);
		     show(#ACTNO2,false);
		     show(#ACTNO3,false);
		      
		     }
		     if(#DQFS=='2')
		     {
		     enable(#ACTNO1,false);
		     enable(#ACTNO2,false);
		     enable(#ACTNO3,true);
		     show(#ACTNO1,false);
		     show(#ACTNO2,false);
		     show(#ACTNO3,true);
		      
		     }
		     refresh();
		   }"
		  </ONLOSTFOCUS>
		  </ITEM>	
		  <ITEM NAME="#ACTNO1"   DEVICE="FIXMSR" INPUT="TEXT" LINE="07" COL="15" TYPE="%-32s"   FUNCTIONS="V(NB)M($MSR2,1)" VISABLE="FALSE" >
			<ONLOSTFOCUS>
			"{
				#PAY_AC_NO=#ACTNO1;
			}"
			</ONLOSTFOCUS>
		</ITEM>
		<ITEM NAME="#ACTNO2"   INPUT="TEXT" DEVICE="FIXICC" LINE="07" COL="15" TYPE="%-32s" VISABLE="FALSE" FUNCTIONS="V(NB)M($MSR2,1)">
			<ONLOSTFOCUS>
			"{
				#PAY_AC_NO=#ACTNO2;
			}"
			</ONLOSTFOCUS>
		</ITEM>
		<ITEM LINE="07"   COL="15" NAME="#ACTNO3"   TYPE="%-32s"  DEVICE="KEYBOARD" VISABLE="FALSE" FUNCTIONS="T()">
		<ONLOSTFOCUS>
	"{
		#PAY_AC_NO=#ACTNO3;
		if(substr(#PAY_AC_NO,0,6)=='621223' or substr(#PAY_AC_NO,0,6)=='621780')
		{
			showmsg('卡介质不允许手输卡号，请重新选择读取方式！');
    	return(false);
		}
	}"
	</ONLOSTFOCUS>
</ITEM>
  <ITEM NAME="#PAY_AC_NO" TYPE="%-32s"  FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
	dim @baktxno as string;
	dim @name as string;
	dim @avbal as string;
	dim @pwd_ind as string;
	dim @actype as string;
	dim @prdt_name as string;
	@baktxno=$TXNO;
	dim  @sdate1 as string;
	dim  @sdate2 as string;
	if($MSR2 =='' and substr(#PAY_AC_NO,0,6) =='621780')
			{
			showmsg('读取二磁信息错误！');
			return(false);
			}  
 	 if(substr(#PAY_AC_NO,0,6) =='621780')
			{
			@sdate1=substr($MSR2,20,4)+'31';
			@sdate2=substr($HDATE,2,6);
			 if(atoi(@sdate2)>=atoi(@sdate1))
			 {
			 showmsg('卡已到期，不能做此交易！');
			 return(false);
			 }
			}
	$TXNO='9731';
	#AC_NO=substr(#PAY_AC_NO,0,24)+space(24-len(#PAY_AC_NO))+'';
	$FD102=#AC_NO+#AC_SEQN;
	commsend_001();
	callserver();
	$TXNO=@baktxno;
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	@name=substr($FD102,125,60);
	@avbal=substr($FD102,185,16);
	@pwd_ind=substr($FD102,48,1);
	@actype=substr($FD102,207,1);
	#PAY_NAME=rtrim(@name);
	#TXAMT15=itoa(#TX_AMT*100,'%016.0f');
	enable(#PAY_NAME,false);
	@prdt_name=rtrim(substr($FD102,313,30));
	showhelp(4,68,5,10,'帐户信息','户名:'+@name+' 余额:'+itoa(val(@avbal,0.01),'%16.2f')+space(6)+' 产品名称:'+@prdt_name);
	#ID_TYPE=substr($FD102,61,1);
	if(@pwd_ind=='Y'){
	showmsg('需要检查密码');
	#DRAW_PWD='';
		show(#LDRAW_PWD,true);
		show(#DRAW_PWD,true);
	}else{
		show(#LDRAW_PWD,false);
		show(#DRAW_PWD ,false);
	
		if(@actype=='1'){
			showmsg(@prdt_name+'必需有密码才能办理大小额业务');
			return(false);
		}
	}
  if(#ID_TYPE=='Y'){
     showmsg('该账户需要凭证件支取，需要输入证件');
     show(#ID_TYPE,true);
     show(#ID_NO,true);
     show(#SHOW_ID_TYPE,true);
     show(#SHOW_ID_NO,true);
   }else{
     show(#ID_TYPE,false);
     show(#ID_NO,false);
     show(#SHOW_ID_TYPE,false);
     show(#SHOW_ID_NO  ,false);
   } 
   setitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PWDFLAG#QUE_PWD#DRAW_PWD#ID_TYPE#CERTNO20#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CT_IND#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10',$FD102);
   #DRAW_PWD='';
   #ID_NO=rtrim(#CERTNO20);// for test
   #PAY_AC_NO=rtrim(#PAY_AC_NO);
      if(len(#PAY_AC_NO)!=7 and len(#PAY_AC_NO)!=5 and len(#PAY_AC_NO)!=3 )
      {
      	@baktxno=$TXNO;
      	$TXNO = '9405';
        #PAY_AC_NO=substr(#PAY_AC_NO,0,24)+space(24-len(#PAY_AC_NO))+'';
        $FD32=#PAY_AC_NO;
      	commsend_001();
      	callserver();
      	if($FD12!='0000')
      	{
      		showmsg(geterror());
      		return (false);
      	}
      	$TXNO=@baktxno;
      }
   }"
   </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="7" COL="44"  NAME="#DRAW_PWD" TYPE="%6d" DEVICE="PINPAD"  VISABLE="FALSE" INPUT="TEXT" FUNCTIONS="i()V(NB)">
  	<ONLOSTFOCUS>
 "{
    //实时校验密码,卡密码由卡系统校验，账号密码由后台核心校验 add by hxc 100603
    dim @baktxno as string;
    if(substr(#PAY_AC_NO,0,6)!='621223' and substr(#PAY_AC_NO,0,6)!='621780')
    {
      @baktxno=$TXNO;
      $TXNO='9317';
      commsend_001();
      $FD30=delspace(#PAY_AC_NO);
      $FD79=getitems('#DRAW_PWD');
      callserver();
      $TXNO=@baktxno;
      if($FD12!='0000'){
        showmsg(geterror());
        return (false);
      }
    }
    else if(substr(#PAY_AC_NO,0,6) == '621223' or substr(#PAY_AC_NO,0,6) == '621780')
    {
		  @baktxno=$TXNO;
		  initfd();
		  commsend_001();
		  $FD16='7007';
		  $FD30=delspace(#PAY_AC_NO);
		  $FD68='4';   //#OPTION ='04'
		  $FD79=getitems('#DRAW_PWD');
		  callagn();
		  $TXNO=@baktxno;
		  if( $FD12 != '0000')
		    {
			    showmsg(geterror());
			    return(false);
		    }
	  }
 }"
 </ONLOSTFOCUS>
</ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 start-->
  <ITEM  NAME="#CHECKACNO"  TYPE="%10s" FUNCTIONS="">
 <ONLOSTFOCUS>
 "{
     dim @txnobak as string;
     dim @len as number;
     @len = len(rtrim(#PAY_AC_NO));
     if(@len != 0 and @len != 3 and @len != 5 and @len != 7)
     {
       @txnobak = $TXNO;
       $TXNO = '9663';
       $FD30 = #PAY_AC_NO;
       commsend_001();
       callserver();
       if($FD12 !='0000')
       {
         show(#PIC,false);
         show(#PIC1,false);
         show(#LBLPIC,false);
         show(#LBLPIC1,false);
         enable(#SETPIC,false);
         enable(#SETPIC1,false);
       }
       else
       {
         show(#PIC,true);
         show(#PIC1,true);
         show(#LBLPIC,true);
         show(#LBLPIC1,true);
         enable(#SETPIC,true);
         enable(#SETPIC1,true);
       }
       $TXNO = @txnobak;
     }
     
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM NAME="#LYACNO" TYPE="%-32s" FUNCTIONS="" />
  <ITEM LINE="7" COL="62" LINES="160" COLS="120" NAME="#PIC" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#PAY_AC_NO;
      call_96641();

  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="7" COL="72" LINES="220" COLS="160" NAME="#PIC1" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC1" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#PAY_AC_NO;
      call_96642();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 end-->
  <ITEM LINE="08"   COL="16" NAME="#ID_TYPE"  INPUT="SELECT" VISABLE="FALSE"  TYPE="%-1s"  DEVICE="NONE" FUNCTIONS="">
  <SELECT>
    <OPTION VALUE="N"     TITLE="0.否"/>
    <OPTION VALUE="Y"     TITLE="1.是"/>
  </SELECT>
  </ITEM>

  <ITEM LINE="08"   COL="54" NAME="#ID_NO"  INPUT="TEXT" VISABLE="FALSE"  TYPE="%-20s"  DEVICE="KEYBOARD" FUNCTIONS="">
  <ONLOSTFOCUS>"{
     if(#ID_NO!=rtrim(#CERTNO20)){
       showmsg('输入的证件号码与原登记证件号码不同');
       return(false);
     }
  }"</ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="9" COL="15"  NAME="#PAY_NAME" DEVICE="KEYBOARD" TYPE="%-60s"  FUNCTIONS="V(NB)"/>
  <ITEM LINE="10" COL="15" NAME="#TX_AMT" TYPE="%16.2f" DEVICE="KEYBOARD"  FUNCTIONS="V(NB)T()">
  <ONLOSTFOCUS>
 	"{
 	     if(#TX_AMT == 0 )
 	     {
 	         showmsg('交易金额要大于零!');
 	         return(false);
 	     }
 	     if(#TX_AMT  &gt;= 20001 )
       {
           showmsg('交易金额上限是20000!');
           return(false);
       }
  }"
  </ONLOSTFOCUS>
  </ITEM>
 <ITEM  NAME="#XTX_AMT"    TYPE="%-21s"        FUNCTIONS="X(#TX_AMT)"/>
  <ITEM LINE="12" COL="15" NAME="#CASH_AC_NO"  DEVICE="KEYBOARD" TYPE="%-32s"  FUNCTIONS="V(NB)T()"/>
  <ITEM LINE="13" COL="15" NAME="#CASH_NAME" DEVICE="KEYBOARD" TYPE="%-60s"  FUNCTIONS="V(NB)T()"/>
  <ITEM LINE="14" COL="15" NAME="#CASH_ADDR"  DEVICE="KEYBOARD" TYPE="%-60s"  FUNCTIONS="T()"/>
  <ITEM LINE="16" COL="15" NAME="#CASH_OPN_BR_NO"  DEVICE="KEYBOARD" TYPE="%-12s"  FUNCTIONS="V(NB)T()">
  <ONLOSTFOCUS>
  "{
    dim @baktxno as string;
    @baktxno=$TXNO;
    $TXNO='9553';
    $FD32=#CASH_OPN_BR_NO;
    commsend_001();
    callserver();
    $TXNO=@baktxno;
    if($FD12!='0000'){
    	showmsg(geterror());
    	return(false);
    }
    showhelp(3,70,8,3,'支付系统行名信息',substr($FD96,0,60));
  	}"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="17" COL="15" NAME="#YW_TYPE"  TYPE="%-12s"  DEVICE="KEYBOARD" FUNCTIONS="V(NB)T()">
  <ONLOSTFOCUS>
  "{
      if(len(#YW_TYPE)!=5){
		  showmsg('请按照人行最新文档输入定期业务的5位编号');
		  return(false);
	  }
  }"
  </ONLOSTFOCUS>
  </ITEM>

<ITEM LINE="19" COL="15" NAME="#BRF"  TYPE="%-60s"  DEVICE="KEYBOARD" FUNCTIONS="J(#CONTENT40)T()"/>
   <!--定义大额的FD123域-->
<ITEM NAME="#CRDB"		TYPE="%-1s" 	FUNCTIONS="T(1)"/>	<!--借贷标志0借1贷----> 
<ITEM NAME="#OPCD"		TYPE="%-2s" 	FUNCTIONS="T(10)"/>	<!--操作代码 --->
<ITEM NAME="#TXNUM" 		TYPE="%5d" 	FUNCTIONS="T(00104)"/>
<ITEM NAME="#PKGNO" 		TYPE="%3d"  	FUNCTIONS="T(005)"/>	<!--PKGNO---->
<ITEM NAME="#ORDERNO"		TYPE="%-8 s"	FUNCTIONS="T()"/>	<!--支付交易序号   ----> 
<ITEM NAME="#OR_BR_NO"  	TYPE="%-12s"	FUNCTIONS="T()"/>	<!--发起行行号     ----> 
<ITEM NAME="#PAY_OPN_BR_NO"	TYPE="%-12s"	FUNCTIONS="T()"/>	<!--付款人开户行   ----> 
<ITEM NAME="#PAY_QS_NO"		TYPE="%-12s" 	FUNCTIONS="T()"/>	<!--付款清算行行号 ---->
<!--<ITEM NAME="#PAY_AC_NO"		TYPE="%-32s" 	FUNCTIONS="T()"/>	付款人帐号     --><!--同名ITEM liangq注--> 
<ITEM NAME="#PAY_ADDR"		TYPE="%-60s"  	FUNCTIONS="T()"/>	<!--付款人地址     ----> 
<ITEM NAME="#PWD"		TYPE="%-8s"  	FUNCTIONS="T()"/>	<!--储户密码       ----> 
<ITEM NAME="#CASH_QS_NO"	TYPE="%-12s" 	FUNCTIONS="T()"/>	<!--收款清算行行号 ---->
<ITEM NAME="#WT_DATE"    	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--委托日期       ----> 
<ITEM NAME="#OPERLEVEL"		TYPE="%-1s" 	FUNCTIONS="T()"/>	<!--优先级         ----> 
<ITEM NAME="#AUTH_TEL"		TYPE="%-6s"	FUNCTIONS="T()"/>	<!--授权操作员号   ----> 
<ITEM NAME="#AUTH_PWD"		TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--授权操作员密码 ----> 
<ITEM NAME="#NOTE_TYPE"   	TYPE="%-2s" 	FUNCTIONS="T()"/>	<!--凭证种类       ----> 
<ITEM NAME="#NOTE_NO"   	TYPE="%-12s"	FUNCTIONS="T()"/>	<!--凭证号码       ----> 
<ITEM NAME="#PACK_DATE"   	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--包日期,定期用  ----> 
<ITEM NAME="#PACK_ID"   	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--包id,定期用    ----> 
<ITEM NAME="#CHRG_IND"		TYPE="%-1s" 	FUNCTIONS="T()"/>	<!--手续费标志     ----> 
<ITEM NAME="#CHRG_AMT"    	TYPE="%-15s"	FUNCTIONS="T()"/>	<!--手续费金额     ----> 
<ITEM NAME="#RESP_DAY"   	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--期待应答日期  ----> 
<ITEM NAME="#PO_TYPE"    	TYPE="%-2s" 	FUNCTIONS="T()"/>	<!--票据类型      ----> 
<ITEM NAME="#PO_DATE"    	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--票据日期      ----> 
<ITEM NAME="#PO_NUM"    	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--票据号码      ----> 
<ITEM NAME="#PC_TX_AMT"    	TYPE="%-15s"	FUNCTIONS="T()"/>	<!--赔偿金额      ----> 
<ITEM NAME="#JF_TX_AMT"    	TYPE="%-15s"	FUNCTIONS="T()"/>	<!--拒付金额      ----> 
<ITEM NAME="#O_WT_DATE"    	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--原委托日期    ----> 
<ITEM NAME="#O_TXNUM"   	TYPE="%-5s" 	FUNCTIONS="T()"/>	<!--原业务编号    ----> 
<ITEM NAME="#O_ORDERNO"   	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--原支付交易序号----> 
<ITEM NAME="#RET_CODE"   	TYPE="%-2s" 	FUNCTIONS="T()"/>	<!--退汇原因代码  ----> 
<ITEM NAME="#RCP_STS"		TYPE="%-2s" 	FUNCTIONS="T()"/>	<!--业务回执状态  ----> 
<ITEM NAME="#RESP1"		TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--Mbfe应答码    ----> 
<ITEM NAME="#RESP2"		TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--Ccpc应答码    ----> 
<ITEM NAME="#PACK_END"   	TYPE="%-1s" 	FUNCTIONS="T()"/>	<!--包结束标志    ----> 
<ITEM NAME="#LV_STS"     	TYPE="%-1s"   	FUNCTIONS="T()"/>	<!--交易状态      ---->
<ITEM NAME="#LW_IND"     	TYPE="%-1s"   	FUNCTIONS="T(1)"/>	<!--来往标识 -->
<ITEM NAME="#DFXYNO"      	TYPE="%-60s"   	FUNCTIONS="T()"/>	<!--多方协议号-->
<ITEM NAME="#OORBRNO"     	TYPE="%-12s"   	FUNCTIONS="T()"/>	<!--原发起行行号 -->
  <ITEM NAME="#OACBRNO"      	TYPE="%-12s"   	FUNCTIONS=""/>		<!--原接收行行号-->
<!--------以上定义为大额的FD123	域填充的内容,需要时再添加----------->
<!-- 102域变量 -->
  <ITEM NAME="#ACTNO24"   	TYPE="%-24s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ"    	TYPE="%-4s" 	FUNCTIONS=""/>
  <ITEM NAME="#VOCTYPE" 	TYPE="%-3s"  	FUNCTIONS=""/>
  <ITEM NAME="#VOCNUM" 		TYPE="%16d" 	FUNCTIONS=""/>
  <ITEM NAME="#FETCHFLAG" 	TYPE="%1s" 	FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG" 	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#QUE_PWD" 	TYPE="%6s" 	FUNCTIONS=""/>

  <ITEM NAME="#CERTFLAG" 	TYPE="%-1s"  	FUNCTIONS=""/>
  <ITEM NAME="#CERTNO20"        TYPE="%-20s" 	FUNCTIONS=""/>
  <ITEM NAME="#STAMPFLAG" 	TYPE="%1s" 	FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG2" 	TYPE="%1s" 	FUNCTIONS=""/>  
  <ITEM NAME="#PWD16"  		TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#PRINTDATE" 	TYPE="%-8s" 	FUNCTIONS=""/>      
  <ITEM NAME="#TXAMT15"   	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#CERTTYPE"  	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#CUSTNAME" 	TYPE="%-50s" 	FUNCTIONS=""/>
  <ITEM NAME="#AVBAL" 		TYPE="%17.2f" 	FUNCTIONS=""/>
  <ITEM NAME="#CURCD" 		TYPE="%-2s"  	FUNCTIONS=""/>
  <ITEM NAME="#CT_IND" 		TYPE="%-1s"  	FUNCTIONS="T(2)"/>
  <ITEM NAME="#DSCPT"     	TYPE="%-3s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTTYPE"   	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ_2"  	TYPE="%-4s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACCOUNTFLAG" 	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#INTEREST1" 	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#INTEREST2" 	TYPE="%-16s" 	FUNCTIONS=""/>  
  <ITEM NAME="#INTEREST3" 	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#PAYAMOUNT" 	TYPE="%-16s" 	FUNCTIONS=""/>  
  <ITEM NAME="#NEWVOCNUM" 	TYPE="%-16d" 	FUNCTIONS=""/>
  <ITEM NAME="#SPEFLAG" 	TYPE="%-20s" 	FUNCTIONS=""/>    
  <ITEM NAME="#PRODNAME" 	TYPE="%-30s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTNO_24"   	TYPE="%-24s" 	FUNCTIONS=""/> 
  <ITEM NAME="#EDUCREDIT" 	TYPE="%1s" 	FUNCTIONS=""/>   
  <ITEM NAME="#DESC10"    	TYPE="%-10s" 	FUNCTIONS=""/>
  <!--<ITEM  NAME="#ID_TYPE"  	TYPE="%-1s" 	FUNCTIONS=""/>--><!--同名ITEM liangq注-->
  <!-------以上是FD102域的内容-------->
<ITEM LINE="21"  COL="69"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT" />
</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="按任意键退出">
    NOTHING
  </PACKAGE>
  <PRINT>"{
        print(3,5, '                  定期贷记往帐录入');
        print(4,5, '委 托 日 期:[8]         支付交易序号:[8]',$HDATE,#ORDERNO);
        print(5,5, '接收行行号:[12]',#AC_BR_NO);
        print(6,5, '付款人帐号 :[32]',#PAY_AC_NO);
        print(7,5, '付款人名称 :[60]',#PAY_NAME);
        print(8,5, '交 易 金 额:[21]',#XTX_AMT);
        print(9,5, '收款人开户行:[12]       对方清算行号: [12]',#CASH_OPN_BR_NO,#CASH_QS_NO);
        print(10,5,'收款人帐号:[24]',#CASH_AC_NO);
        print(11,5,'收款人名称:[60]',#CASH_NAME);
        print(12,5,'附      言:[60]',#BRF);
        print(13,5,'流  水  号:[6]             操作员号:[4]',$FD4,$FD7);
      }"
  </PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印业务专用凭证">
    NOTHING
  </PACKAGE>
  <PRINT>"{
  $KINDNO='00';
  dim @txtime as string;
  @txtime = substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
  
	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:5303');
	print( 5, 13,'交易:定期贷记往帐录入');

	print( 7,20, '支付交易序号:[8       ]                      委托日期:[8       ]',#ORDERNO,$HDATE);
	print( 8,20, '接收行 行 号:[12          ]                  交易金额:[21                   ]',#AC_BR_NO,#XTX_AMT);
	print( 9,20, '付款人 帐 号:[32                              ]',#PAY_AC_NO);
	print(10,20, '付款人 名 称:[60                                                          ]',#PAY_NAME);
	print(11,20, '收款人开户行:[12          ]                  对方清算行号:[12        ]',#CASH_OPN_BR_NO,#CASH_QS_NO);
	print(12,20, '收款人 帐 号:[24                      ]',#CASH_AC_NO);
	print(13,20, '收款人 名 称:[60                                                          ]',#CASH_NAME);
	print(14,20, '附        言:[60                                                          ]',#BRF);
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);
      }"
  </PRINT>
</RESPONSE>

</TRANSACTION>

