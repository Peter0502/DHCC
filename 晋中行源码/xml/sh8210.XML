<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11110100" TITLE="8210 柜面通查询"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">

<!--12345678901234567890123456789012345678901234567890123456789012345678901234567890-->
<!--         1         2         3         4         5         6         7         8-->
<!--  注意：各个配置项的COL 属性最好是奇数, 这样可以避免出现乱码。                  -->
<!--        另外, 每个汉字的开始列号也最好是奇数, 每个字符串的长度也最好是偶数。    -->

<FIRSTWORK RETURN="TRUE">"{   //柜员一进入交易就检查签到状态 20100708

	commsend_001();
	$FD16 = '9803';
	$FD92 = $TLRNO; //本柜员
	callserver();

	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}
	if($FD70!='0')
	{
		showmsg('此柜员尚未签到!');
		return(false);
	}
	
	$FD26='';
	$FD91='';
	$FD70='';
	$FD92='';
	
//	$MSR2='6224217066000016139=0000520223011410';
//	$MSR3='996224217066000016139=1561560500050000000013141537520000000001=10000256320=000016139=1000000223011000';
}"
</FIRSTWORK>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-52s" FUNCTIONS=
  "T(8210                           柜面通查询)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
    "T(─────────────────────────────────────)"/>

  <ITEM ITEM="#TXNO" TYPE="%4d"  FUNCTIONS="T($TXNO=8210)"/>
  <ITEM LINE="6"  COL="15"    TYPE="%-10s" FUNCTIONS="T(开户机构:)"/>
  <ITEM NAME="#INBRNO" INPUT="SELECT" LINE="6" COL="25" TYPE="%-2s" FUNCTIONS="T(01)V(NB)">
  <SELECT>
  	<OPTION VALUE="01" TITLE="融信村镇"/>
  	<OPTION VALUE="02" TITLE="亿通村镇"/>
  	<OPTION VALUE="03" TITLE="汇通村镇"/>
	  <OPTION VALUE="04" TITLE="华丰村镇"/>
  </SELECT>
  </ITEM>
  <ITEM LINE="8"  COL="15"   TYPE="%-10s"  FUNCTIONS="T(账    号: )"/>
  <ITEM LINE="10"  COL="15"   TYPE="%-10s"  FUNCTIONS="T(密    码: )"/>

  <ITEM LINE="8"  COL="25"   NAME="#CARDNO1"  TYPE="%-19s"   DEVICE="MSR" FUNCTIONS="V(NB)m($MSR2,1,19)">
  <ONLOSTFOCUS>
  "{
	if(substr(#CARDNO1,0,6) == '621223')
	{
		showmsg('暂不支持卡办理此业务!');
        	return(false);
	}
	 if(substr(#CARDNO1,0,1) == '5')
	{
		showmsg('对公账户请到本行办理!');
        	return(false);
	}
	 if (substr(#CARDNO1,0,2)=='10' or substr(#CARDNO1,0,2)=='11')
	{
		showmsg('本行客户不支持此业务!');
        	return(false);
	}

  }"
  </ONLOSTFOCUS>
  </ITEM>

  <ITEM NAME="#PASSWD" LINE="10" COL="25" TYPE="%6d" DEVICE="PINPAD" FUNCTIONS="V(NB)i()"/>


  <!-- 中心结构 -->
  <ITEM NAME="#PKHEAD"  TYPE="%-6s"     FUNCTIONS="T(ucgmup)"/>
  <ITEM NAME="#SPBKNO"  TYPE="%-8s"     FUNCTIONS="T()"/>
  <ITEM NAME="#TRANCD"  TYPE="%-6s"     FUNCTIONS="T(ucmeqr)"/>
  <ITEM NAME="#CARDNO"  TYPE="%-20s"    FUNCTIONS="T(#CARDNO1)"/>
  <ITEM NAME="#TRANPW"  TYPE="%-16s"    FUNCTIONS="T(#PASSWD)"/>
  <ITEM NAME="#TRANAM"  TYPE="%-21s"    FUNCTIONS="T()"/>
  <ITEM NAME="#TSTIME"  TYPE="%-10s"    FUNCTIONS="T()"/>
  <ITEM NAME="#INPUTP"  TYPE="%-3s"     FUNCTIONS="T(021)"/>
  <ITEM NAME="#IDTFTP"  TYPE="%-1s"     FUNCTIONS="T()"/>
  <ITEM NAME="#IDTFNO"  TYPE="%-40s"    FUNCTIONS="T()"/>
  <ITEM NAME="#ACBKDT"  TYPE="%-8s"     FUNCTIONS="T()"/>
  <ITEM NAME="#ACBKNO"  TYPE="%-10s"    FUNCTIONS="T()"/>
  <ITEM NAME="#ACBKSQ"  TYPE="%-12s"    FUNCTIONS="T()"/>
  <ITEM NAME="#ISBKDT"  TYPE="%-8s"     FUNCTIONS="T()"/>
  <ITEM NAME="#ISBKNO"  TYPE="%-10s"    FUNCTIONS="T()"/>
  <ITEM NAME="#ISBKSQ"  TYPE="%-12s"    FUNCTIONS="T()"/>
  <ITEM NAME="#CENTDT"  TYPE="%-8s"     FUNCTIONS="T()"/>
  <ITEM NAME="#CENTSQ"  TYPE="%-12s"    FUNCTIONS="T()"/>
  <ITEM NAME="#TRACK2"  TYPE="%-39s"    FUNCTIONS="T($MSR2)"/>
  <ITEM NAME="#TRACK3"  TYPE="%-107s"   FUNCTIONS="T($MSR3)"/>
  <ITEM NAME="#ACCTNA"  TYPE="%-40s"    FUNCTIONS="T()"/>
  <ITEM NAME="#ONLNBL"  TYPE="%-21s"    FUNCTIONS="T()"/>
  <ITEM NAME="#AVALBL"  TYPE="%-21s"    FUNCTIONS="T()"/>
  <ITEM NAME="#HANDFE"  TYPE="%-21s"    FUNCTIONS="T()"/>
  <ITEM NAME="#CORRDT"  TYPE="%-8s"     FUNCTIONS="T()"/>
  <ITEM NAME="#CORRSQ"  TYPE="%-12s"    FUNCTIONS="T()"/>
  <ITEM NAME="#EXTDT1"  TYPE="%-20s"    FUNCTIONS="T()"/>
  <ITEM NAME="#EXTDT2"  TYPE="%-20s"    FUNCTIONS="T()"/>
  <ITEM NAME="#EXTDT3"  TYPE="%-20s"    FUNCTIONS="T()"/>
  <ITEM NAME="#EXTDT4"  TYPE="%-20s"    FUNCTIONS="T()"/>
  <ITEM NAME="#EXTDT5"  TYPE="%-20s"    FUNCTIONS="T()"/>
  <ITEM NAME="#RSPSCD"  TYPE="%-2s"     FUNCTIONS="T()"/>
  <ITEM NAME="#RTERTX"  TYPE="%-80s"    FUNCTIONS="T()"/>

  <ITEM LINE="21"  COL="65" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>"{
	dim @tota as string;
	dim @txno as string;
	@txno=$TXNO;
	commsend_001();
	ucgmup_pack();
	$FD22=#INBRNO;
	$FD16='8220';
	$FD24='gmt';
	@tota=callagn();
	$TXNO=@txno;
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	ucgmup_unpack();
	$TXNO=@txno;
	runoutput();
	rerun();		
  }"
  </ONCLICK>
  </ITEM>
</VARIABLE>


<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="显示内容">
NOTHING
</PACKAGE>
<PRINT>"{
print(4,5,'查询成功!');
print(6,5,'账    号:[20]',#CARDNO1);
print(7,5,'户    名:[40]',#ACCTNA);
print(8,5,'账面余额:[21]',#ONLNBL);
print(9,5,'可用余额:[21]',#AVALBL);
print(14,5,'受理行日期:[8     ]               开户行日期:[8     ]',#ACBKDT,#ISBKDT);
print(15,5,'机    构:[7     ]                  操作员:[6    ]',$KINBR,$TLRNO);
}"
</PRINT>
</RESPONSE>

</TRANSACTION>
