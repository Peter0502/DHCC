<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111100000000000000000000000000" TITLE=" 代收付合同变更"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	initfd();
	commsend_001();
	$FD30 = #PAYBRNO;
	$FD31 = #PAYQSBRNO;
	$FD32 = #PAYOPBRNO;
	$FD33 = #PAYACTNO18;
	$FD44 = #WTDAY;
	$FD67 = #XYTYPE;
	$FD68 = #CHTYPE;
    $FD96=getitems('#XYNO#PAYNAME#PAYADD#CONTENT#SPACE4');
}"
</COMMSEND>
<COMMRECV>"{
  	#OPFLAG=$FD69;
  	#ERRCODE=$FD74;
    #T_ORDERNO=$FD28;
	#T_WTDAY=$FD29;
	#T_PACKID=$FD44;
	#T_XYTYPE=$FD67;
	#T_CHANGTYPE=$FD68;
	#T_PAYBRNO=$FD32;
	#T_PAYQSBRNO=$FD33;
	#T_PAYOPEBRNO=$FD37;
	#T_PAYACTNO=$FD81;
	setitems('#T_XYNO#T_PAYNAME#T_PAYADDRESS#T_CONTENT',$FD96);
}"
</COMMRECV>

<VARIABLE UPLOOP="FALSE">

  <ITEM LINE="3"  COL="3" TYPE="%-49s" FUNCTIONS=
    "T(6583                            代收付合同变更)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
    "T(─────────────────────────────────────)"/>

  <ITEM NAME="#TXNO"    TYPE="%-4s" FUNCTIONS="T($TXNO=6583)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>

  <ITEM LINE="7"  COL="3" TYPE="%-14s" FUNCTIONS="T(委 托   日 期:)"/>
  <ITEM LINE="8"  COL="3" TYPE="%-14s" FUNCTIONS="T(合同   协议号:)"/>
  <ITEM LINE="9"  COL="3" TYPE="%-14s" FUNCTIONS="T(协 议   类 型:)"/>
  <ITEM LINE="10" COL="3" TYPE="%-14s" FUNCTIONS="T(变 更   方 式:)"/>
  <ITEM LINE="11" COL="3" TYPE="%-14s" FUNCTIONS="T(收/付款行行号:)"/>
  <ITEM LINE="12" COL="3" TYPE="%-14s" FUNCTIONS="T(收/付款清算行:)"/>
  <ITEM LINE="13" COL="3" TYPE="%-14s" FUNCTIONS="T(收/付款开户行:)"/>
  <ITEM LINE="14" COL="3" TYPE="%-14s" FUNCTIONS="T(收/付款人账号:)"/>
  <ITEM LINE="15" COL="3" TYPE="%-14s" FUNCTIONS="T(收/付款人名称:)"/>
  <ITEM LINE="16" COL="3" TYPE="%-14s" FUNCTIONS="T(收/付款人地址:)"/>
  <ITEM LINE="17" COL="3" TYPE="%-14s" FUNCTIONS="T(附         言:)"/>

  <ITEM LINE="7" COL="17" NAME="#WTDAY" TYPE="%-8s" DEVICE="KEYBOARD" FUNCTIONS="T($HDATE)D()"/>
  <ITEM LINE="8" COL="17" NAME="#XYNO" TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS="V(NB)T()"/>
  <ITEM LINE="9" COL="17" NAME="#XYTYPE" TYPE="%-1s" DEVICE="KEYBOARD" FUNCTIONS="T(1)J(#SXYTYPE)">
<SELECT>
       <OPTION VALUE="1"  TITLE="代收协议"/>
       <OPTION VALUE="2"  TITLE="代付协议"/>
  </SELECT>
  </ITEM>
  <ITEM NAME="#SXYTYPE" TYPE="%-8s" FUNCTIONS="j(#XYTYPE=1,T{代收协议})j(#XYTYPE=2,T{代付协议})"/>
  <ITEM LINE="10" COL="17" NAME="#CHTYPE" TYPE="%-1s" DEVICE="KEYBOARD" FUNCTIONS="T(1)J(#SCHTYPE)">
  <SELECT>
       <OPTION VALUE="1"  TITLE="新增"/>
       <OPTION VALUE="2"  TITLE="修改"/>
       <OPTION VALUE="0"  TITLE="删除"/>
  </SELECT>
  </ITEM>
  <ITEM NAME="#SCHTYPE" TYPE="%-4s" FUNCTIONS="j(#CHTYPE=1,T{新增})j(#CHTYPE=2,T{修改})j(#CHTYPE=0,T{删除})"/>
  <ITEM LINE="11" COL="17" NAME="#PAYBRNO" TYPE="%-12s" DEVICE="KEYBOARD" FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
  "{
    dim @baktxno as string;
    @baktxno=$TXNO;
    $TXNO='9553';
    $FD32=#PAYBRNO;
    commsend_001();
    callserver();
    $TXNO=@baktxno;
    if($FD12!='0000')
    {
        showmsg(geterror());
        return(false);
    }

  	}"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="12" COL="17" NAME="#PAYQSBRNO" TYPE="%-12s" DEVICE="KEYBOARD" FUNCTIONS="T(313175000011)"/>
  <ITEM LINE="13" COL="17" NAME="#PAYOPBRNO" TYPE="%-12s" DEVICE="KEYBOARD" FUNCTIONS="T()">
  <ONLOSTFOCUS>
  "{
    dim @baktxno as string;
    @baktxno=$TXNO;
    $TXNO='9553';
    $FD32=#PAYOPBRNO;
    commsend_001();
    callserver();
    $TXNO=@baktxno;
    if($FD12!='0000')
    {
        showmsg(geterror());
        return(false);
    }

  	}"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#SUBJECTNO" TYPE="%-7d"  FUNCTIONS=""/>
  <ITEM NAME="#PAYACTYPE"  TYPE="%1d"  FUNCTIONS="T(0)V(NB)"/>
  <ITEM NAME="#PAYACTNO18" LINE="14" COL="17" DEVICE="KEYBOARD" TYPE="%-19s"  FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>
  "{
	  dim @baktxno as string;
	  if(#PAYACTNO18=='1010100')
      {
      		showmsg('不能直接输入现金科目!');
      		return(false);
      }

      @baktxno=$TXNO;
      $TXNO='9731';
	  $FD102=#PAYACTNO18;
      commsend_001();
      callserver();
      $TXNO=@baktxno;
      if($FD12!='0000')
      {
        showmsg(geterror());
        return(false);
      }
	  #PAYNAME=substr($FD102,125,60);

    }"

  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#PAYACTNO" TYPE="%-32s"  FUNCTIONS="T(#PAYACTNO18)"/>
  
  <ITEM LINE="15" COL="17" NAME="#PAYNAME" TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>
  <ITEM LINE="16" COL="17" NAME="#PAYADD" TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>
  <ITEM LINE="17" COL="17" NAME="#CONTENT" TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>

  <ITEM  TYPE="%-4s"  NAME="#SPACE4" FUNCTIONS=""/>

	<!--返回的变量-->
  	<ITEM NAME="#OPFLAG"  TYPE="%-1s"/>
  	<ITEM NAME="#ERRCODE"  TYPE="%-60s"/>
    <ITEM NAME="#T_ORDERNO"			TYPE="%-8s"/>
	<ITEM NAME="#T_WTDAY"			TYPE="%-9s"/>
	<ITEM NAME="#T_PACKID"			TYPE="%-8s"/>
	<ITEM NAME="#T_XYNO"			TYPE="%-60s"/> 
	<ITEM NAME="#T_XYTYPE"			TYPE="%-1s"/>
	<ITEM NAME="#T_CHANGTYPE"		TYPE="%-1s"/> 
	<ITEM NAME="#T_PAYBRNO"			TYPE="%-12s"/>
	<ITEM NAME="#T_PAYQSBRNO"		TYPE="%-12s"/>
	<ITEM NAME="#T_PAYOPEBRNO"		TYPE="%-12s"/>
	<ITEM NAME="#T_PAYACTNO"		TYPE="%-32s"/>
	<ITEM NAME="#T_PAYNAME"			TYPE="%-60s"/>
	<ITEM NAME="#T_PAYADDRESS"		TYPE="%-60s"/>
	<ITEM NAME="#T_CONTENT"			TYPE="%-60s"/>

  <ITEM LINE="21"  COL="65" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT" />  
  </VARIABLE>

<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="显示内容" CHECK="#OPFLAG=0" >
NOTHING
</PACKAGE>
	<PRINT>"{
		print( 3,25,'[8][4] 操作成功',#SXYTYPE,#SCHTYPE);
		print( 5, 5,'委托日期 :[8]',#T_WTDAY);
		print( 5,30,'交易序号 :[8]',#T_ORDERNO);
		print( 5,58,'包序号 :[8]',#T_PACKID);
		print( 6, 5,'合同协议号 :[60]',#T_XYNO);
		print( 7, 5,'合同协议类型 :[1] [8]',#T_XYTYPE,#SXYTYPE);
		print( 7,40,'变更  方式 :[1] [4]',#T_CHANGTYPE,#SCHTYPE);
		print( 8, 5,'收/付款行行号 :[12]',#T_PAYBRNO);
		print( 8,40,'收/付款清算行 :[12]',#T_PAYQSBRNO);
		print( 9, 5,'收/付款开户行 :[12]',#T_PAYOPEBRNO);
		print(10, 5,'收/付款人账号 :[32]',#T_PAYACTNO);
		print(11, 5,'收/付款人名称 :[60]',#T_PAYNAME);
		print(12, 5,'收/付款人地址 :[60]',#T_PAYADDRESS);
		print(13, 5,'附言 :[60]',#T_CONTENT);
}"
	</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="显示内容" CHECK="#OPFLAG=1" >
NOTHING
</PACKAGE>
	<PRINT>"{
		print( 4,25,'操作失败');
		print( 5, 5,'错误描述 :[60]',#ERRCODE);
}"
	</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印业务专用凭证" CHECK="#OPFLAG=0" >
NOTHING
</PACKAGE>
	<PRINT>"{
		$KINDNO='00';
		dim @txtime  as string;
		@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);

		print( 5,20,'机构名称:[30]',$BRNAME);
		print( 5,2,'交易代码:6583');
		print( 5,13,'交易:代收付合同变更');
		print( 7,46,'[8][4] 操作成功',#SXYTYPE,#SCHTYPE);
		print( 9,20,'委托日期 :[8]',#T_WTDAY);
		print( 9,10,'交易序号 :[8]',#T_ORDERNO);
		print( 9,10,'包序号 :[8]',#T_PACKID);
		print(10,20,'合同协议号 :[60]',#T_XYNO);
		print(11,20,'合同协议类型 :[1] [8]',#T_XYTYPE,#SXYTYPE);
		print(11,32,'变更方式 :[1] [4]',#T_CHANGTYPE,#SCHTYPE);
		print(12,20,'收/付款行行号 :[12]',#T_PAYBRNO);
		print(12,29,'收/付款清算行 :[12]',#T_PAYQSBRNO);
		print(13,20,'收/付款开户行:[12]',#T_PAYOPEBRNO);
		print(14,20,'收/付款人账号 :[32]',#T_PAYACTNO);
		print(15,20,'收/付款人名称 :[60]',#T_PAYNAME);
		print(16,20,'收/付款人地址 :[60]',#T_PAYADDRESS);
		print(17,20,'附言 :[60]',#T_CONTENT);
		print(21,20,'备注:');
		print(22,27,'交易日期:[8] [8]',$HDATE,@txtime);
		print(22,5,'柜员:[4]',$FD7);
		print(22,5,'流水号:[6]',$FD4);
}"
	</PRINT>
</RESPONSE>


</TRANSACTION>
