<?xml version="1.0" encoding="GBK" ?>                                          
<TRANSACTION RIGHTS="11111111110000000000000000000000" TITLE="5559    自由格式交易查询"                 
xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">             
<COMMSEND>"{ 
  commsend_001();
  $FD44 =#IN_BEGINDAY;   //开始    日期
  $FD45 =#IN_ENDDAY;     //结束    日期
  $FD58 =#SRCNODECODE;   //原始节点代码
  $FD67 =#FINDTYPE;      //查找    类型
  $FD68 =#PRINTFLAG;     //打印    标识                                      
  }"                                              
</COMMSEND>                                                
<COMMRECV>"{ 
	commrecv_001();                                        
}"                                                                             
</COMMRECV>                                                                            
<VARIABLE UPLOOP="TRUE">                                                        
<ITEM LINE="3"  COL="3" TYPE="%-54s" FUNCTIONS=
"T(5559                        自由格式交易查询)"/>                                                 
<ITEM LINE="4"  COL="3"  TYPE="%-104s" FUNCTIONS=
"T(─────────────────────────────────────)"/>                                                                                
<ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5579)"/>                    
<ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>                                               

<ITEM NAME="#DOLIST" TYPE="%1s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
  
	dim @selid       as number;
	dim @srcnodecode as string;
	dim @in_date     as string;
	dim @desnodecode as string;
	dim @sendorgcode as string;
	dim @rcvorgcode  as string;
	dim @tx_time     as string;
	dim @findtype    as string;
	dim @printflag   as string;
	dim @content     as string;
	dim @content1    as string;
	dim @content2    as string;
	dim @content3    as string;
	dim @content4    as string;
	dim @content5    as string;
	//dim @Newcontent  as string;
	
	if(#DOLIST == '1')
	{
	    @selid=list_work();
	    if(@selid &lt; 0)
	    {
		     list_del();
		     rerun();
		     return(true);
	    }
      @selid=list_getselid();
      if(@selid &lt; 0)
      {
         list_del();
         rerun();
         return(true);
      }

	    @srcnodecode=rtrim(list_gettext(@selid,0));
	    @in_date=rtrim(list_gettext(@selid,1));
	    @desnodecode=rtrim(list_gettext(@selid,2));
	    @sendorgcode=rtrim(list_gettext(@selid,3));
	    @rcvorgcode=rtrim(list_gettext(@selid,4));
	    @tx_time=rtrim(list_gettext(@selid,5));
	    @findtype=rtrim(list_gettext(@selid,6));
	    @printflag=rtrim(list_gettext(@selid,7));
	    @content=rtrim(list_gettext(@selid,8));
	    
	    @content1 = substr(@content,0,50);
      @content2 = substr(@content,50,50);
      @content3 = substr(@content,100,50);
      @content4 = substr(@content,150,50);
	    @content5 = substr(@content,200,50);
	    //@Newcontent=@content1+chr(10)+@content2+chr(10)+@content3+chr(10)+@content4+chr(10)+@content5;
   
	     //自由格式交易的明细
	    open('5559_1.XML','#SRCNODECODE='+@srcnodecode+';#IN_DATE='+@in_date+';#DESNODECODE='+@desnodecode+';#SENDORGCODE='+@sendorgcode+
		';#RCVORGCODE='+@rcvorgcode+';#TX_TIME='+@tx_time+';#FINDTYPE='+@findtype+';#PRINTFLAG='+@printflag+';#CONTENT1='+@content1+
		';#CONTENT2='+@content2+';#CONTENT3='+@content3+';#CONTENT4='+@content4+';#CONTENT5='+@content5+';'); 
		//#CONTENT='+@Newcontent+';
		showfooter();
		return(true);
	}
	list_del();
	#DOLIST='';
  }"
  </ONLOSTFOCUS>
  </ITEM>

<ITEM NAME="#DOLIST" TYPE="%-1s" FUNCTIONS="">
<ONLOSTFOCUS>
"{
	showall();
}"
</ONLOSTFOCUS>
</ITEM>

<!--输入变量-->                                                   
<ITEM  LINE="7"   COL="15" TYPE="%-14s" FUNCTIONS="T(开始    日期:)"/>
<ITEM  LINE="9"   COL="15" TYPE="%-14s" FUNCTIONS="T(结束    日期:)"/> 
<ITEM  LINE="11"  COL="15" TYPE="%-14s" FUNCTIONS="T(原始节点代码:)"/>                                                    
<ITEM  LINE="13"  COL="15" TYPE="%-14s" FUNCTIONS="T(查找    类型:)"/>
<ITEM  LINE="15"  COL="15" TYPE="%-14s" FUNCTIONS="T(打印    标识:)"/>  

<ITEM NAME="#IN_BEGINDAY"   LINE="7"  COL="29"  DEVICE="KEYBOARD" INPUT="TEXT" TYPE="%8d"    FUNCTIONS="T()D()V(NB)"/>              
<ITEM NAME="#IN_ENDDAY"     LINE="9"  COL="29"  DEVICE="KEYBOARD" INPUT="TEXT" TYPE="%8d"    FUNCTIONS="T()D()V(NB)"/>                                               
<ITEM NAME="#SRCNODECODE"   LINE="11" COL="29"  DEVICE="KEYBOARD" INPUT="TEXT" TYPE="%-12s"  FUNCTIONS=""/>  
                                                 
<ITEM NAME="#FINDTYPE"      LINE="13" COL="29"  DEVICE="KEYBOARD" INPUT="SELECT" TYPE="%-1s"   FUNCTIONS="T()">
  <SELECT>
   <OPTION VALUE ="3" TITLE="0.全部"   />
   <OPTION VALUE ="1" TITLE="0.往帐"   />
   <OPTION VALUE ="2" TITLE="0.来帐"   />
  </SELECT>
  <ONLOSTFOCUS>
"{
	  if(#FINDTYPE=='3'){   //如果查找类型选择全部，则往后台传一空值   chengbo 20090624 HS
	           
	          #FINDTYPE='';
	  } 
}"
</ONLOSTFOCUS>   
 </ITEM> 

<ITEM NAME="#PRINTFLAG"     LINE="15" COL="29"  DEVICE="KEYBOARD" INPUT="SELECT" TYPE="%-1s"   FUNCTIONS="T()">
	<SELECT>                                                
		<OPTION VALUE ="3" TITLE="0.全部"   />                
		<OPTION VALUE ="1" TITLE="0.已打印" />                
		<OPTION VALUE ="2" TITLE="0.未打印" />                
	</SELECT> 
	<ONLOSTFOCUS>
"{
	  if(#PRINTFLAG=='3'){   //如果打印标识选择全部，则往后台传一空值   chengbo 20090624 HS
	           
	          #PRINTFLAG='';
	  } 
}"
</ONLOSTFOCUS>                                             
</ITEM>                                                
                                                     
<ITEM LINE="20" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
<ONCLICK>
"{
	dim @tota as string;
	initfd();
	commsend_001();
	$FD16 ='5579';
  $FD44 =#IN_BEGINDAY;   //开始    日期
  $FD45 =#IN_ENDDAY;     //结束    日期
  $FD58 =#SRCNODECODE;   //原始节点代码
  $FD67 =#FINDTYPE;      //查找    类型
  $FD68 =#PRINTFLAG;     //打印    标识 
  //@tota=callserver();
  @tota=calltips();

	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}

	autolist(@tota);	
	#DOLIST='1';
}"
</ONCLICK>
</ITEM> 
</VARIABLE>
<REQUEST>
</REQUEST>

</TRANSACTION>

