<TRANSACTION RIGHTS="11110000" TITLE="5313 借记回执业务审查录入"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
  commsend_001();
	$FD3 =$KINBR;
	$FD44=$HDATE;
	$FD98=#OPTYPE;
	$FD20='1';
	$FD7=$TLRNO;
	#TXAMT15=itoa(#TX_AMT*100,'%016.0f');
  $FD102=getitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PWDFLAG#QUE_PWD#DRAW_PWD#ID_TYPE#ID_NO#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CT_IND#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10');
	lvsend_123();
}"
</COMMSEND>
<COMMRECV>"{
    commrecv_001();
    lvrecv_123();
}"
</COMMRECV>
<FIRSTWORK>
"{
  #PIC='';
  #PIC1='';
  show(#PIC,false);
  show(#PIC1,false);
  show(#LBLPIC,false);
  show(#LBLPIC1,false);
  enable(#SETPIC,false);
  enable(#SETPIC1,false);
}"
</FIRSTWORK>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-54s" FUNCTIONS=
    "T(5313                    借记回执业务审查录入)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(------------------------------------------------------------------------------)"/>
  <ITEM NAME="#TXNO" 	TYPE="%-4s" FUNCTIONS="T($TXNO=5853)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM LINE="05"  COL="03" TYPE="%-12s" FUNCTIONS="T(原发起行号:)"/>
  <ITEM LINE="05"  COL="40" TYPE="%-12s" FUNCTIONS="T(原委托日期:)"/>
  <ITEM LINE="06"  COL="03" TYPE="%-12s" FUNCTIONS="T(原支付序号:)"/>
  <ITEM LINE="07"  COL="03" TYPE="%-12s" FUNCTIONS="T(处理  方式:)"/> 
              
  <ITEM LINE="09"  COL="3"   TYPE="%-12s"   FUNCTIONS="T(回执  状态:)"/>
  <ITEM LINE="09"  COL="40"  TYPE="%-12s"   FUNCTIONS="T(建议  选择:)"/>
  
  <ITEM LINE="10"  COL="3"   TYPE="%-12s"   FUNCTIONS="T(业务  描述:)"/>
  
  <ITEM LINE="11"  COL="03"   TYPE="%-12s"  FUNCTIONS="T(交易  金额:)"/>
  <ITEM LINE="12"  COL="03"   TYPE="%-12s"  FUNCTIONS="T(业务  类型:)"/>
  
  
  <ITEM LINE="13" COL="3"   TYPE="%-12s"  FUNCTIONS="T(收款开户行:)"/>
  <ITEM LINE="13" COL="40"  TYPE="%-12s"  FUNCTIONS="T(应答  日期:)"/>
  <ITEM LINE="14" COL="3"   TYPE="%-12s"  FUNCTIONS="T(付款  帐号:)"/>
  <ITEM LINE="14"  COL="50"  NAME="#LDRAW_PWD"  TYPE="%-12s" INPUT="LABEL" VISABLE="FALSE" FUNCTIONS="T(储户密码:)"/>
  <ITEM LINE="15"  COL="3"  TYPE="%-11s" INPUT="LABEL" VISABLE="FALSE" NAME="#SHOW_ID_TYPE" FUNCTIONS="T(证件类型:)"/>
  <ITEM LINE="14"     COL="55"  NAME="#LBLPIC" TYPE="%-10s" FUNCTIONS="T(照    片:)"/>
  <ITEM LINE="14"     COL="65"  NAME="#LBLPIC1" TYPE="%-10s" FUNCTIONS="T(印    件:)"/>
  <ITEM LINE="15"  COL="40" TYPE="%-9s"   INPUT="LABEL" VISABLE="FALSE" NAME="#SHOW_ID_NO" FUNCTIONS="T(证件号码:)"/>
  <ITEM LINE="16" COL="3"   TYPE="%-12s"  FUNCTIONS="T(付款人名称:)"/>
  <ITEM LINE="17" COL="3"   TYPE="%-12s"  FUNCTIONS="T(付款人地址:)"/>
  <ITEM LINE="18" COL="3"   TYPE="%-12s"  FUNCTIONS="T(收款人帐号:)"/>
  <ITEM LINE="19" COL="3"   TYPE="%-12s"  FUNCTIONS="T(收款人名称:)"/>
  <ITEM LINE="20" COL="3"   TYPE="%-12s"  FUNCTIONS="T(附      言:)"/>


  <ITEM NAME="#BAK_ORDERNO" TYPE="%8s" FUNCTIONS=""/>
  <ITEM LINE="05"   COL="15" NAME="#OR_BR_NO" TYPE="%12s" DEVICE="KEYBOARD" FUNCTIONS="V(NB)T()">
  <ONLOSTFOCUS>
  "{
	dim @baktxno as string;
	@baktxno=$TXNO;
	$TXNO='9553';
	$FD32=#OR_BR_NO;
	commsend_001();
	callserver();
	$TXNO=@baktxno;
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}	
	showhelp(3,70,8,3,'支付系统行名信息',substr($FD96,0,60));
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="05"  COL="52" NAME="#WT_DATE"  TYPE="%8s" DEVICE="KEYBOARD" FUNCTIONS="D()V(NB)T($HDATE)"/>
  <ITEM LINE="06"  COL="15" NAME="#ORDERNO"  TYPE="%8d" DEVICE="KEYBOARD"  FUNCTIONS="V(NB)"/>
  
  <ITEM LINE="07"  COL="15" NAME="#OPTYPE" TYPE="%-1s" DEVICE="KEYBOARD" FUNCTIONS="T(0)">
     <SELECT>
         <OPTION VALUE="0"      TITLE="0.录入"/>
         <OPTION VALUE="1"      TITLE="1.修改"/>
     </SELECT>
   <ONLOSTFOCUS>
  "{
	dim @baktxno as string;
	dim @pkgno as string;
	@pkgno=#PKGNO;
    	@baktxno=$TXNO;
    	$TXNO='9402';
			$FD98=#OPTYPE;
    	commsend_001();
			#PKGNO = '002';
    	lvsend_123();
    	callserver();
    	$TXNO = @baktxno;
    	if($FD12!='0000'){
    		showmsg(geterror());
    		return(false);
    	}
    	#BAK_ORDERNO = #ORDERNO;
    	lvrecv_123();
	  enable(#OR_BR_NO 		  ,false);
		enable(#WT_DATE  		  ,false);
		enable(#ORDERNO  		  ,false);
		enable(#YW_TYPE     	  ,false);
		enable(#TXNUM      	  ,false);
		enable(#CASH_OPN_BR_NO ,false);
		enable(#RESP_DAY    	  ,false);
		enable(#PAY_AC_NO   	  ,false);
		enable(#PAY_NAME    	  ,false);
		enable(#PAY_ADDR 		  ,false);
		enable(#CASH_AC_NO  	  ,false);
		enable(#CASH_NAME   	  ,false);
		enable(#TX_AMT		  ,false);
		enable(#AC_BR_NO	  ,false);
		if(#TXNUM =='30102' or #TXNUM=='30103')
		{
			showmsg('此程序不能回执支票业务');
			return(false);
		}	
		refresh();
		#PKGNO=@pkgno;
    	
    	}"
  </ONLOSTFOCUS>  
  </ITEM>
  <ITEM NAME="#AC_NO"   TYPE="%-24s" FUNCTIONS=""/>
  <ITEM NAME="#AC_SEQN"   TYPE="%-4s" FUNCTIONS=""/>
  <ITEM NAME="#RNAME"    TYPE="%-60s" FUNCTIONS="T()" />
  <ITEM NAME="#ERRCODE" TYPE="%-4s" FUNCTIONS="T()"/>
  <ITEM NAME="#RTXAMT"   TYPE="%16.2f" FUNCTIONS="T()"/>
  <ITEM NAME="#CHECK" TYPE="%-1s" FUNCTIONS="T()">
  <ONLOSTFOCUS>
 	"{
 		dim @baktxno as string;
  		dim @name as string;
  		dim @cnt as number;
  		dim @flag as string;
   		dim @avbal as string;
   		dim @pwd_ind as string;
   		dim @actype as string;
   		dim @prdt_name as string;
   		@flag='0';
   		@baktxno=$TXNO;
   		$TXNO='9731';
   		#AC_NO=substr(#PAY_AC_NO,0,24)+space(24-len(#PAY_AC_NO))+'';
   		$FD102=#AC_NO+#AC_SEQN;
   		commsend_001();
   		callserver();
   		$TXNO=@baktxno;
   		#ERRCODE=$FD12;
   		@name=substr($FD102,125,60);
   		@avbal=substr($FD102,185,16);
   		@pwd_ind=substr($FD102,48,1);
   		@actype=substr($FD102,207,1);
   		#RNAME=rtrim(@name);
   		#RTXAMT=val(@avbal)/100;
   		enable(#RNAME,true);
   		@prdt_name=rtrim(substr($FD102,313,30));
   		showhelp(4,68,5,10,'帐户信息','户名:'+@name+' 余额:'+itoa(val(@avbal,0.01),'%16.2f')+space(6)+' 产品名称:'+@prdt_name);
   		setitems('#ACTNO24#ACTSEQ#VOCTYPE#VOCNUM#FETCHFLAG#PWDFLAG#QUE_PWD#DRAW_PWD#ID_TYPE#CERTNO20#STAMPFLAG#PWDFLAG2#PWD16#PRINTDATE#TXAMT15#CERTTYPE#CUSTNAME#AVBAL#CURCD#CT_IND#DSCPT#ACTTYPE#ACTSEQ_2#ACCOUNTFLAG#INTEREST1#INTEREST2#INTEREST3#PAYAMOUNT#NEWVOCNUM#SPEFLAG#PRODNAME#ACTNO_24#EDUCREDIT#DESC10',$FD102);
   		if(#PAY_NAME != #RNAME)
   		{
   			showmsg('户名不符，不能回执成功!');
   			@flag='1';
   			#RCP_STS='02';
   		}
   		if(#TX_AMT &gt; #RTXAMT)
   		{
   			showmsg('金额不足，不能回执成功!');
   			@flag='1';
   			#RCP_STS='03';
   		}
   		if(#LV_STS=='V')
   		{
   			showmsg('来帐已止付!!');
   			@flag='1';
   			#RCP_STS='20';
   		}
		if(@flag=='0')
		{
			if(#ERRCODE !='0000')
			{
				if(#ERRCODE !='L018')
				{
					showmsg('账户状态错误!!');
					#RCP_STS='11';
				}
				else
				{
					#RCP_STS='90';
					showmsg('其他错误!');
				}	
			}
			else
			{
				showmsg('成功!');
				#RCP_STS='00';
			}
		}
		@cnt=atoi(#RCP_STS);
	  switch(@cnt)
    {
	case 0:
		#CRCPSTAT='成功';
		#PAY_AC_NO=rtrim(#PAY_AC_NO);
		if(len(#PAY_AC_NO)!=7 and len(#PAY_AC_NO)!=5 and len(#PAY_AC_NO)!=3 )
		{
			@baktxno=$TXNO;
			$TXNO = '9405';
			#PAY_AC_NO=substr(#PAY_AC_NO,0,24)+space(24-len(#PAY_AC_NO))+'';
			$FD32=#PAY_AC_NO;
			commsend_001();
			callserver();
			$TXNO=@baktxno;
			if($FD12!='0000')
			{
				showmsg(geterror());
				return (false);
			}
		}
                  break;
          case 1:
                  #CRCPSTAT='账号不存在';
                  break;
          case 2:
                  #CRCPSTAT='账号, 户名不符';
                  break;
          case 3:
                  #CRCPSTAT='账户余额不足支付';
                  break;
          case 10:
                  #CRCPSTAT='账户密码错误';
                  break;
          case 11:
                  #CRCPSTAT='账户状态错误';
                  break;
          case 20:
                  #CRCPSTAT='业务已撤销';
                  break;         
          case 90:
                  #CRCPSTAT='其他错误';
                  break;
          default :
          				#CRCPSTAT='未知错误';
          				break;
    }
    if(#RCP_STS!='00')
    {
    	goitem(#RCP_STS);
    	show(#RCP_STS,true);
    }else
    {
  		if(@pwd_ind=='Y'){
			showmsg('需要检查密码');
			#DRAW_PWD='';
				show(#LDRAW_PWD,true);
				show(#DRAW_PWD,true);
			}else{
				show(#LDRAW_PWD,false);
				show(#DRAW_PWD ,false);
			
				if(@actype=='1'){
					showmsg(@prdt_name+'必需有密码才能办理大小额业务');
					return(false);
				}
			}
			if(#ID_TYPE=='Y'){
  		   showmsg('该账户需要凭证件支取，需要输入证件');
  		   show(#ID_TYPE,true);
  		   show(#ID_NO,true);
  		   show(#SHOW_ID_TYPE,true);
  		   show(#SHOW_ID_NO,true);
  		   enable(#ID_TYPE,false);
  		 }else{
  		   show(#ID_TYPE,false);
  		   show(#ID_NO,false);
  		   show(#SHOW_ID_TYPE,false);
  		   show(#SHOW_ID_NO  ,false);
  		   enable(#ID_TYPE,false);
  		 }
  	}	  
    }"
   </ONLOSTFOCUS>
  </ITEM>

  <ITEM LINE="09" COL="15" NAME="#RCP_STS" TYPE="%-2s" DEVICE="KEYBOARD" FUNCTIONS="T()">
    <SELECT>
	<OPTION VALUE="00" TITLE="成功            "/>
	<OPTION VALUE="01" TITLE="账号不存在      "/>
	<OPTION VALUE="02" TITLE="账号,户名不符   "/>
	<OPTION VALUE="03" TITLE="账户余额不足支付"/>
	<OPTION VALUE="10" TITLE="账户密码错误    "/>
	<OPTION VALUE="11" TITLE="账户状态错误    "/>
	<OPTION VALUE="20" TITLE="业务已止付      "/>
	<OPTION VALUE="90" TITLE="其他错误        "/>
	</SELECT>
	<ONLOSTFOCUS>
	"{
		if(#RCP_STS!='00')
		{
		goitem(#RCP_STS);
		show(#RCP_STS,true);
		show(#ID_TYPE,false);
		show(#ID_NO,false);
		show(#SHOW_ID_TYPE,false);
		show(#SHOW_ID_NO  ,false);
		show(#LDRAW_PWD,false);
		show(#DRAW_PWD ,false);
		goitem(#BRF);
		}
	}"
	</ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="09" COL="52"  NAME="#CRCPSTAT" TYPE="%-16s"  FUNCTIONS="T()"/> 
  <ITEM LINE="10" COL="15"  NAME="#YW_TYPE"     TYPE="%-12s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>  
	<ITEM LINE="11" COL="15"  NAME="#TX_AMT"    		TYPE="%16.2f" DEVICE="KEYBOARD" FUNCTIONS="T()">
  <ONLOSTFOCUS>
 	"{
 	     if(#TX_AMT == 0 )
 	     {  
 	         showmsg('交易金额要大于零!');
 	         return(false);
 	     }
 	}"
 </ONLOSTFOCUS>
 </ITEM>
  <ITEM LINE="12" COL="15"  NAME="#TXNUM"      TYPE="%-5s"  DEVICE="KEYBOARD" FUNCTIONS="T(00114)V(NB)">
   <SELECT>
	<OPTION VALUE="00113" TITLE="国库资金定期借记划拨"/>
	<OPTION VALUE="00119" TITLE="其他定期借记业务    "/>
	<OPTION VALUE="20103" TITLE="财政直接支付    "/>
	<OPTION VALUE="20104" TITLE="财政授权支付    "/>
	<OPTION VALUE="30102" TITLE="支票截留业务    "/>
  </SELECT>
  </ITEM>
  
  <ITEM LINE="13" COL="15"  NAME="#CASH_OPN_BR_NO"  TYPE="%-12s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>
  <ITEM LINE="13" COL="52"  NAME="#RESP_DAY"  	TYPE="%-8s"  DEVICE="KEYBOARD" FUNCTIONS="T($HDATE)"/>
  <ITEM LINE="14" COL="15"  NAME="#PAY_AC_NO"   TYPE="%-32s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>
  <ITEM LINE="14" COL="62"  NAME="#DRAW_PWD" TYPE="%6d" DEVICE="PINPAD"  VISABLE="FALSE" INPUT="TEXT" FUNCTIONS="i()I()V(NB)"/>
   <!--added by liuyong 2009-9-15 显示图片信息 start-->
   <ITEM  NAME="#CHECKACNO"  TYPE="%10s" FUNCTIONS="">
 <ONLOSTFOCUS>
 "{
     dim @txnobak as string;
     dim @len as number;
     @len = len(rtrim(#PAY_AC_NO));
     if(@len != 0 and @len != 3 and @len != 5 and @len != 7)
     {
       @txnobak = $TXNO;
       $TXNO = '9663';
       $FD30 = #PAY_AC_NO;
       commsend_001();
       callserver();
       if($FD12 !='0000')
       {
         show(#PIC,false);
         show(#PIC1,false);
         show(#LBLPIC,false);
         show(#LBLPIC1,false);
         enable(#SETPIC,false);
         enable(#SETPIC1,false);
       }
       else
       {
         show(#PIC,true);
         show(#PIC1,true);
         show(#LBLPIC,true);
         show(#LBLPIC1,true);
         enable(#SETPIC,true);
         enable(#SETPIC1,true);
       }
       $TXNO = @txnobak;
     }
     
 }"
 </ONLOSTFOCUS>
 </ITEM>
 <ITEM NAME="#LYACNO" TYPE="%-32s" FUNCTIONS="" />
  <ITEM LINE="14" COL="62" LINES="160" COLS="120" NAME="#PIC" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#PAY_AC_NO;
      call_96641();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="14" COL="72" LINES="220" COLS="160" NAME="#PIC1" TYPE="%-10s" VISABLE="FALSE" FUNCTIONS=""/>
  <ITEM NAME="#SETPIC1" TYPE="%-10s" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
      #LYACNO=#PAY_AC_NO;
      call_96642();
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <!--added by liuyong 2009-9-15 显示图片信息 end-->
   <ITEM LINE="15"   COL="15" NAME="#ID_TYPE"  INPUT="SELECT" VISABLE="FALSE"  TYPE="%-1s"  DEVICE="NONE" FUNCTIONS="">
  <SELECT>
    <OPTION VALUE="N"     TITLE="0.否"/>
    <OPTION VALUE="Y"     TITLE="1.是"/>
  </SELECT>
  </ITEM>

  <ITEM LINE="15"   COL="50" NAME="#ID_NO"  INPUT="TEXT" VISABLE="FALSE"  TYPE="%-20s"  DEVICE="KEYBOARD" FUNCTIONS="">
  <ONLOSTFOCUS>"{
     if(#ID_NO!=rtrim(#CERTNO20)){
       showmsg('输入的证件号码与原登记证件号码不同');
       return(false);
     }
  }"</ONLOSTFOCUS>
  </ITEM>
  <ITEM LINE="16" COL="15"  NAME="#PAY_NAME"    TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS="T()" />
  <ITEM LINE="17" COL="15"  NAME="#PAY_ADDR"    TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>
  <ITEM LINE="18" COL="15"  NAME="#CASH_AC_NO" 	TYPE="%-32s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>
  
  <ITEM LINE="19" COL="15"  NAME="#CASH_NAME"  	TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>
  <ITEM LINE="20" COL="15"  NAME="#BRF"    	TYPE="%-60s" DEVICE="KEYBOARD" FUNCTIONS="T()"/>
  <ITEM  NAME="#XTX_AMT"    TYPE="%-21s"        FUNCTIONS="X(#TX_AMT)"/>
  
  <!---FD123域的内容--->
<ITEM NAME="#AC_BR_NO" 		TYPE="%-12s"    FUNCTIONS=""/>
<ITEM NAME="#CASH_ADDR"  	TYPE="%-60s"  	FUNCTIONS=""/>
<ITEM NAME="#CHRG_IND"  	TYPE="%-1s"   	FUNCTIONS="T(0)"/>   
<ITEM NAME="#CRDB"		TYPE="%-1s" 	FUNCTIONS="T(0)"/>	<!--借贷标志0借1贷--> 
<ITEM NAME="#OPCD"		TYPE="%-2s" 	FUNCTIONS="T(10)"/>	<!--操作代码 --->
<ITEM NAME="#PKGNO" 		TYPE="%3d"  	FUNCTIONS="T(008)"/>	<!--PKGNO-->
<ITEM NAME="#PAY_OPN_BR_NO"	TYPE="%-12s"	FUNCTIONS=""/>		<!--付款人开户行   --> 
<ITEM NAME="#PAY_QS_NO"		TYPE="%-12s" 	FUNCTIONS=""/>		<!--付款清算行行号 -->
<ITEM NAME="#PWD"		TYPE="%-8s"  	FUNCTIONS=""/>		<!--储户密码       --> 
<ITEM NAME="#CASH_QS_NO"	TYPE="%-12s" 	FUNCTIONS=""/>		<!--收款清算行行号 -->
<ITEM NAME="#OPERLEVEL"		TYPE="%-1s" 	FUNCTIONS="T(0)"/>	<!--优先级         --> 
<ITEM NAME="#AUTH_TEL"		TYPE="%-6s"	FUNCTIONS=""/>		<!--授权操作员号   --> 
<ITEM NAME="#AUTH_PWD"		TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--授权操作员密码 --> 
<ITEM NAME="#NOTE_TYPE"   	TYPE="%-2s" 	FUNCTIONS="T()"/>	<!--凭证种类       --> 
<ITEM NAME="#NOTE_NO"   	TYPE="%-12s"	FUNCTIONS="T()"/>	<!--凭证号码       --> 
<ITEM NAME="#PACK_DATE"   	TYPE="%-8s" 	FUNCTIONS=""/>		<!--包日期,定期用  --> 
<ITEM NAME="#PACK_ID"   	TYPE="%-8s" 	FUNCTIONS=""/>		<!--包id,定期用    --> 
<ITEM NAME="#CHRG_AMT"		TYPE="%-15s" 	FUNCTIONS="T()"/>	<!--手续费标志     --> 
<ITEM NAME="#PO_TYPE"    	TYPE="%-2s" 	FUNCTIONS="T()"/>	<!--票据类型      --> 
<ITEM NAME="#PO_DATE"    	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--票据日期      --> 
<ITEM NAME="#PO_NUM"    	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--票据号码      --> 
<ITEM NAME="#PC_TX_AMT"    	TYPE="%-15s"	FUNCTIONS="T()"/>	<!--赔偿金额      --> 
<ITEM NAME="#JF_TX_AMT"    	TYPE="%-15s"	FUNCTIONS="T()"/>	<!--拒付金额      --> 
<ITEM NAME="#O_WT_DATE"    	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--原委托日期    --> 
<ITEM NAME="#O_TXNUM"   	TYPE="%-5s" 	FUNCTIONS="T()"/>	<!--原业务编号    --> 
<ITEM NAME="#O_ORDERNO"   	TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--原支付交易序号--> 
<ITEM NAME="#RET_CODE"   	TYPE="%-2s" 	FUNCTIONS="T()"/>	<!--退汇原因代码  --> 
<!--<ITEM NAME="#RCP_STS"		TYPE="%-2s" 	FUNCTIONS="T()"/>	<!--业务回执状态  --> <!--同名ITEM liangq注-->
<ITEM NAME="#RESP1"		TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--Mbfe应答码    --> 
<ITEM NAME="#RESP2"		TYPE="%-8s" 	FUNCTIONS="T()"/>	<!--Ccpc应答码    --> 
<ITEM NAME="#PACK_END"   	TYPE="%-1s" 	FUNCTIONS="T()"/>	<!--包结束标志    --> 
<ITEM NAME="#LV_STS"     	TYPE="%-1s"   	FUNCTIONS="T()"/>	<!--交易状态      -->
<ITEM NAME="#LW_IND"     	TYPE="%-1s"   	FUNCTIONS="T(1)"/>	<!--来往标识 -->
<ITEM NAME="#DFXYNO"      	TYPE="%-60s"   	FUNCTIONS=""/>		<!--多方协议号-->
<ITEM NAME="#OORBRNO"     	TYPE="%-12s"   	FUNCTIONS="T()"/>	<!--原发起行行号 -->
  <ITEM NAME="#OACBRNO"      	TYPE="%-12s"   	FUNCTIONS=""/>		<!--原接收行行号-->
<!---FD123内容结束--->

<!-- 102域变量 -->
  <ITEM NAME="#ACTNO24"   	TYPE="%-24s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ"    	TYPE="%-4s" 	FUNCTIONS=""/>
  <ITEM NAME="#VOCTYPE"   	TYPE="%-3s"  	FUNCTIONS=""/>
  <ITEM NAME="#VOCNUM"    	TYPE="%16d" 	FUNCTIONS=""/>
  <ITEM NAME="#FETCHFLAG" 	TYPE="%1s" 	FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG"   	TYPE="%-1s"	FUNCTIONS=""/>
  <ITEM NAME="#QUE_PWD"   	TYPE="%6s" 	FUNCTIONS=""/>
  <!--<ITEM NAME="#DRAW_PWD"  	TYPE="%-6s" 	FUNCTIONS=""/> --><!--同名ITEM liangq注-->
  <ITEM NAME="#CERTFLAG"  	TYPE="%-1s"  	FUNCTIONS=""/>
  <ITEM NAME="#CERTNO20"  	TYPE="%-20s" 	FUNCTIONS=""/>
  <ITEM NAME="#STAMPFLAG" 	TYPE="%1s" 	FUNCTIONS=""/>
  <ITEM NAME="#PWDFLAG2"  	TYPE="%1s" 	FUNCTIONS=""/>  
  <ITEM NAME="#PWD16"     	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#PRINTDATE" 	TYPE="%-8s" 	FUNCTIONS=""/>      
  <ITEM NAME="#TXAMT15"   	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#CERTTYPE"  	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#CUSTNAME"  	TYPE="%-50s" 	FUNCTIONS=""/>
  <ITEM NAME="#AVBAL"     	TYPE="%17.2f" 	FUNCTIONS=""/>
  <ITEM NAME="#CURCD"     	TYPE="%-2s"  	FUNCTIONS=""/>
  <ITEM NAME="#CT_IND"    	TYPE="%-1s"  	FUNCTIONS="T(2)"/>
  <ITEM NAME="#DSCPT"     	TYPE="%-3s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTTYPE"   	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTSEQ_2"  	TYPE="%-4s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACCOUNTFLAG" 	TYPE="%-1s" 	FUNCTIONS=""/>
  <ITEM NAME="#INTEREST1" 	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#INTEREST2" 	TYPE="%-16s" 	FUNCTIONS=""/>  
  <ITEM NAME="#INTEREST3" 	TYPE="%-16s" 	FUNCTIONS=""/>
  <ITEM NAME="#PAYAMOUNT" 	TYPE="%-16s" 	FUNCTIONS=""/>  
  <ITEM NAME="#NEWVOCNUM"	TYPE="%-16d" 	FUNCTIONS=""/>
  <ITEM NAME="#SPEFLAG"   	TYPE="%-20s" 	FUNCTIONS=""/>    
  <ITEM NAME="#PRODNAME"  	TYPE="%-30s" 	FUNCTIONS=""/>
  <ITEM NAME="#ACTNO_24"  	TYPE="%-24s" 	FUNCTIONS=""/> 
  <ITEM NAME="#EDUCREDIT" 	TYPE="%1s" 	FUNCTIONS=""/>   
  <ITEM NAME="#DESC10"    	TYPE="%-10s" 	FUNCTIONS=""/>
  <ITEM NAME="#RATE"	  	TYPE="%-7s"	FUNCTIONS=""/>
  <ITEM NAME="#RATEDATE"  	TYPE="%-5s"	FUNCTIONS=""/>
  <!---FD102定义结束--->
 <ITEM LINE="21"  COL="55"  TYPE="%-10s" NAME="#XIA" FUNCTIONS="T(跳过该笔)" INPUT="BUTTON" >
<ONCLICK>
"{
	if(#OPTYPE=='0')
	{
		initfd();
		commsend_001();
		dim @yn   as string;
		dim @orderno as number;
		dim @orderno_bk as string;
		@orderno_bk = #ORDERNO;


		#PKGNO  = '008';
		$FD16	=	'9567';
		@orderno = atoi(#ORDERNO);
		@orderno = @orderno +1;
		#ORDERNO = itoa(@orderno,'%08d');
		lvsend_123();
		#ORDERNO = @orderno_bk;

		callserver();

		if($FD12!='0000' and $FD12!='9999')
		{
			showmsg(geterror());
			return(false);
		}
		else if($FD12!='0000' and $FD12=='9999')
		{
			showmsg('已经回执完所有记录');
			showhelp(4,58,5,20,'提示信息','已经回执完所有记录');
			return (false);
		}
		else if($FD12=='0000')
		{
			lvrecv_123();
			showmsg('交易处理完毕! 进入交易【'+#ORDERNO+'】的处理');?
			open('5313.XML','#ORDERNO='+#ORDERNO+';#WT_DATE='+#WT_DATE+';#OR_BR_NO='+#OR_BR_NO+';#YW_TYPE='+#YW_TYPE+';#TXNUM='+#TXNUM+';#CASH_OPN_BR_NO='+#CASH_OPN_BR_NO+';#RESP_DAY='+#RESP_DAY+';#PAY_NAME='+#PAY_NAME+';#PAY_ADDR='+#PAY_ADDR+';#CASH_AC_NO='+#CASH_AC_NO+';#CASH_NAME='+#CASH_NAME+';');
			enable(#OR_BR_NO 	  ,true);
			enable(#WT_DATE  	  ,true);
			enable(#ORDERNO  	  ,true);
			enable(#YW_TYPE     	  ,true);
			enable(#TXNUM      	  ,true);
			enable(#CASH_OPN_BR_NO 	  ,true);
			enable(#RESP_DAY    	  ,true);
			enable(#PAY_AC_NO   	  ,true);
			enable(#PAY_NAME    	  ,true);
			enable(#PAY_ADDR 	  ,true);
			enable(#CASH_AC_NO  	  ,true);
			enable(#CASH_NAME   	  ,true);
		}
		else 
		{
			showmsg('程序调用异常,请与科技联系!');
		}

		goitem(#OR_BR_NO);
	}
}"
</ONCLICK>
</ITEM>

<ITEM LINE="21"  COL="69"  TYPE="%-6s" NAME="#QUEDING" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
</VARIABLE>
  <REQUEST>
</REQUEST>



<!--接收信息包-->
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="按任意键退出">
NOTHING
</PACKAGE>
<PRINT>"{
			print(3,5, '普通借记回执往帐录入');
			print(4,5, '委 托 日 期:[8]支付交易序号:[8]',$HDATE,#ORDERNO);
			print(5,5, '接收行行号:[12]',#AC_BR_NO);
			print(6,5, '付款人帐号 :[24]',#PAY_AC_NO);
			print(7,5, '付款人名称 :[60]',#PAY_NAME);
			print(8,5, '交 易 金 额:[21]',#XTX_AMT);
			print(9,5, '收款人开户行:[12]       对方清算行号: [12]',#CASH_OPN_BR_NO,#CASH_QS_NO);
			print(10,5,'收款人帐号:[24]',#CASH_AC_NO);
			print(11,5,'收款人名称:[60]',#CASH_NAME);
			print(12,5,'附      言:[60]',#BRF);
			print(13,5,'流  水  号:[6]                   操作员号:[4]',$FD4,$FD7);
		}"
	</PRINT>
</RESPONSE>
<!--打印信息 -->
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="请打印业务专用凭证">
NOTHING
</PACKAGE>
<PRINT>"{
    $KINDNO='00';
    dim @txtime as string;
    @txtime = substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
    
    print( 5, 20,'机构名称:[30]',$BRNAME);
    print( 5, 2,'代码:5313');
    print( 5, 13,'交易:普通借记回执往帐录入');
    
    print(07,20, '接收行 行 号:[12          ]                  支付交易序号:[8       ]',#AC_BR_NO,#ORDERNO);
    print(08,20, '付款人 帐 号:[24                      ]      委 托  日 期:[8       ]',#PAY_AC_NO,$HDATE);
    print(09,20, '付款人 名 称:[60                                                          ]',#PAY_NAME);
    print(10,20, '交 易  金 额:[21]',#XTX_AMT);
    print(11,20, '收款人开户行:[12          ]                  对方清算行号: [12          ]',#CASH_OPN_BR_NO,#CASH_QS_NO);
    print(12,20, '收款人 帐 号:[24]',#CASH_AC_NO);
    print(13,20, '收款人 名 称:[60                                                          ]',#CASH_NAME);
    print(14,20, '附        言:[60                                                          ]',#BRF);
    
    print( 24,20,'备注:');
    print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
    print( 24,5,'柜员:[4]',$FD7);
    print( 24,5,'流水号:[6]',$FD4);
  }"
  </PRINT>
</RESPONSE>

<LASTWORK>"{
	if(#OPTYPE=='0')
	{
		initfd();
		commsend_001();
		#PKGNO = '008';
		#ORDERNO = #BAK_ORDERNO;
		showmsg('ORDERNO=='+#ORDERNO);
		$FD16	=	'9567';
		lvsend_123();
	
		callserver();

		if($FD12!='0000' and $FD12!='9999')
		{
			showmsg(geterror());
			return(false);
		}
		else if($FD12!='0000' and $FD12=='9999')
		{
			showmsg('已经回执完所有记录');
			showhelp(4,58,5,20,'提示信息','已经回执完所有记录');
			return (false);
		}
		else if($FD12=='0000')
		{
			lvrecv_123();
			showmsg('交易处理完毕! 进入交易【'+#ORDERNO+'】的处理');

			open('5313.XML','#ORDERNO='+#ORDERNO+';#WT_DATE='+#WT_DATE+';#OR_BR_NO='+#OR_BR_NO+';#YW_TYPE='+#YW_TYPE+';#TXNUM='+#TXNUM+';#CASH_OPN_BR_NO='+#CASH_OPN_BR_NO+';#RESP_DAY='+#RESP_DAY+';#PAY_NAME='+#PAY_NAME+';#PAY_ADDR='+#PAY_ADDR+';#CASH_AC_NO='+#CASH_AC_NO+';#CASH_NAME='+#CASH_NAME+';');
			enable(#OR_BR_NO 	  ,true);
			enable(#WT_DATE  	  ,true);
			enable(#ORDERNO  	  ,true);
			enable(#YW_TYPE     	  ,true);
			enable(#TXNUM      	  ,true);
			enable(#CASH_OPN_BR_NO 	  ,true);
			enable(#RESP_DAY    	  ,true);
			enable(#PAY_AC_NO   	  ,true);
			enable(#PAY_NAME    	  ,true);
			enable(#PAY_ADDR 	  ,true);
			enable(#CASH_AC_NO  	  ,true);
			enable(#CASH_NAME   	  ,true);
		}
		else 
		{
			showmsg('程序调用异常,请与科技联系!');
		}
	}
}"
</LASTWORK>
</TRANSACTION>
