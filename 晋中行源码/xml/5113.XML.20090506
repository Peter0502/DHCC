<?xml version="1.0" encoding="GBK" ?>

<TRANSACTION RIGHTS="11110000" TITLE="5113 银行汇票挂失/解挂"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>
"{
	commsend_001();
	commsend_123();
	commsend_hv();
	$FD71  = #OPER;
	$FD72  = #BANK_TYPE;
	$FD88  = #PWD;	
}"
</COMMSEND>
<COMMRECV>
"{
	commrecv_001();
}"
</COMMRECV>
<VARIABLE>

  <ITEM LINE="3"  COL="3" TYPE="%-49s" FUNCTIONS=
    "T(5113                           银行汇票挂失/解挂)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
    "T(─────────────────────────────────────)"/>


  <ITEM NAME="#MSGTYPE"    TYPE="%-5s"   FUNCTIONS="T($MSGTYPE=03001)"/>
  <ITEM NAME="#TXNO"       TYPE="%-4s"   FUNCTIONS="T($TXNO=5813)"/>



<ITEM NAME="#CMTNO"				TYPE="%-3s"			FUNCTIONS=""/>
<ITEM NAME="#O_CMTNO"			TYPE="%-3s"			FUNCTIONS=""/>
<ITEM NAME="#PAY_QS_NO"			TYPE="%-12s"		FUNCTIONS=""/>
<ITEM NAME="#OR_BR_NO"			TYPE="%-12s"		FUNCTIONS=""/>
<ITEM NAME="#PAY_AC_NO"			TYPE="%-32s"		FUNCTIONS=""/>
<ITEM NAME="#PAY_NAME"			TYPE="%-60s"		FUNCTIONS=""/>
<ITEM NAME="#PAY_ADDR"			TYPE="%-60s"		FUNCTIONS=""/>
<ITEM NAME="#CASH_QS_NO"		TYPE="%-12s"		FUNCTIONS=""/>
<ITEM NAME="#CASH_OPN_BR_NO"	TYPE="%-12s"		FUNCTIONS=""/>
<ITEM NAME="#PAY_OPN_BR_NO" 	TYPE="%-12s"		FUNCTIONS=""/>
<ITEM NAME="#RECECO"			TYPE="%-4s"			FUNCTIONS=""/>
<ITEM NAME="#SENDCO"			TYPE="%-4s"			FUNCTIONS=""/>
<ITEM NAME="#CASH_AC_NO"		TYPE="%-32s"		FUNCTIONS=""/>
<ITEM NAME="#CASH_NAME"			TYPE="%-60s"		FUNCTIONS=""/>
<ITEM NAME="#CASH_ADDR"			TYPE="%-60s"		FUNCTIONS=""/>
<ITEM NAME="#YW_TYPE"			TYPE="%-2s"			FUNCTIONS=""/>
<ITEM NAME="#ORDERNO"			TYPE="%-8s"			FUNCTIONS=""/>
<ITEM NAME="#CONTENT"			TYPE="%-60s"		FUNCTIONS=""/>
<ITEM NAME="#RATE"				TYPE="%-7s"			FUNCTIONS=""/>
<ITEM NAME="#RATEDATE"			TYPE="%-5s"			FUNCTIONS=""/>
<ITEM NAME="#OORDERNO"			TYPE="%-8s"			FUNCTIONS=""/>
<ITEM NAME="#PROCODE"			TYPE="%-8s"			FUNCTIONS=""/>
<ITEM NAME="#CR_DATE"			TYPE="%-8s"			FUNCTIONS=""/>
<ITEM NAME="#CR_BR_NO"			TYPE="%-12s"		FUNCTIONS=""/>
<ITEM NAME="#CR_TX_NUM"			TYPE="%-8s"			FUNCTIONS=""/>
<ITEM NAME="#QR_BR_NO"          TYPE="%-12s"     	 FUNCTIONS=""/>
<ITEM NAME="#QR_TX_NUM"         TYPE="%-8s"      	 FUNCTIONS=""/>
<ITEM NAME="#TX_TYPE"           TYPE="%-1s"      	 FUNCTIONS=""/>
<ITEM NAME="#NOTPAY_CONTENT"    TYPE="%-255s"    	 FUNCTIONS=""/>
<ITEM NAME="#NOTPAY_ORDERNO"    TYPE="%-3s"      	FUNCTIONS=""/>
<ITEM NAME="#O_NOTPAY_ORDERNO"  TYPE="%-3s"       	FUNCTIONS=""/>
<ITEM NAME="#RESP1"             TYPE="%-1s"       	FUNCTIONS=""/>
<ITEM NAME="#OPERLEVEL"         TYPE="%-1s"      	FUNCTIONS=""/><!--优先级别-->
<ITEM NAME="#PROC_STS"          TYPE="%-1s"      	 FUNCTIONS=""/><!--处理状态-->

<ITEM NAME="#WT_DAY"            TYPE="%-8s"       	FUNCTIONS="T($HDATE)"/>
<ITEM NAME="#O_WT_DAY"          TYPE="%-8s"       	FUNCTIONS=""/>
<ITEM NAME="#NOTPAY_DATE"       TYPE="%-8s"       	FUNCTIONS=""/>
<ITEM NAME="#CUR_NO"            TYPE="%-3s"       	FUNCTIONS=""/>
<ITEM NAME="#OPCD"              TYPE="%-2s"       	FUNCTIONS=""/>
<ITEM NAME="#NOTE_TYPE"         TYPE="%-3s"       	FUNCTIONS=""/>
<ITEM NAME="#NOTE_NO"           TYPE="%-16s"      	FUNCTIONS=""/>
<ITEM NAME="#LW_IND"            TYPE="%-1s"       	FUNCTIONS="T(1)"/>
<ITEM NAME="#HP_ADD_PWD"    	TYPE="%-1s" 		FUNCTIONS=""/>
<ITEM NAME="#PACKID"        	TYPE="%8d"  		FUNCTIONS=""/>
<ITEM NAME="#O_PACKID"          TYPE="%8d"       	FUNCTIONS=""/>
<ITEM NAME="#PACK_DATE"     	TYPE="%8d"  		FUNCTIONS=""/>
<ITEM NAME="#O_PACK_DATE"   	TYPE="%8d"  		FUNCTIONS=""/>
<ITEM NAME="#TXNUM"     		TYPE="%5d"  		FUNCTIONS=""/>
<ITEM NAME="#O_TXNUM"       	TYPE="%5d"  		FUNCTIONS=""/>
<ITEM NAME="#LV_YW_IND"     	TYPE="%12s" 		FUNCTIONS=""/>
<ITEM NAME="#RESP_DATE"     	TYPE="%8d"  		FUNCTIONS=""/>
<ITEM NAME="#RCP_STS"       	TYPE="%2d"  		FUNCTIONS=""/>
<ITEM NAME="#RESP2"             TYPE="%8s"       	FUNCTIONS=""/>
<ITEM NAME="#RETCODE"           TYPE="%2d"       	FUNCTIONS=""/>
<ITEM NAME="#YW_DTL_ID"         TYPE="%8d"       	FUNCTIONS=""/>
<ITEM NAME="#ACC_IND"           TYPE="%1d"       	FUNCTIONS=""/>
<ITEM NAME="#REQ_TYPE"          TYPE="%1d"       	FUNCTIONS=""/>
<ITEM NAME="#DF_FREEAMT"        TYPE="%16s"      	FUNCTIONS=""/>
<ITEM NAME="#PROTNO"            TYPE="%60s"      	FUNCTIONS=""/>
<ITEM NAME="#PO_TYPE"           TYPE="%1d"       	FUNCTIONS=""/>
<ITEM NAME="#OTYPE"             TYPE="%1d"       	FUNCTIONS="T(1)"/><!-- 表示大额 -->



  <ITEM LINE="07"   COL="09" TYPE="%-09s"  FUNCTIONS="T(操作类型:)"/>
  <ITEM LINE="07"   COL="47" TYPE="%-09s"  FUNCTIONS="T(本行签发:)"/>
  <ITEM LINE="09"   COL="09" TYPE="%-09s"  FUNCTIONS="T(汇票号码:)"/>
  <ITEM LINE="10"   COL="09" TYPE="%-09s"  INPUT="LABEL" NAME="#LB0"  FUNCTIONS="T(签发行号:)"/>
  <ITEM LINE="12"   COL="09" TYPE="%-09s"  FUNCTIONS="T(出票日期:)"/>
  <ITEM LINE="13"   COL="09" TYPE="%-09s"  FUNCTIONS="T(出票金额:)"/>
  <ITEM LINE="15"   COL="09" TYPE="%-09s"  FUNCTIONS="T(汇票密押:)"/>

  
  <ITEM LINE="07"   COL="18" NAME="#OPER"    TYPE="%-1s"  INPUT="SELECT" FUNCTIONS="T(0)">
    <SELECT LINE="7"  COL="17">
          <OPTION VALUE="0" TITLE="挂失"/>
          <OPTION VALUE="1" TITLE="解挂失"/>
      </SELECT>
    </ITEM>
  <ITEM LINE="07"   COL="56" NAME="#BANK_TYPE" TYPE="%-1s"    INPUT="SELECT"   FUNCTIONS="T(0)">
    <SELECT LINE="7"  COL="58">
          <OPTION VALUE="0" TITLE="本行汇票"/>
          <OPTION VALUE="1" TITLE="他行汇票"/>
      </SELECT>
	  <ONLOSTFOCUS>
	  "{
			show(#AC_BR_NO,true);
			show(#LB0,true);
			if(#BANK_TYPE=='0')
			{
				show(#AC_BR_NO,false);
				show(#LB0,false);
			}
	   }"
	  </ONLOSTFOCUS>
    </ITEM>
  <ITEM LINE="09"   COL="18" NAME="#PO_NO"     			TYPE="%8d"    INPUT="TEXT"   FUNCTIONS="V(NB)"/>
  <ITEM LINE="10"   COL="18" NAME="#AC_BR_NO"     	TYPE="%-12s"   INPUT="TEXT"   FUNCTIONS="V(NB)">
   <ONLOSTFOCUS>"{
    dim @br_name as string;
    initfd();
    commsend_001();
    $FD16='9553';
    $FD32=#AC_BR_NO;
    callserver();
    if($FD12!='0000'){
        showmsg(geterror());
        return (false);
    }
    @br_name = substr($FD96,0,60);
    showhelp(3,70,8,3,'支付系统行名信息',substr($FD96,0,60));
  }"</ONLOSTFOCUS>
  </ITEM>

  <ITEM NAME="#SERVERCES" TYPE="%-1s" FUNCTIONS="G(#BANK_TYPE=='0',#OK)">
  <ONLOSTFOCUS>
  "{
		if(#BANK_TYPE=='0')
		{	
			initfd();
			commsend_001();
			commsend_123();
			$FD16 = '9560';
			callserver();
			if($FD12!='0000')
			{
				showmsg(geterror());
				return(false);
			}
			#SIGN_DATE = $FD46;
			#TX_AMT    = val($FD39)/100;

			show(#SIGN_DATE		,true);
			show(#TX_AMT		,true);
		}

   }"
   </ONLOSTFOCUS>
  </ITEM>

  <ITEM LINE="12"  COL="18" NAME="#SIGN_DATE"              TYPE="%-8s"    INPUT="TEXT"   FUNCTIONS=""/>
  <ITEM LINE="13"  COL="18" NAME="#TX_AMT"                 TYPE="%16.2f" INPUT="TEXT"   FUNCTIONS=""/>
<!--<ITEM NAME="#CASH_OPN_BR_NO"   TYPE="%-12s"  FUNCTIONS=""/>--><!--同名ITEM liangq注-->
  <ITEM LINE="15"   COL="18" NAME="#PWD"       TYPE="%-10s" INPUT="TEXT" FUNCTIONS="V(NB)"/>
  <ITEM NAME="#PASSWD"   TYPE="%-6s" FUNCTIONS="T()"/>

  <ITEM LINE="21"  COL="65" TYPE="%-6s" NAME="#OK"  FUNCTIONS="T(确  定)" INPUT="SUBMIT" /> 
 </VARIABLE>
<!--发送信息包-->
<REQUEST>
</REQUEST>

<!--接收信息包-->
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="按任意键退出">
NOTHING
</PACKAGE>
    <PRINT>"{
   print(3,25,'汇票挂失/解挂失');
   print(5,15,'汇票号码 :[20]',#PO_NO);
        print(6,15,'签发金额 :[12]',ltrim(comma(itoa(#TX_AMT,'%17.2f'),16)));
        print(7,15,'流水号码 :[ 6]',$FD4);
}"
</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="27" DESC="打印普通凭证">
NOTHING
</PACKAGE>
    <PRINT>"{
 $KINDNO='00';
 dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
 		print( 3, 25,'[5]',$KINBR);
		print( 3, 10,'[20]',$BRNAME);
		print( 3, 5,'交易日期:[8  ]  [8]',$HDATE,@txtime);
   print(4,36,'汇票挂失/解挂失');
   print(5,10,'汇票号码 :[20]',#PO_NO);
        print(6,10,'签发金额 :[12]',ltrim(comma(itoa(#TX_AMT,'%17.2f'),16)));
		print(7,10,'操作员号:[4]     流 水 号:[6]',$FD7,$FD4);    
}"
</PRINT>
</RESPONSE>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
    <PRINT>"{
 $KINDNO='00';
dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
 	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:5113');
	print( 5, 13,'交易:申请汇票兑付录入');
	
	printacdtl_1();
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);
}"
</PRINT>
</RESPONSE>

<OUTPUT>
</OUTPUT>
</TRANSACTION>
