<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00110000" TITLE="6603 证券回购借出还款记账"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
  <COMMSEND>"{
		initfd();
		$FD21=#BZ;
		$FD27=#DFHM;
		$FD30=#DFZH;
		$FD40=itoa(#HKBJJE*100, '%016.0f');
		$FD41=itoa(#HKLXJE*100, '%016.0f');
		$FD42=$FD40;
		$FD58=#PZH;
		$FD69=#XZBZ;
		$FD72=#ZZLX;
		$FD86=#XYBH;
		$FD89=#PZLX;
		commsend_001();
		$FD16='4703';
	}"
</COMMSEND>
<COMMRECV>"{
	
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-60s" FUNCTIONS=
    "T(6603                      证券回购借出还款记账  )"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
   <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=4703)"/>
   <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
   <!--输入变量-->

  <ITEM LINE="7"   COL="3"  TYPE="%-18s" FUNCTIONS="T(证券回购协议编号:)"/>
  <ITEM LINE="10"  COL="3"  TYPE="%-10s" FUNCTIONS="T(币  种:)"/>
  <ITEM LINE="10"  COL="26" TYPE="%-10s" FUNCTIONS="T(现转标志:)"/>
  <ITEM LINE="10"  COL="49" TYPE="%-10s" FUNCTIONS="T(转账类型:)"/>
  <ITEM LINE="11"  COL="3"  TYPE="%-16s" FUNCTIONS="T(还款本金金额:)"/>
  <ITEM LINE="11"  COL="41" TYPE="%-16s" FUNCTIONS="T(还款利息金额:)"/>
  <ITEM LINE="14"  COL="3"  TYPE="%-10s" FUNCTIONS="T(凭证种类:)"/>
  <ITEM LINE="14"  COL="41" TYPE="%-8s"  FUNCTIONS="T(凭证号:)"/>
  <ITEM LINE="15"  COL="3"  TYPE="%-10s" FUNCTIONS="T(收款帐号:)"/>
  <ITEM LINE="16"  COL="3"  TYPE="%-10s" FUNCTIONS="T(收款户名:)"/>

  <ITEM NAME="#XYBH" 	INPUT="TEXT" LINE="7" COL="21" TYPE="%-10s" 	FUNCTIONS="V(NB)">
   <ONLOSTFOCUS>
   "{
		initfd();
		$FD86=#XYBH;
		commsend_001();
		$FD16='9778';
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#HKBJJE=val($FD42,0.01);
		#HKLXJE=val($FD41,0.01);
		$FD40=itoa(#HKBJJE*100, '%016.0f');
		enable(#HKBJJE,false);
		enable(#HKLXJE,false);
   }"
   </ONLOSTFOCUS>
   </ITEM>
  
   <ITEM NAME="#BZ" INPUT="SELECT" LINE="10"  COL="10" TYPE="%-2s" 	FUNCTIONS="T(01)V(NB)">
  	<SELECT>
  		<OPTION VALUE="01" TITLE="01人民币 "/>
  	</SELECT>
</ITEM>

   <ITEM NAME="#XZBZ" INPUT="SELECT" LINE="10"  COL="36" TYPE="%-1s" ENABLE="FALSE" FUNCTIONS="T(2)V(1|2)">
  	<SELECT>
  		<!--OPTION VALUE="1" TITLE="1.现金 "/-->
  		<OPTION VALUE="2" TITLE="2.转账 "/>
  	</SELECT>
</ITEM>

<ITEM NAME="#ZZLX" INPUT="SELECT" LINE="10"  COL="59" TYPE="%-1s" 	FUNCTIONS="T(3)V(NB)">
  	<SELECT>
		<!--
  		<OPTION VALUE="1" TITLE="0.同城 "/>
  		<OPTION VALUE="2" TITLE="1.大额 "/>
		-->
  		<OPTION VALUE="3" TITLE="2.本行"/>
  	</SELECT>
	<ONLOSTFOCUS>
	"{
		enable(#DFZH, true);
		enable(#DFHM, true);
//		enable(#LZRQ, true);
//		enable(#LZLS, true);
		if('2' == #ZZLX){
//			#DFZH='';
//			#DFHM='';
//			enable(#DFZH, false);
//			enable(#DFHM, false);
		}else{
//			#LZRQ='';
//			#LZLS='';
//			enable(#LZRQ, false);
//			enable(#LZLS, false);
		}
	}"
	</ONLOSTFOCUS>
	</ITEM>

   <ITEM NAME="#HKBJJE"	 LINE="11" COL="17" TYPE="%17.2f" INPUT="TEXT"	FUNCTIONS="V(000000000001,099999999999)"/>

   <ITEM NAME="#HKLXJE"	 LINE="11" COL="55" TYPE="%17.2f" INPUT="TEXT"	FUNCTIONS="T()V(NB)"/>

   <ITEM NAME="#PZLX" INPUT="SELECT" LINE="14"  COL="13" TYPE="%-3s" 	FUNCTIONS="T(122)V(NB)">
  	<SELECT>
  		<OPTION VALUE="122" TITLE="122转帐借方传票 "/>
  		<OPTION VALUE="123" TITLE="123转帐贷方传票 "/>
  	</SELECT>
  </ITEM>

  <ITEM NAME="#PZH"	 LINE="14" COL="49" TYPE="%16d" INPUT="TEXT"	FUNCTIONS="T()"/>

  <ITEM NAME="#DFZH" LINE="15" COL="13" TYPE="%-24s" INPUT="TEXT"	FUNCTIONS="T()">
  <ONLOSTFOCUS>
  "{
		dim @txno as string;

		initfd();
		$FD30=#DFZH;
	if('3' == #ZZLX){
		commsend_001();
		$FD16='9812';
		callserver();
		#DFHM=$FD27;
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		$FD27=#DFHM;
		enable(#DFHM, true);
		goitem(#PASSWD,false);
	}
  }"
  </ONLOSTFOCUS>
  </ITEM>

  <ITEM NAME="#DFHM" LINE="16" COL="13" TYPE="%-48s" INPUT="TEXT"	FUNCTIONS="T()"/>
  <!--
  <ITEM NAME="#LZRQ" 	INPUT="TEXT" LINE="17" COL="13" TYPE="%-8s" 	FUNCTIONS="T()D()"/>

  <ITEM NAME="#LZLS" INPUT="TEXT" LINE="17"  COL="57" TYPE="%8d" 	FUNCTIONS="T()">
	 <ONLOSTFOCUS>
	 "{
		$FD44=#LZRQ;
		$FD45=#LZLS;
	 }"
	 </ONLOSTFOCUS>
	 </ITEM>
	 -->

  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>

  <ITEM NAME="#YEAR"  TYPE="%-4s" FUNCTIONS="T($FD5,1,4)"/>
  <ITEM NAME="#MON"   TYPE="%-2s" FUNCTIONS="T($FD5,5,2)"/>
  <ITEM NAME="#DAY"   TYPE="%-2s" FUNCTIONS="T($FD5,7,2)"/>

  <ITEM NAME="#SUBMIT" LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>

    </VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="证券回购借出还款记账!">
NOTHING
</PACKAGE>
 <PRINT>"{
   print( 5, 30,'证券回购借出还款记帐');
   print( 8, 20,'证券回购 协议编号 : [10]',#XYBH);
   print( 9, 20,'还 款 本 金 金 额 : [12]',ltrim(comma(itoa(#HKBJJE,'%13.2f'),12)));
   print(10, 20,'还 款 利 息 金 额 : [12]',ltrim(comma(itoa(#HKLXJE,'%13.2f'),12)));
 }"
</PRINT>
</RESPONSE>

<RESPONSE>
<PACKAGE DEVICE="PRINTER" DESC="打印业务专用凭证">
NOTHING
</PACKAGE>
  <PRINT>"{
dim @txtime  as string;
@txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	print( 5, 20,'机构名称:[30]',$BRNAME);  
	print( 5, 2,'代码:6603');
	print( 5, 13,'交易:证券回购借出还款记账');
	
	print(07, 20,'证券回购协议编号: [10]',#XYBH);
	print(08, 20,'还 款 本金 金 额: [12]',ltrim(comma(itoa(#HKBJJE,'%13.2f'),12)));
	print(09, 20,'还 款 利息 金 额: [12]',ltrim(comma(itoa(#HKLXJE,'%13.2f'),12)));
	
	print( 24,20,'备注:');
	print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	print( 24,5,'柜员:[4]',$FD7);
	print( 24,5,'流水号:[6]',$FD4);    
     }"
</PRINT>
</RESPONSE>
</TRANSACTION>
