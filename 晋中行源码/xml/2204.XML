<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111001" TITLE="2204 柜员揽存关系维护"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	commsend_001();
	$FD37=#LCZH;
	$FD25=#KHMC;
	$FD92=#GYDM;
	$FD86=#GYMC;
	$FD34=#ZHXH;
	$FD70=#A70;
	$FD29=#LCKH;
	$FD68=#BIFS;
	$FD69=#WHTY;
	$FD81=#BZ;
}"
</COMMSEND>
<COMMRECV>"{
		commrecv_001();
"}
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(2204                        柜员揽存关系维护)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO"    TYPE="%-4s" FUNCTIONS="T($TXNO=1204)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  
  <ITEM NAME="#LWHTY" LINE="5" COL="8" TYPE="%-10s" FUNCTIONS="T(维护类型:)"/>
	<ITEM LINE="5" COL="18" TYPE="%-1s"  NAME="#WHTY"  INPUT="SELECT" FUNCTIONS="V(NB)T(1)">
    <SELECT>
    	<OPTION VALUE="1" TITLE="关联"/>
      <OPTION VALUE="2" TITLE="维护"/>
      <OPTION VALUE="3" TITLE="解除"/>
    </SELECT>
    <ONLOSTFOCUS>"{
    	if(#WHTY=='1')
    	{
    		show(#GYDM,true);
    		enable(#GYDM,true);    		
    	}else if(#WHTY=='2'){
    		show(#GYDM,true);
    		enable(#GYDM,true);
    	}else if(#WHTY=='3'){
    		show(#GYDM,true);
    		enable(#GYDM,false);
    	}
    }"
    </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#LBIFS" LINE="7" COL="8" TYPE="%-10s" FUNCTIONS="T(揽存类型:)"/>
  <ITEM LINE="7" COL="18" TYPE="%-1s"  NAME="#BIFS"  INPUT="SELECT" FUNCTIONS="V(NB)T(1)">
    <SELECT>
      <OPTION VALUE="1" TITLE="关联帐号"/>
      <OPTION VALUE="2" TITLE="关联客户号"/>
    </SELECT>
    <ONLOSTFOCUS>"{
    	if(#BIFS=='1')
    	{
    		show(#LLCZH,true);
    		show(#LCZH,true);
    		show(#LLCKH,false);
    		show(#LCKH,false);
    	}else{
    		show(#LLCZH,false);
    		show(#LCZH,false);
    		show(#LLCKH,true);
    		show(#LCKH,true);
    	}
    }"
    </ONLOSTFOCUS>
  </ITEM>
  
  <!--输入变量-->
  <ITEM NAME="#LLCZH" LINE="9" COL="8" TYPE="%-10s" FUNCTIONS="T(揽存帐号:)"/>
  <ITEM NAME="#LCZH" INPUT="TEXT" LINE="9" COL="18" TYPE="%-19s" FUNCTIONS="">
  <ONLOSTFOCUS>
 "{	initfd();
 		dim @tota as string;
 		dim @txno as string;
		@txno=$TXNO;
 		$TXNO='9759';
		$FD37=#LCZH;
    	commsend_001();
		callserver();
		$TXNO=@txno;
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#KHMC=delspace($FD25);
		#ZHXH=$FD34;
		#A70 =$FD70;
		show(#KHMC,true);
		enable(#KHMC,false);
		
		//去查询揽存信息
		if(#WHTY != '1')
		{
			@txno=$TXNO;
	 		$TXNO='9028';
			$FD37=#LCZH;
			$FD68=#BIFS;
	    	commsend_001();
			callserver();
			$TXNO=@txno;
			if($FD12!='0000'){
				showmsg(geterror());
				return(false);
			}
			#BZ=delspace($FD81);
			#GYDM=$FD92;
			
			initfd();
			@txno=$TXNO;
	 		$TXNO='9718';
			$FD92=#GYDM;
	    	commsend_001();
			callserver();
			$TXNO=@txno;
			if($FD12!='0000'){
				showmsg(geterror());
				return(false);
			}
			#GYMC=delspace($FD86);
			show(#GYMC,true);
		}
 }"
 </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#LLCKH" VISABLE="FALSE" LINE="9" COL="8" TYPE="%-12s" FUNCTIONS="T(揽存客户号:)"/>
  <ITEM NAME="#LCKH" VISABLE="FALSE" INPUT="TEXT" LINE="9" COL="18" TYPE="%-8s" FUNCTIONS="">
  <ONLOSTFOCUS>
 "{	initfd();
 		dim @tota as string;
 		dim @txno as string;
		@txno=$TXNO;
 		$TXNO='9848';
		$FD29=#LCKH;
    	commsend_001();
		callserver();
		$TXNO=@txno;
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#KHMC=delspace($FD25);   
		show(#KHMC,true);
		enable(#KHMC,false);
		
		//去查询揽存信息
		if(#WHTY != '1')
		{
			@txno=$TXNO;
	 		$TXNO='9028';
			$FD37=#LCZH;
			$FD68=#BIFS;
	    	commsend_001();
			callserver();
			$TXNO=@txno;
			if($FD12!='0000'){
				showmsg(geterror());
				return(false);
			}
			#BZ=delspace($FD81);
			#GYDM=$FD92;
			
			initfd();
			@txno=$TXNO;
	 		$TXNO='9718';
			$FD92=#GYDM;
	    	commsend_001();
			callserver();
			$TXNO=@txno;
			if($FD12!='0000'){
				showmsg(geterror());
				return(false);
			}
			#GYMC=delspace($FD86);
			show(#GYMC,true);
		}
 }"
 </ONLOSTFOCUS>
  </ITEM>
    <ITEM LINE="11" COL="8" TYPE="%-10s" FUNCTIONS="T(客户名称:)"/>
  <ITEM NAME="#ZHXH" TYPE="%4d"         FUNCTIONS=""/><!---帐户序号--->
  <ITEM NAME="#A70"  TYPE="%1s"         FUNCTIONS=""/><!---FD70域--->
  <ITEM NAME="#KHMC" LINE="11" COL="18" TYPE="%-60s" FUNCTIONS=""/>
  <ITEM LINE="12"  COL="3" TYPE="%-74s" FUNCTIONS=
   "T(--------------------------------------------------------------------------)"/>
  <ITEM LINE="14" COL="8" TYPE="%-10s" FUNCTIONS="T(柜员代码:)"/>
  <ITEM LINE="16" COL="8" TYPE="%-10s" FUNCTIONS="T(柜员名称:)"/>
  <ITEM NAME="#GYDM" INPUT="TEXT" LINE="14" COL="18" TYPE="%-4s" FUNCTIONS="V(NB)">
  <ONLOSTFOCUS>
 "{	initfd();
 		dim @tota as string;	
 		dim @txno as string;
		@txno=$TXNO;
 		$TXNO='9718';
		$FD92=#GYDM;
    	commsend_001();
		callserver();
		$TXNO=@txno;
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#GYMC=delspace($FD86);
		show(#GYMC,true);
 }"
 </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#WHNAME" TYPE="%-10s" FUNCTIONS="S(#WHTY,#WHTY)"/>
  <ITEM NAME="#GYMC" LINE="16" COL="18" TYPE="%-10s" FUNCTIONS=""/>
  
  <ITEM LINE="18" COL="8" TYPE="%-10s" FUNCTIONS="T(备注:)"/>
  <ITEM NAME="#BZ" INPUT="TEXT" LINE="18" COL="18" TYPE="%-30s" />
  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="柜员揽存关系维护成功">
NOTHING
</PACKAGE>
	<PRINT>
	"{
		print( 3,30,'柜员揽存关系维护');
		print( 5,10,'柜员代码: [ 4]',#GYDM);
		print( 6,10,'柜员名称: [10]',#GYMC);
		
		if(#BIFS == '1')
		{
			print( 7,10,'揽存帐号: [20]',#LCZH);
		}else if(#BIFS == '2')
		{
			print( 7,10,'揽存客户号: [20]',#LCKH);
		}
		print( 8,10,'客户名称: [50]',#KHMC);
		print( 9,10,'维护类型: [10]',#WHNAME);
	}"
	</PRINT>
</RESPONSE>
<RESPONSE>
	<PACKAGE DEVICE="PRINTER" LINESPACE="24" DESC="请打印业务专用凭证">
	NOTHING
	</PACKAGE>
	<PRINT>"{
    $KINDNO='00';
     dim @txtime  as string;
     @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
	   print( 5, 20,'机构名称:[30]',$BRNAME);
	   print( 5, 2,'代码:2204');
	   print( 5, 13,'交易:柜员揽存关系维护'); 
	   print( 7,20,'维护类型: [10]',#WHNAME);
	   print( 8, 20,'客 户 名:[60]',#KHMC);
	  if(#BIFS == '1')
		{
			print( 9, 20,'揽存帐号: [20]',#LCZH);
		}else if(#BIFS == '2')
		{
			print( 9, 20,'揽存客户号: [20]',#LCKH);
		}
	   
	   print( 10,20,'柜员代码:[30]',#GYDM);
	   print( 11,20,'柜员名称: [30]',#GYMC);
	    print_sq(); 
	   print( 24,20,'备注:');
	   
	   print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
	   print( 24,5,'柜员:[4]',$FD7);
	   print( 24,5,'流水号:[6]',$FD4);
	}"
	</PRINT>
</RESPONSE>
<OUTPUT>
</OUTPUT>
</TRANSACTION>
