<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00000000" TITLE="1001 下传报表"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
  <COMMSEND>"{
	commsend_001();
	$FD44=#BBRQ;
	$FD91=#JGBM;	
}"
</COMMSEND>
<COMMRECV>"{
}"
</COMMRECV>

<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(1001                            下传报表)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM LINE="6"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(                             【 下传报表 】)"/>
  <ITEM LINE="8"  COL="3" TYPE="%-74s" FUNCTIONS=
   "T(                      ----------------------------)"/>
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=8991)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  <!--输入变量-->
  <ITEM LINE="10" COL="28" TYPE="%-10s" FUNCTIONS="T( 机构编码:)"/>
  <ITEM LINE="14" COL="28" TYPE="%-10s" FUNCTIONS="T( 报表日期:)"/>
  <ITEM NAME="#JGBM" INPUT="TEXT" LINE="10" COL="38" TYPE="%5d" FUNCTIONS=""/>
  <ITEM NAME="#BBRQ" INPUT="TEXT" LINE="14" COL="38" TYPE="%-8d" FUNCTIONS=""/>
   <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  
  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>"{
	dim @remote_file as string;
	dim @local_file as string;
	dim @file as file;
	@remote_file='rptpack/tar/rpt.'+#JGBM+'.'+#BBRQ+'.Z';
	@local_file= '../rpt/'+#JGBM+'/'+#BBRQ+'/rpt.'+#JGBM+'.'+#BBRQ+'.Z';
	if(call('set_rpt_dir '+#JGBM+' '+ #BBRQ,1)!=0){
		if(msgbox('报表已经存在,重新下传吗?','提示','yes|no')==1){
			return(true);
		}
	}
	if(getfile(@remote_file,@local_file)){
		call( 'cd ../rpt/'+#JGBM+'/'+#BBRQ+';uncompress rpt.'+#JGBM+'.'+
			#BBRQ+'.Z;tar xvf rpt.'+#JGBM+'.'+#BBRQ);
		showmsg('报表下传成功!');
		rerun();
		return(true);
	}else{
		showmsg('报表下传失败,请重试!');
		return(false);
	}	
				
  }"
  </ONCLICK>
  </ITEM>

</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE>
NOTHING
</PACKAGE>
</RESPONSE>
</TRANSACTION>
