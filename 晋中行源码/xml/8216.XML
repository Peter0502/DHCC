<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="00010000" TITLE="8216 柜面通和村镇对账"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">

<!--12345678901234567890123456789012345678901234567890123456789012345678901234567890-->
<!--         1         2         3         4         5         6         7         8-->
<!--  注意：各个配置项的COL 属性最好是奇数, 这样可以避免出现乱码。                  -->
<!--        另外, 每个汉字的开始列号也最好是奇数, 每个字符串的长度也最好是偶数。    -->

<FIRSTWORK RETURN="TRUE">"{   //柜员一进入交易就检查签到状态 20100708

	commsend_001();
	$FD16 = '9803';
	$FD92 = $TLRNO; //本柜员
	callserver();

	if($FD12!='0000')
	{
		showmsg(geterror());
		return(false);
	}
	if($FD70!='0')
	{
		showmsg('此柜员尚未签到!');
		return(false);
	}
	
	$FD26='';
	$FD91='';
	$FD70='';
	$FD92='';
	
}"
</FIRSTWORK>
<VARIABLE>
<ITEM NAME="#SH_JG"		TYPE="%-30s"	FUNCTIONS="T()"/>
<ITEM NAME="#RX_JG"		TYPE="%-30s"	FUNCTIONS="T()"/>
<ITEM NAME="#FX_JG"		TYPE="%-30s"	FUNCTIONS="T()"/>
<ITEM NAME="#XY_JG"		TYPE="%-30s"	FUNCTIONS="T()"/>
<ITEM NAME="#ZQ_JG"		TYPE="%-30s"	FUNCTIONS="T()"/>
<ITEM NAME="#TG_JG"		TYPE="%-30s"	FUNCTIONS="T()"/>
<ITEM NAME="#GJ_JG"		TYPE="%-30s"	FUNCTIONS="T()"/>

  <ITEM LINE="3"  COL="3" TYPE="%-52s" FUNCTIONS=
  "T(8216                           柜面通和村镇对账)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS="T()"/>

  <ITEM ITEM="#TXNO" TYPE="%4d"  FUNCTIONS="T($TXNO=8216)"/>

<ITEM LINE="10" COL="15" TYPE="%-14s" FUNCTIONS="T(对账日期:)"/>
<ITEM LINE="10" COL="25" NAME="#TX_DATE"  TYPE="%8d"    INPUT="TEXT" FUNCTIONS="T($HDATE)D()"/>

  <ITEM LINE="16"  COL="65" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>"{
	dim @tota as string;
	dim @txno as string;
		
	@txno=$TXNO;
	commsend_001();
	$FD16='8226';
	$FD24='gmt';
	$FD28=#TX_DATE;
	@tota=callagn();
	$TXNO=@txno;
	if($FD12!='0000'){
		showmsg(geterror());
		return(false);
	}
	

	 if(substr($FD37,0,1) == '1')
	 {
	 	#SH_JG='商行对账成功';
	 }
	 else
	 {
	 	#SH_JG='商行对账失败';
	 }
	 
	  if(substr($FD37,1,1) == '1')
	 {
	 	#RX_JG='融信对账成功';
	 }
	 else
	 {
	 	#RX_JG='融信对账失败，商行需要补账';
	 }
	 
	  if(substr($FD37,2,1) == '1')
	 {
	 	#FX_JG='汾西对账成功';
	 }
	 else
	 {
	 	#FX_JG='汾西对账失败，商行需要补账';
	 }
	 
	  if(substr($FD37,3,1) == '1')
	 {
	 	#XY_JG='孝义对账成功';
	 }
	 else
	 {
	 	#XY_JG='孝义对账失败，商行需要补账';
	 }
	 
	if(substr($FD37,4,1) == '1')
	 {
	 	#ZQ_JG='左权对账成功';
	 }
	 else
	 {
	 	#ZQ_JG='左权对账失败，商行需要补账';
	 }
	 
	  if(substr($FD37,5,1) == '1')
	 {
	 	#TG_JG='太古对账成功';
	 }
	 else
	 {
	 	#TG_JG='太古对账失败，商行需要补账';
	 }
	 
	  if(substr($FD37,6,1) == '1')
	 {
	 	#GJ_JG='古交对账成功';
	 }
	 else
	 {
	 	#GJ_JG='古交对账失败，商行需要补账';
	 }
	 
	runoutput();
	rerun();
	refresh();
	return(true);		
  }"
  </ONCLICK>
  </ITEM>
</VARIABLE>


<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="显示内容">
NOTHING
</PACKAGE>
<PRINT>"{
print(4,20,'对账结果');
print(6,15,'商行对账结果：[30]',#SH_JG);
print(7,15,'融信对账结果：[30]',#RX_JG);
print(8,15,'汾西对账结果：[30]',#FX_JG);
print(9,15,'孝义对账结果：[30]',#XY_JG);
print(10,15,'左权对账结果：[30]',#ZQ_JG);
print(11,15,'太古对账结果：[30]',#TG_JG);
print(12,15,'古交对账结果：[30]',#GJ_JG);

print(15,10,'机    构:[7     ]                  操作员:[6    ]',$KINBR,$TLRNO);
}"
</PRINT>
</RESPONSE>

</TRANSACTION>
