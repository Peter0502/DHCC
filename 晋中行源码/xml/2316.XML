<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111001" TITLE="2316 关联企业信息维护"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
	commsend_001();
	$FD70=#CZLX;
	$FD26=#NAME;
	$FD28=#CUSTNO;
	$FD29=#QYBH;
	$FD67=#GLLX;
	$FD69=#ZJLX;
	$FD62=#ZJHM;
	$FD37=#ZZJGDM;
	$FD38=#XYDM;
	
}"
</COMMSEND>
<COMMRECV>"{
		commrecv_001();
}"
</COMMRECV>
<VARIABLE>
  <ITEM LINE="3"  COL="3" TYPE="%-44s" FUNCTIONS=
    "T(2316                       关联企业信息维护)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  <ITEM NAME="#TXNO"    TYPE="%-4s" FUNCTIONS="T($TXNO=1317)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>
  
  <!--输入变量-->
  <ITEM LINE="7" COL="15" TYPE="%-10s" FUNCTIONS="T(操作类型:!)"/>
  <ITEM NAME="#CZLX" INPUT="SELECT" LINE="7" COL="22" TYPE="%-1s" FUNCTIONS="T(1)">
  <SELECT>
		<OPTION VALUE="1" TITLE="修改"/>
		<OPTION VALUE="2" TITLE="删除"/>
	</SELECT>
	<ONLOSTFOCUS>"{
		if(#CZLX == '2'){
		enable(#GLLX,false);
		enable(#NAME,false);
		enable(#ZJLX,false);
		enable(#ZJHM,false);
		enable(#ZZJGDM,false);
		enable(#XYDM,false);
		
		}
		else{
		enable(#GLLX,true);
		enable(#NAME,true);
		enable(#ZJLX,true);
		enable(#ZJHM,true);
		enable(#ZZJGDM,true);
		enable(#XYDM,true);
		}
		}"
	</ONLOSTFOCUS>
	
  </ITEM>
  <ITEM NAME="#SCZLX" TYPE="%-4s"      FUNCTIONS="S(#CZLX,#CZLX)"/>
  
  <ITEM LINE="8"  COL="3" TYPE="%-74s" FUNCTIONS=
   "T(--------------------------------------------------------------------------)"/>
  <ITEM LINE="10" COL="15" TYPE="%-9s" FUNCTIONS="T(客 户 号:)"/>
	<ITEM LINE="11" COL="15" TYPE="%-10S" FUNCTIONS="T(企业编号:)"/> 
	
	<ITEM LINE="13" COL="15" TYPE="%-10S" FUNCTIONS="T(关联类型:)"/>  
  <ITEM LINE="14"  COL="15" TYPE="%-10s" FUNCTIONS="T(关联企业名称:)"/>
 
  <ITEM LINE="15" COL="15" TYPE="%-10s" FUNCTIONS="T(证件类型:)"/>
  <ITEM LINE="16" COL="15" TYPE="%-10s" FUNCTIONS="T(证件号码:)"/>  
  <ITEM NAME="#ZZJGDM1" LINE="17" COL="15" TYPE="%-20s" FUNCTIONS="T(组织机构代码:)"/> 
  <ITEM NAME="#XYDM1" LINE="18" COL="15" TYPE="%-10s" FUNCTIONS="T(信用代码:)"/>
  
  <ITEM NAME="#CUSTNO"  INPUT="TEXT" LINE="10" COL="22" TYPE="%-8s" FUNCTIONS="">
  <ONLOSTFOCUS>
  	"{
		dim @txno_bak as string;
		@txno_bak=$TXNO;
		$TXNO='9942';
		$FD28=#CUSTNO;
		commsend_001();
		$TXNO=@txno_bak;
		callserver();
		#KHLX=$FD66;
		showmsg(#KHLX);
		//showmsg(#KHTYPE);	
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
			}
		if(#KHLX == '1')
		{
			showmsg('个人户不能做此交易！');
			return(false);
		}
	}"  	
  	</ONLOSTFOCUS>
  </ITEM>
 <!-- <ITEM NAME="#GDBH" INPUT="TEXT" LINE="11" COL="22" TYPE="%4d"  FUNCTIONS=""> 
  <ONLOSTFOCUS> 
 "{	
 		<!--initfd();	
    commsend_001();
 		$FD16='9891';
		$FD28=#KHH;
	  $FD34=#SHXH;
		callserver();
		if($FD12!='0000'){
			showmsg(geterror());
			return(false);
		}
		#SHFSLB=delspace($FD67);
		show(#SHFSLB,true);
 
  dim @txno_bak as string;
	dim @tota as string;
	@txno_bak=$TXNO;
	$TXNO='9798';
	commsend_001();
	@tota=callserver();	
	$TXNO=@txno_bak;
	setsel(#SHFSMX,@tota,'o5t20o1v2o2');
	show(#SHFSMX,true);
	if(#CZLX == '2')
	{
		goitem(#SUBMIT);
	}
	}"
 </ONLOSTFOCUS>
  </ITEM> -->
   
   <ITEM NAME="#S" TYPE="%-30s" FUNCTIONS="">
   <ONLOSTFOCUS>
    "{   //获取证件类型
  		dim @txno_bak as string;
			dim @tota as string;
			@txno_bak=$TXNO;
			$TXNO='9799';
			$FD67='1';
			commsend_001();
			@tota=callserver();
			if($FD12 != '0000')
			{
				showmsg(geterror());
				return(false);
			}
		
			$TXNO=@txno_bak;
			setsel(#ZJLX,@tota,'o5t20o1v1o2');
			}"
  	</ONLOSTFOCUS>
  </ITEM>
  
	<ITEM NAME="#QYBH" INPUT="TEXT" LINE="11" COL="22" TYPE="%4d"  FUNCTIONS="">
		<ONLOSTFOCUS>"{
			initfd();
			commsend_001();
			$FD28=#CUSTNO;
			$FD29=#QYBH;
			$FD16='8553';
			
			callserver();
			if($FD12!='0000')
			{
				showmsg(geterror());
				return(false);
			}
			#GLLX=$FD67;
			#NAME=$FD26;
			
			#ZJLX=$FD69;
			#ZJHM=$FD62;
			
			#ZZJGDM=$FD37;
			#XYDM=$FD38;
			
			}"
			</ONLOSTFOCUS>
	</ITEM>
<!--
  <ITEM NAME="#JZGX" 	INPUT="SELECT" 	LINE="14" COL="22" TYPE="%-1s" 	FUNCTIONS="T(0)V(NB)">
  <SELECT>
		<OPTION VALUE="0" TITLE="1.配偶"/>
		<OPTION VALUE="1" TITLE="2.父母"/>
		<OPTION VALUE="2" TITLE="3.子女"/>
		<OPTION VALUE="3" TITLE="4.其他血亲"/>
		<OPTION VALUE="4" TITLE="5.其他姻亲"/>
	</SELECT>
  </ITEM>
  <ITEM NAME="#CYBH" INPUT="TEXT" LINE="10" COL="25" TYPE="%-6s" 	FUNCTIONS="V(NB)"/>  -->
  <ITEM NAME="#GLLX" 	INPUT="SELECT" LINE="13" COL="22" TYPE="%-1s" 	FUNCTIONS="T(1)V(NB)">
  	<SELECT>
  		<OPTION VALUE="1" TITLE="1.实际控制人"/>
		  <OPTION VALUE="2" TITLE="2.除股东外控制本企业的相关企业"/>	
		  <OPTION VALUE="3" TITLE="3.本企业控制的相关企业"/>	
		  <OPTION VALUE="4" TITLE="4.被同一企业控制的相关企业"/>
		  <OPTION VALUE="5" TITLE="5.其他关联企业"/>	
  	</SELECT>
  	<!--
    <ONLOSTFOCUS>"{
		if(#GDLX == '1'){
		show(#ZZJGDM,true);
		show(#XYDM,true);
		show(#ZZJGDM1,true);
		show(#XYDM1,true);
		//show(#GDXB1,false);
		//enable(#GDXB1,false);
		show(#GDXB,false);
		enable(#GDXB,false);
		}
		else
		{
			show(#ZZJGDM,false);
			show(#XYDM,false);
			show(#ZZJGDM1,false);
			show(#XYDM1,false);
			show(#GDXB,true);
			enable(#GDXB,true);
			//show(#GDXB1,true);
			//enable(#GDXB1,true);
		}
		}"
		</ONLOSTFOCUS>   -->
  </ITEM>
  
  <ITEM NAME="#NAME" 	INPUT="TEXT" LINE="14" COL="22" TYPE="%-20s" 	FUNCTIONS="V(NB)"/>
<!--
 <ITEM NAME="#GDXB" INPUT="SELECT" LINE="15" COL="22" TYPE="%-6s" 	FUNCTIONS="T(M)V(NB)">
  	<SELECT>
		<OPTION VALUE="M" TITLE="1.男"/>
		<OPTION VALUE="F" TITLE="2.女"/>
	</SELECT>
  </ITEM>
-->
   

   <ITEM NAME="#SKHLX" TYPE="%-4s"  FUNCTIONS="S(#KHLX,#KHLX)"/> 
  
  <ITEM NAME="#ZJLX" INPUT="SELECT" LINE="15" COL="22" TYPE="%-50s" FUNCTIONS="T()V(NB)"> 	
  	<SELECT>
  		<OPTION VALUE="1" TITLE="1.身份证">
  	</SELECT>
  </ITEM>
  <ITEM NAME="#ZJHM" INPUT="TEXT" LINE="16" COL="22" TYPE="%-20s" FUNCTIONS="V(NB)">	
  	
  <ONLOSTFOCUS>
  	"{
  	dim @l as number;
		@l = len(#ZJHM);
		if('1' == #ZJLX){
    		if(@l == 15 or  @l == 18){
		}else{
	  		showmsg('身份证号码位数错误');
        	return(false);
			}
    	}
	}"
	</ONLOSTFOCUS>
	</ITEM>
	<ITEM NAME="#ZZJGDM" INPUT="TEXT" LINE="17" COL="22" TYPE="%-20s" FUNCTIONS="T()V(NB)">
	<ONLOSTFOCUS>"{
		dim @l as number;
		@l = len(#ZZJGDM);
    if(@l == 10){
		}
		else{
	  		showmsg('组织机构号码位数错误，应为10位');
        	return(false);
			}
    	
  }"
  </ONLOSTFOCUS>
  </ITEM>
  <ITEM NAME="#XYDM" INPUT="TEXT" LINE="18" COL="22" TYPE="%-20s" FUNCTIONS="T()V(NB)">
  <ONLOSTFOCUS>"{
		dim @l as number;
		@l = len(#XYDM);
    if(@l == 18){
		}
		else{
	  		showmsg('机构信用号码位数错误，应为18位');
        	return(false);
			}
    	
  }"
  </ONLOSTFOCUS>
  </ITEM>	
<!--  <ITEM NAME="#CGBL" INPUT="TEXT" LINE="19" COL="22" TYPE="%-16.2f" FUNCTIONS="V(NB)">
  	<ONLOSTFOCUS>
 		"{
 		if(#CGBL &lt; 0.0 or #CGBL &gt; 100.0)
 		{
 			showmsg('请输入正确的持股比例!');
 			return(false);
 		}
 		}"
 		</ONLOSTFOCUS>
 </ITEM>
-->   
  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM NAME="#SUBMIT" LINE="25" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="SUBMIT"/>
</VARIABLE>
<REQUEST>
</REQUEST>
<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="关联企业信息">
NOTHING
</PACKAGE>
	<PRINT>
	"{
		if(#CZLX == '1')
		{
			print( 3,30,'关联企业信息[4]',#SCZLX);
			print( 5,22,'客   户   号: [ 8]',#CUSTNO);
			print( 6,22,'企 业  编 号: [ 4]',#QYBH);
			print( 7,22,'关 联  类 型：[ 50]',#GLLX);
			print( 8,22,'关联企业名称：[ 50]',#NAME);
			print( 9,22,'注 册  类 型：[ 2]',#ZJLX);
			print(10,22,'注 册  号 码：[ 20]',#ZJHM);
			print(11,22,'组织机构代码：[ 10]',#ZZJGDM);
			print(12,22,'信 用  代 码：[ 18]',#XYDM);

		}
		else
		{
			print( 3,30,'关联企业信息[4]',#SCZLX);
			print( 5,22,'客   户   号: [ 8]',#CUSTNO);
			print( 6,22,'企	业  编 号: [ 4]',#GDBH);
			print( 7,22,'关 联  类 型：[ 50]',#GLLX);
			print( 8,22,'关联企业名称：[ 50]',#NAME);
			print( 9,22,'注 册  类 型：[ 2]',#ZJLX);
			print(10,22,'注 册  号 码：[ 20]',#ZJHM);
			print(11,22,'组织机构代码：[ 10]',#ZZJGDM);
			print(12,22,'信 用  代 码：[ 18]',#XYDM);
		}
	}"
	</PRINT>
</RESPONSE>
<OUTPUT>
</OUTPUT>
<RESPONSE>
<PACKAGE DEVICE="PRINTER" DESC="关联企业信息">
NOTHING
</PACKAGE>
        <PRINT>
        "{
            $KINDNO='00';
            dim @txtime  as string;
            @txtime=substr($SYSTIME,0,2)+':'+substr($SYSTIME,2,2)+':'+substr($SYSTIME,4,2);
             print( 5, 20,'机构名称:[30]',$BRNAME);
             print( 5, 2,'代码:2316');
             print( 5, 13,'交易:关联企业信息维护');

             if(#CZLX == '1')
         {
              print( 7,30,'关联企业信息[4]',#SCZLX);
							print( 8,22,'客   户   号: [ 8]',#CUSTNO);
							print( 9,22,'企	业  编 号: [ 4]',#GDBH);
							print(10,22,'关 联  类 型：[ 50]',#GLLX);
							print(11,22,'关联企业名称：[ 50]',#NAME);
							print(12,22,'注 册  类 型：[ 2]',#ZJLX);
							print(13,22,'注 册  号 码：[ 20]',#ZJHM);
							print(14,22,'组织机构代码：[ 10]',#ZZJGDM);
							print(15,22,'信 用  代 码：[ 18]',#XYDM);
              
              print( 24,20,'备注:')
              print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
              print( 24,5,'柜员:[4]',$FD7);
              print( 24,5,'流水号:[6]',$FD4);

          }
         else
         {
          		print( 7,30,'关联企业信息[4]',#SCZLX);
							print( 8,22,'客   户   号: [ 8]',#CUSTNO);
							print( 9,22,'企	业  编 号: [ 4]',#GDBH);
							print(10,22,'关 联  类 型：[ 50]',#GLLX);
							print(11,22,'关联企业名称：[ 50]',#NAME);
							print(12,22,'注 册  类 型：[ 2]',#ZJLX);
							print(13,22,'注 册  号 码：[ 20]',#ZJHM);
							print(14,22,'组织机构代码：[ 10]',#ZZJGDM);
							print(15,22,'信 用  代 码：[ 18]',#XYDM);
              
              print( 24,20,'备注:')
              print( 24,27,'交易日期:[8] [8]',$HDATE,@txtime);
              print( 24,5,'柜员:[4]',$FD7);
              print( 24,5,'流水号:[6]',$FD4);     				
 
         }
        }"
        </PRINT>
</RESPONSE>
</TRANSACTION>



