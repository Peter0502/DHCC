<?xml version="1.0" encoding="GBK" ?> 
<TRANSACTION RIGHTS="11111001" TITLE="1003.XML 大小额报表打印" 
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org"> 
<!--12345678901234567890123456789012345678901234567890123456789012345678901234567890--> 
<!--         1         2         3         4         5         6         7         8--> 
 
<!--  注意：各个配置项的COL 属性最好是奇数, 这样可以避免出现乱码。                  --> 
<!--        另外, 每个汉字的开始列号也最好是奇数, 每个字符串的长度也最好是偶数。    --> 
 
<VARIABLE> 
  <ITEM LINE="3"  COL="3" TYPE="%-42s" FUNCTIONS= 
 "T(1003                          大小额报表打印)"/> 
<!--12345678901234567890123456789012345678901234567890123456789012345678901234567890--> 
<!--         1         2         3         4         5         6         7         8--> 
  <ITEM LINE="4"  COL="3" TYPE="%-74s" FUNCTIONS= 
 "T(─────────────────────────────────────)"/> 
<!--12345678901234567890123456789012345678901234567890123456789012345678901234567890--> 
 
   
  <ITEM LINE="8"  COL="25" TYPE="%-10s" FUNCTIONS="T(报表日期: 12345678)"/> 
  <ITEM LINE="10" COL="25" TYPE="%-10s" FUNCTIONS="T(报表名称:!1)"/> 
  <ITEM LINE="12" COL="25" NAME="#SHOWKINBR" TYPE="%-14s" INPUT="LABEL" VISABLE="FALSE"  FUNCTIONS="T(行    号:)"/> 
 
  <!--ITEM LINE="14" COL="25" TYPE="%-30s" FUNCTIONS="T(打印方式:!1)"/--> 
 
  <ITEM NAME="#CALDATE"  TYPE="%8s"  FUNCTIONS=""> 
   <ONLOSTFOCUS> 
   "{ 
		dim @d as date; 
		@d=$HDATE; 
		//showmsg($HDATE); 
		#RPTDATE=@d-1;	 
   }" 
   </ONLOSTFOCUS> 
  </ITEM>    
  <ITEM LINE="8"  COL="35" NAME="#RPTDATE"  TYPE="%8d"  DEVICE="KEYBOARD" FUNCTIONS="V(19800101,20100101)"> 
   <ONLOSTFOCUS> 
   "{ 
       //show(#RPTNAME,true); 
   }" 
   </ONLOSTFOCUS> 
  </ITEM>    
  <ITEM LINE="10" COL="35" NAME="#RPTNAME"  TYPE="%-20s" DEVICE="KEYBOARD" FUNCTIONS="T(RPT501)"> 
   <SELECT> 
	 <OPTION VALUE="RPT501"      TITLE="大额支付往帐清单" /> 
	 <OPTION VALUE="RPT502"      TITLE="大额支付来帐清单" /> 
	 <OPTION VALUE="RPT503"      TITLE="大额支付类来帐挂账清单" /> 
	 <OPTION VALUE="RPT504"      TITLE="大额汇票登记簿" /> 
	 <OPTION VALUE="RPT505"      TITLE="大额大额支付往帐拒绝清单" /> 
	 <OPTION VALUE="RPT506"      TITLE="大额查询登记簿" /> 
	 <OPTION VALUE="RPT507"      TITLE="大额查复登记簿" /> 
	 <OPTION VALUE="RPT508"      TITLE="大额自由格式" /> 
	 <OPTION VALUE="RPT509"      TITLE="大额撤销,退回登记簿查询清单" /> 
	 <OPTION VALUE="RPT510"      TITLE="小额支付类往帐清单" /> 
	 <OPTION VALUE="RPT511"      TITLE="小额支付类来帐清单" /> 
	 <OPTION VALUE="RPT512"      TITLE="小额支付类来帐挂账清单" /> 
	 <OPTION VALUE="RPT513"      TITLE="小额支付往帐拒绝清单" /> 
	 <OPTION VALUE="RPT514"      TITLE="小额往包清单" /> 
	 <OPTION VALUE="RPT515"      TITLE="小额来包清单" /> 
	 <OPTION VALUE="RPT516"      TITLE="小额拒绝往包清单" /> 
	 <OPTION VALUE="RPT517"      TITLE="小额查询登记簿-" /> 
	 <OPTION VALUE="RPT518"      TITLE="小额查复登记簿" /> 
	 <OPTION VALUE="RPT519"      TITLE="小额自由格式" /> 
	 <OPTION VALUE="RPT520"      TITLE="小额撤冲正止退登记簿查询清单" /> 
	 <OPTION VALUE="rptHP1"      TITLE="银行汇票签发清单(日)" /> 
	 <OPTION VALUE="rptHP2"      TITLE="银行汇票移存清单(日)" /> 
	 <OPTION VALUE="rptHP3"      TITLE="银行汇票核销清单(日)" /> 
	 <OPTION VALUE="rptHP4"      TITLE="银行汇票签发统计(月)" /> 
	 <OPTION VALUE="rptHP5"      TITLE="银行汇票未核销统计表" /> 
	 <OPTION VALUE="rptHP6"      TITLE="银行汇票逾期退回未清算清单(日)" />
	 <OPTION VALUE="rptHP7"      TITLE="银行汇票兑付未清算清单(日)" />
   </SELECT> 
   <ONLOSTFOCUS> 
   "{ 
        goitem(#RPTTYPE); 
   }" 
   </ONLOSTFOCUS> 
  </ITEM> 
 <!-- 
  <ITEM LINE="14" COL="35" NAME="#RPTTYPE"  TYPE="%-1s" DEVICE="KEYBOARD" FUNCTIONS="T(0)"> 
   <SELECT LINE="14" COL="52"> 
     <OPTION VALUE="0  使用本机终端打印机      " TITLE="0.使用本机终端打印机"/> 
     <OPTION VALUE="1  使用中心机房高速行打    " TITLE="1.使用中心机房高速行打"/> 
   </SELECT> 
  </ITEM> 
  --> 
  <ITEM NAME="#RPTTYPE"  TYPE="%-1s" FUNCTIONS="T(0)"> 
    <ONLOSTFOCUS> 
    "{ 
		if($KINBR=='19999' or $KINBR=='10001')
		{
			show(#SHOWKINBR,true); 
			show(#KINBR,true); 
		} 
		else
		{ 
			#KINBR=$KINBR; 
		}
	 
    }" 
    </ONLOSTFOCUS> 
  </ITEM> 
<ITEM LINE="12" COL="35" NAME="#KINBR" TYPE="%-5s" DEVICE="KEYBOARD" INPUT="TEXT"  MESSAGE="" VISABLE="FALSE"  FUNCTIONS="T($KINBR,1,5)">  
    <ONLOSTFOCUS> 
    "{ 
       if($KINBR=='19999')
	{ 
	 //showmsg('输 99999 可以打印出全社报表'); 
	} 
	if($KINBR=='10001') 
	{
		showmsg('清算中心输入00000可一次打印所有行所有报表');
	}
    }" 
  </ONLOSTFOCUS> 
  </ITEM> 
<!--
  <ITEM  NAME="#BBB"  TYPE="%2s" FUNCTIONS="T($KINBR,1,2)"/> 
  <ITEM  NAME="#CCC"  TYPE="%2s" FUNCTIONS="T(#KINBR,1,2)"/> 
  <ITEM  NAME="#AAA"  TYPE="%1s" FUNCTIONS=""> 
  <ONLOSTFOCUS> 
"{ 
     if(#BBB!='00') 
     { 
             if(#BBB!=#CCC)            
             { 
              showmsg('不能查询他行!!'); 
               return(false); 
             } 
     } 
}" 
</ONLOSTFOCUS> 
</ITEM> 
-->
  <ITEM LINE="21"  COL="65" TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON" >   
   <ONCLICK> 
   "{ 
        dim @prtcmd as string; 
        @prtcmd='fview -p rlp'+$KINBR+$NETPRT+' '; 
      //  @prtcmd='fview '; 
	    call('extend_tar.sh '+#RPTDATE); 
	    if($KINBR=='10001')
		{
			showmsg('why');
		    call('liuyue.sh '+#RPTDATE); 
		}
	    if(#KINBR=='00000' and  $KINBR=='10001')
	    {
		    #RPTNAME='HVLV_ALL';
		    #KINBR = '10001';
	    }

	    if(#KINBR=='99999'){ 
	    	call(@prtcmd+'../rpt/'+#RPTDATE+'/'+#RPTNAME+'.txt'); 
	    } 
	    else{ 
	    	call(@prtcmd+'../rpt/'+#RPTDATE+'/'+#KINBR+'/'+#RPTNAME+'.txt'); 
	    } 
    }" 
   </ONCLICK> 
  </ITEM> 
 
 
</VARIABLE> 
 
<REQUEST><PACKAGE>#RPTDATE$KINBR#RPTNAME</PACKAGE></REQUEST> 
 
<RESPONSE><PACKAGE></PACKAGE></RESPONSE> 
<OUTPUT></OUTPUT> 
 
</TRANSACTION> 
 
