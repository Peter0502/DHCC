<?xml version="1.0" encoding="GBK" ?>
<TRANSACTION RIGHTS="11111111" TITLE="5587 扣税交易与行内冲正"
  xmlns="http://www.otd.org/MENU" xmlns:W3CNS="http://www.w3c.org">
<COMMSEND>"{
  commsend_001();
}"
</COMMSEND>
<COMMRECV>"{
   commrecv_001();
}"
</COMMRECV>

<VARIABLE UPLOOP="TRUE">
  <ITEM LINE="3"  COL="3" TYPE="%-50s" FUNCTIONS=
    "T(5587                          需要与行内冲正的扣税交易查询-冲正)"/>
  <ITEM LINE="4"  COL="3"  TYPE="%-74s" FUNCTIONS=
   "T(─────────────────────────────────────)"/>
  
  <ITEM NAME="#TXNO" TYPE="%-4s" FUNCTIONS="T($TXNO=5586)"/>
  <ITEM NAME="#MSGTYPE" TYPE="%-5s" FUNCTIONS="T($MSGTYPE=03001)"/>

  <ITEM LINE="12"  COL="5" TYPE="%-14s" FUNCTIONS="T(委 托  日 期:)"/>
  <ITEM LINE="12"  COL="40" TYPE="%-14s" FUNCTIONS="T(征税机关代码:)"/>
  <ITEM LINE="13"  COL="5" TYPE="%-14s" FUNCTIONS="T(交易流水序号:)"/>
  <ITEM LINE="13"  COL="40" TYPE="%-14s" FUNCTIONS="T(扣 税  账 号:)"/>
  <ITEM LINE="14"  COL="5" TYPE="%-14s" FUNCTIONS="T(纳税 人 名称:)"/>
  <ITEM LINE="15"  COL="5" TYPE="%-14s" FUNCTIONS="T(扣税账号户名:)"/>
  <ITEM LINE="16"  COL="5" TYPE="%-14s" FUNCTIONS="T(扣/缴税金额 :)"/>
  <ITEM LINE="17"  COL="5" TYPE="%-14s" FUNCTIONS="T(TIPS扣税结果:)"/>
  <ITEM LINE="17"  COL="40" TYPE="%-14s" FUNCTIONS="T(核心记账结果:)"/>
  <ITEM LINE="18"  COL="5" TYPE="%-14s" FUNCTIONS="T(TIPS对账结果:)"/>
  <!--输入变量-->
  <ITEM NAME="#AAAA" FUNCTIONS="">
  <ONLOSTFOCUS>
  "{
     dim @txno as string;
   dim @tota as string;
   dim @taxorgcode as string;
   dim @wtdate as string;
   dim @traceno as string;
   dim @taxpayname as string;
   dim @payacct as string;
   dim @handorgname as string;
   dim @taxamt as string;
   dim @tipsksstat as string;
   dim @hxjzstat as string;
   dim @tipsdzjg as string;
   dim @ii as number;
   
     @ii=0;
     commsend_001();
     $FD16='9526';
     $TXNO='9526';
     @tota=calltips();
     if($FD12!='0000'){
        showmsg(geterror());
        return(false);
     }
     savefiletxt('../tmp/TIPS_CZ'+$KINBR+$TTYNAME,@tota);
     list_init(7,78,5,1);  
     list_setcolcnt(10);

     list_setcol(0,'征收机关代码',14);   
     list_setcol(1,'委托日期',10);  
     list_setcol(2,'流水号',10);  
     list_setcol(3,'纳税人名称',50);  
     list_setcol(4,'缴税账号',32);  
     list_setcol(5,'缴税账户户名',50);  
     list_setcol(6,'缴税金额',18);  
     list_setcol(7,'TIPS扣税结果',20);  
     list_setcol(8,'核心记账结果',20);  
     list_setcol(9,'TIPS对账结果',20);  
     list_load('../tmp/TIPS_CZ'+$KINBR+$TTYNAME);
     list_work();
     @ii=list_getselid();
     @taxorgcode=list_gettext(@ii,0);
     @wtdate=list_gettext(@ii,1);
     @traceno=list_gettext(@ii,2);
     @taxpayname=list_gettext(@ii,3);
     @payacct=list_gettext(@ii,4);
     @handorgname=list_gettext(@ii,5);
     @taxamt=list_gettext(@ii,6);
     @tipsksstat=list_gettext(@ii,7);
     @hxjzstat=list_gettext(@ii,8);
     @tipsdzjg=list_gettext(@ii,9);
     
     #WT_DATE=@wtdate;
     #TAXORGCODE=@taxorgcode;
     #TRACE_NO=@traceno;
     #TAXPAYNAME=@taxpayname;
     #PAYACCT=@payacct;
     #HANDORGNAME=@handorgname;
     #TXAMT=comma(@taxamt);
     #TIPSSTAT=@tipsksstat;
     #HXSTAT=@hxjzstat;
     #TIPSCHKSTAT=@tipsdzjg;
     
     enable(#WT_DATE,true);
     enable(#TAXORGCODE,true);
     enable(#TRACE_NO,true);
     enable(#TAXPAYNAME,true);
     enable(#PAYACCT,true);
     enable(#HANDORGNAME,true);
     enable(#TXAMT,true);
     enable(#TIPSSTAT,true);
     enable(#HXSTAT,true);
     enable(#TIPSCHKSTAT,true);
  }"    
  </ONLOSTFOCUS>
  </ITEM>
        
  <ITEM NAME="#WT_DATE"     LINE="12" COL="19" TYPE="%-8s"  INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#TAXORGCODE"  LINE="12" COL="54" TYPE="%-12s" INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#TRACE_NO"    LINE="13" COL="19" TYPE="%-8s"  INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#PAYACCT"     LINE="13" COL="54" TYPE="%-24s" INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#TAXPAYNAME"  LINE="14" COL="19" TYPE="%-60s" INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#HANDORGNAME" LINE="15" COL="19" TYPE="%-60s" INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#TXAMT"       LINE="16" COL="19" TYPE="%-17s" INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#TIPSSTAT"    LINE="17" COL="19" TYPE="%-20s" INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#HXSTAT"      LINE="17" COL="54" TYPE="%-20s" INPUT="LABEL" FUNCTIONS=""/>
  <ITEM NAME="#TIPSCHKSTAT" LINE="18" COL="19" TYPE="%-20s" INPUT="LABEL" FUNCTIONS=""/>

  <!------------一些没有用的变量,只是为了公共脚本执行时不报错------------>
  <ITEM NAME="#PASSWD" TYPE="%-6s" FUNCTIONS="T()"/>
  <ITEM NAME="#RETSTAT" TYPE="%-4s" FUNCTIONS="T()"/>

  <ITEM LINE="21" COL="59"  TYPE="%-6s" FUNCTIONS="T(确  定)" INPUT="BUTTON">
  <ONCLICK>"{
       
       //initfd();
       //commsend_001();
       //$TXNO='5586';
       //$FD16=$TXNO;
       //$FD44=#WT_DATE;
       //$FD73=#TRACE_NO;
       //$FD30=#TAXORGCODE;
       //$FD40=#TXAMT;

       //calltips();   
       //if($FD12!='0000'){
       //      showmsg(geterror());
       //      rerun();
       //      return(true);
       //}else {
       //  runoutput();
       //  #WT_DATE='';
       //  #TAXORGCODE='';
       //  #TRACE_NO='';
       //  #TAXPAYNAME='';
       //  #PAYACCT='';
       //  #HANDORGNAME='';
       //  #TXAMT='';
       //  #TIPSSTAT='';
       //  #HXSTAT='';
       //  #TIPSCHKSTAT='';
       //  
       //  enable(#WT_DATE,true);
       //  enable(#TAXORGCODE,true);
       //  enable(#TRACE_NO,true);
       //  enable(#TAXPAYNAME,true);
       //  enable(#PAYACCT,true);
       //  enable(#HANDORGNAME,true);
       //  enable(#TXAMT,true);
       //  enable(#TIPSSTAT,true);
       //  enable(#HXSTAT,true);
       //  enable(#TIPSCHKSTAT,true);
       //  rerun();
       //  return(true);
       // }
 }"
  </ONCLICK>
  </ITEM>
   
</VARIABLE>
<REQUEST>
</REQUEST>

<RESPONSE>
<PACKAGE DEVICE="SCREEN" DESC="显示内容" >
NOTHING
</PACKAGE>
</RESPONSE>
</TRANSACTION>
